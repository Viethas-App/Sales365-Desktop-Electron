{"version":3,"file":"default-src_app_sales_components_bill-type_bill-type-15_bill-type-15_module_ts-src_app_sales_-4b3184.js","mappings":"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","sources":["./src/app/sales/components/bill-type/bill-type-15/add/add.component.ts","./src/app/sales/components/bill-type/bill-type-15/add/add.component.html","./src/app/sales/components/bill-type/bill-type-15/bill-type-15.module.ts","./src/app/sales/components/bill-type/bill-type-15/detail/detail.component.ts","./src/app/sales/components/bill-type/bill-type-15/detail/detail.component.html","./src/app/sales/components/bill-type/bill-type-15/edit/edit.component.ts","./src/app/sales/components/bill-type/bill-type-15/edit/edit.component.html","./src/app/sales/menu/manage/delivery/services/ahamoveService/ahamove.service.ts","./src/app/sales/menu/manage/delivery/services/ghnService/ghn.service.ts","./src/app/sales/menu/manage/delivery/services/ghtkService/ghtk.service.ts","./src/app/sales/menu/manage/delivery/services/vnpostPost/vnpost-service.service.ts"],"sourcesContent":["import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { Observable } from 'rxjs';\r\nimport { WarrantyK57Col3Component } from 'src/app/sales/components/print/warranty/warranty-k57-col3/warranty-k57-col3.component';\r\nimport { WarrantyK80Col3Component } from 'src/app/sales/components/print/warranty/warranty-k80-col3/warranty-k80-col3.component';\r\nimport { WarrantyK80Col4Component } from 'src/app/sales/components/print/warranty/warranty-k80-col4/warranty-k80-col4.component';\r\nimport { WarrantyA5Component } from 'src/app/sales/components/print/warranty/warranty-a5/warranty-a5.component';\r\nimport { WarrantyA4Component } from 'src/app/sales/components/print/warranty/warranty-a4/warranty-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { VhBillType15, VhBillType15Detail, VhBillType15DetailCombo, VhWarranty } from '../bill-type15-interface';\r\n\r\n@Component({\r\n  selector: 'bill-type15-add',\r\n  templateUrl: './add.component.html',\r\n  styleUrls: ['./add.component.scss']\r\n})\r\nexport class AddComponent implements OnInit {\r\n  display_promotion_selling_price: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').display_promotion_selling_price\r\n  warning_lot_expried: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').warning_lot_expried\r\n  invoice: VhBillType15 = {\r\n    bill_type: 15,\r\n    payment_type: 1,\r\n    id_customer: 'id_retail',\r\n    id_branch: this.vhQuerySales.getDefaultBranch()._id,\r\n    id_employee: this.vhAuth.getUser()._id,\r\n    id_wallet: 'id_cash',\r\n    date: new Date(),\r\n    total: 0,\r\n    payment: 0,\r\n    tax: 0,\r\n    discount: 0,\r\n    fee: 0,\r\n    note: '',\r\n    price_type: 1,\r\n    payment_points: 0,\r\n    payment_coupons: 0,\r\n    discount_bill: 0,\r\n    earning_points_bill: 0,\r\n    use_points: 0,\r\n    id_technician: ''\r\n  }\r\n  subTotal: number = 0;\r\n  taxValue: number = 0;\r\n  invoiceDetail: VhBillType15Detail[] = [];\r\n  warrantyProd: VhWarranty[] = []\r\n  warrantyNote: VhWarranty[] = []\r\n  warrantyDel: VhWarranty[] = []\r\n  listTax: any[] = this.vhQuerySales.getlocalTaxs().filter(tax => tax.status);\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore\r\n  employee: any = {};\r\n  pickerTime = new Date();\r\n  customer: any;\r\n  printer: any;\r\n  discount_bill: number = 0;\r\n  percent_discount_bill: number = 0;\r\n  is_discount_bill: boolean = false;\r\n  list_earning_point_bills: any = [];\r\n  list_earning_points_products: any = [];\r\n  customer_group: any = [];\r\n  point_validity = 0;\r\n  default_price_type: number\r\n  showModalChangePriceType: boolean = false;\r\n  id_branch = this.vhQuerySales.getDefaultBranch()._id\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private languageService: LanguageService,\r\n    private vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    public vhAuth: VhAuth,\r\n    private cdRef: ChangeDetectorRef,\r\n    private fncService: FunctionService,\r\n    private nzModalService: NzModalService\r\n  ) {\r\n\r\n    // set nhân viên mặc định\r\n\r\n    this.invoice.id_technician = (this.vhAuth.getUser()._id)\r\n\r\n    this.invoice.id_employee = (this.vhAuth.getUser()._id)\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    this.invoice.id_branch = (this.vhQuerySales.getDefaultBranch()._id)\r\n    if (this.vhAuth.checkMyPermission('default_price_type_1')) this.default_price_type = 1;\r\n    else if (this.vhAuth.checkMyPermission('default_price_type_2')) this.default_price_type = 2;\r\n    this.invoice.price_type = (this.default_price_type)\r\n\r\n    if (!this.warrantyProd.length) this.addWarrantyProd()\r\n    if (!this.warrantyNote.length) this.addWarrantyNote()\r\n    // ------bắt sự kiện nhấn phím nóng-----\r\n    this.eventKeypress();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    let tax = this.listTax.find(item => item.default);\r\n    if (tax) {\r\n      this.id_tax = tax._id\r\n      this.invoice.tax = (tax['value']);\r\n    }\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_warranty')\r\n    this.printer = printer ? printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)] : { discount_hidden: false, note_hidden: false, fee_hidden: false, tax_hidden: false, debt_hidden: false };\r\n    this.checkPrinter = this.printer.enable;\r\n  }\r\n  event: any // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n  }\r\n  checkPrinter: boolean = false;\r\n  /**\r\n   * lắng nghe sk nhấn f1 f2 f3 f4 trên bàn phím\r\n   * @example \r\n   */\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113 || keycode === 114) event.preventDefault();\r\n      if (keycode === 115) this.searchProductList = !this.searchProductList;\r\n      else if (this.invoiceDetail.length > 0) {\r\n        switch (keycode) {\r\n          case 114: this.payInvoice(16)\r\n            break;\r\n          case 112: this.payInvoice(15, false)\r\n            break;\r\n          case 113: {\r\n            if (this.checkPrinter) this.payInvoice(15, true)\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  ngAfterViewInit() {\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      if (document.querySelector(\".discount-price\")) this.discount_price = this.vhAlgorithm.vhnumeral(\".discount-price\");\r\n      if (document.querySelector(\".invoice-fee\")) this.invoice_fee = this.vhAlgorithm.vhnumeral(\".invoice-fee\")\r\n    })\r\n    // get các loại chương trình tích điểm\r\n    Promise.all([\r\n      this.vhQuerySales.getEarningPointsBills(),\r\n      this.vhQuerySales.getEarningPointsProducts(),\r\n    ])\r\n      .then(([earning_point_bills, earning_points_products]: any) => {\r\n        // this.list_earning_point_bills = this.vhQuerySales.getLocalAppSettingNameStation('sales_program').enable_sales_method_all_branch ? earning_point_bills.filter( item => item.id_branch == this.vhQuerySales.getDefaultBranch()._id) : earning_point_bills;\r\n        // this.list_earning_points_products =  this.vhQuerySales.getLocalAppSettingNameStation('sales_program').enable_sales_method_all_branch ? earning_points_products.filter( item => item.id_branch == this.vhQuerySales.getDefaultBranch()._id) : earning_points_products;\r\n        this.list_earning_point_bills = earning_point_bills\r\n        this.list_earning_points_products = earning_points_products\r\n        this.customer_group = this.vhQuerySales.getlocalCustomerClasss()\r\n\r\n      })\r\n  }\r\n  /**\r\n   *  hàm xóa sp\r\n   * @param detail\r\n   * @example  this.deleteGoods(bill_detail_selected)\r\n   */\r\n  deleteGoods(detail: VhBillType15Detail, index) {\r\n    this.vhComponent.alertConfirm(\"\", \"\", `${this.languageService.translate(\"Delete\")} ${detail.name}?`, \"OK\", this.languageService.translate(\"Cancel\"))\r\n      .then(() => {\r\n        if (!this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').show_product_mutil_line_warranty)\r\n          this.removeInvoiceDetail(detail.id_product)\r\n        else {\r\n          this.invoiceDetail.splice(index, 1)\r\n        }\r\n        if (this.is_discount_bill) {\r\n          setTimeout(() => {\r\n            this.getDiscountBillOfCustomer()\r\n          }, 200);\r\n        }\r\n        else {\r\n          setTimeout(() => {\r\n            this.invoice.discount = ((this.percent_discount_bill / 100) * this.subTotal)\r\n            if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n          }, 200);\r\n        }\r\n      }, () => { })\r\n  }\r\n  searchProductList: boolean = false;\r\n  /**\r\n * mở component chọn sp\r\n * @example this.openSearchProductList()\r\n */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  /**\r\n   * nhận output từ component chọn sp (app-search-product-import)\r\n   * @param data sp được chọn để thêm vào bill\r\n   * @example this.closeSearchProductList(product_selected)\r\n   */\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      if (data.manylot && !data.lot_number) this.openModalChooseLot(data)\r\n      else {\r\n        if (data.combos && data.combos.filter(e => e.lots && !e.id_lotproduct).length) {\r\n          this.tempDetail = data;\r\n          this.show_modal_select_lots_combo = true;\r\n        }\r\n        else {\r\n          let price = this.default_price_type == 1 ? data.price : data.price2 ? data.price2 : data.price // check 2 đk là kiểu giá bán và có giá bán sỉ hay ko\r\n          if (!this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').show_product_mutil_line_warranty)\r\n            this.addInvoiceDetail({\r\n              ...data, price: price,\r\n              earning_points_product: this.getTotalEarningPointProduct(data, null)\r\n            }, null)\r\n          else\r\n            this.addInvoiceDetailMutilLine({\r\n              ...data, price: price,\r\n              earning_points_product: this.getTotalEarningPointProduct(data, null)\r\n            }, null)\r\n        }\r\n      }\r\n    }\r\n    if (this.is_discount_bill) {\r\n      setTimeout(() => {\r\n        this.getDiscountBillOfCustomer()\r\n      }, 200);\r\n    }\r\n    else {\r\n      setTimeout(() => {\r\n        if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n        this.invoice.discount = ((this.percent_discount_bill / 100) * this.subTotal)\r\n      }, 200);\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n  goBack() {\r\n    this.vhComponent.alertConfirm(`${this.languageService.translate(\"Confirm\")}`, \"\", `${this.languageService.translate(\"Are you sure to cancel the sales order\")}?`, \"OK\", this.languageService.translate('Cancel'))\r\n      .then(() => { this.isExit = true; this.router.navigate([\"/sales/dashboard/manage/warranty/invoices\"], { state: this.dataRestore }) }, () => { })\r\n  }\r\n  /**\r\n   * bắt sk thay đổi số lượng sp trong bill\r\n   * @param product \r\n   * @param event : giá trị thay đổi\r\n   * @example this.checkQuantityProduct(bill_detail_selected, 1)\r\n   */\r\n  checkQuantityProduct(product, event) {\r\n    if (!event) product.quantity = 1;\r\n    this.setSubTotal();\r\n    if (this.is_discount_bill) {\r\n      setTimeout(() => {\r\n        this.getDiscountBillOfCustomer()\r\n      }, 200);\r\n    }\r\n    else {\r\n      setTimeout(() => {\r\n        this.invoice.discount = ((this.percent_discount_bill / 100) * this.subTotal)\r\n        if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n      }, 200);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi đơn vị của bill_detail\r\n   * @param ev  ratio được chọn\r\n   * @param item\r\n   * @example  this.changeUnit(24, bill_detail_selected)\r\n   */\r\n  changeUnit(ev, item) {\r\n    if (this.default_price_type == 1) {\r\n      let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n      if (unit) {\r\n        item.unit = unit.unit\r\n        item.price = parseFloat(unit.price)\r\n        item.ratio = parseFloat(unit.ratio)\r\n        item.price_origin = parseFloat(unit.price)\r\n      }\r\n    }\r\n    else {\r\n      let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n      if (unit) {\r\n        item.unit = unit.unit\r\n        item.price = parseFloat(unit.price2)\r\n        item.ratio = parseFloat(unit.ratio)\r\n        item.price_origin = parseFloat(unit.price2)\r\n      }\r\n    }\r\n    this.setSubTotal()\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhBillType15Detail;\r\n  /**\r\n* mở modal thay đổi giá bán sản phẩm trong bill\r\n* @param detail \r\n* @example this.openEditUnitPrice(bilL_detail_selected)\r\n*/\r\n  openEditUnitPrice(detail: VhBillType15Detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n  /**\r\n   * bắt sk nhấn nút Ok modal giảm giá sp\r\n   * @example this.handleEditUnit()\r\n   */\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      this.setSubTotal();\r\n      this.isVisibleEditUnitPrice = false;\r\n      if (this.is_discount_bill) {\r\n        setTimeout(() => {\r\n          this.getDiscountBillOfCustomer()\r\n        }, 200);\r\n      }\r\n      else {\r\n        setTimeout(() => {\r\n          this.invoice.discount = ((this.percent_discount_bill / 100) * this.subTotal)\r\n          if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n        }, 200);\r\n      }\r\n    } else { this.vhComponent.showToast(2000, this.languageService.translate(\"Invalid data, please check again\"), \"alert-toast\") }\r\n  }\r\n  /**\r\n   * tắt modal giảm giá sp\r\n   * @example this.handleCancelEditUnit()\r\n   */\r\n  handleCancelEditUnit() { this.isVisibleEditUnitPrice = false }\r\n\r\n  /**\r\n  *  sự kiện nhận thay đổi giá từ output component app-change-price-type\r\n  * @event : boolean | null\r\n  */\r\n  changePriceType(event) {\r\n    this.showModalChangePriceType = false;\r\n    if (event != null) { // nếu có thay đổi kiểu giá bán thì cập nhật lại giá các sản phẩm thành giá bán sỉ\r\n      this.default_price_type = event;\r\n      if (this.invoiceDetail.length) { // nếu có  length mơi update\r\n        let bill_details = this.invoiceDetail\r\n        for (let i in bill_details) {\r\n          let price_update = 0;\r\n          let product = this.vhQuerySales.getlocalDetailProduct(bill_details[i].id_subproduct ? bill_details[i].id_subproduct : bill_details[i].id_product);\r\n          product = { ...product, ...this.vhQuerySales.getUnit_byRatio(product.units, bill_details[i].ratio) }\r\n          if (event == 1) {\r\n            price_update = product.price\r\n          }\r\n          else {\r\n            price_update = product.price2 ? product.price2 : product.price\r\n          }\r\n          bill_details[i].price = price_update;\r\n          bill_details[i].price_origin = price_update;\r\n        }\r\n        this.setSubTotal();\r\n        if (this.is_discount_bill) {\r\n          setTimeout(() => {\r\n            this.getDiscountBillOfCustomer()\r\n          }, 200);\r\n        }\r\n        else {\r\n          setTimeout(() => {\r\n            if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n\r\n          }, 200);\r\n        }\r\n      }\r\n      this.invoice.price_type = (event)\r\n    }\r\n  }\r\n  // -------set employee-------\r\n  /**\r\n  * bắt sk thay đổi phụ trách bảo hành\r\n  * @param event id_employee selected\r\n  */\r\n  closeAndReceiveTechnician(event) {\r\n    if (event) {\r\n      this.invoice.id_technician = (event);\r\n    }\r\n  }\r\n  /**\r\n  * bắt sk thay đổi nv bán hàng\r\n  * @param event id_employee selected\r\n  */\r\n  closeAndReceiveReceptionist(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n\r\n    }\r\n  }\r\n  // ----set customer-----\r\n  radioValue: 1 | 2 | 3= 1;\r\n  /**\r\n  * bắt sk thay đổi khách hàng\r\n  * @param event id_customer\r\n  */\r\n  closeAndReceiveCustomer(event) {\r\n    if (event) {\r\n      this.invoice.id_customer = (event);\r\n      if (!this.vhQuerySales.getlocalCustomer(event).debt_enable) this.invoice.payment = (this.getTotalATax());\r\n      this.invoice.retail_name = ('')\r\n      this.invoice.retail_phone = ('')\r\n      this.invoice.retail_address = ('')\r\n      this.getClassAndProgram(event)\r\n    }\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi loại khách hàng (member or retail)\r\n   * @param event \r\n   * @example this.changeCustomerType(1)\r\n   */\r\n  changeCustomerType(event) {\r\n    if (this.radioValue == 1) this.invoice.id_customer = (\"id_retail\")\r\n    if (event == 2 && this.invoice.retail_name) {\r\n      this.nzModalService.confirm({\r\n        nzTitle: `${this.languageService.translate('Retail customer information will be lost')}?`,\r\n        nzCancelText: this.languageService.translate(\"Cancel\"),\r\n        nzOkText: \"Ok\",\r\n        nzOnOk: () => { this.clearRetailCustomer() },\r\n        nzOnCancel: () => { this.radioValue = 1 },\r\n      }\r\n      )\r\n    }\r\n    this.getClassAndProgram(this.invoice.id_customer)\r\n  }\r\n\r\n\r\n\r\n\r\n  customer_class: any;\r\n  program_bill: any;\r\n  program_product: any;\r\n\r\n  /**\r\n   * hàm này để gán chương trình tich diem hóa đơn và sản phẩm của khách hàng\r\n   */\r\n  getClassAndProgram(id_customer) {\r\n    this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n    this.customer_class = this.customer_group.find(item => item._id == this.vhQuerySales.getlocalCustomer(id_customer).id_customer_class);\r\n    if (this.customer_class && this.customer_class.id_earning_points_bill) {\r\n      this.program_bill = this.list_earning_point_bills.find(item => item._id == this.customer_class.id_earning_points_bill);\r\n    }\r\n    if (this.customer_class && this.customer_class.id_earning_points_product) {\r\n      this.program_product = this.list_earning_points_products.find(item => item._id == this.customer_class.id_earning_points_product);\r\n    }\r\n    if (!this.customer_class) {\r\n      this.program_bill = null;\r\n      this.program_product = null;\r\n    }\r\n    this.point_validity = this.vhQuerySales.getlocalCustomerPoints(this.invoice.id_customer)\r\n    this.getDiscountMethodCustomer()\r\n\r\n  }\r\n\r\n  /**\r\n   * kiểm tra khách hàng có chương trình tích điểm nào ko\r\n   * @param id_customer \r\n   * @example this.getDiscountMethodCustomer()\r\n   */\r\n  getDiscountMethodCustomer() {\r\n    let check = this.vhQuerySales.getlocalDiscount_bill(this.customer_class?.id_discount_bill)\r\n    if (check) {\r\n      this.is_discount_bill = true\r\n      this.getDiscountBillOfCustomer()\r\n      this.vhComponent.alertMessageDesktop('success', this.languageService.translate(\"This customer applies the discount calculation formula \") + check.name, 5000)\r\n    }\r\n    else {\r\n      this.is_discount_bill = false\r\n      this.invoice.discount_bill = (0)\r\n    }\r\n\r\n  }\r\n  /**\r\n   * tính lại chiết khấu hóa đơn\r\n   * @example this.getDiscountBillOfCustomer()\r\n   */\r\n  getDiscountBillOfCustomer() {\r\n    this.discount_bill = this.vhQuerySales.getDiscount_bill_byCustomer(this.subTotal, this.invoice.id_customer) ? this.vhQuerySales.getDiscount_bill_byCustomer(this.subTotal, this.invoice.id_customer).discount : 0;\r\n    this.invoice.discount_bill = (this.discount_bill)\r\n    this.setTotal()\r\n  }\r\n\r\n  /**\r\n   * clear dữ liệu khách lẻ trong bill trường hợp thay đổi thành khách thành viên\r\n   * @example this.clearRetailCustomer()\r\n   */\r\n  clearRetailCustomer() {\r\n    this.invoice.retail_address = ('')\r\n    this.invoice.retail_name = ('')\r\n    this.invoice.retail_phone = ('')\r\n  }\r\n  /**\r\n   * bắt sk thay đổi phương thức thanh toán\r\n   * @param event \r\n   * @example this.closeAndGetValuePayment(event)\r\n   */\r\n  closeAndGetValuePayment(event) {\r\n    if (event[0] == 1 || event[0] == 2) {\r\n      this.setPaymentType(event[0])\r\n    }\r\n    else if (event[0] == 3) {\r\n      this.setPaymentType(event[0], event[1]);\r\n    }\r\n  }\r\n  /**\r\n   * cập nhật payment_type cho bill\r\n   * @param type \r\n   * @param id_wallet \r\n   * @example  this.setPaymentType(1)\r\n   */\r\n  setPaymentType(type: 1 | 2 | 3, id_wallet?) {\r\n    this.invoice.payment_type = (type)\r\n    switch (type) {\r\n      case 1: {\r\n        this.invoice.id_wallet = ('id_cash');\r\n        this.invoice.payment = (this.invoice.payment ? this.invoice.payment : this.invoice.total + this.taxValue);\r\n\r\n        break;\r\n      }\r\n      case 2: {\r\n        this.invoice.payment = (0); this.invoice.id_wallet = (null);\r\n\r\n        break;\r\n      }\r\n      case 3: {\r\n        if (id_wallet) {\r\n          this.invoice.id_wallet = (id_wallet)\r\n          this.invoice.payment = (this.invoice.payment ? this.invoice.payment : this.invoice.total + this.taxValue);\r\n\r\n          break;\r\n        }\r\n      }\r\n    };\r\n  } /**\r\n  * bắt sk thay đổi date của hóa đơn , gán lại giá trị date mới cho đơn\r\n  * @example this.setPickerTime('2023-06-12T08:02:27.697Z')\r\n  */\r\n  setPickerTime(event) {\r\n    if (new Date(event).getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 5000)\r\n      this.pickerTime = new Date(this.invoice.date)\r\n      this.invoice.date = (new Date(this.pickerTime));\r\n    }\r\n    else this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        this.invoice.date = (event);\r\n      }\r\n      else {\r\n        this.pickerTime = new Date(validitydate)\r\n        this.invoice.date = (new Date(this.pickerTime));\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n    if (this.isGotPromotion) this.getPromotions()\r\n  }\r\n  // -------change tax------\r\n  id_tax: string;\r\n  /**\r\n   * bắt sk thay đổi thuế của bill\r\n   * @param event \r\n   */\r\n  changeTax(event) {\r\n    let tax = this.listTax.find(item => item._id == event);\r\n    this.invoice.tax = (tax.value);\r\n    this.setTaxValue();\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n  discount_price: any;\r\n  /**\r\n   * bắt sk thay đổi giảm giá của hóa đơn , gán lại giá trị giảm giá mới cho đơn\r\n   * @example this.editDiscount()\r\n   */\r\n  editDiscount() {\r\n    if (this.discount_price.getRawValue() && this.discount_price.getRawValue() >= 0 && this.discount_price.getRawValue() <= this.subTotal) {\r\n      this.invoice.discount = (parseFloat(this.discount_price.getRawValue()));\r\n      this.percent_discount_bill = this.subTotal ? (this.invoice.discount / this.subTotal) * 100 : 0\r\n    } else {\r\n      document.getElementById(\"discount-price\")['value'] = this.invoice.discount;\r\n      this.discount_price = this.vhAlgorithm.vhnumeral('.discount-price');\r\n    }\r\n    this.setTotal()\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi giảm giá bill theo %\r\n   * @param value % giảm\r\n   * @example this.editPercentDiscount(10) \r\n   */\r\n  editPercentDiscount(value) {\r\n    if (parseFloat(value) > 100)\r\n      document.getElementById(\"percent-discount-price\")['value'] = 0\r\n    else this.percent_discount_bill = value;\r\n    this.invoice.discount = this.subTotal * (this.percent_discount_bill / 100)\r\n    this.setTotal()\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n\r\n  showModalOtherDiscount = false\r\n  /**\r\n   * mở modal thanh toán bằng điểm hoặc coupon\r\n   * @example openModalOtherDiscount()\r\n   */\r\n  openModalOtherDiscount() {\r\n    this.showModalOtherDiscount = true;\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn ok modal thanh toán bằng điểm hoặc coupon\r\n   * @example handleOkOtherDiscount()\r\n   */\r\n  handleOkOtherDiscount() {\r\n    if (this.invoice.payment < this.invoice.payment_points + this.invoice.payment_coupons) this.invoice.payment = (0);\r\n    this.showModalOtherDiscount = false;\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n  value_discount_point: number = 0;\r\n  /**\r\n   * tính lại giá trị thanh toán bằng tiền với số điểm sử dụng tương úng trong chương trình tích điểm\r\n   * @param value điểm sử dụng\r\n   * @example this.calculatePoint2Money(10)\r\n   */\r\n  calculatePoint2Money(value) {\r\n    if (value <= this.point_validity) {\r\n      this.value_discount_point = value;\r\n\r\n      this.invoice.payment_points = ((value / this.customer_class.payment.points) * this.customer_class.payment.money)\r\n      this.invoice.use_points = (value)\r\n    }\r\n    else {\r\n      this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Vượt quá giới hạn điểm cho phép\"))\r\n    }\r\n  }\r\n  product_codes: any = [];\r\n  /**\r\n   * kiểm tra mã coupon hợp lệ hay ko , tính số tiền thanh toán theo coupon tương ứng\r\n   * @param code \r\n   * @example getDiscountOfCoupon('KDJWOIHA')\r\n   */\r\n  getDiscountOfCoupon(code) {\r\n    if (code)\r\n      this.vhQuerySales.getCoupon_Code_Name_Release_byCode(code)\r\n        .then((product_codes: any) => {\r\n          if (product_codes && !this.product_codes.find(item => item.code == code)) {\r\n            switch (product_codes.status) {\r\n              case 1: {\r\n                this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Phiếu này chưa được quy đổi\"))\r\n                break;\r\n              }\r\n              case 3: {\r\n                if (new Date() < new Date(product_codes.date_expire)) {\r\n                  this.product_codes.push(product_codes)\r\n                  this.invoice.payment_coupons = (product_codes.value)\r\n                  this.vhComponent.alertMessageDesktop(\"success\", this.languageService.translate(\"Sử dụng coupon thành công\"))\r\n                }\r\n                else {\r\n                  this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Phiếu này đã hết hạn sử dụng\"), 8000)\r\n                }\r\n                break;\r\n              }\r\n              case 4: {\r\n                this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Phiếu này đã được sử dụng\"), 8000)\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          if (!product_codes) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Không tìm thấy phiếu này\"), 8000)\r\n          setTimeout(() => {\r\n            document.getElementById('coupon').getElementsByTagName(\"input\")[0].value = '';\r\n          }, 200);\r\n        })\r\n\r\n  }\r\n\r\n  /**\r\n   * xóa coupon đã thêm, tính lại tiền thanh toán bằng coupon\r\n   * @param item \r\n   * @example this.onCloseProductCode(coupon_selected)\r\n   */\r\n  onCloseProductCode(item) {\r\n    this.product_codes.splice(this.product_codes.findIndex(i => i._id == item._id), 1);\r\n    this.invoice.payment_coupons = (-item.value)\r\n  }\r\n  invoice_fee: any;\r\n  /**\r\n   * bắt sk thay đổi phí của hóa đơn , gán lại giá trị phí mới cho đơn\r\n   * @example this.editFee()\r\n   */\r\n  editFee() {\r\n    if (this.invoice_fee.getRawValue() && this.invoice_fee.getRawValue() >= 0) {\r\n      this.invoice.fee = (parseFloat(this.invoice_fee.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"invoice-fee\")['value'] = this.invoice.fee;\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral('.invoice-fee');\r\n    }\r\n    this.setTotal()\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n\r\n  // -------modal edit pay---------\r\n  edit_pay: boolean = false;\r\n  edit_paytotal: any;\r\n  /**\r\n   * mở modal chỉnh sửa thanh toán của bill\r\n   * @example this.showModalEditTotalPay()\r\n   */\r\n  showModalEditTotalPay() {\r\n    if (this.invoice.payment_type != 2 && this.vhQuerySales.getlocalCustomer(this.invoice.id_customer).debt_enable) {\r\n      this.vhAlgorithm.waitingStack().then(() => {\r\n        this.edit_paytotal = this.vhAlgorithm.vhnumeral(\".edit-pay\");\r\n      })\r\n      this.edit_pay = true;\r\n    }\r\n    else if (!this.vhQuerySales.getlocalCustomer(this.invoice.id_customer).debt_enable) {\r\n      this.vhComponent.showToast(5000,\r\n        this.languageService.translate(\"This customer is not allowed to debt\"), \"alert-toast\"\r\n      )\r\n    }\r\n  }\r\n  /**\r\n   * trả về tổng tiền \r\n   * @returns number\r\n   * @example let total = this.getTotalATax()\r\n   */\r\n  getTotalATax(): number {\r\n    return this.invoice.total + this.taxValue\r\n  }\r\n  /**\r\n   * bắt sk nhấn nút ok modal chỉnh sửa thanh toán của bill\r\n   * @example this.handleEditPay()\r\n   */\r\n  handleEditPay() {\r\n    if (this.edit_paytotal.getRawValue() >= 0 && this.edit_paytotal.getRawValue() <= this.getTotalATax()) {\r\n      this.invoice.payment = (parseFloat(this.edit_paytotal.getRawValue()))\r\n    }\r\n    this.edit_pay = false;\r\n  }\r\n  /**\r\n   * bắt sk nhấn nút hủy modal chỉnh sửa thanh toán của bill\r\n   * @example this.handleCancelEditPay()\r\n   */\r\n  handleCancelEditPay() {\r\n    this.edit_pay = false;\r\n  }\r\n  save_enable = true;\r\n  /**\r\n   * xử lý sk nhấn nút thanh toán hoặc lưu tạm\r\n   * @param bill_type \r\n   * @param print biến cờ để check in hay ko\r\n   * @example this.payInvoice(1)\r\n   */\r\n  payInvoice(bill_type: 15 | 16 | 17 = 16, print?) {\r\n\r\n\r\n    if (this.vhAuth.checkMyPermission(\"warranty_enable_payment\") || bill_type == 16) {\r\n      if (bill_type == 16) {\r\n        this.invoice.payment_coupons = 0;\r\n        this.invoice.payment_points = (0);\r\n        this.invoice.use_points = (0);\r\n      }\r\n      if (this.getTotalEarningPoint() && bill_type != 16) {\r\n        let earned_points = this.getTotalEarningPoint() - this.value_discount_point\r\n        this.vhQuerySales.updateCustomer_byEarnedPoints(this.invoice.id_customer, earned_points)\r\n        this.invoice.earning_points_bill = (this.getTotalEarningPoint())\r\n      }\r\n      if (this.warrantyProd.length == 1 && !this.warrantyProd[0].content) {\r\n        this.vhComponent.showToast(2000, this.languageService.translate(\"Please add a product warranty\"), \"alert-toast\")\r\n      } else {\r\n        this.vhComponent.alertConfirm(\r\n          bill_type == 16 ? `${this.languageService.translate(\"Save\")}?` : `${this.languageService.translate(\"Pay\")}?`,\r\n          \"\", \"\", \"OK\", this.languageService.translate(\"Cancel\")\r\n        ).then(() => {\r\n          if (this.save_enable) {\r\n            this.save_enable = false;\r\n            this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n\r\n              this.createOrUpdate(bill_type).then(bill => {\r\n                this.save_enable = true;\r\n                this.vhComponent.hideLoading(0).then(() => {\r\n                  if (bill == \"create\")\r\n                    this.vhComponent.showToast(2000,\r\n                      `${this.languageService.translate(\"Warranty invoice\")} ${this.invoice.bill_code} ${this.languageService.translate(\"has been created successfully\")}`, \"success-toast\"\r\n                    )\r\n                  else\r\n                    this.vhComponent.showToast(2000,\r\n                      `${this.languageService.translate(\"Warranty invoice\")} ${this.invoice.bill_code} ${this.languageService.translate(\"has been updated successfully\")}`, \"success-toast\"\r\n                    )\r\n\r\n                  if (print) this.handlePrint()\r\n                  else this.handle()\r\n                })\r\n              })\r\n            })\r\n          }\r\n        }, () => { })\r\n      }\r\n    }\r\n    else this.vhComponent.showToast(1500, this.languageService.translate('You do not have this rights'), \"alert-toast\")\r\n  }\r\n  /**\r\n   * tạo bill lên DB\r\n   * @param bill_type \r\n   * @returns \r\n   */\r\n  createOrUpdate(bill_type: 15 | 16 | 17): Promise<'create' | 'update'> {\r\n\r\n    return new Promise<any>(resolve => {\r\n      this.vhQuerySales.createBill_Billdetail(this.getCreateUpdateInvoice(bill_type), this.getCreateUpdateInvoiceDetail()).then((res) => {\r\n        this.invoice._id = (res._id)\r\n        this.invoice.bill_code = (res.bill_code)\r\n        this.createWarranty(this.getCreateWarranty()).then(() => resolve('create'))\r\n      })\r\n    })\r\n\r\n  }\r\n  ///////////////////////////////////////////XỬ LÝ WARRANTY///////////////////////////////////////\r\n\r\n  /**\r\n   * tạo sản phẩm bảo hành lên DB\r\n   * @param bill_type \r\n   * @returns Promise<any[]>\r\n   * @example  this.createWarranty([<array_warranty_product>]).then(() => \r\n   */\r\n  createWarranty(array) {\r\n    const promiseAddWarranty = []\r\n    for (let i = 0; i < array.length; i++) {\r\n      promiseAddWarranty.push(this.vhQuerySales.addWarranty(array[i]))\r\n    }\r\n    return Promise.all(promiseAddWarranty)\r\n  }\r\n\r\n\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_warranty')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return WarrantyK57Col3Component\r\n      case 'print_size_k80_3c': return WarrantyK80Col3Component\r\n      case 'print_size_k80_4c': return WarrantyK80Col4Component\r\n      case 'print_size_a5': return WarrantyA5Component\r\n      case 'print_size_a4': return WarrantyA4Component\r\n      default: return WarrantyA4Component\r\n    }\r\n  }\r\n\r\n  /**\r\n   * trờ về trang danh sách hóa đơn sau khi đã thanh toán xong\r\n   * @example this.handle(true)\r\n   */\r\n  handle() {\r\n    this.isExit = true;\r\n    this.router.navigate(['/sales/dashboard/manage/warranty/invoices'], { state: this.dataRestore })\r\n  }\r\n  /**\r\n   * kiểm tra dữ liệu thông tin máy in và mở component in\r\n   * @example this.handlePrint()\r\n   */\r\n  handlePrint() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice: this.invoice, invoice_detail: this.invoiceDetail, warrantyProd: this.warrantyProd, warrantyNote: this.warrantyNote }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.handle())\r\n        })\r\n    }, (err) => this.vhComponent.alertMessage(this.languageService.translate(\"Function\"), \"\", this.languageService.translate(\"Please turn on the printer function\"), \"OK\")\r\n      .then(() => this.handle()))\r\n  }\r\n\r\n  //--------------visible drawer info customer-----------\r\n  visibleInfoCustomer: boolean = false;\r\n  /**\r\n  * mở modal xem thông tin khách hàng\r\n  * @example this.openInfoCustomer()\r\n  */\r\n  openInfoCustomer() {\r\n    if (this.invoice.id_customer != 'id_retail') {\r\n      this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n      this.visibleInfoCustomer = true;\r\n    }\r\n  }\r\n  /**\r\n   * đóng modal xem thông tin khách hàng\r\n   * @example this.openInfoCustomer()\r\n   */\r\n  closeInfoCustomer(event) {\r\n    this.visibleInfoCustomer = false;\r\n  }\r\n\r\n  // // ------thoát trang-----\r\n  isExit: boolean = false;\r\n  checkDeactivate(currentRoute: ActivatedRouteSnapshot, currentState: RouterStateSnapshot, nextState?: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    return nextState.url == '/login' ? true : (this.isExit ? this.isExit : this.vhComponent.alertConfirm(this.languageService.translate(\"Confirm\"), \"\", this.languageService.translate(\"Are you sure to cancel the sales order\"), \"OK\", (this.languageService.translate(\"Cancel\"))).then(() => { return true }).catch(() => { return false }))\r\n  }\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\".sales-best-selling\") && document.querySelector(\".waranty-invoice-quote-header\") && document.querySelector(\"#waranty-invoice-quote-invoiceDetail\")) {\r\n      document.getElementById(\"waranty-invoice-quote-invoiceDetail\").style.height = document.querySelector(\".sales-best-selling\").clientHeight\r\n        - document.querySelector(\".waranty-invoice-quote-header\").clientHeight - 10 + \"px\";\r\n    }\r\n    if (document.getElementById(\"waranty-invoice-prodAndnote-invoiceDetail\") && document.querySelector(\".sales-cart\") && document.querySelector(\".sales-cart-header\")) {\r\n      document.getElementById(\"waranty-invoice-prodAndnote-invoiceDetail\").style.height = document.querySelector(\".sales-cart\").clientHeight - document.querySelector(\".sales-cart-header\").clientHeight - 10 + 'px';\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n  // -------------xử lý warranty-----------\r\n  searchProductListWarranty: boolean = false;\r\n  /**\r\n   * mở drawer chọn sản phẩm bảo hành\r\n   * @example this.openSearchProductListWarranty()\r\n   */\r\n  openSearchProductListWarranty() {\r\n    this.searchProductListWarranty = !this.searchProductListWarranty;\r\n  }\r\n  /**\r\n   * bắt sk đóng drawer chọn sản phẩm bảo hành\r\n   * @param event sản phẩm trả về nếu có\r\n   * @example this.closeSearchProductListWarranty(null)\r\n   */\r\n  closeSearchProductListWarranty(event) {\r\n    if (event) {\r\n      this.addWarrantyProd();\r\n      this.warrantyProd[0].content = event.name;\r\n    }\r\n    this.searchProductListWarranty = false;\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi tên sp bảo hành\r\n   * @param index \r\n   * @param item \r\n   * @example this.editWarrantyProd(1,)\r\n   */\r\n  editWarrantyProd(index, item) {\r\n    if (this.warrantyProd.length > 1 && item.content == '') this.removeWarrantyProd(index, item);\r\n  }\r\n  editWarrantyNote(index, item) {\r\n    if (this.warrantyNote.length > 1 && item.content == '') this.removeWarrantyNote(index, item);\r\n  }\r\n  /**add customer */\r\n  showDrawerAddCusomer: boolean = false;\r\n  showDrawerAddRetail: boolean = false\r\n  /**\r\n   * mở modal thêm khách hàng thành viên mới hoặc thêm thông tin khách lẻ\r\n   * @example this.openDrawerAddCustomerOrRetail()\r\n   */\r\n  openDrawerAddCustomerOrRetail() {\r\n    if (this.radioValue == 1) this.showDrawerAddRetail = true\r\n    else this.showDrawerAddCusomer = true\r\n  }\r\n  /**\r\n   * bắt sk đóng drawer thêm khách hàng\r\n   * @param result nhận về từ output\r\n   * @example this.closeAddCustomer('FDNIWUHDWUDHUWYDG')\r\n   */\r\n  closeAddCustomer(result) {\r\n    if (this.radioValue == 1) {\r\n      if (result) {\r\n        this.invoice.retail_name = (result.retail_name)\r\n        this.invoice.retail_phone = (result.retail_phone)\r\n        this.invoice.retail_address = (result.retail_address)\r\n      }\r\n      this.showDrawerAddRetail = false\r\n    }\r\n    else {\r\n      this.showDrawerAddCusomer = false\r\n      if (result) this.invoice.id_customer = (result)\r\n    }\r\n  }\r\n\r\n\r\n  isGotPromotion = false;\r\n  showProductGift = false;\r\n  product_gift_type7: any = [];\r\n  showProductGiftType7 = false;\r\n  gotten_gift_type7 = false;\r\n  bill_details_pmtype_7: any = [];\r\n  /**\r\n   * bắt sk nhấn nút ok chọn quà của promotion type = 7, gán các sp được chọn trong CTKM vào bill_detail\r\n   * @example this.handleAddGiftType7()\r\n   */\r\n  handleAddGiftType7() {\r\n    this.showProductGiftType7 = false;\r\n    if (!this.gotten_gift_type7)\r\n      for (let i in this.product_gift_type7) {\r\n        // this.product_gift_type7[i].products_gift = this.product_gift_type7[i].products_gift.filter(item => item.choose).map(e => { return { ...e } })\r\n        if (this.product_gift_type7[i].products_gift.length) this.invoiceDetail.push(this.product_gift_type7[i])\r\n      }\r\n    \r\n    this.gotten_gift_type7 = true;\r\n  }\r\n  /**\r\n  * hàm lấy quà\r\n  */\r\n  getPromotions() {\r\n    this.gotten_gift_type7 = false;\r\n    this.vhComponent.showLoading('')\r\n      .then(() => {\r\n        this.vhQuerySales.changeBillDetails_withPromotions(this.invoiceDetail, this.invoice.date).then((bill_details_display: any) => {\r\n          \r\n          this.handleChooseLotForPromotion(bill_details_display.bill_details_pmtype_0to6)\r\n          this.handleChooseLotForPromotion(bill_details_display.bill_details_pmtype_7)\r\n\r\n          this.bill_details_pmtype_7 = this.vhAlgorithm.sortNumberbyASC([...bill_details_display.bill_details_pmtype_7], 'total_bill_value')\r\n          this.isGotPromotion = true;\r\n          this.vhComponent.hideLoading(0)\r\n          this.invoiceDetail = [...bill_details_display.bill_details_pmtype_0to6,]\r\n          // if (bill_details_display.filter(item => item.products_gift).length) this.showProductGift = true;\r\n          this.getEarningpointPromotion();\r\n\r\n          // this.product_gift_type7 = [...bill_details_display.bill_details_pmtype_7]\r\n          this.handlePromotionType7(this.bill_details_pmtype_7)\r\n          this.setSubTotal()\r\n\r\n        }, error => {\r\n          this.vhComponent.hideLoading(0).then(() => {\r\n            this.vhComponent.showToast(5000, error, \"alert-toast\")\r\n          })\r\n        })\r\n      })\r\n  }\r\n\r\n  /**\r\n   * xử lý dữ liệu sản phẩm sau khi lấy quả của prmotion_type = 7\r\n   * @param bill_details_pmtype_7 \r\n   */\r\n  handlePromotionType7(bill_details_pmtype_7) {\r\n    if (bill_details_pmtype_7.length)\r\n      if (bill_details_pmtype_7.findLastIndex(e => e.total_bill_value <= this.getTotalATax()) != -1)\r\n        this.product_gift_type7 = [bill_details_pmtype_7[bill_details_pmtype_7.findLastIndex(e => e.total_bill_value <= this.getTotalATax())]]\r\n      else this.product_gift_type7 = []\r\n    else this.product_gift_type7 = []\r\n    // \r\n\r\n  }\r\n\r\n  /**\r\n   * xử lý chọn lô tự động cho sản phẩm chọn trong khuyến mãi\r\n   * @param promotion array product promotion\r\n   * @example this.handleChooseLotForPromotion([])\r\n   */\r\n  handleChooseLotForPromotion(promotion) {\r\n    for (let i of promotion) {\r\n      if (i.products_gift) {\r\n        for (let product of i.products_gift) {\r\n          if (product.lots && product.lots.length) {\r\n            let min_date_exp = this.vhAlgorithm.sortDatebyASC(product.lots, 'date_exp')\r\n            product['id_lotproduct'] = min_date_exp[0]._id;\r\n            product['lot_number'] = min_date_exp[0].lot_number;\r\n          }\r\n          if (product.combos) {\r\n            product.combos.forEach(element => {\r\n              if (element.lots && element.lots.length) {\r\n                let min_date_exp = this.vhAlgorithm.sortDatebyASC(element.lots, 'date_exp')\r\n                element['id_lotproduct'] = min_date_exp[0]._id;\r\n                element['lot_number'] = min_date_exp[0].lot_number;\r\n              }\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * hàm này để get SubTotal mới của mảng đã lấy quà\r\n   * đồng thời gán điểm tích lũy sản phẩm mới của các sản phẩm trong khuyến mãi nếu có\r\n   */\r\n  getEarningpointPromotion() {\r\n    for (let i of this.invoiceDetail) {\r\n      if (i.products_gift) {\r\n        for (let product of i.products_gift) {\r\n          product.earning_points_product = this.getTotalEarningPointProduct(i, true);\r\n        }\r\n      }\r\n      if (i.products) {\r\n        for (let product of i.products) {\r\n          product.earning_points_product = this.getTotalEarningPointProduct(i, true)\r\n        }\r\n      }\r\n      if (!i.id_promotion) i.earning_points_product = this.getTotalEarningPointProduct(i, null)\r\n    }\r\n    this.setSubTotal();\r\n  }\r\n\r\n  /**\r\n   * hàm này để kiểm tra disable sản phẩm tặng hay ko\r\n   * @param data phần tử trong mảng đã lấy quà\r\n   * @returns\r\n   */\r\n  checkDisableChooseProductGift(data) {\r\n    if (data.products_gift.filter(item => item.choose).length == data.promotions_maximum) return true;\r\n    else return false\r\n  }\r\n  /**\r\n   * trả về tên unit theo ratio truyền vào\r\n   * @param units mảng units của sp\r\n   * @param ratio ratio được chọn\r\n   * @returns string\r\n   * @example let unit_name = this.getUnit([], 1)\r\n   */\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit\r\n  }\r\n\r\n  show_modal_select_lots = false;\r\n  list_search_lot = [];\r\n\r\n  /**\r\n   * trả về tên lô theo id_lot được chọn\r\n   * @param lots \r\n   * @param _id \r\n   * @returns string\r\n   * @example this.getLotNumber([], 'DJWOIDHIEUGHWDSJDNWIHD')\r\n   */\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id);\r\n    return lot.lot_number\r\n  }\r\n  /**\r\n   * lọc danh sách lô của sp theo số lô (lot_number)\r\n   * @param value \r\n   */\r\n  searchLot(value) {\r\n    this.tempDetail.lots = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.list_search_lot, ['lot_number'])\r\n  }\r\n  /**\r\n   * mở modal chọn lô cho sp\r\n   * @param data \r\n   * @example this.openModalChooseLot(bill_detail_selected)\r\n   */\r\n  openModalChooseLot(data) {\r\n    this.tempDetail = data\r\n    this.list_search_lot = this.tempDetail.lots\r\n    if (!this.list_search_lot.length) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Sản phẩm này không có lô khả dụng để bán!\"))\r\n    else this.show_modal_select_lots = true;\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi id_lotnumber của bill-detail\r\n   * @param e id_lotnumber thay đổi\r\n   * @example this.changeLot('DNIUHWIDCHBIQOHSDOIHW')\r\n   */\r\n  changeLot(e) {\r\n    this.tempDetail.lot_number = this.tempDetail.lots.find(item => item._id == e).lot_number\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút ok của modal chọn lô sp\r\n   * @example this.handleChooseLot()\r\n   */\r\n  handleChooseLot() {\r\n    if (this.warning_lot_expried) {\r\n      let lot_select = this.list_search_lot.find(e => e._id == this.tempDetail.id_lotproduct)\r\n      if (new Date().getTime() >= new Date(lot_select.date_exp).getTime()) {\r\n        this.nzModalService.confirm({\r\n          nzTitle: this.languageService.translate(\"Lô này đã hết hạn! Tiếp tục bán sản phẩm này?\"),\r\n          nzOnOk: () => {\r\n            this.show_modal_select_lots = false;\r\n            this.tempDetail.lots = this.list_search_lot;\r\n            if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n          },\r\n          nzOnCancel: () => {\r\n            // this.show_modal_select_lots = false;\r\n            // this.tempDetail.lots = this.list_search_lot;\r\n          }\r\n\r\n        })\r\n      }\r\n      else {\r\n        this.show_modal_select_lots = false;\r\n        this.tempDetail.lots = this.list_search_lot;\r\n        if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n      }\r\n    }\r\n    else {\r\n      this.show_modal_select_lots = false;\r\n      this.tempDetail.lots = this.list_search_lot;\r\n      if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút hủy modal chọn lô sp\r\n   * @example this.handleCancelChooseLot()\r\n   */\r\n  handleCancelChooseLot() {\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot\r\n  }\r\n\r\n\r\n\r\n\r\n  /**\r\n   * hàm get điểm tích lũy theo hóa đơn\r\n   * 1. get hạng khách hàng\r\n   * 2. từ hạng khách hàng get tích điểm theo bill\r\n   * 3. check các điều kiện của chương trình\r\n   * a check sản phẩm khuyến mãi include_promotion_product\r\n   * b  check giảm giá/ chiết khấu include_discount\r\n   * c check thanh toán = điểm thưởng include_paid_points\r\n   * d check phí  include_fee\r\n   * e check thuế include_tax\r\n   * @returns 0 | number\r\n   */\r\n  getEarningBill() {\r\n    if (this.program_bill && this.subTotal > this.program_bill.bill_total_minimum) {\r\n      let subTotal = this.subTotal;\r\n      if (!this.program_bill.include_promotion_product) { // ko tích điểm sp có km =>  tính lại subTotal\r\n        subTotal = this.getSubTotalNotPromotion()\r\n        if (this.program_bill.include_discount) subTotal = subTotal - this.invoice.discount - this.invoice.discount_bill\r\n\r\n        if (this.program_bill.include_paid_points && this.invoice.payment_points) subTotal = subTotal - this.invoice.payment_points\r\n        if (this.program_bill.include_fee) subTotal += this.invoice.fee;\r\n\r\n        if (this.program_bill.include_tax) subTotal += subTotal * (this.invoice.tax / 100)\r\n        return ((subTotal - subTotal % this.program_bill.exchange.money) / this.program_bill.exchange.money) * this.program_bill.exchange.points\r\n      }\r\n      else {\r\n        subTotal = this.subTotal;\r\n        if (this.program_bill.include_discount) subTotal = subTotal - this.invoice.discount - this.invoice.discount_bill\r\n\r\n        if (this.program_bill.include_paid_points && this.invoice.payment_points) subTotal = subTotal - this.invoice.payment_points\r\n        if (this.program_bill.include_fee) subTotal += this.invoice.fee;\r\n\r\n        if (this.program_bill.include_tax) subTotal += subTotal * (this.invoice.tax / 100)\r\n        return ((subTotal - subTotal % this.program_bill.exchange.money) / this.program_bill.exchange.money) * this.program_bill.exchange.points\r\n      }\r\n    }\r\n    else return 0\r\n  }\r\n\r\n\r\n  /**\r\n  * hàm này trả về tổng tiền của sản phẩm ko có chương trình khuyến mãi\r\n  * return : number\r\n  */\r\n  getSubTotalNotPromotion() {\r\n    return this.invoiceDetail.filter(item => item.price_origin == item.price).reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n  }\r\n\r\n  /**\r\n   * hàm này trả về tổng tiền của sản phẩm  ko có chương trình khuyến mãi thuộc chương trình tích điểm sản phẩm\r\n   * return : number\r\n   */\r\n  getSubTotalNotPromotionOFProduct(products_of_program_earnig_product) {\r\n    return this.invoiceDetail\r\n      .filter(item => item.price_origin == item.price && products_of_program_earnig_product.find(i => i == item.id_product))\r\n      .reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n  }\r\n\r\n\r\n  /**\r\n   * hàm này trả về tổng điểm được tích của tất cả sản phẩm\r\n   * @returns 0 | number\r\n   */\r\n  getEarningProduct(products) {\r\n    if (this.program_product) {\r\n      let subTotal = 0;\r\n      if (!this.program_product.include_promotion_product) { // tích điểm sp có km =>  tính lại subTotal\r\n        subTotal = this.getSubTotalNotPromotionOFProduct(this.program_product.products)\r\n        return ((subTotal - subTotal % this.program_product.exchange.money) / this.program_product.exchange.money) * this.program_product.exchange.points\r\n      }\r\n      else {\r\n        subTotal = products.filter(item => item.price_origin == item.price && this.program_product.products.find(i => i == item.id_product)).reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n        return ((subTotal - subTotal % this.program_product.exchange.money) / this.program_product.exchange.money) * this.program_product.exchange.points\r\n      }\r\n    }\r\n    else return 0\r\n  }\r\n\r\n\r\n\r\n\r\n  earning_point: number = 0;\r\n  /**\r\n   * hàm này trả về tổng điểm được tích của đơn và sản phẩm\r\n   * @returns 0 | number\r\n   */\r\n  getTotalEarningPoint() {\r\n    this.earning_point = this.getEarningProduct(this.invoiceDetail) + this.getEarningBill();\r\n    return this.earning_point\r\n  }\r\n\r\n  /**\r\n   * hàm này trả về điểm được tích của sản phẩm được thêm\r\n   * @param product sản phẩm được thêm\r\n   * @returns 0 | number\r\n   */\r\n  getTotalEarningPointProduct(product, promotion) {\r\n    if (this.program_product) {\r\n      let subTotal = 0;\r\n      if (!this.program_product.include_promotion_product && promotion) { // tích điểm sp có km =>  tính lại subTotal\r\n        subTotal = this.program_product.products.find(i => i == product._id) ? product.price : 0\r\n        return ((subTotal - subTotal % this.program_product.exchange.money) / this.program_product.exchange.money) * this.program_product.exchange.points\r\n      }\r\n      else {\r\n        subTotal = this.program_product.products.find(i => i == product._id) ? product.price : 0\r\n        return ((subTotal - subTotal % this.program_product.exchange.money) / this.program_product.exchange.money) * this.program_product.exchange.points\r\n      }\r\n    }\r\n    else return 0\r\n  }\r\n  show_modal_select_lots_combo = false\r\n  /**\r\n   * bắt sk nhấn nút ok của modal chọn lô cho combo\r\n   * @example this.handleChooseLotCombo()\r\n   */\r\n  handleChooseLotCombo() {\r\n    if (this.tempDetail.combos.filter(item => item.lots && !item.id_lotproduct).length)\r\n      this.vhComponent.alertMessageDesktop(\"warning\", this.languageService.translate(\"Vui lòng chọn lô cho sản phẩm thuộc combo này\"))\r\n    else {\r\n      this.show_modal_select_lots_combo = false;\r\n      this.closeSearchProductList(this.tempDetail)\r\n    }\r\n  }\r\n\r\n\r\n  /******************************Xu ly warranty note *******************************/\r\n  /** Thêm sản phẩm bảo hành */\r\n  public addWarrantyProd() {\r\n    const add = () => {\r\n      let item: VhWarranty = { content: '', quantity: 1, type: 1, id_bill: this.invoice._id }\r\n      if (this.invoice._id) item['id_bill'] = this.invoice._id\r\n      this.warrantyProd.unshift(item)\r\n    }\r\n    if (this.warrantyProd.length) {\r\n      if (this.warrantyProd[0].content) add()\r\n    } else add()\r\n  }\r\n  /** xóa sản phẩm bảo hành */\r\n  public removeWarrantyProd(index: number, item: VhWarranty) {\r\n    if (index == 0) {\r\n      if (this.warrantyProd.length > 1) this.warrantyProd.splice(index, 1)\r\n      else if (this.warrantyProd[index].content.length) this.warrantyProd[0].content = ''\r\n    } else this.warrantyProd.splice(index, 1)\r\n\r\n    if (item._id) this.warrantyDel.push(item)\r\n  }\r\n  /** Thêm ghi chú bảo hành */\r\n  public addWarrantyNote() {\r\n    const add = () => {\r\n      let item: VhWarranty = { content: '', type: 2, id_bill: this.invoice._id }\r\n      if (this.invoice._id) item['id_bill'] = this.invoice._id\r\n      this.warrantyNote.unshift(item)\r\n    }\r\n    if (this.warrantyNote.length) {\r\n      if (this.warrantyNote[0].content) add()\r\n    } else add()\r\n  }\r\n  /** Xóa ghi chú bảo hành */\r\n  public removeWarrantyNote(index: number, item: VhWarranty) {\r\n    if (index == 0) {\r\n      if (this.warrantyNote.length > 1) this.warrantyNote.splice(index, 1)\r\n      else if (this.warrantyNote[index].content.length) this.warrantyNote[0].content = ''\r\n    } else this.warrantyNote.splice(index, 1)\r\n    if (item._id) this.warrantyDel.push(item)\r\n  }\r\n  /** Lấy toàn bộ sản phẩm và ghi chú bảo hành */\r\n  public getWarranty() {\r\n    return this.warrantyNote.concat(this.warrantyProd).filter(item => {\r\n      if (item.content) {\r\n        item.id_bill = this.invoice._id; return true\r\n      } else return false\r\n    })\r\n  }\r\n\r\n\r\n  /** Lấy toàn bộ các sản phẩm và ghi chú bảo hành */\r\n  public getCreateWarranty() {\r\n    return this.warrantyNote.concat(this.warrantyProd).filter(item => {\r\n      if (!item.id_bill) item.id_bill = this.invoice._id\r\n      if (item.content && !item._id) return true\r\n      else return false\r\n    })\r\n  }\r\n\r\n\r\n  /******************************Xu ly invoice detail *******************************/\r\n  /** Thêm sản phẩm vào bill detail */\r\n  public addInvoiceDetail(value: any, new_price?: any) {\r\n    if (value['id_subproduct']) {\r\n      let index = this.invoiceDetail.findIndex(detail => detail['id_subproduct'] == value['id_subproduct'] && detail['ratio'] == value['ratio'])\r\n      if (index != -1) {\r\n        if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n      } else {\r\n        this.addBill_Detail(value, new_price)\r\n      }\r\n    }\r\n    else {\r\n      let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == value['_id'] && detail['ratio'] == value['ratio'])\r\n      if (index != -1) {\r\n        if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n      } else {\r\n        this.addBill_Detail(value, new_price)\r\n      }\r\n    }\r\n    this.setSubTotal()\r\n  }\r\n  /**\r\n   * xử lý các trường của sp được chọn và thêm vào mảng local\r\n   * @param value \r\n   * @param new_price \r\n   * @example  this.addBill_Detail(product_selected)\r\n   */\r\n  addBill_Detail(value: any, new_price?: number) {\r\n    let detail: any = {\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      ptype: value.type,\r\n      unit: value.unit,\r\n\r\n      units: value.units ? value.units : [],\r\n\r\n      ratio: value.ratio ? value.ratio : 1,\r\n      price: new_price != null ? new_price : value.price,\r\n      price_origin: value.price,\r\n      earning_points_product: value.earning_points_product ? value.earning_points_product : 0,\r\n    }\r\n\r\n    if (value.type == 5) {\r\n      detail['cbtype'] = 5;\r\n      detail['combos'] = [...value.combos.map(item => {\r\n        let product: VhBillType15DetailCombo = {\r\n          id_product: item.id_product,\r\n          name: item.name,\r\n          ptype: item.type,\r\n          price: item.price,\r\n          quantity: item.quantity,\r\n          unit: item.unit,\r\n          units: item.units,\r\n          ratio: item.ratio ? item.ratio : 1\r\n        }\r\n        if (item.lots) product['lots'] = item.lots;\r\n        if (item.id_lotproduct) product['id_lotproduct'] = item.id_lotproduct;\r\n        if (item.id_subproduct) product['id_subproduct'] = item.id_subproduct;\r\n        return product;\r\n      })]\r\n    }\r\n    if (value.lot_number) detail['lot_number'] = value.lot_number;\r\n    if (value.lots) detail['lots'] = value.lots;\r\n    if (value.id_lotproduct) detail['id_lotproduct'] = value.id_lotproduct;\r\n    if (value.id_subproduct) detail['id_subproduct'] = value.id_subproduct;\r\n\r\n    this.invoiceDetail.unshift(detail)\r\n  }\r\n\r\n  /** Thêm sản phẩm vào bill detail */\r\n  public addInvoiceDetailMutilLine(value: any, new_price?: any) {\r\n    let detail: any = {\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      ptype: value.type,\r\n      unit: value.unit,\r\n      price: new_price != null ? new_price : value.price,\r\n      price_origin: value.price,\r\n\r\n      units: value.units,\r\n      ratio: value.ratio ? value.ratio : 1,\r\n    }\r\n\r\n    if (value.type == 5) {\r\n      detail['subComboName'] = value.subComboName\r\n      detail['combos'] = [...value.combos.map(item => {\r\n        let product: VhBillType15DetailCombo = {\r\n          id_product: item.id_product, name: item.name, ptype: item.type,\r\n          price: item.price, quantity: item.quantity,\r\n          units: item.units,\r\n          unit: item.unit, ratio: item.ratio ? item.ratio : 1\r\n        }\r\n\r\n        if (item.lots) product['lots'] = item.lots;\r\n        if (item.id_lotproduct) product['id_lotproduct'] = item.id_lotproduct;\r\n        if (item.id_subproduct) product['id_subproduct'] = item.id_subproduct;\r\n        return product;\r\n      })]\r\n    }\r\n    if (value.lot_number) detail['lot_number'] = value.lot_number;\r\n    if (value.lots) detail['lots'] = value.lots;\r\n    if (value.id_lotproduct) detail['id_lotproduct'] = value.id_lotproduct;\r\n    if (value.id_subproduct) detail['id_subproduct'] = value.id_subproduct;\r\n    this.invoiceDetail.unshift(detail)\r\n\r\n    this.setSubTotal()\r\n  }\r\n  /** Xóa sản phẩm khỏi bill detail */\r\n  public removeInvoiceDetail(id: string) {\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == id)\r\n    if (index != -1) {\r\n      this.invoiceDetail.splice(index, 1);\r\n      this.setSubTotal()\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * tính lại cộng tiền của bill khi có sự thay đổi (thêm xóa sửa bill_detail, đổi giá bán, khuyến mãi, phí ,thuế ,...)\r\n   * @example this.setSubTotal()\r\n   */\r\n  public setSubTotal() {\r\n    // this.subTotal = this.invoiceDetail.reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      let total_product_gift = 0;\r\n      let total_products = 0;\r\n      if (i.products_gift) {\r\n        total_product_gift = i.products_gift.filter(item => item.choose).reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n      }\r\n      if (i.products) {\r\n        total_products = i.products.reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n      }\r\n      subTotal += total_products + total_product_gift + (i.price ? i.price * i.quantity : 0)\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal()\r\n  }\r\n\r\n  /**\r\n   * tính lại tổng tiền của bill để lưu trường total\r\n   * @example this.setTotal();\r\n   */\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount - this.invoice.discount_bill - (this.invoice.payment_coupons + this.invoice.payment_points) + this.invoice.fee > 0 ? this.subTotal - this.invoice.discount - this.invoice.discount_bill - (this.invoice.payment_coupons + this.invoice.payment_points) + this.invoice.fee : 0\r\n    this.setTaxValue();\r\n  }\r\n\r\n  /**\r\n   * tính giá trị thuế ra tiền\r\n   * @example this.setTaxValue()\r\n   */\r\n  setTaxValue() {\r\n    this.taxValue = this.invoice.total * (this.invoice.tax / 100)\r\n    this.setPayment()\r\n  }\r\n\r\n  /**\r\n   * tính lại thanh toán để lưu trường payment của bill\r\n   * @param value : giá trị thanh toán tự nhập nếu có (trường hợp nợ lại 1 phần)\r\n   * @example this.setPayment()\r\n   */\r\n  setPayment(value?: number) {\r\n\r\n    if (this.invoice.payment_type == 2) {\r\n      this.invoice.payment = 0\r\n    } else {\r\n      if (value != null)\r\n        this.invoice.payment = value\r\n      else\r\n        this.invoice.payment = this.invoice.total + this.taxValue\r\n    }\r\n  }\r\n\r\n  /** Lấy bill dùng cho database */\r\n  public getCreateUpdateInvoice(bill_type: 15 | 16 | 17 | null = null) {\r\n    if (bill_type) this.invoice.bill_type = (bill_type)\r\n    return this.invoice\r\n  }\r\n  /** Lấy tất cả bill detail dùng cho database */\r\n  public getCreateUpdateInvoiceDetail(): VhBillType15Detail[] {\r\n    return this.invoiceDetail.map(item => {\r\n      if (!item.pmtype) {\r\n        let detail: VhBillType15Detail = {\r\n          id_product: item.id_product,\r\n          ptype: item.ptype,\r\n          price: item.price,\r\n          quantity: item.quantity,\r\n          earning_points_product: item.earning_points_product,\r\n          ratio: item.ratio,\r\n        }\r\n        if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct\r\n        if (item.id_subproduct) detail['id_subproduct'] = item.id_subproduct\r\n        if (item.price < item.price_origin) detail['price_origin'] = item.price_origin\r\n        if (item.price == item.price_origin) detail['price_origin'] = item.price\r\n\r\n        if (item.ptype == 5) {\r\n          detail['combos'] = item.combos.map(combo => {\r\n            let product: VhBillType15DetailCombo = {\r\n              id_product: combo.id_product,\r\n              price: combo.price,\r\n              quantity: combo.quantity,\r\n              ptype: combo.ptype,\r\n              ratio: combo.ratio ? combo.ratio : 1,\r\n            }\r\n            if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct\r\n            if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct\r\n            return product;\r\n          })\r\n        }\r\n        return detail\r\n      }\r\n      else {\r\n        let detail: any = {\r\n          id_promotion: item.id_promotion,\r\n          pmtype: item.pmtype,\r\n        }\r\n        if (item.products_gift) {\r\n          if (item.products_gift.filter(ele => ele.choose).length) {\r\n            detail['products_gift'] = item.products_gift.filter(ele => ele.choose).map(e => {\r\n              let prod = {\r\n                id_product: e.id_product,\r\n                price: e.price,\r\n                price_origin: e.price_origin,\r\n                quantity: e.quantity,\r\n                ptype: e.ptype,\r\n                earning_points_product: e.earning_points_product,\r\n                ratio: e.ratio\r\n              }\r\n              if (e.ptype == 5) {\r\n                prod['combos'] = e.combos.map(combo => {\r\n                  let product: VhBillType15DetailCombo = {\r\n                    id_product: combo.id_product,\r\n                    price: combo.price,\r\n                    quantity: combo.quantity,\r\n                    ptype: combo.ptype,\r\n                    ratio: combo.ratio ? combo.ratio : 1,\r\n                  }\r\n                  if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct\r\n                  if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct\r\n                  return product;\r\n                })\r\n              }\r\n              if (e.id_lotproduct) prod['id_lotproduct'] = e.id_lotproduct\r\n              if (e.id_subproduct) prod['id_subproduct'] = e.id_subproduct\r\n              return prod\r\n            })\r\n            return detail\r\n          }\r\n        }\r\n        else {\r\n          detail['products'] = item.products.map(e => {\r\n            let prod = {\r\n              id_product: e.id_product,\r\n              price: e.price,\r\n              price_origin: e.price_origin,\r\n              quantity: e.quantity,\r\n              ptype: e.ptype,\r\n              id_category: e.id_category,\r\n              earning_points_product: e.earning_points_product,\r\n              ratio: e.ratio\r\n            }\r\n            if (e.ptype == 5) {\r\n              prod['combos'] = e.combos.map(combo => {\r\n                let product: VhBillType15DetailCombo = {\r\n                  id_product: combo.id_product,\r\n                  price: combo.price,\r\n                  quantity: combo.quantity,\r\n                  ptype: combo.ptype,\r\n                  ratio: combo.ratio ? combo.ratio : 1,\r\n                }\r\n                if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct\r\n                if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct\r\n                return product;\r\n              })\r\n            }\r\n            if (e.id_lotproduct) prod['id_lotproduct'] = e.id_lotproduct\r\n            if (e.id_subproduct) prod['id_subproduct'] = e.id_subproduct\r\n            return prod\r\n          })\r\n          return detail\r\n        }\r\n\r\n      }\r\n    }).filter(item => item)\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}} <b> {{'Create warranty invoice' | translate}}</b>\r\n</div>\r\n\r\n<nz-layout>\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"18\" class=\"title sales-cart-header-title\">\r\n                    <b>{{\"Create warranty invoice\" | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"center-all-content\">\r\n                    <button [disabled]=\"  !invoiceDetail.length\" (click)=\"payInvoice(16)\"\r\n                        [disabled]=\"!invoiceDetail.length\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\">\r\n                        <i nz-icon nzType=\"save\" nzTheme=\"outline\"></i>\r\n                        {{'Temporary' | translate}} (F3)</button>\r\n                </div>\r\n                <div id=\"waranty-invoice-prodAndnote-invoiceDetail\"\r\n                    class=\"waranty-invoice-prodAndnote-invoiceDetail hideScrollbar\" nz-col nzSpan=\"24\">\r\n                    <div nz-row>\r\n                        <div nz-col class=\"search-product-warrany\" nzSpan=\"24\">\r\n                            <div>\r\n                                <h5>{{\"Warranty, repair products\"|translate}}</h5>\r\n                            </div>\r\n                            <div>\r\n                                <ion-icon (click)=\"openSearchProductListWarranty()\" slot=\"end\"\r\n                                    style=\"color: var(--ion-color-vh-green); margin-right:10px; font-size: 1.3rem; text-align:end;cursor: pointer;\"\r\n                                    name=\"search-outline\"></ion-icon>\r\n                                <ion-icon (click)=\"addWarrantyProd()\" slot=\"end\"\r\n                                    style=\"color: var(--ion-color-vh-green); font-size: 1.2rem; text-align:end;cursor: pointer;\"\r\n                                    src=\"assets/icon/add.svg\"></ion-icon>\r\n                            </div>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"24\">\r\n                            <div class=\"hideScrollbar waranty-invoice-prod-invoiceDetail\">\r\n                                <div class=\"invoiceDetail-item\" *ngFor=\"let item of warrantyProd;let i = index\">\r\n                                    <div nz-row>\r\n                                        <div (click)=\"removeWarrantyProd(i,item)\" nz-col nzSpan=\"2\" class=\"center-col\">\r\n                                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                        </div>\r\n                                        <div nz-col nzSpan=\"18\" class=\"center-col\">\r\n                                            <p class=\"max-width-two-line\" style=\"width: 100%;\">\r\n                                                <input [(ngModel)]=\"item.content\" (blur)=\"editWarrantyProd(i,item)\"\r\n                                                    [placeholder]=\"'Enter product name' | translate\"\r\n                                                    class=\"nz-no-border\" nz-input />\r\n                                            </p>\r\n                                        </div>\r\n                                        <div nz-col nzSpan=\"4\"\r\n                                            *ngIf=\"(warrantyProd.length == 1 && warrantyProd[0].content) || warrantyProd.length>1\">\r\n                                            <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"1\" [nzStep]=\"1\"\r\n                                                [(ngModel)]=\"item.quantity\"\r\n                                                (ngModelChange)=\"checkQuantityProduct(item,$event)\"></nz-input-number>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div nz-col class=\"search-product-warrany\" nzSpan=\"24\">\r\n                            <div>\r\n                                <h5>{{\"Note\"|translate}}</h5>\r\n                            </div>\r\n                            <div>\r\n                                <ion-icon (click)=\"addWarrantyNote()\" slot=\"end\"\r\n                                    style=\"color: var(--ion-color-vh-green); font-size: 1.2rem; text-align:end;cursor: pointer;\"\r\n                                    src=\"assets/icon/add.svg\"></ion-icon>\r\n                            </div>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"24\">\r\n                            <div class=\"hideScrollbar waranty-invoice-prod-invoiceDetail\">\r\n                                <div class=\"invoiceDetail-item\" *ngFor=\"let item of warrantyNote;let i = index\">\r\n                                    <div nz-row>\r\n                                        <div (click)=\"invoice.removeWarrantyNote(i,item)\" nz-col nzSpan=\"2\"\r\n                                            class=\"center-col\">\r\n                                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                        </div>\r\n                                        <div nz-col nzSpan=\"18\" class=\"center-col\">\r\n                                            <input [(ngModel)]=\"item.content\" (blur)=\"editWarrantyNote(i,item)\"\r\n                                                [placeholder]=\"'Enter note' | translate\" class=\"nz-no-border\"\r\n                                                nz-input />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-best-selling\">\r\n            <div nz-row class=\"waranty-invoice-quote\">\r\n                <div class=\"waranty-invoice-quote-header\" nz-col nzSpan=\"8\">\r\n                    <h5>{{\"Quote\" | translate}}</h5>\r\n                </div>\r\n                <div style=\"text-align: end;\" class=\"waranty-invoice-quote-header\" nz-col nzSpan=\"16\">\r\n                    <button style=\"margin-right: 8px;\" nz-button nzType=\"primary\" (click)=\"getPromotions()\">\r\n                        <i nz-icon nzType=\"gift\" nzTheme=\"outline\"></i> {{'Promotions' | translate}}</button>\r\n                    <button style=\"margin-right: 8px;\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                        (click)=\"showModalChangePriceType = true\">\r\n                        {{'Choose selling price' | translate}}</button>\r\n                    <button style=\"font-size: 0.9rem;\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                        (click)=\"openSearchProductList()\">\r\n                        <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                        {{'Search (F4)' | translate}}</button>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div id=\"waranty-invoice-quote-invoiceDetail\"\r\n                        class=\"hideScrollbar waranty-invoice-quote-invoiceDetail\">\r\n                        <div class=\"invoiceDetail-item\" *ngFor=\"let item of invoiceDetail,index as i\">\r\n                            <div nz-row>\r\n                                <div nz-col nzSpan=\"24\">\r\n                                    <ng-container [ngSwitch]=\"item.pmtype\">\r\n                                        <ng-container *ngSwitchCase=\"1\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products\">\r\n                                                <div nz-col nzSpan=\"1\">\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                                    <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        <br>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"data.combos\">\r\n                                                        <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ':\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                    <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                          <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                          <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                      </nz-select> -->\r\n                                                    {{data.unit}}\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                    {{data.quantity}}\r\n                                                    <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                          (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(data)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{data.price_origin > data.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"2\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products\">\r\n                                                <div nz-col nzSpan=\"1\"></div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                                    <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        <br>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"data.combos\">\r\n                                                        <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ':\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                    <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                          <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                          <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                      </nz-select> -->\r\n                                                    {{data.unit}}\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                    {{data.quantity}}\r\n                                                    <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                          (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(data)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{data.price_origin > data.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"3\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products\">\r\n                                                <div nz-col nzSpan=\"1\"></div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                                    <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        <br>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"data.combos\">\r\n                                                        <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ':\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                    <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                          <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                          <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                      </nz-select> -->\r\n                                                    {{data.unit}}\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                    {{data.quantity}}\r\n                                                    <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                          (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(data)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{data.price_origin > data.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"4\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products\">\r\n                                                <div nz-col nzSpan=\"1\"></div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                                    <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        <br>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"data.combos\">\r\n                                                        <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ':\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                    <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                          <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                          <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                      </nz-select> -->\r\n                                                    {{data.unit}}\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                    {{data.quantity}}\r\n                                                    <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                          (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(data)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{data.price_origin > data.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"5\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products\">\r\n                                                <div nz-col nzSpan=\"1\"></div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                                    <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        <br>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"data.combos\">\r\n                                                        <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ':\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                    <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                          <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                          <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                      </nz-select> -->\r\n                                                    {{data.unit}}\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                    {{data.quantity}}\r\n                                                    <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                          (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(data)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{data.price_origin > data.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"6\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}} <i\r\n                                                            nz-icon nzType=\"gift\" nzTheme=\"outline\"\r\n                                                            style=\"cursor: pointer;\"\r\n                                                            (click)=\"showProductGift = true\"></i></p>\r\n\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <!-- <div nz-row *ngFor=\"let data of item.products\">\r\n                                  <div nz-col nzSpan=\"1\"></div>\r\n                                  <div nz-col nzSpan=\"8\">\r\n                                      <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                  </div>\r\n                                  <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                      \r\n                                      {{data.unit}}\r\n                                  </div>\r\n                                  <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                      {{data.quantity}}\r\n                                       \r\n                                  </div>\r\n                                  <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                      <p class=\"max-width-two-line\" style=\" margin-left: 16px;\">\r\n                                          <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                          <del style=\"margin-left:5px;font-size: 0.8rem;\" *ngIf=\"display_promotion_selling_price\">\r\n                                              {{data.price_origin > data.price ?\r\n                                              vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                              ''}}\r\n                                          </del>\r\n                                      </p>\r\n                                  </div>\r\n                                  <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                      <p class=\"max-width-two-line\">\r\n                                          <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                      </p>\r\n                                  </div>\r\n                              </div> -->\r\n                                            <div nz-row *ngFor=\"let data of item.products_gift\">\r\n                                                <ng-container *ngIf=\"data.choose\">\r\n\r\n                                                    <div nz-col nzSpan=\"1\"></div>\r\n                                                    <div nz-col nzSpan=\"8\">\r\n                                                        <i style=\"margin-bottom: 0;\">{{data.name}}</i>\r\n                                                        <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                            <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                                (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                            <br>\r\n                                                        </ng-container>\r\n                                                        <p *ngIf=\"data.combos\">\r\n                                                            <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                                style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                                {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                                combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ')': combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                                getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                            </span>\r\n                                                        </p>\r\n\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                        <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                              <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                              <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                          </nz-select> -->\r\n                                                        {{data.unit}}\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                        {{data.quantity}}\r\n                                                        <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                              (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                    </div>\r\n                                                    <div (click)=\"openEditUnitPrice(data)\"\r\n                                                        class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                        <p class=\"max-width-two-line\"\r\n                                                            style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                            <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                            <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                                *ngIf=\"display_promotion_selling_price\">\r\n                                                                {{data.price_origin > data.price ?\r\n                                                                vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                                ''}}\r\n                                                            </del>\r\n                                                        </p>\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                        <p class=\"max-width-two-line\">\r\n                                                            <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                        </p>\r\n                                                    </div>\r\n                                                </ng-container>\r\n\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"7\">\r\n                                            <div nz-row *ngIf=\"item.products_gift.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}} <i\r\n                                                            nz-icon nzType=\"gift\" nzTheme=\"outline\"\r\n                                                            style=\"cursor: pointer;\"\r\n                                                            (click)=\"showProductGiftType7 = true\"></i></p>\r\n\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products_gift\">\r\n                                                <ng-container *ngIf=\"data.choose\">\r\n\r\n                                                    <div nz-col nzSpan=\"1\"></div>\r\n                                                    <div nz-col nzSpan=\"8\">\r\n                                                        <i style=\"margin-bottom: 0;\">{{data.name}}</i>\r\n                                                        <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                            <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                                (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        </ng-container>\r\n                                                        <p *ngIf=\"data.combos\">\r\n                                                            <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                                style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                                {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                                combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ')': combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                                getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                            </span>\r\n                                                        </p>\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                        <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                              <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                              <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                          </nz-select> -->\r\n                                                        {{data.unit}}\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                        {{data.quantity}}\r\n                                                        <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                              (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                    </div>\r\n                                                    <div (click)=\"openEditUnitPrice(data)\"\r\n                                                        class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                        <p class=\"max-width-two-line\"\r\n                                                            style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                            <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                            <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                                *ngIf=\"display_promotion_selling_price\">\r\n                                                                {{data.price_origin > data.price ?\r\n                                                                vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                                ''}}\r\n                                                            </del>\r\n                                                        </p>\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                        <p class=\"max-width-two-line\">\r\n                                                            <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                        </p>\r\n                                                    </div>\r\n                                                </ng-container>\r\n\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchDefault>\r\n                                            <div nz-row>\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Are you sure to delete' | translate}} {{item.name}}\"\r\n                                                    (nzOnConfirm)=\"deleteGoods(item,i)\"\r\n                                                    nzPopconfirmPlacement=\"bottomLeft\" nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{item.name}}</p>\r\n                                                    <ng-container *ngIf=\"item.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(item)\">{{getLotNumber(item.lots, item.id_lotproduct)}}</pre>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"item.combos\">\r\n                                                        <span *ngFor=\"let combo of item.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == item.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ' :\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                            <ng-container *ngIf=\"combo.id_lotproduct\">\r\n                                                                <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                                    (click)=\"openModalChooseLot(combo)\">{{getLotNumber(combo.lots, combo.id_lotproduct)}}</pre>\r\n                                                            </ng-container>\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\">\r\n                                                    <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.ratio\"\r\n                                                        (ngModelChange)=\"changeUnit($event,item)\">\r\n                                                        <!-- <nz-option [nzLabel]=\"item.unit\" [nzValue]=\"1\"></nz-option> -->\r\n                                                        <nz-option *ngFor=\"let i of item.units\" [nzLabel]=\"i.unit\"\r\n                                                            [nzValue]=\"i.ratio\"></nz-option>\r\n                                                    </nz-select>\r\n                                                    <!-- {{item.unit}} -->\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <!-- {{item.quantity}} -->\r\n                                                    <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\"\r\n                                                        [(ngModel)]=\"item.quantity\"\r\n                                                        (ngModelChange)=\"checkQuantityProduct(item,$event)\"\r\n                                                        id=\"quantity\">\r\n                                                    </nz-input-number>\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(item)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(item.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{item.price_origin > item.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(item.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(item.price*item.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                    </ng-container>\r\n\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Receptionist' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_employee\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveReceptionist($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Technician' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_technician\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveTechnician($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Issued date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\" nz-row style=\"overflow: visible;\">\r\n                <div class=\"sales-bills-customer-title\">\r\n                    <b>{{'Customer information' | translate}}</b>\r\n                    <ion-icon (click)=\"openDrawerAddCustomerOrRetail()\"\r\n                        style=\"color: var(--ion-color-vh-white);padding-right: 5px;\"\r\n                        [src]=\"invoice.retail_name ? 'assets/icon/eye.svg':'assets/icon/add.svg'\">\r\n                    </ion-icon>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <nz-radio-group [(ngModel)]=\"radioValue\" (ngModelChange)=\"changeCustomerType($event)\"\r\n                        nzName=\"radiogroup\">\r\n                        <label nz-radio [nzValue]=1>{{'Retail customer' | translate}}</label>\r\n                        <label nz-radio [nzValue]=2>{{'Member' | translate}}</label>\r\n                        <label nz-radio [nzValue]=3>{{'Search customer' | translate}}</label>\r\n                    </nz-radio-group>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <ng-container *ngIf=\"radioValue == 1 && invoice.retail_name\">\r\n                        {{invoice.retail_name}} - {{invoice.retail_phone}} {{invoice.retail_address ? '-':\r\n                        ''}} {{invoice.retail_address}}\r\n                    </ng-container>\r\n                    <ng-container *ngIf=\"radioValue == 2\">\r\n                        <app-customer [id_customer]=\"invoice.id_customer\"\r\n                            (closeAndReceiveCustomer)=\"closeAndReceiveCustomer($event)\"></app-customer>\r\n                        <i (click)=\"openInfoCustomer()\"\r\n                            [ngClass]=\"invoice.id_customer !='id_retail' ? 'active' : 'deactive'\"\r\n                            style=\"cursor: pointer;\" nz-icon nzType=\"info-circle\" nzTheme=\"outline\"></i>\r\n                    </ng-container>\r\n                    <ng-container *ngIf=\"radioValue == 3\">\r\n                        <app-search-customer [id_customer]=\"invoice.id_customer\"\r\n                            (closeAndReceiveCustomer)=\"closeAndReceiveCustomer($event)\"></app-search-customer>\r\n                        <i (click)=\"openInfoCustomer()\"\r\n                            [ngClass]=\"invoice.id_customer !='id_retail' ? 'active' : 'deactive'\"\r\n                            style=\"cursor: pointer;\" nz-icon nzType=\"info-circle\" nzTheme=\"outline\"></i>\r\n                    </ng-container>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\" *ngIf=\"radioValue == 2 && invoice.id_customer != 'id_retail'\"\r\n                    style=\"display: flex; justify-content: space-between;margin: 8px 0;\">\r\n                    <span>\r\n                        {{'Accumulated points' | translate}} : <b>{{point_validity}}</b>\r\n                    </span>\r\n                    <span>\r\n                        {{'Plus' | translate}} : <b>{{getTotalEarningPoint()}}</b>\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <div nz-col nzSpan=\"24\" style=\"display: flex;justify-content: space-between;\">\r\n                    <b>{{'Payment information' | translate}}</b>\r\n                    <span (click)=\"openModalOtherDiscount()\" style=\"cursor: pointer;color: var(--ion-color-vh-green);\">\r\n                        <i nz-icon nzType=\"plus\" nzTheme=\"outline\"></i>\r\n                        {{'Add other payment' |translate}}\r\n                    </span>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div>{{'SubTotal' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n\r\n                <ng-container *ngIf=\"vhAuth.localStorageGET('show_discount')\">\r\n                    <div class=\"sales-bills-content-discount\"\r\n                        style=\"display: flex;justify-content: space-between;align-items: center;\" nz-col nzSpan=\"24\">\r\n                        <div style=\"width: auto;\">{{'Discount value' | translate}}</div>\r\n                        <div>\r\n                            <input id=\"percent-discount-price\" style=\"width: 50px;\" #percentDiscount type=\"number\"\r\n                                max=\"100\" min=\"0\" step=\"1\" (blur)=\"editPercentDiscount(percentDiscount.value)\"\r\n                                [ngModel]=\"percent_discount_bill | number:'1.0-2'\" class=\"border_bottom \" maxlength=\"3\"\r\n                                nz-input />%\r\n                        </div>\r\n                        <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                            class=\"border_bottom discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\"\r\n                            nz-input />\r\n                    </div>\r\n                </ng-container>\r\n\r\n                <div *ngIf=\"discount_bill >0\" class=\"sales-bills-content-discount\"\r\n                    style=\"display: flex;justify-content: space-between;align-items: center;\" nz-col nzSpan=\"24\">\r\n                    <div style=\"width: auto;\">{{'Discount' | translate}}\r\n                    </div>\r\n                    <span>{{vhAlgorithm.vhcurrencyunit(discount_bill)}}</span>\r\n                </div>\r\n                <div *ngIf=\"invoice.payment_points\" class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Point payment' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.payment_points)}}</div>\r\n                </div>\r\n                <div *ngIf=\"invoice.payment_coupons\" class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Coupon payment' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.payment_coupons)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_fee')\">\r\n                    <div>{{'Fee' | translate}}</div>\r\n                    <input (blur)=\"editFee()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.fee)\"\r\n                        class=\"border_bottom invoice-fee\" type=\"text\" maxlength=\"15\" id=\"invoice-fee\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-tax\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_tax')\">\r\n                    <span>{{'Tax' | translate}}</span>\r\n                    <div>\r\n                        <nz-select *ngIf=\"listTax.length\" [(ngModel)]=\"id_tax\" (ngModelChange)=\"changeTax($event)\"\r\n                            nzBorderless>\r\n                            <nz-option *ngFor=\"let item of listTax\" nzValue=\"{{item._id}}\"\r\n                                nzLabel=\"{{vhAlgorithm.vhpercent(item.value/100)}}\">\r\n                            </nz-option>\r\n                        </nz-select>\r\n                        <span class=\"not-found\" *ngIf=\"!listTax.length\">0.00%</span>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"7\" style=\"text-align: end;\">\r\n                        {{vhAlgorithm.vhcurrencyunit(taxValue)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Total' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(getTotalATax())}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <div>\r\n                        <b>{{'Pay' | translate}}</b>\r\n                        <ng-container *ngIf=\"product_gift_type7.length && !gotten_gift_type7\">\r\n                            <i style=\"font-size: 1rem;  margin-left: 8px; cursor: pointer;color: var(--ion-color-vh-green)\"\r\n                                nz-icon nzType=\"gift\" nzTheme=\"outline\" (click)=\"showProductGiftType7 = true\"></i>\r\n                        </ng-container>\r\n\r\n                    </div>\r\n                    <div> {{vhAlgorithm.vhcurrencyunit(invoice.payment)}}<img (click)=\"showModalEditTotalPay()\"\r\n                            *ngIf=\"invoice.payment_type != 2\" style=\"width: 16px;margin-left:10px\"\r\n                            src=\"assets/icon/Iconfeather-edit.svg\" /></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_rest')\">\r\n                    <div>{{'Rest' | translate}}</div>\r\n                    <div> {{vhAlgorithm.vhcurrencyunit_symbol(getTotalATax() - invoice.payment)}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"sales-bills-content-payment_type\" nz-col nzSpan=\"24\">\r\n                    <app-tax [payment_type]=\"invoice.payment_type\" [id_wallet]=\"invoice.id_wallet\"\r\n                        [id_customer]=\"invoice.id_customer\" (closeAndGetValuePayment)=\"closeAndGetValuePayment($event)\">\r\n                    </app-tax>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!invoiceDetail.length || !checkPrinter\" (click)=\"payInvoice(15,true)\" nz-button\r\n                    class=\"order-and-print\">\r\n                    {{\"Pay & Print\"|translate}} (F2)\r\n                </button>\r\n                <button [disabled]=\"!invoiceDetail.length\" (click)=\"payInvoice(15,false)\" nz-button class=\"order\">\r\n                    {{\"Pay\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n\r\n<!-- -----nz-drawer list-product-------- -->\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\" [default_price_type]=\"default_price_type\">\r\n</app-search-product>\r\n<!-- -----nz-drawer list-product-warranty-------- -->\r\n<app-search-product-warranty-invoice *ngIf=\"searchProductListWarranty\"\r\n    [searchProductListWarranty]=\"searchProductListWarranty\"\r\n    (closeSearchProductListWarranty)=\"closeSearchProductListWarranty($event)\">\r\n</app-search-product-warranty-invoice>\r\n\r\n<!--Modal edit unit price-->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Edit unit price' | translate}}\" (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Unit price' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\" [value]=\"tempDetail.price\" nz-input\r\n                    placeholder=\"{{'Enter unit price' | translate}}\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!--Modal edit pay-->\r\n<nz-modal [(nzVisible)]=\"edit_pay\" [nzFooter]=\"modalFooterEditPay\" nzTitle=\"{{'Edit' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditPay()\" (nzOnOk)=\"handleEditPay()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Pay' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input [value]=\"vhAlgorithm.vhcurrencyunit(invoice.payment)\" class=\"edit-pay\" type=\"text\" maxlength=\"15\"\r\n                    nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditPay>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditPay()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditPay()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n\r\n<!-- MOdal giảm giá khác (coupon hoặc đổi điểm) -->\r\n<nz-modal [(nzVisible)]=\"showModalOtherDiscount\" nzTitle=\"{{'Other payment' | translate}}\" nzWidth=\"50vw\"\r\n    (nzOnCancel)=\"showModalOtherDiscount = false\" nzCancelText=\"\" (nzOnOk)=\"handleOkOtherDiscount()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row class=\"center-all-content\">\r\n            <div nz-col nzSpan=\"6\">\r\n                {{\"Coupon\" | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"12\" id=\"coupon\" style=\"display: flex;\">\r\n                <input #coupon nz-input placeholder=\"{{'Enter or scan code' | translate}}\"\r\n                    (keyup.enter)=\"getDiscountOfCoupon(coupon.value)\" />\r\n                <button style=\"margin-left: 8px;\" nz-button nzType=\"primary\"\r\n                    (click)=\"getDiscountOfCoupon(coupon.value)\">{{'Apply'| translate}}</button>\r\n            </div>\r\n            <div nz-col nzSpan=\"6\" class=\"text-end\">\r\n                {{vhAlgorithm.vhcurrencyunit(invoice.payment_coupons)}}\r\n            </div>\r\n        </div>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"6\"></div>\r\n            <div nz-col nzSpan=\"18\">\r\n                <nz-tag *ngFor=\"let item of product_codes\" [nzColor]=\"'green'\" nzMode=\"closeable\"\r\n                    (nzOnClose)=\"onCloseProductCode(item)\">{{item.code}}</nz-tag>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <ng-container *ngIf=\"customer_class?.payment.enable\">\r\n            <div nz-row class=\"center-all-content mt-8\">\r\n                <div nz-col nzSpan=\"6\">\r\n                    {{\"Accumulated points\" | translate}}\r\n                </div>\r\n                <div nz-col nzSpan=\"12\">\r\n                    <nz-input-number [(ngModel)]=\"value_discount_point\" style=\"width: 100%;\" #point\r\n                        nzPlaceHolder=\"{{'Enter points' | translate}}\" [nzMin]=\"0\" [nzMax]=\"point_validity\" [nzStep]=\"1\"\r\n                        (keyup)=\"calculatePoint2Money(point['value'])\"></nz-input-number>\r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"text-end\">\r\n                    {{vhAlgorithm.vhcurrencyunit(invoice.payment_points)}}\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"mt-8\">\r\n                <div nz-col nzSpan=\"14\">\r\n                    <label>{{\"Point conversion rate\" | translate}}:\r\n                        {{customer_class.payment.points}} Điểm =\r\n                        {{vhAlgorithm.vhcurrencyunit_symbol(customer_class.payment.money)}}</label>\r\n                </div>\r\n                <div nz-col nzSpan=\"10\" class=\"text-end\">\r\n                    {{'Current accumulated points' | translate}} : {{point_validity }}\r\n                </div>\r\n            </div>\r\n        </ng-container>\r\n\r\n        <div nz-row class=\"mt-8 beetween-all-content\">\r\n            <b>{{'Total discount' | translate}}</b>\r\n            <b>{{vhAlgorithm.vhcurrencyunit(invoice.payment_points + invoice.payment_coupons)}}</b>\r\n        </div>\r\n    </ng-container>\r\n</nz-modal>\r\n\r\n\r\n<!-- modal chọn sản phẩm tặng -->\r\n<nz-modal nzWidth=\"70vw\" [(nzVisible)]=\"showProductGift\" nzTitle=\"{{'Chọn quà tặng'}}\"\r\n    (nzOnCancel)=\"showProductGift = false\" (nzOnOk)=\"showProductGift = false;getEarningpointPromotion()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"invoiceDetail\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{{\"Product name\" | translate}}</th>\r\n                    <!-- <th>{{'Lot number' | translate}}</th> -->\r\n                    <th>{{'Unit' | translate}}</th>\r\n                    <th>{{'Quantity' | translate}}</th>\r\n                    <th>{{'Unit price' | translate}}</th>\r\n                    <th>{{'Functions' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let item of basicTable.data\">\r\n                    <ng-container *ngIf=\"item.pmtype == 6\">\r\n                        <tr>\r\n                            <td colspan=\"5\"><b>{{ item.name }}</b> ({{'_Selected gift quantity' | translate}}: {{\r\n                                item.promotions_maximum }})</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td colspan=\"5\">\r\n                                <b>{{ 'List of purchased products' | translate }} :</b> <br>\r\n                                <span *ngFor=\"let data of item.products\">\r\n                                    {{data.name}}({{data.unit}}) x{{data.quantity}} <br>\r\n                                </span>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td colspan=\"5\">\r\n                                <b>{{ 'List of gifted products' | translate }} :</b>\r\n                            </td>\r\n                        </tr>\r\n                        <ng-container *ngFor=\"let data of item.products_gift\">\r\n                            <tr>\r\n                                <td>\r\n                                    {{ data.name }}\r\n                                    <ng-container *ngIf=\"data.lots\">\r\n                                        <br> {{'Lot number' | translate}}:\r\n                                        <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                            [(ngModel)]=\"data.id_lotproduct\">\r\n                                            <nz-option *ngFor=\"let element of data.lots\"\r\n                                                nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp |date : 'dd/MM/yyyy'}}\"\r\n                                                [nzValue]=\"element._id\"></nz-option>\r\n                                        </nz-select>\r\n                                    </ng-container>\r\n\r\n\r\n                                </td>\r\n\r\n                                <td>{{ getUnit(data.units, data.ratio) }}</td>\r\n                                <td>{{ data.quantity }}</td>\r\n                                <td>\r\n                                    {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n                                    <del>{{vhAlgorithm.vhcurrencyunit(data.price_origin)}}</del>\r\n                                </td>\r\n                                <td>\r\n                                    <nz-switch [(ngModel)]=\"data.choose\"\r\n                                        [nzDisabled]=\"checkDisableChooseProductGift(item) && !data.choose\"></nz-switch>\r\n                                </td>\r\n                            </tr>\r\n                            <ng-container *ngIf=\"data.ptype == 5\">\r\n                                <tr *ngFor=\"let combo of data.combos\">\r\n                                    <td>- {{ combo.name }}\r\n                                        <ng-container *ngIf=\"combo.lots\">\r\n                                            <br> {{'Lot number' | translate}}:\r\n                                            <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                                [(ngModel)]=\"combo.id_lotproduct\">\r\n                                                <nz-option *ngFor=\"let element of combo.lots\"\r\n                                                    nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp |date : 'dd/MM/yyyy'}}\"\r\n                                                    [nzValue]=\"element._id\"></nz-option>\r\n                                            </nz-select>\r\n                                        </ng-container>\r\n                                    </td>\r\n\r\n                                    <td>{{ getUnit(combo.units, combo.ratio) }}</td>\r\n                                    <td>{{ combo.quantity }}</td>\r\n                                    <td>\r\n                                        {{vhAlgorithm.vhcurrencyunit(combo.price) }}\r\n                                        <!-- <del>{{vhAlgorithm.vhcurrencyunit(combo.price_origin)}}</del> -->\r\n                                    </td>\r\n                                    <td>\r\n                                        <!-- <nz-switch [(ngModel)]=\"combo.choose\"\r\n                                          [nzDisabled]=\"checkDisableChooseProductGift(item) && !combo.choose\"></nz-switch> -->\r\n                                    </td>\r\n                                </tr>\r\n                            </ng-container>\r\n\r\n                        </ng-container>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n    </ng-container>\r\n</nz-modal>\r\n\r\n<!-- modal chọn sản phẩm tặng type 7 -->\r\n<nz-modal nzWidth=\"70vw\" [(nzVisible)]=\"showProductGiftType7\" nzTitle=\"{{'Chọn quà tặng'}}\"\r\n    (nzOnCancel)=\"showProductGiftType7 = false\" (nzOnOk)=\"showProductGiftType7 = false;handleAddGiftType7()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"product_gift_type7\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{{\"Product name\" | translate}}</th>\r\n                    <!-- <th>{{'Lot number' | translate}}</th> -->\r\n                    <th>{{'Unit' | translate}}</th>\r\n                    <th>{{'Quantity' | translate}}</th>\r\n                    <th>{{'Unit price' | translate}}</th>\r\n                    <th>{{'Functions' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let item of basicTable.data\">\r\n                    <ng-container *ngIf=\"item.products_gift\">\r\n                        <tr>\r\n                            <td colspan=\"5\"><b>{{ item.name }}</b> ({{'_Selected gift quantity' | translate}}: {{\r\n                                item.promotions_maximum }})</td>\r\n                        </tr>\r\n                        <ng-container *ngFor=\"let data of item.products_gift\">\r\n                            <tr>\r\n                                <td>\r\n                                    {{ data.name }}\r\n                                    <ng-container *ngIf=\"data.lots\">\r\n                                        <br> {{'Lot number' | translate}}:\r\n                                        <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                            [(ngModel)]=\"data.id_lotproduct\">\r\n                                            <nz-option *ngFor=\"let element of data.lots\"\r\n                                                nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp |date : 'dd/MM/yyyy'}}\"\r\n                                                [nzValue]=\"element._id\"></nz-option>\r\n                                        </nz-select>\r\n                                    </ng-container>\r\n                                </td>\r\n\r\n                                <td>{{ getUnit(data.units, data.ratio) }}</td>\r\n                                <td>{{ data.quantity }}</td>\r\n                                <td>\r\n                                    {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n                                    <del>{{vhAlgorithm.vhcurrencyunit(data.price_origin)}}</del>\r\n                                </td>\r\n                                <td>\r\n                                    <nz-switch [(ngModel)]=\"data.choose\"\r\n                                        [nzDisabled]=\"checkDisableChooseProductGift(item) && !data.choose\"></nz-switch>\r\n                                </td>\r\n                            </tr>\r\n                            <ng-container *ngIf=\"data.ptype == 5\">\r\n                                <tr *ngFor=\"let combo of data.combos\">\r\n                                    <td>- {{ combo.name }}\r\n                                        <ng-container *ngIf=\"combo.lots\">\r\n                                            <br> {{'Lot number' | translate}}:\r\n                                            <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                                [(ngModel)]=\"combo.id_lotproduct\">\r\n                                                <nz-option *ngFor=\"let element of combo.lots\"\r\n                                                    nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp |date : 'dd/MM/yyyy'}}\"\r\n                                                    [nzValue]=\"element._id\"></nz-option>\r\n                                            </nz-select>\r\n                                        </ng-container>\r\n                                    </td>\r\n\r\n                                    <td>{{ getUnit(combo.units, combo.ratio) }}</td>\r\n                                    <td>{{ combo.quantity }}</td>\r\n                                    <td>\r\n                                        {{vhAlgorithm.vhcurrencyunit(combo.price) }}\r\n                                        <!-- <del>{{vhAlgorithm.vhcurrencyunit(combo.price_origin)}}</del> -->\r\n                                    </td>\r\n                                    <td>\r\n                                        <!-- <nz-switch [(ngModel)]=\"combo.choose\"\r\n                                      [nzDisabled]=\"checkDisableChooseProductGift(item) && !combo.choose\"></nz-switch> -->\r\n                                    </td>\r\n                                </tr>\r\n                            </ng-container>\r\n                        </ng-container>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n    </ng-container>\r\n</nz-modal>\r\n\r\n\r\n<!-- modal chọn lô/HSD -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice2\" [(nzVisible)]=\"show_modal_select_lots\"\r\n    nzTitle=\"{{'Select lot number' | translate}}\" (nzOnCancel)=\"handleCancelChooseLot()\" (nzOnOk)=\"handleChooseLot()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input type=\"text\" nz-input placeholder=\"{{'Find lot number' | translate}}\" #searchValue\r\n                    (keyup)=\"searchLot(searchValue.value )\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <nz-radio-group [(ngModel)]=\"tempDetail.id_lotproduct\" (ngModelChange)=\"changeLot($event)\"\r\n            style=\"width:100%;padding: 8px 0;\">\r\n            <div nz-row *ngFor=\"let item of tempDetail.lots\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <label class=\"radio-purchase\" nz-radio [nzValue]=\"item._id\" style=\"width:100%;\">\r\n                        <div nz-row>\r\n                            <div nz-col nzSpan=\"6\">\r\n                                {{item.lot_number}}\r\n                            </div>\r\n\r\n                            <div nz-col nzSpan=\"6\">\r\n                                NSX: {{item.date_mfg | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                            <div nz-col nzSpan=\"6\">\r\n                                HSD: {{item.date_exp | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                            <div nz-col nzSpan=\"6\" class=\"ion-text-end\">\r\n                                {{'Stock' | translate}}:\r\n                                <span\r\n                                    style=\" color: var(--ion-color-vh-orange)\">{{item.quantity_branch[id_branch]/tempDetail.ratio\r\n                                    | number : '1.0-2'}}</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                    </label>\r\n                </div>\r\n\r\n            </div>\r\n        </nz-radio-group>\r\n        <div *ngIf=\"!tempDetail.lots.length\" style=\"text-align: center;\">{{'No data' | translate}}</div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice2>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelChooseLot()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\" [disabled]=\"!tempDetail.id_lotproduct\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLot()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!-- modal chọn lô/HSD cho combo-->\r\n<nz-modal nzWidth=\"70vw\" *ngIf=\"show_modal_select_lots_combo\" [nzFooter]=\"modalFooterEditUnitPrice3\"\r\n    [(nzVisible)]=\"show_modal_select_lots_combo\"\r\n    nzTitle=\"{{'Select lot number for products in combo' | translate}}: {{tempDetail.name}}\"\r\n    (nzOnCancel)=\"show_modal_select_lots_combo = false\" (nzOnOk)=\"handleChooseLotCombo()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"tempDetail.combos\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th nzWidth=\"30%\">{{\"Product name\" | translate}}</th>\r\n                    <th nzWidth=\"30%\">{{'Lot number' | translate}}</th>\r\n                    <th nzWidth=\"10%\">{{'Unit' | translate}}</th>\r\n                    <th nzWidth=\"10%\">{{'Quantity' | translate}}</th>\r\n                    <th nzWidth=\"20%\" nzAlign=\"right\">{{'Unit price' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let data of basicTable.data\">\r\n                    <ng-container *ngIf=\"data.lots\">\r\n\r\n                        <tr>\r\n                            <td>{{ data.name }}</td>\r\n                            <td>\r\n                                <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                    [(ngModel)]=\"data.id_lotproduct\" style=\"width: 100%;\">\r\n                                    <nz-option *ngFor=\"let element of data.lots\"\r\n                                        nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp | date: 'dd/MM/yyyy'}}\"\r\n                                        [nzValue]=\"element._id\"></nz-option>\r\n                                </nz-select>\r\n                            </td>\r\n                            <td>{{getUnit(data.units, data.ratio)}}</td>\r\n                            <td>{{ data.quantity }}</td>\r\n                            <td nzAlign=\"right\">\r\n                                {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n\r\n                            </td>\r\n                        </tr>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice3>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"show_modal_select_lots_combo = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLotCombo()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n\r\n<!-- đổi giá bán -->\r\n<app-change-price-type *ngIf=\"showModalChangePriceType\" [showModalChangePriceType]=\"showModalChangePriceType\"\r\n    (changePriceType)=\"changePriceType($event)\" [default_price_type]=\"default_price_type\"></app-change-price-type>\r\n<!-- --------------visible drawer info customer----------- -->\r\n<app-customer-profile *ngIf=\"visibleInfoCustomer\" [visibleInfoCustomer]=\"visibleInfoCustomer\" [customer]=\"customer\"\r\n    (closeInfoCustomer)=\"closeInfoCustomer($event)\"></app-customer-profile>\r\n<app-add-customer *ngIf=\"showDrawerAddCusomer\" [showDrawerAddCusomer]=\"showDrawerAddCusomer\"\r\n    (closeAddCustomer)=\"closeAddCustomer($event)\"></app-add-customer>\r\n<app-retail-info *ngIf=\"showDrawerAddRetail\" [showDrawerAddRetail]=\"showDrawerAddRetail\"\r\n    [retail_name]=\"invoice.retail_name\" [retail_phone]=\"invoice.retail_phone\" [retail_address]=\"invoice.retail_address\"\r\n    (closeAddCustomer)=\"closeAddCustomer($event)\"></app-retail-info>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { AddComponent } from './add/add.component';\r\nimport { EditComponent } from './edit/edit.component';\r\nimport { DetailComponent } from './detail/detail.component';\r\nimport { SearchModule } from '../../search/search.module';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { NgZorroAntModule } from 'src/app/ng-zorro-ant.module';\r\nimport { ComponentsModule } from 'src/app/sales/sale-desktop/components/components.module';\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddComponent,\r\n    EditComponent,\r\n    DetailComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    ComponentsModule,\r\n    NgZorroAntModule,\r\n    TranslateModule,\r\n    IonicModule,\r\n    FormsModule,\r\n    SearchModule\r\n  ],\r\n  exports: [\r\n    AddComponent,\r\n    EditComponent,\r\n    DetailComponent\r\n  ],\r\n})\r\nexport class BillType15Module { }\r\n","import { Component, OnInit, ChangeDetectorRef, Input } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { WarrantyK57Col3Component } from 'src/app/sales/components/print/warranty/warranty-k57-col3/warranty-k57-col3.component';\r\nimport { WarrantyK80Col3Component } from 'src/app/sales/components/print/warranty/warranty-k80-col3/warranty-k80-col3.component';\r\nimport { WarrantyK80Col4Component } from 'src/app/sales/components/print/warranty/warranty-k80-col4/warranty-k80-col4.component';\r\nimport { WarrantyA5Component } from 'src/app/sales/components/print/warranty/warranty-a5/warranty-a5.component';\r\nimport { WarrantyA4Component } from 'src/app/sales/components/print/warranty/warranty-a4/warranty-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { VhBillType15, VhBillType15Detail, VhWarranty } from '../bill-type15-interface';\r\n\r\n@Component({\r\n  selector: 'bill-type15-detail',\r\n  templateUrl: './detail.component.html',\r\n  styleUrls: ['./detail.component.scss']\r\n})\r\nexport class DetailComponent {\r\n  @Input() url = '';\r\n  display_promotion_selling_price: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').display_promotion_selling_price\r\n  printer: any\r\n  tableHeight: string;\r\n  public invoiceInfo: any;\r\n  public invoice: VhBillType15\r\n  subTotal = 0;\r\n  invoice_detail = []\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore;\r\n  warrantyProd: VhWarranty[] = []\r\n  warrantyNote: VhWarranty[] = []\r\n  constructor(\r\n    private router: Router,\r\n    private vhQuerySales: VhQuerySales,\r\n    private languageService: LanguageService,\r\n    private vhAuth: VhAuth,\r\n    private vhComponent: VhComponent,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private cdRef: ChangeDetectorRef,\r\n    private fncService: FunctionService\r\n  ) {\r\n    this.getDataInvoice(this.router.getCurrentNavigation().extras.state.id)\r\n\r\n  }\r\n\r\n  /**\r\n   * gán bill và bill-detail get được vào biến và get các thông tin của nv, khách hàng, phương thức thanh toán\r\n   * @example this.init(bill, bill-deails)\r\n   */\r\n  init(invoice: VhBillType15 = null, invoiceDetail: VhBillType15Detail[] = null, warranty: VhWarranty[] = null) {\r\n    this.invoice = invoice\r\n    this.invoice_detail = invoiceDetail;\r\n    this.warrantyProd = warranty.filter(e => e.type == 1)\r\n    this.warrantyNote = warranty.filter(e => e.type == 2)\r\n    if (invoice && invoiceDetail) {\r\n      this.invoiceInfo = {\r\n        employee: this.vhAuth.getlocalEmployee(this.invoice.id_employee),\r\n        partner: this.vhQuerySales.getlocalCustomer(this.invoice.id_customer),\r\n        paymentName: this.setPaymentName(this.invoice.payment_type),\r\n        technician: this.vhAuth.getlocalEmployee(this.invoice.id_technician),\r\n      }\r\n    } else this.invoiceInfo = { employee: {}, partner: {}, paymentName: '' }\r\n    this.setSubTotal()\r\n  }\r\n  /**\r\n   * tính cộng tiền hóa đơn\r\n   * @example this.setSubTotal()\r\n   */\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoice_detail) {\r\n      subTotal += (i.price ? i.price * i.quantity : 0)\r\n    }\r\n    this.subTotal = subTotal;\r\n  }\r\n\r\n\r\n  /**\r\n   * get dữ liệu bill từ DB\r\n   * @param id : nhận từ state truyền qua\r\n   * @example this.getDataInvoice('DHIWHNXDIWODUHIWDHOWID')\r\n   */\r\n  private getDataInvoice(id) {\r\n    this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n      Promise.all([\r\n        this.vhQuerySales.getBill(id),\r\n        this.vhQuerySales.getBill_details_byId_bill(id),\r\n        this.vhQuerySales.getWarrantys_byFields({ id_bill: { $eq: id } })\r\n      ]).then(([invoice, invoiceDetail, warranty]: any) => {\r\n        if (!invoiceDetail.length)\r\n          this.init(invoice, [], [])\r\n        else {\r\n          invoiceDetail = this.vhAlgorithm.sortVietnamesebyASC(invoiceDetail, 'name');\r\n          this.init(invoice, invoiceDetail, warranty)\r\n        }\r\n        this.vhComponent.hideLoading(0)\r\n      })\r\n    })\r\n\r\n  }\r\n  /**\r\n   * trả về tên unit của sản phẩm theo ratio truyền vào\r\n   * @param units \r\n   * @param ratio \r\n   * @returns string\r\n   * @example let unit_name = this.getUnit([object], 1)\r\n   */\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit\r\n  }\r\n\r\n  /**\r\n   * trả về chuỗi thông tin lô theo id lô truyền vào\r\n   * @param lots \r\n   * @param _id \r\n   * @returns string\r\n   * @example let lot = this.getLotNumber([], 'DNIWUHNDKLJWHDIWUOH')\r\n   */\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id)\r\n    return lot.lot_number + '\\n' + this.fncService.formatDate(lot.date_mfg) + ' - ' + this.fncService.formatDate(lot.date_exp)\r\n  }\r\n\r\n  /**\r\n   * xóa hóa đơn lên DB\r\n   * @example this.deleteInvoice()\r\n   */\r\n  deleteInvoice() {\r\n    this.vhQuerySales.getValidityDate(this.invoice.date).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        if (this.vhAuth.checkMyPermission(\"warranty_enable_cancel_bill\")) {\r\n          this.vhComponent.alertConfirm(this.languageService.translate(\"Confirm\"), \"\", `${this.languageService.translate(\"Are you sure to cancel the sales invoice\")}?`, \"OK\", this.languageService.translate(\"Cancel\"))\r\n            .then(() => {\r\n              this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n                this.vhQuerySales.deleteBill_Billdetail(this.invoice._id).then(() => {\r\n                  this.vhComponent.hideLoading(0).then(() => {\r\n                    this.dataRestore.invoice = this.dataRestore.invoice.filter(e => e._id != this.invoice._id)\r\n                    this.vhComponent.showToast(2000,\r\n                      `${this.languageService.translate(\"Warranty, Repair invoices\")} ${this.invoice.bill_code} ${this.languageService.translate(\"has been cancelled successfully\")}`, \"success-toast\")\r\n                    this.router.navigate([this.url], { state: this.dataRestore })\r\n                  })\r\n                })\r\n              })\r\n            }, () => { })\r\n        } else this.vhComponent.showToast(1500, this.languageService.translate('You do not have this rights'), \"alert-toast\")\r\n      }\r\n      else {\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n\r\n\r\n  }\r\n  /**\r\n   * trả về tên phương thức thanh toán\r\n   * @param type \r\n   * @returns string\r\n   * @example this.setPaymentName(1)\r\n   */\r\n  public setPaymentName(type: 1 | 2 | 3) {\r\n    switch (type) {\r\n      case 1: return this.languageService.translate(\"Cash\")\r\n      case 2: return this.languageService.translate(\"Debit\")\r\n      case 3: return this.vhQuerySales.getlocalWallet(this.invoice.id_wallet).name\r\n    }\r\n  }\r\n  /**\r\n   * trả về chuỗi thông tin địa chỉ của supplier\r\n   * @param partner \r\n   * @returns string\r\n   * @example let addr = this.renderAddress(supplier_info)\r\n   */\r\n  public renderAddress(partner) {\r\n    return (partner.address ? partner.address : '') +\r\n      (partner.district ? ', ' + partner.district : '') +\r\n      (partner.province ? ', ' + partner.province : '') +\r\n      (partner.country ? ', ' + partner.country : '')\r\n  }\r\n  public goToCart() {\r\n    this.vhQuerySales.getValidityDate(this.invoice.date).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        this.router.navigate([this.url + '/edit'], { state: { invoiceDetail: this.invoice_detail, invoice: this.invoice, warrantyProd: this.warrantyProd, warrantyNote: this.warrantyNote } })\r\n      }\r\n      else {\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n\r\n  }\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_warranty')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n\r\n  /**\r\n   * kiểm tra thông tin dữ liệu trang in và mở component in\r\n   * @example this.printInvoice()\r\n   */\r\n  printInvoice() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice: this.invoice, invoice_detail: this.invoice_detail, warrantyProd: this.warrantyProd, warrantyNote: this.warrantyNote }, false, false, `modal-print-${printer['_id']}`)\r\n    }, (err) => {\r\n      this.vhComponent.alertMessage(this.languageService.translate(\"Function\"), \"\", this.languageService.translate(\"Please turn on the printer function\"), \"OK\")\r\n\r\n    })\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return WarrantyK57Col3Component\r\n      case 'print_size_k80_3c': return WarrantyK80Col3Component\r\n      case 'print_size_k80_4c': return WarrantyK80Col4Component\r\n      case 'print_size_a5': return WarrantyA5Component\r\n      case 'print_size_a4': return WarrantyA4Component\r\n      default: return WarrantyA4Component\r\n    }\r\n  }\r\n  goBack() {\r\n    this.router.navigate([this.url], { state: this.dataRestore });\r\n  }\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\".sales-best-selling\") && document.querySelector(\".waranty-invoice-quote-header\") && document.querySelector(\".ant-table-thead\")) {\r\n      this.tableHeight = document.querySelector(\".sales-best-selling\").clientHeight\r\n        - document.querySelector(\".waranty-invoice-quote-header\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - 35 + \"px\"\r\n    }\r\n    if (document.getElementById(\"receipt-invoice-prodAndnote-invoiceDetail\") && document.querySelector(\".sales-cart\") && document.querySelector(\".sales-cart-header\")) {\r\n      document.getElementById(\"receipt-invoice-prodAndnote-invoiceDetail\").style.height = document.querySelector(\".sales-cart\").clientHeight - document.querySelector(\".sales-cart-header\").clientHeight - 10 + 'px';\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n\r\n<nz-layout *ngIf=\"invoice\">\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title sales-cart-header-title\">\r\n                    <b>{{\"Invoice\" | translate}}: {{invoice.bill_code}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"center-all-content\">\r\n                    <button (click)=\"goToCart()\" class=\"btn-data nz-hover-border center-all-content\" nz-button nzType=\"default\">\r\n                        <span nz-icon nzType=\"edit\" nzTheme=\"outline\"></span>\r\n                        {{'Edit' | translate}}\r\n                      </button>\r\n                    <button (click)=\"printInvoice()\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\">\r\n                        <ion-icon style=\"margin-right: 5px;\" src=\"assets/icon/management/printer.svg\"></ion-icon>\r\n                        {{'Print' | translate}}\r\n                    </button>\r\n                    <button [disabled]=\"invoice.bill_type == 17\" (click)=\"deleteInvoice()\"\r\n                    class=\"btn-data nz-hover-border\" nz-button nzType=\"default\">\r\n                    <ion-icon style=\"margin-right: 5px;\" name=\"trash-outline\"></ion-icon>\r\n                    {{'Delete' | translate}}\r\n                </button>\r\n                </div>\r\n                \r\n                <div id=\"receipt-invoice-prodAndnote-invoiceDetail\"\r\n                    class=\"receipt-invoice-prodAndnote-invoiceDetail hideScrollbar\" nz-col nzSpan=\"24\">\r\n                    <div nz-row>\r\n                        <div nz-col class=\"search-product-warrany\" nzSpan=\"24\">\r\n                            <div>\r\n                                <h5>{{\"Warranty, repair products\"|translate}}</h5>\r\n                            </div>\r\n                            <div>\r\n                            </div>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"24\">\r\n                            <div class=\"hideScrollbar waranty-invoice-prod-invoiceDetail\">\r\n                                <div class=\"invoiceDetail-item\" *ngFor=\"let item of warrantyProd\">\r\n                                    <div nz-row>\r\n                                        <div nz-col nzSpan=\"20\" class=\"invoiceDetail-item-content\">\r\n                                            {{item.content}}\r\n                                        </div>\r\n                                        <div style=\"font-weight: bold;\" nz-col nzSpan=\"4\"\r\n                                            class=\"ion-text-end invoiceDetail-item-quantity\">\r\n                                            {{\"Quantity\" | translate}}: {{item.quantity}}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div nz-col class=\"search-product-warrany\" nzSpan=\"24\">\r\n                            <h5>{{\"Note\"|translate}}</h5>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"24\">\r\n                            <div class=\"hideScrollbar waranty-invoice-prod-invoiceDetail\">\r\n                                <div class=\"invoiceDetail-item\" *ngFor=\"let item of warrantyNote\">\r\n                                    <div nz-row>\r\n                                        <div nz-col nzSpan=\"24\" class=\"center-col\">\r\n                                            {{item.content}}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-best-selling\">\r\n            <div nz-row class=\"waranty-invoice-quote\">\r\n                <div class=\"waranty-invoice-quote-header\" nz-col nzSpan=\"24\">\r\n                    <h5>{{\"Quote\" | translate}}</h5>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                        <div class=\"invoiceDetail-item\">\r\n                            <nz-table [nzScroll]=\"{ y: tableHeight }\" [nzData]=\"invoice_detail\"\r\n                                #rowSelectionTable nzShowSizeChanger nzNoResult=\"{{'No data' | translate}}\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th nzWidth=\"35%\"><b>{{'Product name' | translate}}</b></th>\r\n                                        <th nzWidth=\"15%\" nzAlign='center'><b>{{'Unit' | translate}}</b></th>\r\n                                        <th nzWidth=\"15%\" nzAlign='center'><b>{{'Quantity' | translate}}</b></th>\r\n                                        <th nzWidth=\"15%\" nzAlign='right'><b>{{'Unit price' | translate}}</b></th>\r\n                                        <th nzWidth=\"20%\" nzAlign='right'><b>{{'Total' | translate}}</b></th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    <ng-container *ngFor=\"let item of rowSelectionTable.data\">\r\n                                        <ng-container *ngIf=\"item.id_promotion\">\r\n                                            <tr style=\"cursor: pointer;\">\r\n                                                <td colspan=\"5\"><b>{{item.name}}</b></td>\r\n                                            </tr>\r\n                                            <tr style=\"cursor: pointer;\" *ngFor=\"let data of item.products\">\r\n                                                <td>{{data.name}} <br>\r\n                                                    <ng-container *ngIf=\"data.lots\">\r\n                                                        <pre>{{getLotNumber(data.lots, data.id_lotproduct)}}</pre> <br>\r\n                                                    </ng-container>\r\n                                                    <ng-container *ngIf=\"data.combos\">\r\n                                                        <span class=\"sub-name\"\r\n                                                            *ngFor=\"let combo of data.combos\">{{combo.quantity}}x\r\n                                                            {{combo.name}} ({{getUnit(combo.units,combo.ratio)}}),\r\n                                                        </span>\r\n                                                    </ng-container>\r\n                                                </td>\r\n                                                <td nzAlign='center'>\r\n                                                    {{getUnit(data.units, data.ratio)}}\r\n                                                </td>\r\n                                                <td nzAlign='center'>{{data.quantity}}</td>\r\n                                                <td nzAlign='right'>\r\n                                                    {{vhAlgorithm.vhcurrencyunit(data.price)}}\r\n                                                    <del style=\"font-size: 0.7rem;\"\r\n                                                        *ngIf=\"display_promotion_selling_price\">\r\n                                                        {{data.price_origin > data.price ?\r\n                                                        vhAlgorithm.vhcurrencyunit(data.price_origin) : ''}}\r\n                                                    </del>\r\n                                                </td>\r\n                                                <td nzAlign='right'><b>{{vhAlgorithm.vhcurrencyunit(data.quantity *\r\n                                                        data.price)}}</b></td>\r\n                                            </tr>\r\n                                            <tr style=\"cursor: pointer;\" *ngFor=\"let data of item.products_gift\">\r\n                                                <td>{{data.name}} <i>({{'Gift' | translate}})</i><br>\r\n                                                    <ng-container *ngIf=\"data.lots\">\r\n                                                        {{getLotNumber(data.lots, data.id_lotproduct)}} <br>\r\n                                                    </ng-container>\r\n                                                    <ng-container *ngIf=\"data.combos\">\r\n                                                        <span class=\"sub-name\"\r\n                                                            *ngFor=\"let combo of data.combos\">{{combo.quantity}}x\r\n                                                            {{combo.name}} ({{getUnit(combo.units,combo.ratio)}}),\r\n                                                        </span>\r\n                                                    </ng-container>\r\n                                                </td>\r\n                                                <td nzAlign='center'>\r\n                                                    {{getUnit(data.units, data.ratio)}}\r\n                                                </td>\r\n                                                <td nzAlign='center'>{{data.quantity}}</td>\r\n                                                <td nzAlign='right'>\r\n                                                    {{vhAlgorithm.vhcurrencyunit(data.price)}}\r\n                                                    <del style=\"font-size: 0.7rem;\"\r\n                                                        *ngIf=\"display_promotion_selling_price\">\r\n                                                        {{data.price_origin > data.price ?\r\n                                                        vhAlgorithm.vhcurrencyunit(data.price_origin) : ''}}\r\n                                                    </del>\r\n                                                </td>\r\n                                                <td nzAlign='right'><b>{{vhAlgorithm.vhcurrencyunit(data.quantity *\r\n                                                        data.price)}}</b></td>\r\n                                            </tr>\r\n                                        </ng-container>\r\n\r\n                                        <tr style=\"cursor: pointer;\" *ngIf=\"!item.id_promotion\">\r\n                                            <td>{{item.name}}\r\n                                                <ng-container *ngIf=\"item.id_lotproduct\">\r\n                                                    <pre>{{getLotNumber(item.lots, item.id_lotproduct)}} </pre>\r\n                                                </ng-container>\r\n\r\n                                                <ng-container *ngIf=\"item.combos\">\r\n                                                    <span class=\"sub-name\"\r\n                                                        *ngFor=\"let combo of item.combos\">{{combo.quantity}}x\r\n                                                        {{combo.name}} ({{getUnit(combo.units,combo.ratio)}}), </span>\r\n                                                </ng-container>\r\n\r\n                                            </td>\r\n                                            <td nzAlign='center'>\r\n                                                {{getUnit(item.units, item.ratio)}}\r\n                                            </td>\r\n                                            <td nzAlign='center'>{{item.quantity}}</td>\r\n                                            <td nzAlign='right'>\r\n                                                {{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n                                                <del style=\"font-size: 0.7rem;\" *ngIf=\"display_promotion_selling_price\">\r\n                                                    {{item.price_origin > item.price ?\r\n                                                    vhAlgorithm.vhcurrencyunit(item.price_origin) : ''}}\r\n                                                </del>\r\n                                            </td>\r\n                                            <td nzAlign='right'><b>{{vhAlgorithm.vhcurrencyunit(item.quantity *\r\n                                                    item.price)}}</b></td>\r\n                                        </tr>\r\n                                    </ng-container>\r\n                                </tbody>\r\n                            </nz-table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\" [ngClass]=\"invoice.bill_type == 16 ? 'continue-sell' : 'not-continue-sell'\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div>\r\n                    <b>{{'Receptionist' | translate}}</b>\r\n                    <div>{{invoiceInfo.employee.name}}</div>\r\n                </div>\r\n                <div>\r\n                    <b>{{'Technician' | translate}}</b>\r\n                    <div>{{invoiceInfo.technician.name}}</div>\r\n                </div>\r\n                <div>\r\n                    <b>{{'Issued date' | translate}}</b>\r\n                    <div>{{invoice.date | date: 'dd/MM/yyyy HH:mm'}}</div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\" nz-row>\r\n                <b>{{'Customer information' | translate}}</b>\r\n                <div *ngIf=\"invoiceInfo.partner._id == 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{invoiceInfo.partner.name | translate}}\r\n                </div>\r\n                <div *ngIf=\"invoiceInfo.partner._id != 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{invoiceInfo.partner.name | translate}} - {{invoiceInfo.partner.phone}}\r\n                </div>\r\n                <div *ngIf=\"invoiceInfo.partner._id != 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{renderAddress(invoiceInfo.partner)}}\r\n                </div>\r\n                <div *ngIf=\"invoiceInfo.partner._id == 'id_retail' && invoice.retail_name\" nz-col nzSpan=\"24\">\r\n                    {{invoice.retail_name}} - {{invoice.retail_phone}} {{invoice.retail_address ? '-':\r\n                    ''}} {{invoice.retail_address}}\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                <!-- <div nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_discount_invoice') && invoice.getDiscountInvoice() >= 0\">\r\n                <div>{{'Discount' | translate}}</div>\r\n                <div>{{vhAlgorithm.vhcurrencyunit(invoice.getDiscountInvoice())}}</div>\r\n            </div> -->\r\n                <div nz-col nzSpan=\"24\">\r\n                    <span>{{'SubTotal' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\" *ngIf=\"invoice.discount_bill\">\r\n                    <span>{{'Discount' | translate}}\r\n                    </span>\r\n\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.discount_bill)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Discount value' | translate}}\r\n                    </span>\r\n                    <span>{{(invoice.discount/subTotal)*100 || 0 | number :'1.0-2'}}%</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.discount)}}</div>\r\n                </div>\r\n\r\n                <div *ngIf=\"invoice.payment_points\" class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Point payment' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.payment_points)}}</div>\r\n                </div>\r\n                <div *ngIf=\"invoice.payment_coupons\" class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Coupon payment' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.payment_coupons)}}</div>\r\n                </div>\r\n\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\"  >\r\n                    <span>{{'Fee' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.fee)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-tax\" nz-col nzSpan=\"24\"  >\r\n                    <span>{{'Tax' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhpercent(invoice.tax/100)}}</div>\r\n                    <div>\r\n                        {{vhAlgorithm.vhcurrencyunit(invoice.total * (invoice.tax / 100))}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Total' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.total)}}</div>\r\n\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Pay' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit_symbol(invoice.payment)}}</div>\r\n\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Rest' | translate}}</span>\r\n                    <div style=\"color: var(--ion-color-vh-red);\">{{vhAlgorithm.vhcurrencyunit_symbol(invoice.total *\r\n                        (1+invoice.tax / 100) -\r\n                        invoice.payment)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-payment_type\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Payment method' | translate}}</span>\r\n                    <div>{{setPaymentName(this.invoice.payment_type)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Note' | translate}}</span>\r\n                    <div>{{invoice.note}}</div>\r\n                </div>\r\n            </div>\r\n            <div *ngIf=\"invoice.bill_type == 16\" nz-row class=\"sales-bills-button\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <button nz-button class=\"button payment-print\" (click)=\"goToCart()\">{{'Continue to sell...'\r\n                        |translate}}</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>","import { ChangeDetectorRef, Component, Input, OnInit } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { Observable } from 'rxjs';\r\nimport { WarrantyK57Col3Component } from 'src/app/sales/components/print/warranty/warranty-k57-col3/warranty-k57-col3.component';\r\nimport { WarrantyK80Col3Component } from 'src/app/sales/components/print/warranty/warranty-k80-col3/warranty-k80-col3.component';\r\nimport { WarrantyK80Col4Component } from 'src/app/sales/components/print/warranty/warranty-k80-col4/warranty-k80-col4.component';\r\nimport { WarrantyA5Component } from 'src/app/sales/components/print/warranty/warranty-a5/warranty-a5.component';\r\nimport { WarrantyA4Component } from 'src/app/sales/components/print/warranty/warranty-a4/warranty-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { VhBillType15, VhBillType15Detail, VhBillType15DetailCombo, VhWarranty } from '../bill-type15-interface';\r\n\r\n@Component({\r\n  selector: 'bill-type15-edit',\r\n  templateUrl: './edit.component.html',\r\n  styleUrls: ['./edit.component.scss']\r\n})\r\nexport class EditComponent implements OnInit {\r\n  @Input() url = '';\r\n  display_promotion_selling_price: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').display_promotion_selling_price\r\n  warning_lot_expried: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').warning_lot_expried\r\n  invoice: VhBillType15 = this.router.getCurrentNavigation().extras.state.invoice\r\n  subTotal: number = 0;\r\n  taxValue: number = 0;\r\n  invoiceDetail: VhBillType15Detail[] = this.router.getCurrentNavigation().extras.state.invoiceDetail;\r\n  warrantyProd: VhWarranty[] = this.router.getCurrentNavigation().extras.state.warrantyProd;\r\n  warrantyNote: VhWarranty[] = this.router.getCurrentNavigation().extras.state.warrantyNote;\r\n  warrantyDel: VhWarranty[] = [];\r\n  id_receipt = this.router.getCurrentNavigation().extras.state.id_receipt\r\n  listTax: any[] = this.vhQuerySales.getlocalTaxs().filter(tax => tax.status);\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore\r\n  employee: any = {};\r\n  pickerTime = new Date();\r\n  customer: any;\r\n  printer: any;\r\n  discount_bill: number = 0;\r\n  percent_discount_bill: number = 0;\r\n  is_discount_bill: boolean = false;\r\n  list_earning_point_bills: any = [];\r\n  list_earning_points_products: any = [];\r\n  customer_group: any = [];\r\n  point_validity = 0;\r\n  default_price_type: number\r\n  showModalChangePriceType: boolean = false;\r\n  id_branch = this.vhQuerySales.getDefaultBranch()._id\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private languageService: LanguageService,\r\n    private vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    public vhAuth: VhAuth,\r\n    private cdRef: ChangeDetectorRef,\r\n    private fncService: FunctionService,\r\n    private nzModalService: NzModalService\r\n  ) {\r\n\r\n    // set nhân viên mặc định\r\n\r\n    this.invoice.id_technician = (this.vhAuth.getUser()._id)\r\n\r\n    this.invoice.id_employee = (this.vhAuth.getUser()._id)\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    this.invoice.id_branch = (this.vhQuerySales.getDefaultBranch()._id)\r\n    if (this.vhAuth.checkMyPermission('default_price_type_1')) this.default_price_type = 1;\r\n    else if (this.vhAuth.checkMyPermission('default_price_type_2')) this.default_price_type = 2;\r\n    this.invoice.price_type = (this.default_price_type)\r\n\r\n    if (!this.warrantyProd.length) this.addWarrantyProd()\r\n    if (!this.warrantyNote.length) this.addWarrantyNote()\r\n    // ------bắt sự kiện nhấn phím nóng-----\r\n    this.eventKeypress();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    if (!this.invoice.payment_coupons) this.invoice.payment_coupons = 0\r\n    if (!this.invoice.payment_points) this.invoice.payment_points = 0\r\n    let tax = this.listTax.find(item => item.default);\r\n    if (tax) {\r\n      this.id_tax = tax._id\r\n      this.invoice.tax = (tax['value']);\r\n    }\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_warranty')\r\n    this.printer = printer ? printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)] : { discount_hidden: false, note_hidden: false, fee_hidden: false, tax_hidden: false, debt_hidden: false };\r\n    this.checkPrinter = this.printer.enable;\r\n\r\n\r\n    //tính tổng tiền\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      let total_product_gift = 0;\r\n      let total_products = 0;\r\n      if (i.products_gift) {\r\n        total_product_gift = i.products_gift.filter(item => item.choose).reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n\r\n      }\r\n      else if (i.products) {\r\n\r\n        total_products = i.products.reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n      }\r\n      subTotal += total_products + total_product_gift + (i.price ? i.price * i.quantity : 0)\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.taxValue = this.invoice.total * (this.invoice.tax / 100)\r\n  }\r\n  event: any // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n  }\r\n  checkPrinter: boolean = false;\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113 || keycode === 114) event.preventDefault();\r\n      if (keycode === 115) this.searchProductList = !this.searchProductList;\r\n      else if (this.invoiceDetail.length > 0) {\r\n        switch (keycode) {\r\n          case 114: this.payInvoice(16)\r\n            break;\r\n          case 112: this.payInvoice(15, false)\r\n            break;\r\n          case 113: {\r\n            if (this.checkPrinter) this.payInvoice(15, true)\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  ngAfterViewInit() {\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      if (document.querySelector(\".discount-price\")) this.discount_price = this.vhAlgorithm.vhnumeral(\".discount-price\");\r\n      if (document.querySelector(\".invoice-fee\")) this.invoice_fee = this.vhAlgorithm.vhnumeral(\".invoice-fee\")\r\n    })\r\n    // get các loại chương trình tích điểm\r\n    Promise.all([\r\n      this.vhQuerySales.getEarningPointsBills(),\r\n      this.vhQuerySales.getEarningPointsProducts(),\r\n    ])\r\n      .then(([earning_point_bills, earning_points_products]: any) => {\r\n        // this.list_earning_point_bills = this.vhQuerySales.getLocalAppSettingNameStation('sales_program').enable_sales_method_all_branch ? earning_point_bills.filter( item => item.id_branch == this.vhQuerySales.getDefaultBranch()._id) : earning_point_bills;\r\n        // this.list_earning_points_products =  this.vhQuerySales.getLocalAppSettingNameStation('sales_program').enable_sales_method_all_branch ? earning_points_products.filter( item => item.id_branch == this.vhQuerySales.getDefaultBranch()._id) : earning_points_products;\r\n        this.list_earning_point_bills = earning_point_bills\r\n        this.list_earning_points_products = earning_points_products\r\n        this.customer_group = this.vhQuerySales.getlocalCustomerClasss()\r\n\r\n      })\r\n  }\r\n  deleteGoods(detail: VhBillType15Detail, index) {\r\n    this.vhComponent.alertConfirm(\"\", \"\", `${this.languageService.translate(\"Delete\")} ${detail.name}?`, \"OK\", this.languageService.translate(\"Cancel\"))\r\n      .then(() => {\r\n        if (!this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').show_product_mutil_line_warranty)\r\n          this.removeInvoiceDetail(detail.id_product)\r\n        else {\r\n          this.invoiceDetail.splice(index, 1)\r\n        }\r\n        if (this.is_discount_bill) {\r\n          setTimeout(() => {\r\n            this.getDiscountBillOfCustomer()\r\n          }, 200);\r\n        }\r\n        else {\r\n          setTimeout(() => {\r\n            this.invoice.discount = ((this.percent_discount_bill / 100) * this.subTotal)\r\n            if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n          }, 200);\r\n        }\r\n      }, () => { })\r\n  }\r\n  searchProductList: boolean = false;\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      if (data.manylot && !data.lot_number) this.openModalChooseLot(data)\r\n      else {\r\n        if (data.combos && data.combos.filter(e => e.lots && !e.id_lotproduct).length) {\r\n          this.tempDetail = data;\r\n          this.show_modal_select_lots_combo = true;\r\n        }\r\n        else {\r\n          let price = this.default_price_type == 1 ? data.price : data.price2 ? data.price2 : data.price // check 2 đk là kiểu giá bán và có giá bán sỉ hay ko\r\n          if (!this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').show_product_mutil_line_warranty)\r\n            this.addInvoiceDetail({\r\n              ...data, price: price,\r\n              earning_points_product: this.getTotalEarningPointProduct(data, null)\r\n            }, null)\r\n          else\r\n            this.addInvoiceDetailMutilLine({\r\n              ...data, price: price,\r\n              earning_points_product: this.getTotalEarningPointProduct(data, null)\r\n            }, null)\r\n        }\r\n      }\r\n    }\r\n    if (this.is_discount_bill) {\r\n      setTimeout(() => {\r\n        this.getDiscountBillOfCustomer()\r\n      }, 200);\r\n    }\r\n    else {\r\n      setTimeout(() => {\r\n        if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n        this.invoice.discount = ((this.percent_discount_bill / 100) * this.subTotal)\r\n      }, 200);\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n  goBack() {\r\n    this.vhComponent.alertConfirm(`${this.languageService.translate(\"Confirm\")}`, \"\", `${this.languageService.translate(\"Are you sure to cancel the sales order\")}?`, \"OK\", this.languageService.translate('Cancel'))\r\n      .then(() => { this.isExit = true; this.router.navigate([this.url], { state: this.dataRestore }) }, () => { })\r\n  }\r\n  checkQuantityProduct(product, event) {\r\n    if (!event) product.quantity = 1;\r\n    this.setSubTotal();\r\n    if (this.is_discount_bill) {\r\n      setTimeout(() => {\r\n        this.getDiscountBillOfCustomer()\r\n      }, 200);\r\n    }\r\n    else {\r\n      setTimeout(() => {\r\n        this.invoice.discount = ((this.percent_discount_bill / 100) * this.subTotal);\r\n\r\n\r\n        if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n      }, 200);\r\n    }\r\n  }\r\n  changeUnit(ev, item) {\r\n    if (this.default_price_type == 1) {\r\n      let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n      if (unit) {\r\n        item.unit = unit.unit\r\n        item.price = parseFloat(unit.price)\r\n        item.ratio = parseFloat(unit.ratio)\r\n        item.price_origin = parseFloat(unit.price)\r\n      }\r\n    }\r\n    else {\r\n      let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n      if (unit) {\r\n        item.unit = unit.unit\r\n        item.price = parseFloat(unit.price2)\r\n        item.ratio = parseFloat(unit.ratio)\r\n        item.price_origin = parseFloat(unit.price2)\r\n      }\r\n    }\r\n    this.setSubTotal()\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhBillType15Detail;\r\n  openEditUnitPrice(detail: VhBillType15Detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      this.setSubTotal();\r\n      this.isVisibleEditUnitPrice = false;\r\n      if (this.is_discount_bill) {\r\n        setTimeout(() => {\r\n          this.getDiscountBillOfCustomer()\r\n        }, 200);\r\n      }\r\n      else {\r\n        setTimeout(() => {\r\n          this.invoice.discount = ((this.percent_discount_bill / 100) * this.subTotal)\r\n          if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n        }, 200);\r\n      }\r\n    } else { this.vhComponent.showToast(2000, this.languageService.translate(\"Invalid data, please check again\"), \"alert-toast\") }\r\n  }\r\n  handleCancelEditUnit() { this.isVisibleEditUnitPrice = false }\r\n\r\n  /**\r\n  *  sự kiện nhận thay đổi giá từ output component app-change-price-type\r\n  * @event : boolean | null\r\n  */\r\n  changePriceType(event) {\r\n    this.showModalChangePriceType = false;\r\n    if (event != null) { // nếu có thay đổi kiểu giá bán thì cập nhật lại giá các sản phẩm thành giá bán sỉ\r\n      this.default_price_type = event;\r\n      if (this.invoiceDetail.length) { // nếu có  length mơi update\r\n        let bill_details = this.invoiceDetail\r\n        for (let i in bill_details) {\r\n          let price_update = 0;\r\n          let product = this.vhQuerySales.getlocalDetailProduct(bill_details[i].id_subproduct ? bill_details[i].id_subproduct : bill_details[i].id_product);\r\n          product = { ...product, ...this.vhQuerySales.getUnit_byRatio(product.units, bill_details[i].ratio) }\r\n          if (event == 1) {\r\n            price_update = product.price\r\n          }\r\n          else {\r\n            price_update = product.price2 ? product.price2 : product.price\r\n          }\r\n          bill_details[i].price = price_update;\r\n          bill_details[i].price_origin = price_update;\r\n        }\r\n        this.setSubTotal();\r\n        if (this.is_discount_bill) {\r\n          setTimeout(() => {\r\n            this.getDiscountBillOfCustomer()\r\n          }, 200);\r\n        }\r\n        else {\r\n          setTimeout(() => {\r\n            if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n\r\n          }, 200);\r\n        }\r\n      }\r\n      this.invoice.price_type = (event)\r\n    }\r\n  }\r\n  // -------set employee-------\r\n  closeAndReceiveTechnician(event) {\r\n    if (event) {\r\n      this.invoice.id_technician = (event);\r\n    }\r\n  }\r\n  closeAndReceiveReceptionist(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n\r\n    }\r\n  }\r\n  // ----set customer-----\r\n  radioValue: 1 | 2 | 3 = 1;\r\n  closeAndReceiveCustomer(event) {\r\n    if (event) {\r\n      this.invoice.id_customer = (event);\r\n      this.getClassAndProgram(event);\r\n\r\n    }\r\n  }\r\n  changeCustomerType(event) {\r\n    if (this.radioValue == 1) this.invoice.id_customer = (\"id_retail\")\r\n    if (event == 2 && this.invoice.retail_name) {\r\n      this.nzModalService.confirm({\r\n        nzTitle: `${this.languageService.translate('Retail customer information will be lost')}?`,\r\n        nzCancelText: this.languageService.translate(\"Cancel\"),\r\n        nzOkText: \"Ok\",\r\n        nzOnOk: () => { this.clearRetailCustomer() },\r\n        nzOnCancel: () => { this.radioValue = 1 },\r\n      }\r\n      )\r\n    }\r\n    this.getClassAndProgram(this.invoice.id_customer)\r\n  }\r\n\r\n\r\n\r\n\r\n  customer_class: any;\r\n  program_bill: any;\r\n  program_product: any;\r\n\r\n  /**\r\n   * hàm này để gán chương trình tich diem hóa đơn và sản phẩm của khách hàng\r\n   */\r\n  getClassAndProgram(id_customer) {\r\n    this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n    this.customer_class = this.customer_group.find(item => item._id == this.vhQuerySales.getlocalCustomer(id_customer).id_customer_class);\r\n    if (this.customer_class && this.customer_class.id_earning_points_bill) {\r\n      this.program_bill = this.list_earning_point_bills.find(item => item._id == this.customer_class.id_earning_points_bill);\r\n    }\r\n    if (this.customer_class && this.customer_class.id_earning_points_product) {\r\n      this.program_product = this.list_earning_points_products.find(item => item._id == this.customer_class.id_earning_points_product);\r\n    }\r\n    if (!this.customer_class) {\r\n      this.program_bill = null;\r\n      this.program_product = null;\r\n    }\r\n    this.point_validity = this.vhQuerySales.getlocalCustomerPoints(this.invoice.id_customer)\r\n    this.getDiscountMethodCustomer(this.invoice.id_customer)\r\n\r\n  }\r\n\r\n  getDiscountMethodCustomer(id_customer) {\r\n    let check = this.vhQuerySales.getlocalDiscount_bill(this.customer_class?.id_discount_bill)\r\n    if (check) {\r\n      this.is_discount_bill = true\r\n      this.getDiscountBillOfCustomer()\r\n      this.vhComponent.alertMessageDesktop('success', this.languageService.translate(\"This customer applies the discount calculation formula \") + check.name, 5000)\r\n    }\r\n    else {\r\n      this.is_discount_bill = false\r\n      this.invoice.discount_bill = (0)\r\n    }\r\n\r\n  }\r\n  getDiscountBillOfCustomer() {\r\n    this.discount_bill = this.vhQuerySales.getDiscount_bill_byCustomer(this.subTotal, this.invoice.id_customer) ? this.vhQuerySales.getDiscount_bill_byCustomer(this.subTotal, this.invoice.id_customer).discount : 0;\r\n    this.invoice.discount_bill = (this.discount_bill)\r\n    this.setTotal()\r\n  }\r\n\r\n  clearRetailCustomer() {\r\n    this.invoice.retail_address = ('')\r\n    this.invoice.retail_name = ('')\r\n    this.invoice.retail_phone = ('')\r\n  }\r\n  closeAndGetValuePayment(event) {\r\n    if (event[0] == 1 || event[0] == 2) {\r\n      this.setPaymentType(event[0])\r\n    }\r\n    else if (event[0] == 3) {\r\n      this.setPaymentType(event[0], event[1]);\r\n    }\r\n  }\r\n  setPaymentType(type: 1 | 2 | 3, id_wallet?) {\r\n    this.invoice.payment_type = (type)\r\n    switch (type) {\r\n      case 1: {\r\n        this.invoice.id_wallet = ('id_cash');\r\n        this.invoice.payment = (this.invoice.payment ? this.invoice.payment : this.invoice.total + this.taxValue);\r\n\r\n        break;\r\n      }\r\n      case 2: {\r\n        this.invoice.payment = (0); this.invoice.id_wallet = (null);\r\n\r\n        break;\r\n      }\r\n      case 3: {\r\n        if (id_wallet) {\r\n          this.invoice.id_wallet = (id_wallet)\r\n          this.invoice.payment = (this.invoice.payment ? this.invoice.payment : this.invoice.total + this.taxValue);\r\n\r\n          break;\r\n        }\r\n      }\r\n    };\r\n  }\r\n  setPickerTime(event) {\r\n    if (new Date(event).getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 5000)\r\n      this.pickerTime = new Date(this.invoice.date)\r\n      this.invoice.date = (new Date(this.pickerTime));\r\n    }\r\n    else this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        this.invoice.date = (event);\r\n      }\r\n      else {\r\n        this.pickerTime = new Date(validitydate)\r\n        this.invoice.date = (new Date(this.pickerTime));\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n    if (this.isGotPromotion) this.getPromotions()\r\n  }\r\n  // -------change tax------\r\n  id_tax: string;\r\n  changeTax(event) {\r\n    let tax = this.listTax.find(item => item._id == event);\r\n    this.invoice.tax = (tax.value);\r\n    this.setTaxValue();\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n  discount_price: any;\r\n  editDiscount() {\r\n    if (this.discount_price.getRawValue() && this.discount_price.getRawValue() >= 0 && this.discount_price.getRawValue() <= this.subTotal) {\r\n      this.invoice.discount = (parseFloat(this.discount_price.getRawValue()));\r\n      this.percent_discount_bill = this.subTotal ? (this.invoice.discount / this.subTotal) * 100 : 0\r\n    } else {\r\n      document.getElementById(\"discount-price\")['value'] = this.invoice.discount;\r\n      this.discount_price = this.vhAlgorithm.vhnumeral('.discount-price');\r\n    }\r\n    this.setTotal()\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n\r\n  editPercentDiscount(value) {\r\n    if (parseFloat(value) > 100)\r\n      document.getElementById(\"percent-discount-price\")['value'] = 0\r\n    else this.percent_discount_bill = value;\r\n    this.invoice.discount = this.subTotal * (this.percent_discount_bill / 100)\r\n    this.setTotal()\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n\r\n  showModalOtherDiscount = false\r\n  openModalOtherDiscount() {\r\n    this.showModalOtherDiscount = true;\r\n  }\r\n\r\n  handleOkOtherDiscount() {\r\n    if (this.invoice.payment < this.invoice.payment_points + this.invoice.payment_coupons) this.invoice.payment = (0);\r\n    this.showModalOtherDiscount = false;\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n  value_discount_point: number = 0;\r\n  calculatePoint2Money(value) {\r\n    if (value <= this.point_validity) {\r\n      this.value_discount_point = value;\r\n\r\n      this.invoice.payment_points = ((value / this.customer_class.payment.points) * this.customer_class.payment.money)\r\n      this.invoice.use_points = (value)\r\n    }\r\n    else {\r\n      this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Vượt quá giới hạn điểm cho phép\"))\r\n    }\r\n  }\r\n  product_codes: any = [];\r\n  getDiscountOfCoupon(code) {\r\n    if (code)\r\n      this.vhQuerySales.getCoupon_Code_Name_Release_byCode(code)\r\n        .then((product_codes: any) => {\r\n          if (product_codes && !this.product_codes.find(item => item.code == code)) {\r\n            switch (product_codes.status) {\r\n              case 1: {\r\n                this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Phiếu này chưa được quy đổi\"))\r\n                break;\r\n              }\r\n              case 3: {\r\n                if (new Date() < new Date(product_codes.date_expire)) {\r\n                  this.product_codes.push(product_codes)\r\n                  this.invoice.payment_coupons = (product_codes.value)\r\n                  this.vhComponent.alertMessageDesktop(\"success\", this.languageService.translate(\"Sử dụng coupon thành công\"))\r\n                }\r\n                else {\r\n                  this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Phiếu này đã hết hạn sử dụng\"), 8000)\r\n                }\r\n                break;\r\n              }\r\n              case 4: {\r\n                this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Phiếu này đã được sử dụng\"), 8000)\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          if (!product_codes) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Không tìm thấy phiếu này\"), 8000)\r\n          setTimeout(() => {\r\n            document.getElementById('coupon').getElementsByTagName(\"input\")[0].value = '';\r\n          }, 200);\r\n        })\r\n\r\n  }\r\n\r\n  onCloseProductCode(item) {\r\n    this.product_codes.splice(this.product_codes.findIndex(i => i._id == item._id), 1);\r\n    this.invoice.payment_coupons = (-item.value)\r\n  }\r\n  invoice_fee: any;\r\n  editFee() {\r\n    if (this.invoice_fee.getRawValue() && this.invoice_fee.getRawValue() >= 0) {\r\n      this.invoice.fee = (parseFloat(this.invoice_fee.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"invoice-fee\")['value'] = this.invoice.fee;\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral('.invoice-fee');\r\n    }\r\n    this.setTotal()\r\n    if (!this.gotten_gift_type7) this.handlePromotionType7(this.bill_details_pmtype_7)\r\n  }\r\n\r\n  // -------modal edit pay---------\r\n  edit_pay: boolean = false;\r\n  edit_paytotal: any;\r\n  showModalEditTotalPay() {\r\n    if (this.invoice.payment_type != 2 && this.vhQuerySales.getlocalCustomer(this.invoice.id_customer).debt_enable) {\r\n      this.vhAlgorithm.waitingStack().then(() => {\r\n        this.edit_paytotal = this.vhAlgorithm.vhnumeral(\".edit-pay\");\r\n      })\r\n      this.edit_pay = true;\r\n    }\r\n    else if (!this.vhQuerySales.getlocalCustomer(this.invoice.id_customer).debt_enable) {\r\n      this.vhComponent.showToast(5000,\r\n        this.languageService.translate(\"This customer is not allowed to debt\"), \"alert-toast\"\r\n      )\r\n    }\r\n  }\r\n  getTotalATax(): number {\r\n    return this.invoice.total + this.taxValue\r\n  }\r\n  handleEditPay() {\r\n    if (this.edit_paytotal.getRawValue() >= 0 && this.edit_paytotal.getRawValue() <= this.getTotalATax()) {\r\n      this.invoice.payment = (parseFloat(this.edit_paytotal.getRawValue()))\r\n    }\r\n    this.edit_pay = false;\r\n  }\r\n  handleCancelEditPay() {\r\n    this.edit_pay = false;\r\n  }\r\n  payInvoice(bill_type: 15 | 16 | 17 = 16, print?) {\r\n\r\n\r\n    if (this.vhAuth.checkMyPermission(\"warranty_enable_payment\") || bill_type == 16) {\r\n      if (bill_type == 16) {\r\n        this.invoice.payment_coupons = 0;\r\n        this.invoice.payment_points = (0);\r\n        this.invoice.use_points = (0);\r\n      }\r\n      if (this.getTotalEarningPoint() && bill_type != 16) {\r\n        let earned_points = this.getTotalEarningPoint() - this.value_discount_point\r\n        this.vhQuerySales.updateCustomer_byEarnedPoints(this.invoice.id_customer, earned_points)\r\n        this.invoice.earning_points_bill = (this.getTotalEarningPoint())\r\n      }\r\n      if (this.warrantyProd.length == 1 && !this.warrantyProd[0].content) {\r\n        this.vhComponent.showToast(2000, this.languageService.translate(\"Please add a product warranty\"), \"alert-toast\")\r\n      } else {\r\n        this.vhComponent.alertConfirm(\r\n          bill_type == 16 ? `${this.languageService.translate(\"Save\")}?` : `${this.languageService.translate(\"Pay\")}?`,\r\n          \"\", \"\", \"OK\", this.languageService.translate(\"Cancel\")\r\n        ).then(() => {\r\n          this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n            this.createOrUpdate(bill_type).then(bill => {\r\n              this.vhComponent.hideLoading(0).then(() => {\r\n                if (bill == \"create\")\r\n                  this.vhComponent.showToast(2000,\r\n                    `${this.languageService.translate(\"Warranty invoice\")} ${this.invoice.bill_code} ${this.languageService.translate(\"has been created successfully\")}`, \"success-toast\"\r\n                  )\r\n                else\r\n                  this.vhComponent.showToast(2000,\r\n                    `${this.languageService.translate(\"Warranty invoice\")} ${this.invoice.bill_code} ${this.languageService.translate(\"has been updated successfully\")}`, \"success-toast\"\r\n                  )\r\n\r\n                if (print) this.handlePrint()\r\n                else this.handle()\r\n              })\r\n            })\r\n          })\r\n        }, () => { })\r\n      }\r\n    }\r\n    else this.vhComponent.showToast(1500, this.languageService.translate('You do not have this rights'), \"alert-toast\")\r\n  }\r\n  createOrUpdate(bill_type: 15 | 16 | 17): Promise<'create' | 'update'> {\r\n\r\n    return new Promise<any>(resolve => {\r\n      this.vhQuerySales.updateBill_Billdetail(this.invoice._id || this.id_receipt, this.getCreateUpdateInvoice(bill_type), this.getCreateUpdateInvoiceDetail()).then((res) => {\r\n        Promise.all([\r\n          this.createWarranty(this.getCreateWarranty()),\r\n          this.updateWarranty(this.getUpdateWarranty()),\r\n          this.delWarranty(this.getDelWarranty())\r\n        ]).then(() => resolve('update')).catch(err => {\r\n\r\n          this.vhComponent.hideLoading(0)\r\n        })\r\n      }).catch(err => {\r\n\r\n        this.vhComponent.hideLoading(0)\r\n      })\r\n    })\r\n\r\n  }\r\n  ///////////////////////////////////////////XỬ LÝ WARRANTY///////////////////////////////////////\r\n  createWarranty(array) {\r\n    const promiseAddWarranty = []\r\n    for (let i = 0; i < array.length; i++) {\r\n      promiseAddWarranty.push(this.vhQuerySales.addWarranty(array[i]))\r\n    }\r\n    return Promise.all(promiseAddWarranty)\r\n  }\r\n  updateWarranty(array) {\r\n    const promiseUpdateWarranty = []\r\n    for (let i = 0; i < array.length; i++) {\r\n      promiseUpdateWarranty.push(this.vhQuerySales.updateWarranty(array[i]._id, array[i]))\r\n    }\r\n    return Promise.all(promiseUpdateWarranty)\r\n  }\r\n  delWarranty(array) {\r\n    const promiseDelWarranty = []\r\n    for (let i = 0; i < array.length; i++) {\r\n      promiseDelWarranty.push(this.vhQuerySales.deleteWarranty(array[i]._id))\r\n    }\r\n    return Promise.all(promiseDelWarranty)\r\n  }\r\n  ///////////////////////////////////////////XỬ LÝ WARRANTY///////////////////////////////////////\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_warranty')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return WarrantyK57Col3Component\r\n      case 'print_size_k80_3c': return WarrantyK80Col3Component\r\n      case 'print_size_k80_4c': return WarrantyK80Col4Component\r\n      case 'print_size_a5': return WarrantyA5Component\r\n      case 'print_size_a4': return WarrantyA4Component\r\n      default: return WarrantyA4Component\r\n    }\r\n  }\r\n\r\n  handle() {\r\n    this.isExit = true;\r\n    this.router.navigate([this.url], { state: this.dataRestore })\r\n  }\r\n  handlePrint() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice: this.invoice, invoice_detail: this.invoiceDetail, warrantyProd: this.warrantyProd, warrantyNote: this.warrantyNote }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.handle())\r\n        })\r\n    }, (err) => this.vhComponent.alertMessage(this.languageService.translate(\"Function\"), \"\", this.languageService.translate(\"Please turn on the printer function\"), \"OK\")\r\n      .then(() => this.handle()))\r\n  }\r\n\r\n  //--------------visible drawer info customer-----------\r\n  visibleInfoCustomer: boolean = false;\r\n  openInfoCustomer() {\r\n    if (this.invoice.id_customer != 'id_retail') {\r\n      this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n      this.visibleInfoCustomer = true;\r\n    }\r\n  }\r\n  closeInfoCustomer(event) {\r\n    this.visibleInfoCustomer = false;\r\n  }\r\n\r\n  // // ------thoát trang-----\r\n  isExit: boolean = false;\r\n  // checkDeactivate(currentRoute: ActivatedRouteSnapshot, currentState: RouterStateSnapshot, nextState?: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n  //   return nextState.url == '/login' ? true : (this.isExit ? this.isExit : this.vhComponent.alertConfirm(this.languageService.translate(\"Confirm\"), \"\", this.languageService.translate(\"Are you sure to cancel the sales order\"), \"OK\", (this.languageService.translate(\"Cancel\"))).then(() => { return true }).catch(() => { return false }))\r\n  // }\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\".sales-best-selling\") && document.querySelector(\".waranty-invoice-quote-header\") && document.querySelector(\"#waranty-invoice-quote-invoiceDetail\")) {\r\n      document.getElementById(\"waranty-invoice-quote-invoiceDetail\").style.height = document.querySelector(\".sales-best-selling\").clientHeight\r\n        - document.querySelector(\".waranty-invoice-quote-header\").clientHeight - 10 + \"px\";\r\n    }\r\n    if (document.getElementById(\"waranty-invoice-prodAndnote-invoiceDetail\") && document.querySelector(\".sales-cart\") && document.querySelector(\".sales-cart-header\")) {\r\n      document.getElementById(\"waranty-invoice-prodAndnote-invoiceDetail\").style.height = document.querySelector(\".sales-cart\").clientHeight - document.querySelector(\".sales-cart-header\").clientHeight - 10 + 'px';\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n  // -------------xử lý warranty-----------\r\n  searchProductListWarranty: boolean = false;\r\n  openSearchProductListWarranty() {\r\n    this.searchProductListWarranty = !this.searchProductListWarranty;\r\n  }\r\n  closeSearchProductListWarranty(event) {\r\n    if (event) {\r\n      this.addWarrantyProd();\r\n      this.warrantyProd[0].content = event.name;\r\n    }\r\n    this.searchProductListWarranty = false;\r\n  }\r\n  editWarrantyProd(index, item) {\r\n    if (this.warrantyProd.length > 1 && item.content == '') this.removeWarrantyProd(index, item);\r\n  }\r\n  editWarrantyNote(index, item) {\r\n    if (this.warrantyNote.length > 1 && item.content == '') this.removeWarrantyNote(index, item);\r\n  }\r\n  /**add customer */\r\n  showDrawerAddCusomer: boolean = false;\r\n  showDrawerAddRetail: boolean = false\r\n  openDrawerAddCustomerOrRetail() {\r\n    if (this.radioValue == 1) this.showDrawerAddRetail = true\r\n    else this.showDrawerAddCusomer = true\r\n  }\r\n  closeAddCustomer(result) {\r\n    if (this.radioValue == 1) {\r\n      if (result) {\r\n        this.invoice.retail_name = (result.retail_name)\r\n        this.invoice.retail_phone = (result.retail_phone)\r\n        this.invoice.retail_address = (result.retail_address)\r\n      }\r\n      this.showDrawerAddRetail = false\r\n    }\r\n    else {\r\n      this.showDrawerAddCusomer = false\r\n      if (result) this.invoice.id_customer = (result)\r\n    }\r\n  }\r\n\r\n\r\n  isGotPromotion = false;\r\n  showProductGift = false;\r\n  product_gift_type7: any = [];\r\n  showProductGiftType7 = false;\r\n  gotten_gift_type7 = false;\r\n  bill_details_pmtype_7: any = [];\r\n  handleAddGiftType7() {\r\n    this.showProductGiftType7 = false;\r\n    if (!this.gotten_gift_type7)\r\n      for (let i in this.product_gift_type7) {\r\n        // this.product_gift_type7[i].products_gift = this.product_gift_type7[i].products_gift.filter(item => item.choose).map(e => { return { ...e } })\r\n        if (this.product_gift_type7[i].products_gift.length) this.addBill_detail_promotion(this.product_gift_type7[i])\r\n      }\r\n\r\n    this.gotten_gift_type7 = true;\r\n  }\r\n  /**\r\n  * hàm lấy quà\r\n  */\r\n  getPromotions() {\r\n    this.gotten_gift_type7 = false;\r\n    this.vhComponent.showLoading('')\r\n      .then(() => {\r\n        this.vhQuerySales.changeBillDetails_withPromotions(this.invoiceDetail, this.invoice.date).then((bill_details_display: any) => {\r\n\r\n          this.handleChooseLotForPromotion(bill_details_display.bill_details_pmtype_0to6)\r\n          this.handleChooseLotForPromotion(bill_details_display.bill_details_pmtype_7)\r\n\r\n          this.bill_details_pmtype_7 = this.vhAlgorithm.sortNumberbyASC([...bill_details_display.bill_details_pmtype_7], 'total_bill_value')\r\n          this.isGotPromotion = true;\r\n          this.vhComponent.hideLoading(0)\r\n          this.invoiceDetail = [...bill_details_display.bill_details_pmtype_0to6,]\r\n          // if (bill_details_display.filter(item => item.products_gift).length) this.showProductGift = true;\r\n          this.getEarningpointPromotion();\r\n\r\n          // this.product_gift_type7 = [...bill_details_display.bill_details_pmtype_7]\r\n          this.handlePromotionType7(this.bill_details_pmtype_7)\r\n          this.setSubTotal()\r\n\r\n        }, error => {\r\n          this.vhComponent.hideLoading(0).then(() => {\r\n            this.vhComponent.showToast(5000, error, \"alert-toast\")\r\n          })\r\n        })\r\n      })\r\n  }\r\n\r\n  handlePromotionType7(bill_details_pmtype_7) {\r\n    if (bill_details_pmtype_7.length)\r\n      if (bill_details_pmtype_7.findLastIndex(e => e.total_bill_value <= this.getTotalATax()) != -1)\r\n        this.product_gift_type7 = [bill_details_pmtype_7[bill_details_pmtype_7.findLastIndex(e => e.total_bill_value <= this.getTotalATax())]]\r\n      else this.product_gift_type7 = []\r\n    else this.product_gift_type7 = []\r\n    // \r\n\r\n  }\r\n\r\n  handleChooseLotForPromotion(promotion) {\r\n    for (let i of promotion) {\r\n      if (i.products_gift) {\r\n        for (let product of i.products_gift) {\r\n          if (product.lots && product.lots.length) {\r\n            let min_date_exp = this.vhAlgorithm.sortDatebyASC(product.lots, 'date_exp')\r\n            product['id_lotproduct'] = min_date_exp[0]._id;\r\n            product['lot_number'] = min_date_exp[0].lot_number;\r\n          }\r\n          if (product.combos) {\r\n            product.combos.forEach(element => {\r\n              if (element.lots && element.lots.length) {\r\n                let min_date_exp = this.vhAlgorithm.sortDatebyASC(element.lots, 'date_exp')\r\n                element['id_lotproduct'] = min_date_exp[0]._id;\r\n                element['lot_number'] = min_date_exp[0].lot_number;\r\n              }\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * hàm này để get SubTotal mới của mảng đã lấy quà\r\n   * đồng thời gán điểm tích lũy sản phẩm mới của các sản phẩm trong khuyến mãi nếu có\r\n   */\r\n  getEarningpointPromotion() {\r\n    for (let i of this.invoiceDetail) {\r\n      if (i.products_gift) {\r\n        for (let product of i.products_gift) {\r\n          product.earning_points_product = this.getTotalEarningPointProduct(i, true);\r\n        }\r\n      }\r\n      if (i.products) {\r\n        for (let product of i.products) {\r\n          product.earning_points_product = this.getTotalEarningPointProduct(i, true)\r\n        }\r\n      }\r\n      if (!i.id_promotion) i.earning_points_product = this.getTotalEarningPointProduct(i, null)\r\n    }\r\n    this.setSubTotal();\r\n  }\r\n\r\n  /**\r\n   * hàm này để kiểm tra disable sản phẩm tặng hay ko\r\n   * @param data phần tử trong mảng đã lấy quà\r\n   * @returns\r\n   */\r\n  checkDisableChooseProductGift(data) {\r\n    if (data.products_gift.filter(item => item.choose).length == data.promotions_maximum) return true;\r\n    else return false\r\n  }\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit\r\n  }\r\n\r\n  show_modal_select_lots = false;\r\n  list_search_lot = [];\r\n\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id);\r\n    return lot.lot_number\r\n  }\r\n  searchLot(value) {\r\n    this.tempDetail.lots = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.list_search_lot, ['lot_number'])\r\n  }\r\n  openModalChooseLot(data) {\r\n    this.tempDetail = data\r\n    this.list_search_lot = this.tempDetail.lots\r\n    if (!this.list_search_lot.length) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Sản phẩm này không có lô khả dụng để bán!\"))\r\n    else this.show_modal_select_lots = true;\r\n  }\r\n\r\n  changeLot(e) {\r\n    this.tempDetail.lot_number = this.tempDetail.lots.find(item => item._id == e).lot_number\r\n  }\r\n\r\n  handleChooseLot() {\r\n    if (this.warning_lot_expried) {\r\n      let lot_select = this.list_search_lot.find(e => e._id == this.tempDetail.id_lotproduct)\r\n      if (new Date().getTime() >= new Date(lot_select.date_exp).getTime()) {\r\n        this.nzModalService.confirm({\r\n          nzTitle: this.languageService.translate(\"Lô này đã hết hạn! Tiếp tục bán sản phẩm này?\"),\r\n          nzOnOk: () => {\r\n            this.show_modal_select_lots = false;\r\n            this.tempDetail.lots = this.list_search_lot;\r\n            if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n          },\r\n          nzOnCancel: () => {\r\n            // this.show_modal_select_lots = false;\r\n            // this.tempDetail.lots = this.list_search_lot;\r\n          }\r\n\r\n        })\r\n      }\r\n      else {\r\n        this.show_modal_select_lots = false;\r\n        this.tempDetail.lots = this.list_search_lot;\r\n        if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n      }\r\n    }\r\n    else {\r\n      this.show_modal_select_lots = false;\r\n      this.tempDetail.lots = this.list_search_lot;\r\n      if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n    }\r\n  }\r\n\r\n  handleCancelChooseLot() {\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot\r\n  }\r\n\r\n\r\n\r\n\r\n  /**\r\n   * hàm get điểm tích lũy theo hóa đơn\r\n   * 1. get hạng khách hàng\r\n   * 2. từ hạng khách hàng get tích điểm theo bill\r\n   * 3. check các điều kiện của chương trình\r\n   * a check sản phẩm khuyến mãi include_promotion_product\r\n   * b  check giảm giá/ chiết khấu include_discount\r\n   * c check thanh toán = điểm thưởng include_paid_points\r\n   * d check phí  include_fee\r\n   * e check thuế include_tax\r\n   * @returns 0 | number\r\n   */\r\n  getEarningBill() {\r\n    if (this.program_bill && this.subTotal > this.program_bill.bill_total_minimum) {\r\n      let subTotal = this.subTotal;\r\n      if (!this.program_bill.include_promotion_product) { // ko tích điểm sp có km =>  tính lại subTotal\r\n        subTotal = this.getSubTotalNotPromotion()\r\n        if (this.program_bill.include_discount) subTotal = subTotal - this.invoice.discount - this.invoice.discount_bill\r\n\r\n        if (this.program_bill.include_paid_points && this.invoice.payment_points) subTotal = subTotal - this.invoice.payment_points\r\n        if (this.program_bill.include_fee) subTotal += this.invoice.fee;\r\n\r\n        if (this.program_bill.include_tax) subTotal += subTotal * (this.invoice.tax / 100)\r\n        return ((subTotal - subTotal % this.program_bill.exchange.money) / this.program_bill.exchange.money) * this.program_bill.exchange.points\r\n      }\r\n      else {\r\n        subTotal = this.subTotal;\r\n        if (this.program_bill.include_discount) subTotal = subTotal - this.invoice.discount - this.invoice.discount_bill\r\n\r\n        if (this.program_bill.include_paid_points && this.invoice.payment_points) subTotal = subTotal - this.invoice.payment_points\r\n        if (this.program_bill.include_fee) subTotal += this.invoice.fee;\r\n\r\n        if (this.program_bill.include_tax) subTotal += subTotal * (this.invoice.tax / 100)\r\n        return ((subTotal - subTotal % this.program_bill.exchange.money) / this.program_bill.exchange.money) * this.program_bill.exchange.points\r\n      }\r\n    }\r\n    else return 0\r\n  }\r\n\r\n\r\n  /**\r\n  * hàm này trả về tổng tiền của sản phẩm ko có chương trình khuyến mãi\r\n  * return : number\r\n  */\r\n  getSubTotalNotPromotion() {\r\n    return this.invoiceDetail.filter(item => item.price_origin == item.price).reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n  }\r\n\r\n  /**\r\n   * hàm này trả về tổng tiền của sản phẩm  ko có chương trình khuyến mãi thuộc chương trình tích điểm sản phẩm\r\n   * return : number\r\n   */\r\n  getSubTotalNotPromotionOFProduct(products_of_program_earnig_product) {\r\n    return this.invoiceDetail\r\n      .filter(item => item.price_origin == item.price && products_of_program_earnig_product.find(i => i == item.id_product))\r\n      .reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n  }\r\n\r\n\r\n  /**\r\n   * hàm này trả về tổng điểm được tích của tất cả sản phẩm\r\n   * @returns 0 | number\r\n   */\r\n  getEarningProduct(products) {\r\n    if (this.program_product) {\r\n      let subTotal = 0;\r\n      if (!this.program_product.include_promotion_product) { // tích điểm sp có km =>  tính lại subTotal\r\n        subTotal = this.getSubTotalNotPromotionOFProduct(this.program_product.products)\r\n        return ((subTotal - subTotal % this.program_product.exchange.money) / this.program_product.exchange.money) * this.program_product.exchange.points\r\n      }\r\n      else {\r\n        subTotal = products.filter(item => item.price_origin == item.price && this.program_product.products.find(i => i == item.id_product)).reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n        return ((subTotal - subTotal % this.program_product.exchange.money) / this.program_product.exchange.money) * this.program_product.exchange.points\r\n      }\r\n    }\r\n    else return 0\r\n  }\r\n\r\n\r\n\r\n\r\n  earning_point: number = 0;\r\n  /**\r\n   * hàm này trả về tổng điểm được tích của đơn và sản phẩm\r\n   * @returns 0 | number\r\n   */\r\n  getTotalEarningPoint() {\r\n    this.earning_point = this.getEarningProduct(this.invoiceDetail) + this.getEarningBill();\r\n    return this.earning_point\r\n  }\r\n\r\n  /**\r\n   * hàm này trả về điểm được tích của sản phẩm được thêm\r\n   * @param product sản phẩm được thêm\r\n   * @returns 0 | number\r\n   */\r\n  getTotalEarningPointProduct(product, promotion) {\r\n    if (this.program_product) {\r\n      let subTotal = 0;\r\n      if (!this.program_product.include_promotion_product && promotion) { // tích điểm sp có km =>  tính lại subTotal\r\n        subTotal = this.program_product.products.find(i => i == product._id) ? product.price : 0\r\n        return ((subTotal - subTotal % this.program_product.exchange.money) / this.program_product.exchange.money) * this.program_product.exchange.points\r\n      }\r\n      else {\r\n        subTotal = this.program_product.products.find(i => i == product._id) ? product.price : 0\r\n        return ((subTotal - subTotal % this.program_product.exchange.money) / this.program_product.exchange.money) * this.program_product.exchange.points\r\n      }\r\n    }\r\n    else return 0\r\n  }\r\n  show_modal_select_lots_combo = false\r\n  handleChooseLotCombo() {\r\n    if (this.tempDetail.combos.filter(item => item.lots && !item.id_lotproduct).length)\r\n      this.vhComponent.alertMessageDesktop(\"warning\", this.languageService.translate(\"Vui lòng chọn lô cho sản phẩm thuộc combo này\"))\r\n    else {\r\n      this.show_modal_select_lots_combo = false;\r\n      this.closeSearchProductList(this.tempDetail)\r\n    }\r\n  }\r\n\r\n\r\n  /******************************Xu ly warranty note *******************************/\r\n  /** Thêm sản phẩm bảo hành */\r\n  public addWarrantyProd() {\r\n    const add = () => {\r\n      let item: VhWarranty = { content: '', quantity: 1, type: 1, id_bill: this.invoice._id }\r\n      if (this.invoice._id) item['id_bill'] = this.invoice._id\r\n      this.warrantyProd.unshift(item)\r\n    }\r\n    if (this.warrantyProd.length) {\r\n      if (this.warrantyProd[0].content) add()\r\n    } else add()\r\n  }\r\n  /** xóa sản phẩm bảo hành */\r\n  public removeWarrantyProd(index: number, item: VhWarranty) {\r\n    if (index == 0) {\r\n      if (this.warrantyProd.length > 1) this.warrantyProd.splice(index, 1)\r\n      else if (this.warrantyProd[index].content.length) this.warrantyProd[0].content = ''\r\n    } else this.warrantyProd.splice(index, 1)\r\n\r\n    if (item._id) this.warrantyDel.push(item)\r\n  }\r\n  /** Thêm ghi chú bảo hành */\r\n  public addWarrantyNote() {\r\n    const add = () => {\r\n      let item: VhWarranty = { content: '', type: 2, id_bill: this.invoice._id }\r\n      if (this.invoice._id) item['id_bill'] = this.invoice._id\r\n      this.warrantyNote.unshift(item)\r\n    }\r\n    if (this.warrantyNote.length) {\r\n      if (this.warrantyNote[0].content) add()\r\n    } else add()\r\n  }\r\n  /** Xóa ghi chú bảo hành */\r\n  public removeWarrantyNote(index: number, item: VhWarranty) {\r\n    if (index == 0) {\r\n      if (this.warrantyNote.length > 1) this.warrantyNote.splice(index, 1)\r\n      else if (this.warrantyNote[index].content.length) this.warrantyNote[0].content = ''\r\n    } else this.warrantyNote.splice(index, 1)\r\n    if (item._id) this.warrantyDel.push(item)\r\n  }\r\n  /** Lấy toàn bộ sản phẩm và ghi chú bảo hành */\r\n  public getWarranty() {\r\n    return this.warrantyNote.concat(this.warrantyProd).filter(item => {\r\n      if (item.content) {\r\n        item.id_bill = this.invoice._id; return true\r\n      } else return false\r\n    })\r\n  }\r\n\r\n  public getWarrantyProd() {\r\n    return this.warrantyProd\r\n  }\r\n  public getWarrantyNote() {\r\n    return this.warrantyNote\r\n  }\r\n  public getDelWarranty() {\r\n    return this.warrantyDel\r\n  }\r\n  public getUpdateWarranty() {\r\n    return this.warrantyNote.concat(this.warrantyProd).filter(item => item.content && item._id)\r\n  }\r\n  /** Lấy toàn bộ các sản phẩm và ghi chú bảo hành */\r\n  public getCreateWarranty() {\r\n    return this.warrantyNote.concat(this.warrantyProd).filter(item => {\r\n      if (!item.id_bill) item.id_bill = this.invoice._id\r\n      if (item.content && !item._id) return true\r\n      else return false\r\n    })\r\n  }\r\n  public getInvoiceDetailCombos(idDetail: string): VhBillType15DetailCombo[] {\r\n    let detailBill: VhBillType15Detail = this.invoiceDetail.find(detail => detail._id == idDetail)\r\n    return detailBill ? detailBill.combos : null;\r\n  }\r\n\r\n  /******************************Xu ly invoice detail *******************************/\r\n  /** Thêm sản phẩm vào bill detail */\r\n  public addInvoiceDetail(value: any, new_price?: any) {\r\n    if (value['id_subproduct']) {\r\n      let index = this.invoiceDetail.findIndex(detail => detail['id_subproduct'] == value['id_subproduct'] && detail['ratio'] == value['ratio'])\r\n      if (index != -1) {\r\n        if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n      } else {\r\n        this.addBill_Detail(value, new_price)\r\n      }\r\n    }\r\n    else {\r\n      let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == value['_id'] && detail['ratio'] == value['ratio'])\r\n      if (index != -1) {\r\n        if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n      } else {\r\n        this.addBill_Detail(value, new_price)\r\n      }\r\n    }\r\n    this.setSubTotal()\r\n  }\r\n  addBill_Detail(value: any, new_price?: number) {\r\n    let detail: any = {\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      ptype: value.type,\r\n      unit: value.unit,\r\n\r\n      units: value.units ? value.units : [],\r\n\r\n      ratio: value.ratio ? value.ratio : 1,\r\n      price: new_price != null ? new_price : value.price,\r\n      price_origin: value.price,\r\n      earning_points_product: value.earning_points_product ? value.earning_points_product : 0,\r\n    }\r\n\r\n    if (value.type == 5) {\r\n      detail['cbtype'] = 5;\r\n      detail['combos'] = [...value.combos.map(item => {\r\n        let product: VhBillType15DetailCombo = {\r\n          id_product: item.id_product,\r\n          name: item.name,\r\n          ptype: item.type,\r\n          price: item.price,\r\n          quantity: item.quantity,\r\n          unit: item.unit,\r\n          units: item.units,\r\n          ratio: item.ratio ? item.ratio : 1\r\n        }\r\n        if (item.lots) product['lots'] = item.lots;\r\n        if (item.id_lotproduct) product['id_lotproduct'] = item.id_lotproduct;\r\n        if (item.id_subproduct) product['id_subproduct'] = item.id_subproduct;\r\n        return product;\r\n      })]\r\n    }\r\n    if (value.lot_number) detail['lot_number'] = value.lot_number;\r\n    if (value.lots) detail['lots'] = value.lots;\r\n    if (value.id_lotproduct) detail['id_lotproduct'] = value.id_lotproduct;\r\n    if (value.id_subproduct) detail['id_subproduct'] = value.id_subproduct;\r\n\r\n    this.invoiceDetail.unshift(detail)\r\n  }\r\n  addBill_detail_promotion(value) {\r\n    this.invoiceDetail.push(value)\r\n  }\r\n  /** Thêm sản phẩm vào bill detail */\r\n  public addInvoiceDetailMutilLine(value: any, new_price?: any) {\r\n    let detail: any = {\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      ptype: value.type,\r\n      unit: value.unit,\r\n      price: new_price != null ? new_price : value.price,\r\n      price_origin: value.price,\r\n\r\n      units: value.units,\r\n      ratio: value.ratio ? value.ratio : 1,\r\n    }\r\n\r\n    if (value.type == 5) {\r\n      detail['subComboName'] = value.subComboName\r\n      detail['combos'] = [...value.combos.map(item => {\r\n        let product: VhBillType15DetailCombo = {\r\n          id_product: item.id_product, name: item.name, ptype: item.type,\r\n          price: item.price, quantity: item.quantity,\r\n          units: item.units,\r\n          unit: item.unit, ratio: item.ratio ? item.ratio : 1\r\n        }\r\n\r\n        if (item.lots) product['lots'] = item.lots;\r\n        if (item.id_lotproduct) product['id_lotproduct'] = item.id_lotproduct;\r\n        if (item.id_subproduct) product['id_subproduct'] = item.id_subproduct;\r\n        return product;\r\n      })]\r\n    }\r\n    if (value.lot_number) detail['lot_number'] = value.lot_number;\r\n    if (value.lots) detail['lots'] = value.lots;\r\n    if (value.id_lotproduct) detail['id_lotproduct'] = value.id_lotproduct;\r\n    if (value.id_subproduct) detail['id_subproduct'] = value.id_subproduct;\r\n    this.invoiceDetail.unshift(detail)\r\n\r\n    this.setSubTotal()\r\n  }\r\n  /** Xóa sản phẩm khỏi bill detail */\r\n  public removeInvoiceDetail(id: string) {\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == id)\r\n    if (index != -1) {\r\n      this.invoiceDetail.splice(index, 1);\r\n      this.setSubTotal()\r\n    }\r\n  }\r\n\r\n\r\n  public setSubTotal() {\r\n    // this.subTotal = this.invoiceDetail.reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      let total_product_gift = 0;\r\n      let total_products = 0;\r\n      if (i.products_gift) {\r\n        total_product_gift = i.products_gift.filter(item => item.choose).reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n      }\r\n      if (i.products) {\r\n        total_products = i.products.reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n      }\r\n      subTotal += total_products + total_product_gift + (i.price ? i.price * i.quantity : 0)\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal()\r\n  }\r\n\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount - this.invoice.discount_bill - (this.invoice.payment_coupons + this.invoice.payment_points) + this.invoice.fee > 0 ? this.subTotal - this.invoice.discount - this.invoice.discount_bill - (this.invoice.payment_coupons + this.invoice.payment_points) + this.invoice.fee : 0\r\n\r\n    this.setTaxValue();\r\n  }\r\n\r\n  setTaxValue() {\r\n    this.taxValue = this.invoice.total * (this.invoice.tax / 100)\r\n    this.setPayment()\r\n  }\r\n\r\n  setPayment(value?: number) {\r\n\r\n    if (this.invoice.payment_type == 2) {\r\n      this.invoice.payment = 0\r\n    } else {\r\n      if (value != null)\r\n        this.invoice.payment = value\r\n      else\r\n        this.invoice.payment = this.invoice.total + this.taxValue\r\n    }\r\n  }\r\n\r\n  /** Lấy bill dùng cho database */\r\n  public getCreateUpdateInvoice(bill_type: 15 | 16 | 17 | null = null) {\r\n    if (bill_type) this.invoice.bill_type = (bill_type)\r\n    return this.invoice\r\n  }\r\n  /** Lấy tất cả bill detail dùng cho database */\r\n  public getCreateUpdateInvoiceDetail(): VhBillType15Detail[] {\r\n    return this.invoiceDetail.map(item => {\r\n      if (!item.pmtype) {\r\n        let detail: VhBillType15Detail = {\r\n          id_product: item.id_product,\r\n          ptype: item.ptype,\r\n          price: item.price,\r\n          quantity: item.quantity,\r\n          earning_points_product: item.earning_points_product,\r\n          ratio: item.ratio,\r\n        }\r\n        if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct\r\n        if (item.id_subproduct) detail['id_subproduct'] = item.id_subproduct\r\n        if (item.price < item.price_origin) detail['price_origin'] = item.price_origin\r\n        if (item.price == item.price_origin) detail['price_origin'] = item.price\r\n\r\n        if (item.ptype == 5) {\r\n          detail['combos'] = item.combos.map(combo => {\r\n            let product: VhBillType15DetailCombo = {\r\n              id_product: combo.id_product,\r\n              price: combo.price,\r\n              quantity: combo.quantity,\r\n              ptype: combo.ptype,\r\n              ratio: combo.ratio ? combo.ratio : 1,\r\n            }\r\n            if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct\r\n            if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct\r\n            return product;\r\n          })\r\n        }\r\n        return detail\r\n      }\r\n      else {\r\n        let detail: any = {\r\n          id_promotion: item.id_promotion,\r\n          pmtype: item.pmtype,\r\n        }\r\n        if (item.products_gift) {\r\n          if (item.products_gift.filter(ele => ele.choose).length) {\r\n            detail['products_gift'] = item.products_gift.filter(ele => ele.choose).map(e => {\r\n              let prod = {\r\n                id_product: e.id_product,\r\n                price: e.price,\r\n                price_origin: e.price_origin,\r\n                quantity: e.quantity,\r\n                ptype: e.ptype,\r\n                earning_points_product: e.earning_points_product,\r\n                ratio: e.ratio\r\n              }\r\n              if (e.ptype == 5) {\r\n                prod['combos'] = e.combos.map(combo => {\r\n                  let product: VhBillType15DetailCombo = {\r\n                    id_product: combo.id_product,\r\n                    price: combo.price,\r\n                    quantity: combo.quantity,\r\n                    ptype: combo.ptype,\r\n                    ratio: combo.ratio ? combo.ratio : 1,\r\n                  }\r\n                  if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct\r\n                  if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct\r\n                  return product;\r\n                })\r\n              }\r\n              if (e.id_lotproduct) prod['id_lotproduct'] = e.id_lotproduct\r\n              if (e.id_subproduct) prod['id_subproduct'] = e.id_subproduct\r\n              return prod\r\n            })\r\n            return detail\r\n          }\r\n        }\r\n        else {\r\n          detail['products'] = item.products.map(e => {\r\n            let prod = {\r\n              id_product: e.id_product,\r\n              price: e.price,\r\n              price_origin: e.price_origin,\r\n              quantity: e.quantity,\r\n              ptype: e.ptype,\r\n              id_category: e.id_category,\r\n              earning_points_product: e.earning_points_product,\r\n              ratio: e.ratio\r\n            }\r\n            if (e.ptype == 5) {\r\n              prod['combos'] = e.combos.map(combo => {\r\n                let product: VhBillType15DetailCombo = {\r\n                  id_product: combo.id_product,\r\n                  price: combo.price,\r\n                  quantity: combo.quantity,\r\n                  ptype: combo.ptype,\r\n                  ratio: combo.ratio ? combo.ratio : 1,\r\n                }\r\n                if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct\r\n                if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct\r\n                return product;\r\n              })\r\n            }\r\n            if (e.id_lotproduct) prod['id_lotproduct'] = e.id_lotproduct\r\n            if (e.id_subproduct) prod['id_subproduct'] = e.id_subproduct\r\n            return prod\r\n          })\r\n          return detail\r\n        }\r\n\r\n      }\r\n    }).filter(item => item)\r\n  }\r\n\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}} <b> {{'Edit warranty invoice' | translate}}</b>\r\n</div>\r\n\r\n<nz-layout>\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"18\" class=\"title sales-cart-header-title\">\r\n                    <b>{{\"Create warranty invoice\" | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"center-all-content\">\r\n                    <button [disabled]=\"  !invoiceDetail.length\" (click)=\"payInvoice(16)\"\r\n                        [disabled]=\"!invoiceDetail.length\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\">\r\n                        <i nz-icon nzType=\"save\" nzTheme=\"outline\"></i>\r\n                        {{'Temporary' | translate}} (F3)</button>\r\n                </div>\r\n                <div id=\"waranty-invoice-prodAndnote-invoiceDetail\"\r\n                    class=\"waranty-invoice-prodAndnote-invoiceDetail hideScrollbar\" nz-col nzSpan=\"24\">\r\n                    <div nz-row>\r\n                        <div nz-col class=\"search-product-warrany\" nzSpan=\"24\">\r\n                            <div>\r\n                                <h5>{{\"Warranty, repair products\"|translate}}</h5>\r\n                            </div>\r\n                            <div>\r\n                                <ion-icon (click)=\"openSearchProductListWarranty()\" slot=\"end\"\r\n                                    style=\"color: var(--ion-color-vh-green); margin-right:10px; font-size: 1.3rem; text-align:end;cursor: pointer;\"\r\n                                    name=\"search-outline\"></ion-icon>\r\n                                <ion-icon (click)=\"addWarrantyProd()\" slot=\"end\"\r\n                                    style=\"color: var(--ion-color-vh-green); font-size: 1.2rem; text-align:end;cursor: pointer;\"\r\n                                    src=\"assets/icon/add.svg\"></ion-icon>\r\n                            </div>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"24\">\r\n                            <div class=\"hideScrollbar waranty-invoice-prod-invoiceDetail\">\r\n                                <div class=\"invoiceDetail-item\" *ngFor=\"let item of warrantyProd;let i = index\">\r\n                                    <div nz-row>\r\n                                        <div (click)=\"removeWarrantyProd(i,item)\" nz-col nzSpan=\"2\" class=\"center-col\">\r\n                                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                        </div>\r\n                                        <div nz-col nzSpan=\"18\" class=\"center-col\">\r\n                                            <p class=\"max-width-two-line\" style=\"width: 100%;\">\r\n                                                <input [(ngModel)]=\"item.content\" (blur)=\"editWarrantyProd(i,item)\"\r\n                                                    [placeholder]=\"'Enter product name' | translate\"\r\n                                                    class=\"nz-no-border\" nz-input />\r\n                                            </p>\r\n                                        </div>\r\n                                        <div nz-col nzSpan=\"4\"\r\n                                            *ngIf=\"(warrantyProd.length == 1 && warrantyProd[0].content) || warrantyProd.length>1\">\r\n                                            <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"1\" [nzStep]=\"1\"\r\n                                                [(ngModel)]=\"item.quantity\"\r\n                                                (ngModelChange)=\"checkQuantityProduct(item,$event)\"></nz-input-number>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div nz-col class=\"search-product-warrany\" nzSpan=\"24\">\r\n                            <div>\r\n                                <h5>{{\"Note\"|translate}}</h5>\r\n                            </div>\r\n                            <div>\r\n                                <ion-icon (click)=\"addWarrantyNote()\" slot=\"end\"\r\n                                    style=\"color: var(--ion-color-vh-green); font-size: 1.2rem; text-align:end;cursor: pointer;\"\r\n                                    src=\"assets/icon/add.svg\"></ion-icon>\r\n                            </div>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"24\">\r\n                            <div class=\"hideScrollbar waranty-invoice-prod-invoiceDetail\">\r\n                                <div class=\"invoiceDetail-item\" *ngFor=\"let item of warrantyNote;let i = index\">\r\n                                    <div nz-row>\r\n                                        <div (click)=\"invoice.removeWarrantyNote(i,item)\" nz-col nzSpan=\"2\"\r\n                                            class=\"center-col\">\r\n                                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                        </div>\r\n                                        <div nz-col nzSpan=\"18\" class=\"center-col\">\r\n                                            <input [(ngModel)]=\"item.content\" (blur)=\"editWarrantyNote(i,item)\"\r\n                                                [placeholder]=\"'Enter note' | translate\" class=\"nz-no-border\"\r\n                                                nz-input />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-best-selling\">\r\n            <div nz-row class=\"waranty-invoice-quote\">\r\n                <div class=\"waranty-invoice-quote-header\" nz-col nzSpan=\"8\">\r\n                    <h5>{{\"Quote\" | translate}}</h5>\r\n                </div>\r\n                <div style=\"text-align: end;\" class=\"waranty-invoice-quote-header\" nz-col nzSpan=\"16\">\r\n                    <button style=\"margin-right: 8px;\" nz-button nzType=\"primary\" (click)=\"getPromotions()\">\r\n                        <i nz-icon nzType=\"gift\" nzTheme=\"outline\"></i> {{'Promotions' | translate}}</button>\r\n                    <button style=\"margin-right: 8px;\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                        (click)=\"showModalChangePriceType = true\">\r\n                        {{'Choose selling price' | translate}}</button>\r\n                    <button style=\"font-size: 0.9rem;\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                        (click)=\"openSearchProductList()\">\r\n                        <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                        {{'Search (F4)' | translate}}</button>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div id=\"waranty-invoice-quote-invoiceDetail\"\r\n                        class=\"hideScrollbar waranty-invoice-quote-invoiceDetail\">\r\n                        <div class=\"invoiceDetail-item\" *ngFor=\"let item of invoiceDetail,index as i\">\r\n                            <div nz-row>\r\n                                <div nz-col nzSpan=\"24\">\r\n                                    <ng-container [ngSwitch]=\"item.pmtype\">\r\n                                        <ng-container *ngSwitchCase=\"1\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products\">\r\n                                                <div nz-col nzSpan=\"1\">\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                                    <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        <br>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"data.combos\">\r\n                                                        <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ':\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                    <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                          <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                          <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                      </nz-select> -->\r\n                                                    {{data.unit}}\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                    {{data.quantity}}\r\n                                                    <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                          (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(data)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{data.price_origin > data.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"2\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products\">\r\n                                                <div nz-col nzSpan=\"1\"></div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                                    <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        <br>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"data.combos\">\r\n                                                        <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ':\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                    <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                          <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                          <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                      </nz-select> -->\r\n                                                    {{data.unit}}\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                    {{data.quantity}}\r\n                                                    <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                          (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(data)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{data.price_origin > data.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"3\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products\">\r\n                                                <div nz-col nzSpan=\"1\"></div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                                    <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        <br>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"data.combos\">\r\n                                                        <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ':\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                    <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                          <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                          <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                      </nz-select> -->\r\n                                                    {{data.unit}}\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                    {{data.quantity}}\r\n                                                    <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                          (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(data)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{data.price_origin > data.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"4\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products\">\r\n                                                <div nz-col nzSpan=\"1\"></div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                                    <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        <br>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"data.combos\">\r\n                                                        <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ':\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                    <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                          <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                          <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                      </nz-select> -->\r\n                                                    {{data.unit}}\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                    {{data.quantity}}\r\n                                                    <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                          (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(data)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{data.price_origin > data.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"5\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products\">\r\n                                                <div nz-col nzSpan=\"1\"></div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                                    <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        <br>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"data.combos\">\r\n                                                        <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == data.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ':\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                    <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                          <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                          <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                      </nz-select> -->\r\n                                                    {{data.unit}}\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                    {{data.quantity}}\r\n                                                    <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                          (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(data)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{data.price_origin > data.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"6\">\r\n                                            <div nz-row *ngIf=\"item.products.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}} <i\r\n                                                            nz-icon nzType=\"gift\" nzTheme=\"outline\"\r\n                                                            style=\"cursor: pointer;\"\r\n                                                            (click)=\"showProductGift = true\"></i></p>\r\n\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <!-- <div nz-row *ngFor=\"let data of item.products\">\r\n                                  <div nz-col nzSpan=\"1\"></div>\r\n                                  <div nz-col nzSpan=\"8\">\r\n                                      <p style=\"margin-bottom: 0;\">{{data.name}}</p>\r\n                                  </div>\r\n                                  <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                      \r\n                                      {{data.unit}}\r\n                                  </div>\r\n                                  <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                      {{data.quantity}}\r\n                                       \r\n                                  </div>\r\n                                  <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                      <p class=\"max-width-two-line\" style=\" margin-left: 16px;\">\r\n                                          <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                          <del style=\"margin-left:5px;font-size: 0.8rem;\" *ngIf=\"display_promotion_selling_price\">\r\n                                              {{data.price_origin > data.price ?\r\n                                              vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                              ''}}\r\n                                          </del>\r\n                                      </p>\r\n                                  </div>\r\n                                  <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                      <p class=\"max-width-two-line\">\r\n                                          <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                      </p>\r\n                                  </div>\r\n                              </div> -->\r\n                                            <div nz-row *ngFor=\"let data of item.products_gift\">\r\n                                                <ng-container *ngIf=\"data.choose\">\r\n\r\n                                                    <div nz-col nzSpan=\"1\"></div>\r\n                                                    <div nz-col nzSpan=\"8\">\r\n                                                        <i style=\"margin-bottom: 0;\">{{data.name}}</i>\r\n                                                        <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                            <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                                (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                            <br>\r\n                                                        </ng-container>\r\n                                                        <p *ngIf=\"data.combos\">\r\n                                                            <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                                style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                                {{ i == data.combos.length-1 ? combo.quantity + 'x ' + combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ')': combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                                getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                            </span>\r\n                                                        </p>\r\n\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                        <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                              <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                              <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                          </nz-select> -->\r\n                                                        {{data.unit}}\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                        {{data.quantity}}\r\n                                                        <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                              (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                    </div>\r\n                                                    <div (click)=\"openEditUnitPrice(data)\"\r\n                                                        class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                        <p class=\"max-width-two-line\"\r\n                                                            style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                            <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                            <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                                *ngIf=\"display_promotion_selling_price\">\r\n                                                                {{data.price_origin > data.price ?\r\n                                                                vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                                ''}}\r\n                                                            </del>\r\n                                                        </p>\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                        <p class=\"max-width-two-line\">\r\n                                                            <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                        </p>\r\n                                                    </div>\r\n                                                </ng-container>\r\n\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchCase=\"7\">\r\n                                            <div nz-row *ngIf=\"item.products_gift.length\">\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Cancel promotion?' | translate}}\"\r\n                                                    (nzOnConfirm)=\"deletePromotion()\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                                    nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"23\">\r\n                                                    <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}} <i\r\n                                                            nz-icon nzType=\"gift\" nzTheme=\"outline\"\r\n                                                            style=\"cursor: pointer;\"\r\n                                                            (click)=\"showProductGiftType7 = true\"></i></p>\r\n\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div nz-row *ngFor=\"let data of item.products_gift\">\r\n                                                <ng-container *ngIf=\"data.choose\">\r\n\r\n                                                    <div nz-col nzSpan=\"1\"></div>\r\n                                                    <div nz-col nzSpan=\"8\">\r\n                                                        <i style=\"margin-bottom: 0;\">{{data.name}}</i>\r\n                                                        <ng-container *ngIf=\"data.id_lotproduct\">\r\n                                                            <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                                (click)=\"openModalChooseLot(data)\">{{getLotNumber(data.lots, data.id_lotproduct)}}</pre>\r\n                                                        </ng-container>\r\n                                                        <p *ngIf=\"data.combos\">\r\n                                                            <span *ngFor=\"let combo of data.combos;index as i\"\r\n                                                                style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                                {{ i == data.combos.length-1 ? combo.quantity + 'x ' + combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ')': combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                                getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                            </span>\r\n                                                        </p>\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"3\" style=\"text-align: center;\">\r\n                                                        <!-- <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.unit_exchange\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                              <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option>\r\n                                              <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"idx\"></nz-option>\r\n                                          </nz-select> -->\r\n                                                        {{data.unit}}\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"4\" style=\"text-align: center;\">\r\n                                                        {{data.quantity}}\r\n                                                        <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                              (ngModelChange)=\"checkQuantityProduct(item,$event)\" id=\"quantity\"></nz-input-number> -->\r\n                                                    </div>\r\n                                                    <div (click)=\"openEditUnitPrice(data)\"\r\n                                                        class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                        <p class=\"max-width-two-line\"\r\n                                                            style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                            <span>{{vhAlgorithm.vhcurrencyunit(data.price)}}</span>\r\n                                                            <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                                *ngIf=\"display_promotion_selling_price\">\r\n                                                                {{data.price_origin > data.price ?\r\n                                                                vhAlgorithm.vhcurrencyunit(data.price_origin) :\r\n                                                                ''}}\r\n                                                            </del>\r\n                                                        </p>\r\n                                                    </div>\r\n                                                    <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                        <p class=\"max-width-two-line\">\r\n                                                            <b>{{vhAlgorithm.vhcurrencyunit(data.price*data.quantity)}}</b>\r\n                                                        </p>\r\n                                                    </div>\r\n                                                </ng-container>\r\n\r\n                                            </div>\r\n                                        </ng-container>\r\n                                        <ng-container *ngSwitchDefault>\r\n                                            <div nz-row>\r\n                                                <div nz-popconfirm\r\n                                                    nzPopconfirmTitle=\"{{'Are you sure to delete' | translate}} {{item.name}}\"\r\n                                                    (nzOnConfirm)=\"deleteGoods(item,i)\"\r\n                                                    nzPopconfirmPlacement=\"bottomLeft\" nz-col nzSpan=\"1\">\r\n                                                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"8\">\r\n                                                    <p style=\"margin-bottom: 0;\">{{item.name}}</p>\r\n                                                    <ng-container *ngIf=\"item.id_lotproduct\">\r\n                                                        <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                            (click)=\"openModalChooseLot(item)\">{{getLotNumber(item.lots, item.id_lotproduct)}}</pre>\r\n                                                    </ng-container>\r\n                                                    <p *ngIf=\"item.combos\">\r\n                                                        <span *ngFor=\"let combo of item.combos;index as i\"\r\n                                                            style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                                            {{ i == item.combos.length-1 ? combo.quantity + 'x ' +\r\n                                                            combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ' :\r\n                                                            combo.quantity + 'x ' + combo.name + ' (' +\r\n                                                            getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                                            <ng-container *ngIf=\"combo.id_lotproduct\">\r\n                                                                <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                                                    (click)=\"openModalChooseLot(combo)\">{{getLotNumber(combo.lots, combo.id_lotproduct)}}</pre>\r\n                                                            </ng-container>\r\n                                                        </span>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"3\">\r\n                                                    <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.ratio\"\r\n                                                        (ngModelChange)=\"changeUnit($event,item)\">\r\n                                                        <!-- <nz-option [nzLabel]=\"item.unit\" [nzValue]=\"1\"></nz-option> -->\r\n                                                        <nz-option *ngFor=\"let i of item.units\" [nzLabel]=\"i.unit\"\r\n                                                            [nzValue]=\"i.ratio\"></nz-option>\r\n                                                    </nz-select>\r\n                                                    <!-- {{item.unit}} -->\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <!-- {{item.quantity}} -->\r\n                                                    <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\"\r\n                                                        [(ngModel)]=\"item.quantity\"\r\n                                                        (ngModelChange)=\"checkQuantityProduct(item,$event)\"\r\n                                                        id=\"quantity\">\r\n                                                    </nz-input-number>\r\n                                                </div>\r\n                                                <div (click)=\"openEditUnitPrice(item)\"\r\n                                                    class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                                                    <p class=\"max-width-two-line\"\r\n                                                        style=\"border-bottom: 1px var(--ion-color-vh-gray) solid; margin-left: 16px;\">\r\n                                                        <span>{{vhAlgorithm.vhcurrencyunit(item.price)}}</span>\r\n                                                        <del style=\"margin-left:5px;font-size: 0.8rem;\"\r\n                                                            *ngIf=\"display_promotion_selling_price\">\r\n                                                            {{item.price_origin > item.price ?\r\n                                                            vhAlgorithm.vhcurrencyunit(item.price_origin) :\r\n                                                            ''}}\r\n                                                        </del>\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                                                    <p class=\"max-width-two-line\">\r\n                                                        <b>{{vhAlgorithm.vhcurrencyunit(item.price*item.quantity)}}</b>\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </ng-container>\r\n                                    </ng-container>\r\n\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Receptionist' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_employee\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveReceptionist($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Technician' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_technician\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveTechnician($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Issued date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\" nz-row style=\"overflow: visible;\">\r\n                <div class=\"sales-bills-customer-title\">\r\n                    <b>{{'Customer information' | translate}}</b>\r\n                    <ion-icon (click)=\"openDrawerAddCustomerOrRetail()\"\r\n                        style=\"color: var(--ion-color-vh-white);padding-right: 5px;\"\r\n                        [src]=\"invoice.retail_name ? 'assets/icon/eye.svg':'assets/icon/add.svg'\">\r\n                    </ion-icon>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <nz-radio-group [(ngModel)]=\"radioValue\" (ngModelChange)=\"changeCustomerType($event)\"\r\n                        nzName=\"radiogroup\">\r\n                        <label nz-radio [nzValue]=1>{{'Retail customer' | translate}}</label>\r\n                        <label nz-radio [nzValue]=2>{{'Member' | translate}}</label>\r\n                        <label nz-radio [nzValue]=3>{{'Search customer' | translate}}</label>\r\n                    </nz-radio-group>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <ng-container *ngIf=\"radioValue == 1 && invoice.retail_name\">\r\n                        {{invoice.retail_name}} - {{invoice.retail_phone}} {{invoice.retail_address ? '-':\r\n                        ''}} {{invoice.retail_address}}\r\n                    </ng-container>\r\n                    <ng-container *ngIf=\"radioValue == 2\">\r\n                        <app-customer [id_customer]=\"invoice.id_customer\"\r\n                            (closeAndReceiveCustomer)=\"closeAndReceiveCustomer($event)\"></app-customer>\r\n                        <i (click)=\"openInfoCustomer()\"\r\n                            [ngClass]=\"invoice.id_customer !='id_retail' ? 'active' : 'deactive'\"\r\n                            style=\"cursor: pointer;\" nz-icon nzType=\"info-circle\" nzTheme=\"outline\"></i>\r\n                    </ng-container>\r\n                    <ng-container *ngIf=\"radioValue == 3\">\r\n                        <app-search-customer [id_customer]=\"invoice.id_customer\"\r\n                            (closeAndReceiveCustomer)=\"closeAndReceiveCustomer($event)\"></app-search-customer>\r\n                        <i (click)=\"openInfoCustomer()\"\r\n                            [ngClass]=\"invoice.id_customer !='id_retail' ? 'active' : 'deactive'\"\r\n                            style=\"cursor: pointer;\" nz-icon nzType=\"info-circle\" nzTheme=\"outline\"></i>\r\n                    </ng-container>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\" *ngIf=\"radioValue == 2 && invoice.id_customer != 'id_retail'\"\r\n                style=\"display: flex; justify-content: space-between;margin: 8px 0;\">\r\n                <span>\r\n                    {{'Accumulated points' | translate}} : <b>{{point_validity}}</b>\r\n                </span>\r\n                <span>\r\n                    {{'Plus' | translate}} : <b>{{getTotalEarningPoint()}}</b>\r\n                </span>\r\n            </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <div nz-col nzSpan=\"24\" style=\"display: flex;justify-content: space-between;\">\r\n                    <b>{{'Payment information' | translate}}</b>\r\n                    <span (click)=\"openModalOtherDiscount()\" style=\"cursor: pointer;color: var(--ion-color-vh-green);\">\r\n                        <i nz-icon nzType=\"plus\" nzTheme=\"outline\"></i>\r\n                        {{'Add other payment' |translate}}\r\n                    </span>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div>{{'SubTotal' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n\r\n                <ng-container *ngIf=\"vhAuth.localStorageGET('show_discount')\">\r\n                    <div class=\"sales-bills-content-discount\"\r\n                        style=\"display: flex;justify-content: space-between;align-items: center;\" nz-col nzSpan=\"24\">\r\n                        <div style=\"width: auto;\">{{'Discount value' | translate}}</div>\r\n                        <div>\r\n                            <input id=\"percent-discount-price\" style=\"width: 50px;\" #percentDiscount type=\"number\"\r\n                                max=\"100\" min=\"0\" step=\"1\"\r\n                                (blur)=\"editPercentDiscount(percentDiscount.value)\"\r\n                                [ngModel]=\"percent_discount_bill | number:'1.0-2'\" class=\"border_bottom \" maxlength=\"3\"\r\n                                nz-input />%\r\n                        </div>\r\n                        <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                            class=\"border_bottom discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\"\r\n                            nz-input />\r\n                    </div>\r\n                </ng-container>\r\n\r\n                <div *ngIf=\"discount_bill >0\" class=\"sales-bills-content-discount\"\r\n                    style=\"display: flex;justify-content: space-between;align-items: center;\" nz-col nzSpan=\"24\">\r\n                    <div style=\"width: auto;\">{{'Discount' | translate}}\r\n                    </div>\r\n                    <span>{{vhAlgorithm.vhcurrencyunit(discount_bill)}}</span>\r\n                </div>\r\n                <div *ngIf=\"invoice.payment_points\" class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Point payment' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.payment_points)}}</div>\r\n                </div>\r\n                <div *ngIf=\"invoice.payment_coupons\" class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Coupon payment' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.payment_coupons)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_fee')\">\r\n                    <div>{{'Fee' | translate}}</div>\r\n                    <input (blur)=\"editFee()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.fee)\"\r\n                        class=\"border_bottom invoice-fee\" type=\"text\" maxlength=\"15\" id=\"invoice-fee\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-tax\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_tax')\">\r\n                    <span>{{'Tax' | translate}}</span>\r\n                    <div>\r\n                        <nz-select *ngIf=\"listTax.length\" [(ngModel)]=\"id_tax\" (ngModelChange)=\"changeTax($event)\"\r\n                            nzBorderless>\r\n                            <nz-option *ngFor=\"let item of listTax\" nzValue=\"{{item._id}}\"\r\n                                nzLabel=\"{{vhAlgorithm.vhpercent(item.value/100)}}\">\r\n                            </nz-option>\r\n                        </nz-select>\r\n                        <span class=\"not-found\" *ngIf=\"!listTax.length\">0.00%</span>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"7\" style=\"text-align: end;\">\r\n                        {{vhAlgorithm.vhcurrencyunit(taxValue)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Total' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(getTotalATax())}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <div>\r\n                        <b>{{'Pay' | translate}}</b>\r\n                        <ng-container *ngIf=\"product_gift_type7.length && !gotten_gift_type7\">\r\n                            <i style=\"font-size: 1rem;  margin-left: 8px; cursor: pointer;color: var(--ion-color-vh-green)\"\r\n                                nz-icon nzType=\"gift\" nzTheme=\"outline\" (click)=\"showProductGiftType7 = true\"></i>\r\n                        </ng-container>\r\n\r\n                    </div>\r\n                    <div> {{vhAlgorithm.vhcurrencyunit(invoice.payment)}}<img (click)=\"showModalEditTotalPay()\"\r\n                            *ngIf=\"invoice.payment_type != 2\" style=\"width: 16px;margin-left:10px\"\r\n                            src=\"assets/icon/Iconfeather-edit.svg\" /></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_rest')\">\r\n                    <div>{{'Rest' | translate}}</div>\r\n                    <div> {{vhAlgorithm.vhcurrencyunit_symbol(getTotalATax() - invoice.payment)}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"sales-bills-content-payment_type\" nz-col nzSpan=\"24\">\r\n                    <app-tax [payment_type]=\"invoice.payment_type\" [id_wallet]=\"invoice.id_wallet\"\r\n                        [id_customer]=\"invoice.id_customer\"\r\n                        (closeAndGetValuePayment)=\"closeAndGetValuePayment($event)\">\r\n                    </app-tax>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!invoiceDetail.length || !checkPrinter\" (click)=\"payInvoice(15,true)\" nz-button\r\n                    class=\"order-and-print\">\r\n                    {{\"Pay & Print\"|translate}} (F2)\r\n                </button>\r\n                <button [disabled]=\"!invoiceDetail.length\" (click)=\"payInvoice(15,false)\" nz-button class=\"order\">\r\n                    {{\"Pay\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n\r\n<!-- -----nz-drawer list-product-------- -->\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\" [default_price_type]=\"default_price_type\">\r\n</app-search-product>\r\n<!-- -----nz-drawer list-product-warranty-------- -->\r\n<app-search-product-warranty-invoice *ngIf=\"searchProductListWarranty\"\r\n    [searchProductListWarranty]=\"searchProductListWarranty\"\r\n    (closeSearchProductListWarranty)=\"closeSearchProductListWarranty($event)\">\r\n</app-search-product-warranty-invoice>\r\n\r\n<!--Modal edit unit price-->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Edit unit price' | translate}}\" (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Unit price' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\" [value]=\"tempDetail.price\" nz-input\r\n                    placeholder=\"{{'Enter unit price' | translate}}\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!--Modal edit pay-->\r\n<nz-modal [(nzVisible)]=\"edit_pay\" [nzFooter]=\"modalFooterEditPay\" nzTitle=\"{{'Edit' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditPay()\" (nzOnOk)=\"handleEditPay()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Pay' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input [value]=\"vhAlgorithm.vhcurrencyunit(invoice.payment)\" class=\"edit-pay\" type=\"text\"\r\n                    maxlength=\"15\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditPay>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditPay()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditPay()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n\r\n<!-- MOdal giảm giá khác (coupon hoặc đổi điểm) -->\r\n<nz-modal [(nzVisible)]=\"showModalOtherDiscount\" nzTitle=\"{{'Other payment' | translate}}\" nzWidth=\"50vw\"\r\n    (nzOnCancel)=\"showModalOtherDiscount = false\" nzCancelText=\"\" (nzOnOk)=\"handleOkOtherDiscount()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row class=\"center-all-content\">\r\n            <div nz-col nzSpan=\"6\">\r\n                {{\"Coupon\" | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"12\" id=\"coupon\" style=\"display: flex;\">\r\n                <input #coupon nz-input placeholder=\"{{'Enter or scan code' | translate}}\"\r\n                    (keyup.enter)=\"getDiscountOfCoupon(coupon.value)\" />\r\n                <button style=\"margin-left: 8px;\" nz-button nzType=\"primary\"\r\n                    (click)=\"getDiscountOfCoupon(coupon.value)\">{{'Apply'| translate}}</button>\r\n            </div>\r\n            <div nz-col nzSpan=\"6\" class=\"text-end\">\r\n                {{vhAlgorithm.vhcurrencyunit(invoice.payment_coupons)}}\r\n            </div>\r\n        </div>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"6\"></div>\r\n            <div nz-col nzSpan=\"18\">\r\n                <nz-tag *ngFor=\"let item of product_codes\" [nzColor]=\"'green'\" nzMode=\"closeable\"\r\n                    (nzOnClose)=\"onCloseProductCode(item)\">{{item.code}}</nz-tag>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <ng-container *ngIf=\"customer_class?.payment.enable\">\r\n            <div nz-row class=\"center-all-content mt-8\">\r\n                <div nz-col nzSpan=\"6\">\r\n                    {{\"Accumulated points\" | translate}}\r\n                </div>\r\n                <div nz-col nzSpan=\"12\">\r\n                    <nz-input-number [(ngModel)]=\"value_discount_point\" style=\"width: 100%;\" #point\r\n                        nzPlaceHolder=\"{{'Enter points' | translate}}\" [nzMin]=\"0\" [nzMax]=\"point_validity\" [nzStep]=\"1\"\r\n                        (keyup)=\"calculatePoint2Money(point['value'])\"></nz-input-number>\r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"text-end\">\r\n                    {{vhAlgorithm.vhcurrencyunit(invoice.payment_points)}}\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"mt-8\">\r\n                <div nz-col nzSpan=\"14\">\r\n                    <label>{{\"Point conversion rate\" | translate}}:\r\n                        {{customer_class.payment.points}} Điểm =\r\n                        {{vhAlgorithm.vhcurrencyunit_symbol(customer_class.payment.money)}}</label>\r\n                </div>\r\n                <div nz-col nzSpan=\"10\" class=\"text-end\">\r\n                    {{'Current accumulated points' | translate}} : {{point_validity }}\r\n                </div>\r\n            </div>\r\n        </ng-container>\r\n\r\n        <div nz-row class=\"mt-8 beetween-all-content\">\r\n            <b>{{'Total discount' | translate}}</b>\r\n            <b>{{vhAlgorithm.vhcurrencyunit(invoice.payment_points + invoice.payment_coupons)}}</b>\r\n        </div>\r\n    </ng-container>\r\n</nz-modal>\r\n\r\n\r\n<!-- modal chọn sản phẩm tặng -->\r\n<nz-modal nzWidth=\"70vw\" [(nzVisible)]=\"showProductGift\" nzTitle=\"{{'Chọn quà tặng'}}\"\r\n    (nzOnCancel)=\"showProductGift = false\" (nzOnOk)=\"showProductGift = false;getEarningpointPromotion()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"invoiceDetail\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{{\"Product name\" | translate}}</th>\r\n                    <!-- <th>{{'Lot number' | translate}}</th> -->\r\n                    <th>{{'Unit' | translate}}</th>\r\n                    <th>{{'Quantity' | translate}}</th>\r\n                    <th>{{'Unit price' | translate}}</th>\r\n                    <th>{{'Functions' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let item of basicTable.data\">\r\n                    <ng-container *ngIf=\"item.pmtype == 6\">\r\n                        <tr>\r\n                            <td colspan=\"5\"><b>{{ item.name }}</b> ({{'_Selected gift quantity' | translate}}: {{\r\n                                item.promotions_maximum }})</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td colspan=\"5\">\r\n                                <b>{{ 'List of purchased products' | translate }} :</b> <br>\r\n                                <span *ngFor=\"let data of item.products\">\r\n                                    {{data.name}}({{data.unit}}) x{{data.quantity}} <br>\r\n                                </span>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td colspan=\"5\">\r\n                                <b>{{ 'List of gifted products' | translate }} :</b>\r\n                            </td>\r\n                        </tr>\r\n                        <ng-container *ngFor=\"let data of item.products_gift\">\r\n                            <tr>\r\n                                <td>\r\n                                    {{ data.name }}\r\n                                    <ng-container *ngIf=\"data.lots\">\r\n                                        <br> {{'Lot number' | translate}}:\r\n                                        <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                            [(ngModel)]=\"data.id_lotproduct\">\r\n                                            <nz-option *ngFor=\"let element of data.lots\"\r\n                                                nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp |date : 'dd/MM/yyyy'}}\"\r\n                                                [nzValue]=\"element._id\"></nz-option>\r\n                                        </nz-select>\r\n                                    </ng-container>\r\n\r\n\r\n                                </td>\r\n\r\n                                <td>{{ getUnit(data.units, data.ratio) }}</td>\r\n                                <td>{{ data.quantity }}</td>\r\n                                <td>\r\n                                    {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n                                    <del>{{vhAlgorithm.vhcurrencyunit(data.price_origin)}}</del>\r\n                                </td>\r\n                                <td>\r\n                                    <nz-switch [(ngModel)]=\"data.choose\"\r\n                                        [nzDisabled]=\"checkDisableChooseProductGift(item) && !data.choose\"></nz-switch>\r\n                                </td>\r\n                            </tr>\r\n                            <ng-container *ngIf=\"data.ptype == 5\">\r\n                                <tr *ngFor=\"let combo of data.combos\">\r\n                                    <td>- {{ combo.name }}\r\n                                        <ng-container *ngIf=\"combo.lots\">\r\n                                            <br> {{'Lot number' | translate}}:\r\n                                            <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                                [(ngModel)]=\"combo.id_lotproduct\">\r\n                                                <nz-option *ngFor=\"let element of combo.lots\"\r\n                                                    nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp |date : 'dd/MM/yyyy'}}\"\r\n                                                    [nzValue]=\"element._id\"></nz-option>\r\n                                            </nz-select>\r\n                                        </ng-container>\r\n                                    </td>\r\n\r\n                                    <td>{{ getUnit(combo.units, combo.ratio) }}</td>\r\n                                    <td>{{ combo.quantity }}</td>\r\n                                    <td>\r\n                                        {{vhAlgorithm.vhcurrencyunit(combo.price) }}\r\n                                        <!-- <del>{{vhAlgorithm.vhcurrencyunit(combo.price_origin)}}</del> -->\r\n                                    </td>\r\n                                    <td>\r\n                                        <!-- <nz-switch [(ngModel)]=\"combo.choose\"\r\n                                          [nzDisabled]=\"checkDisableChooseProductGift(item) && !combo.choose\"></nz-switch> -->\r\n                                    </td>\r\n                                </tr>\r\n                            </ng-container>\r\n\r\n                        </ng-container>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n    </ng-container>\r\n</nz-modal>\r\n\r\n<!-- modal chọn sản phẩm tặng type 7 -->\r\n<nz-modal nzWidth=\"70vw\" [(nzVisible)]=\"showProductGiftType7\" nzTitle=\"{{'Chọn quà tặng'}}\"\r\n    (nzOnCancel)=\"showProductGiftType7 = false\" (nzOnOk)=\"showProductGiftType7 = false;handleAddGiftType7()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"product_gift_type7\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{{\"Product name\" | translate}}</th>\r\n                    <!-- <th>{{'Lot number' | translate}}</th> -->\r\n                    <th>{{'Unit' | translate}}</th>\r\n                    <th>{{'Quantity' | translate}}</th>\r\n                    <th>{{'Unit price' | translate}}</th>\r\n                    <th>{{'Functions' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let item of basicTable.data\">\r\n                    <ng-container *ngIf=\"item.products_gift\">\r\n                        <tr>\r\n                            <td colspan=\"5\"><b>{{ item.name }}</b> ({{'_Selected gift quantity' | translate}}: {{\r\n                                item.promotions_maximum }})</td>\r\n                        </tr>\r\n                        <ng-container *ngFor=\"let data of item.products_gift\">\r\n                            <tr>\r\n                                <td>\r\n                                    {{ data.name }}\r\n                                    <ng-container *ngIf=\"data.lots\">\r\n                                        <br> {{'Lot number' | translate}}:\r\n                                        <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                            [(ngModel)]=\"data.id_lotproduct\">\r\n                                            <nz-option *ngFor=\"let element of data.lots\"\r\n                                                nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp |date : 'dd/MM/yyyy'}}\"\r\n                                                [nzValue]=\"element._id\"></nz-option>\r\n                                        </nz-select>\r\n                                    </ng-container>\r\n                                </td>\r\n\r\n                                <td>{{ getUnit(data.units, data.ratio) }}</td>\r\n                                <td>{{ data.quantity }}</td>\r\n                                <td>\r\n                                    {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n                                    <del>{{vhAlgorithm.vhcurrencyunit(data.price_origin)}}</del>\r\n                                </td>\r\n                                <td>\r\n                                    <nz-switch [(ngModel)]=\"data.choose\"\r\n                                        [nzDisabled]=\"checkDisableChooseProductGift(item) && !data.choose\"></nz-switch>\r\n                                </td>\r\n                            </tr>\r\n                            <ng-container *ngIf=\"data.ptype == 5\">\r\n                                <tr *ngFor=\"let combo of data.combos\">\r\n                                    <td>- {{ combo.name }}\r\n                                        <ng-container *ngIf=\"combo.lots\">\r\n                                            <br> {{'Lot number' | translate}}:\r\n                                            <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                                [(ngModel)]=\"combo.id_lotproduct\">\r\n                                                <nz-option *ngFor=\"let element of combo.lots\"\r\n                                                    nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp |date : 'dd/MM/yyyy'}}\"\r\n                                                    [nzValue]=\"element._id\"></nz-option>\r\n                                            </nz-select>\r\n                                        </ng-container>\r\n                                    </td>\r\n\r\n                                    <td>{{ getUnit(combo.units, combo.ratio) }}</td>\r\n                                    <td>{{ combo.quantity }}</td>\r\n                                    <td>\r\n                                        {{vhAlgorithm.vhcurrencyunit(combo.price) }}\r\n                                        <!-- <del>{{vhAlgorithm.vhcurrencyunit(combo.price_origin)}}</del> -->\r\n                                    </td>\r\n                                    <td>\r\n                                        <!-- <nz-switch [(ngModel)]=\"combo.choose\"\r\n                                      [nzDisabled]=\"checkDisableChooseProductGift(item) && !combo.choose\"></nz-switch> -->\r\n                                    </td>\r\n                                </tr>\r\n                            </ng-container>\r\n                        </ng-container>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n    </ng-container>\r\n</nz-modal>\r\n\r\n\r\n<!-- modal chọn lô/HSD -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice2\" [(nzVisible)]=\"show_modal_select_lots\"\r\n    nzTitle=\"{{'Select lot number' | translate}}\" (nzOnCancel)=\"handleCancelChooseLot()\" (nzOnOk)=\"handleChooseLot()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input type=\"text\" nz-input placeholder=\"{{'Find lot number' | translate}}\" #searchValue\r\n                    (keyup)=\"searchLot(searchValue.value )\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <nz-radio-group [(ngModel)]=\"tempDetail.id_lotproduct\" (ngModelChange)=\"changeLot($event)\"\r\n            style=\"width:100%;padding: 8px 0;\">\r\n            <div nz-row *ngFor=\"let item of tempDetail.lots\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <label class=\"radio-purchase\" nz-radio [nzValue]=\"item._id\" style=\"width:100%;\">\r\n                        <div nz-row>\r\n                            <div nz-col nzSpan=\"6\">\r\n                                {{item.lot_number}}\r\n                            </div>\r\n\r\n                            <div nz-col nzSpan=\"6\">\r\n                                NSX: {{item.date_mfg | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                            <div nz-col nzSpan=\"6\">\r\n                                HSD: {{item.date_exp | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                            <div nz-col nzSpan=\"6\" class=\"ion-text-end\">\r\n                                {{'Stock' | translate}}:\r\n                                <span\r\n                                    style=\" color: var(--ion-color-vh-orange)\">{{item.quantity_branch[id_branch]/tempDetail.ratio\r\n                                    | number : '1.0-2'}}</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                    </label>\r\n                </div>\r\n\r\n            </div>\r\n        </nz-radio-group>\r\n        <div *ngIf=\"!tempDetail.lots.length\" style=\"text-align: center;\">{{'No data' | translate}}</div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice2>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelChooseLot()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\" [disabled]=\"!tempDetail.id_lotproduct\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLot()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!-- modal chọn lô/HSD cho combo-->\r\n<nz-modal nzWidth=\"70vw\" *ngIf=\"show_modal_select_lots_combo\" [nzFooter]=\"modalFooterEditUnitPrice3\"\r\n    [(nzVisible)]=\"show_modal_select_lots_combo\"\r\n    nzTitle=\"{{'Select lot number for products in combo' | translate}}: {{tempDetail.name}}\"\r\n    (nzOnCancel)=\"show_modal_select_lots_combo = false\" (nzOnOk)=\"handleChooseLotCombo()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"tempDetail.combos\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th nzWidth=\"30%\">{{\"Product name\" | translate}}</th>\r\n                    <th nzWidth=\"30%\">{{'Lot number' | translate}}</th>\r\n                    <th nzWidth=\"10%\">{{'Unit' | translate}}</th>\r\n                    <th nzWidth=\"10%\">{{'Quantity' | translate}}</th>\r\n                    <th nzWidth=\"20%\" nzAlign=\"right\">{{'Unit price' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let data of basicTable.data\">\r\n                    <ng-container *ngIf=\"data.lots\">\r\n\r\n                        <tr>\r\n                            <td>{{ data.name }}</td>\r\n                            <td>\r\n                                <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                    [(ngModel)]=\"data.id_lotproduct\" style=\"width: 100%;\">\r\n                                    <nz-option *ngFor=\"let element of data.lots\"\r\n                                        nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp | date: 'dd/MM/yyyy'}}\"\r\n                                        [nzValue]=\"element._id\"></nz-option>\r\n                                </nz-select>\r\n                            </td>\r\n                            <td>{{getUnit(data.units, data.ratio)}}</td>\r\n                            <td>{{ data.quantity }}</td>\r\n                            <td nzAlign=\"right\">\r\n                                {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n\r\n                            </td>\r\n                        </tr>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice3>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"show_modal_select_lots_combo = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLotCombo()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n\r\n<!-- đổi giá bán -->\r\n<app-change-price-type *ngIf=\"showModalChangePriceType\" [showModalChangePriceType]=\"showModalChangePriceType\"\r\n    (changePriceType)=\"changePriceType($event)\" [default_price_type]=\"default_price_type\"></app-change-price-type>\r\n<!-- --------------visible drawer info customer----------- -->\r\n<app-customer-profile *ngIf=\"visibleInfoCustomer\" [visibleInfoCustomer]=\"visibleInfoCustomer\" [customer]=\"customer\"\r\n    (closeInfoCustomer)=\"closeInfoCustomer($event)\"></app-customer-profile>\r\n<app-add-customer *ngIf=\"showDrawerAddCusomer\" [showDrawerAddCusomer]=\"showDrawerAddCusomer\"\r\n    (closeAddCustomer)=\"closeAddCustomer($event)\"></app-add-customer>\r\n    <app-retail-info *ngIf=\"showDrawerAddRetail\" [showDrawerAddRetail]=\"showDrawerAddRetail\"\r\n    [retail_name]=\"invoice.retail_name\" [retail_phone]=\"invoice.retail_phone\"\r\n    [retail_address]=\"invoice.retail_address\" (closeAddCustomer)=\"closeAddCustomer($event)\"></app-retail-info>","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { VhQuerySales } from 'ionic-vhframeworks';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AhamoveService {\r\n  private URL: string = this.vhQuerySales.getShippingAhamoveURL()\r\n  // api_key = '183a9baa5176ebbaa9c10fe67fc02161d63f6849'; //dev\r\n  api_key = 'fc0ee646897ef09f19fd61075337728c61bc9480'; //production\r\n  constructor(\r\n    private http: HttpClient,\r\n    private vhQuerySales: VhQuerySales\r\n  ) { }\r\n\r\n  getTokenAhaMove(phone) {\r\n\r\n    const options = {\r\n      params: {\r\n        \"url\": 'https://api.ahamove.com/v1/partner/register_account',\r\n        \"mobile\": phone,\r\n        \"api_key\": this.api_key,\r\n        \"name\": \"Viethas\",\r\n        \"address\": \"Khách hàng\"\r\n      }\r\n    }\r\n    return this.http.get(this.URL, options).toPromise();\r\n  }\r\n  getAllServiceAhaMove(city_id) {\r\n\r\n    const options = {\r\n      params: {\r\n        \"url\": `https://api.ahamove.com/v1/order/service_types?city_id=${city_id}`,\r\n      }\r\n    }\r\n    return this.http.get(this.URL, options).toPromise();\r\n  }\r\n  calculateFeeAhamove(data) {\r\n    \r\n    const options = {\r\n      params: {\r\n        \"url\": \"https://api.ahamove.com/v2/order/estimated_fee\",\r\n      }\r\n    }\r\n    const body = {\r\n      \"token\": data.token,\r\n      \"order_time\": 0,\r\n      \"path\": data.path,\r\n      \"services\": data.services,\r\n      \"payment_method\": \"CASH\"\r\n    }\r\n    return this.http.post(this.URL, body, options).toPromise();\r\n  }\r\n  createOrderAhamove(data) {\r\n\r\n    let x = `[{\"address\":\"${data.pick_address}\",\"name\":\"${data.pick_name}\",\"mobile\":\"${data.pick_tel}\"},{\"address\":\"${data.address}\",\"name\":\"${data.name}\",\"mobile\":\"${data.phone}\",\"cod\":${data.cod},\"remarks\":\"${data.note}\"}]`;\r\n    const options = {\r\n      params: {\r\n        \"url\": \"https://api.ahamove.com/v1/order/create\",\r\n        \"token\": data.token,\r\n        \"order_time\": data.order_time,\r\n        \"service_id\": data.service_id,\r\n        \"payment_method\": \"CASH\",\r\n        \"path\": x\r\n      }\r\n    }\r\n    return this.http.get(this.URL, options).toPromise();\r\n  }\r\n  getDetailBillAhamove(token, order_id) {\r\n\r\n    const options = {\r\n      params: {\r\n        \"url\": `https://api.ahamove.com/v1/order/detail`,\r\n        \"token\": token,\r\n        \"order_id\": order_id\r\n      }\r\n    }\r\n    return this.http.get(this.URL, options).toPromise();\r\n  }\r\n  cancelOrderAhamove(token, order_id) {\r\n\r\n    const options = {\r\n      params: {\r\n        \"url\": `https://api.ahamove.com/v1/order/cancel`,\r\n        \"token\": token,\r\n        \"order_id\": order_id,\r\n        \"comment\": \"No comment\"\r\n      }\r\n    }\r\n    return this.http.get(this.URL, options).toPromise();\r\n  }\r\n}\r\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GhnService {\r\n\r\n  constructor(private http: HttpClient) { }\r\n  /**\r\n  * kiểm tra token của giao hàng nhanh có hợp lệ hay không\r\n  * @example : this.transportService.connectTokenGhn(token).then(res =>{\r\n  * @param : tokenName\r\n  * @return :\r\n  **/\r\n  connectTokenGhn(token) {\r\n    let urlGhn = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shop/all';\r\n    const options = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n      })\r\n    }\r\n    return this.http.get(urlGhn, options).toPromise();\r\n  }\r\n  /**\r\n  * get các tỉnh trong nước Việt Nam\r\n  * @param token\r\n  * @example this.transportService.getProvinceGhn().then(res =>{})\r\n  * @return\r\n  **/\r\n  getProvinceGhn(token) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/master-data/province';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n      })\r\n    }\r\n    return this.http.get(url, opptions).toPromise();\r\n  }\r\n  /**\r\n  * get các huyện trong tỉnh của Việt Nam\r\n  * @param token ,province_id\r\n  * @example this.transportService.getDistrictGhn().then(res =>{})\r\n  * @return\r\n  **/\r\n  getDistrictGhn(token, province_id?) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/master-data/district';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n\r\n      }),\r\n      params: {\r\n        \"province_id\": province_id ? province_id : 0\r\n      }\r\n    }\r\n    return this.http.get(url, opptions).toPromise();\r\n  }\r\n  /**\r\n  * get các xã trong huyện của Việt Nam\r\n  * @param token ,district_id\r\n  * @example this.transportService.getWardGhn().then(res =>{})\r\n  * @return\r\n  **/\r\n  getWardGhn(token, district_id) {\r\n    let url = `https://online-gateway.ghn.vn/shiip/public-api/master-data/ward?${district_id}`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n      }),\r\n      params: {\r\n        \"district_id\": district_id\r\n      }\r\n    }\r\n    return this.http.get(url, opptions).toPromise();\r\n  }\r\n  /**\r\n  * tính phí vận chuyển\r\n  * @param token,data\r\n  * @example this.transportService.calculate_delivery_fee().then(res =>{})\r\n  * @return\r\n  **/\r\n  calculate_delivery_fee(token, data) {\r\n    let url = \"https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/fee\";\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n        \"ShopId\": data.shop_id.toString()\r\n      }),\r\n      params: {\r\n        \"service_id\": data.service_id,\r\n        \"to_ward_code\": data.to_ward_code,\r\n        \"from_district_id\": data.from_district_id,\r\n        \"height\": data.height,\r\n        \"length\": data.length,\r\n        \"weight\": data.weight,\r\n        \"width\": data.width,\r\n        \"insurance_value\": data.insurance_value,\r\n        \"to_district_id\": data.to_district_id\r\n      }\r\n    }\r\n    return this.http.get(url, opptions).toPromise();\r\n  }\r\n  /**\r\n  * chọn service : đi bộ, bay...\r\n  * @param token,data\r\n  * @example this.transportService.calculate_delivery_fee().then(res =>{})\r\n  * @return result { data : [service_id,short_name,service_type_id]}\r\n  **/\r\n  getServiceDelivery(token, data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/available-services';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n      }),\r\n      params: {\r\n        \"shop_id\": data.shop_id,\r\n        \"from_district\": data.from_district_id,\r\n        \"to_district\": data.to_district_id\r\n      }\r\n    }\r\n    return this.http.get(url, opptions).toPromise();\r\n  }\r\n  /**\r\n  * tạo đơn giao hàng\r\n  * @param data\r\n  * @example this.transportService.createOrderGhn().then(res =>{})\r\n  * @return\r\n  **/\r\n  createOrderGhn(data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/create';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Token\": data.token,\r\n        \"Content-Type\": \"application/json\",\r\n        \"ShopId\": data.shop_id.toString()\r\n      }),\r\n    }\r\n    let params = {\r\n      \"to_name\": data.to_name,\r\n      \"to_phone\": data.to_phone,\r\n      \"to_address\": data.to_address,\r\n      \"to_ward_code\": data.to_ward_code,\r\n      \"to_district_id\": data.to_district_id,\r\n      \"weight\": data.weight,\r\n      \"height\": data.height,\r\n      \"length\": data.length,\r\n      \"width\": data.width,\r\n      \"payment_type_id\": data.payment_type_id,\r\n      \"required_note\": data.required_note,\r\n      \"items\": data.items,\r\n      \"service_id\": data.service_id,\r\n      \"cod_amount\": data.cod_amount,\r\n      \"insurance_value\": data.insurance_value,\r\n      \"note\": data.note ? data.note : ''\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Tính (đoán) ngày vận chuyển hàng hoàn thành\r\n  * @param data;\r\n  * @example : this.transportService.calculateTheExpectedDeliveryTime().then(res =>{})\r\n  * @return :\r\n  **/\r\n  calculateTheExpectedDeliveryTime(token, data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/leadtime';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n        \"ShopId\": data.shop_id.toString()\r\n      }),\r\n    }\r\n    let params = {\r\n      \"from_district_id\": data.from_district_id,\r\n      \"from_ward_code\": data.from_ward_code,\r\n      \"to_district_id\": data.to_district_id,\r\n      \"to_ward_code\": data.to_ward_code,\r\n      \"service_id\": data.service_id\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n  getInfoOrder(token, order_code) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/detail';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n      }),\r\n    }\r\n    let params = {\r\n      \"order_code\": order_code\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n  cancelOrder(data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/switch-status/cancel';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": data.token,\r\n        \"ShopId\": data.shop_id.toString(),\r\n      }),\r\n    }\r\n    let params = {\r\n      \"order_codes\": data.order_code\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n  getOtpGhn(data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shop/affiliateOTP';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": \"5c8844f1-17f6-11eb-afc8-92a278719a56\", //gán cứng token\r\n      }),\r\n    }\r\n    let params = {\r\n      \"phone\": data.phone\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n  addStaffToStore(data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shop/affiliateCreateWithShop';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": \"5c8844f1-17f6-11eb-afc8-92a278719a56\",  //gán cứng token\r\n      }),\r\n    }\r\n    let params = {\r\n      \"phone\": data.phone,\r\n      \"otp\": data.otp,\r\n      \"shop_id\": data.shop_id\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n}\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { VhQuerySales } from 'ionic-vhframeworks';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GhtkService {\r\n  private URL: string = this.vhQuerySales.getShippingGHTKURL()\r\n  constructor(\r\n    private http: HttpClient,\r\n    private vhQuerySales: VhQuerySales\r\n  ) { }\r\n\r\n\r\n  /**\r\n  * kiểm tra token của giao hàng tiết kiệm có hợp lệ hay không và lấy thông tin kho\r\n  * @example : this.transportService.connectTokenGhtk(token).then(res =>{\r\n  * @param : tokenName\r\n  * @return :\r\n  **/\r\n  getWareHouseGhtk(token) {\r\n    // let options:any = {\r\n    //   method: 'GET',\r\n    //   url: 'http://115.78.100.57:8013/miscellaneous/ghtk',                       \r\n    //   params: {\r\n    //     token:token,\r\n    //     url: 'https://services.giaohangtietkiem.vn/services/shipment/list_pick_add'\r\n    //   }            \r\n    // };          \r\n    // return axios.request(options);\r\n    \r\n    const opptions = {\r\n      params: {\r\n        \"token\": token,\r\n        \"url\": 'https://services.giaohangtietkiem.vn/services/shipment/list_pick_add'\r\n      }\r\n    }\r\n\r\n    return this.http.get(this.URL, opptions).toPromise();\r\n  }\r\n  /**\r\n  * tính toán phí vận chuyển\r\n  * @example : this.transportService.calculateFeeGhtk(data,transport).then(res =>{\r\n  * @param : data,transport\r\n  * @return :\r\n  **/\r\n  calculateFeeGhtk(data, transport) {\r\n\r\n    const opptions = {\r\n      params: {\r\n        \"token\": data.token,\r\n        \"url\": \"https://services.giaohangtietkiem.vn/services/shipment/fee\"\r\n      }\r\n    }\r\n    let params = {\r\n      \"pick_address_id\": data.shop_id,\r\n      \"province\": data.province,\r\n      \"district\": data.district,\r\n      \"weight\": data.weight * 1000,\r\n      \"value\": data.insurance_value,\r\n      \"transport\": transport\r\n    }\r\n    \r\n    return this.http.post(this.URL, params, opptions).toPromise();\r\n  }\r\n  /**\r\n  * tính toán phí vận chuyển\r\n  * @example : this.transportService.calculateFeeGhtk(data,transport).then(res =>{\r\n  * @param : data,transport\r\n  * @return :\r\n  **/\r\n  createOrderGhtk(token, products, order) {\r\n\r\n    const opptions = {\r\n      params: {\r\n        \"token\": token,\r\n        \"url\": \"https://services.giaohangtietkiem.vn/services/shipment/order/?ver=1.6.3\"\r\n      }\r\n    }\r\n    let params = {\r\n      \"products\": products,\r\n      \"order\": order\r\n    }\r\n    return this.http.post(this.URL, params, opptions).toPromise();\r\n  }\r\n  getStatusBill(token, order_code) {\r\n\r\n    const opptions = {\r\n      params: {\r\n        \"token\": token,\r\n        \"url\": `https://services.giaohangtietkiem.vn/services/shipment/v2/${order_code}`\r\n      }\r\n    }\r\n    return this.http.get(this.URL, opptions).toPromise();\r\n  }\r\n  cancelOrder(token, order_code) {\r\n\r\n    const opptions = {\r\n      params: {\r\n        \"token\": token,\r\n        \"url\": `https://services.giaohangtietkiem.vn/services/shipment/cancel/${order_code}`\r\n      }\r\n    }\r\n    let params = {}\r\n    return this.http.post(this.URL, params, opptions).toPromise();\r\n  }\r\n}\r\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class VnpostService {\r\n  private URL_TEST = 'https://donhang-uat.vnpost.vn/api/api'\r\n  private URL_PRODUCT = 'https://donhang.vnpost.vn/api/api'\r\n  private URL_SERVER = 'https://us-central1-servers-1b3fe.cloudfunctions.net/app/shippingclouds/vietnampost'\r\n  private TenDangNhap: string = '0909925354'\r\n  private MatKhau: string = '123456'\r\n  constructor(\r\n    private http: HttpClient\r\n  ) {\r\n\r\n  }\r\n  getTokenVnpost() {\r\n    let url = `${this.URL_PRODUCT}/MobileAuthentication/GetAccessToken`;\r\n    let json: any = {\r\n      TenDangNhap: this.TenDangNhap,\r\n      MatKhau: this.MatKhau\r\n    }\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': 'none' }\r\n    }\r\n    return this.http.post(this.URL_SERVER, json, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Kiểm tra xem liệu khách hàng đã có mã CRM và đã ủy quyền cho Viethas đẩy đơn hay chưa\r\n   * @param token\r\n   * @param customer_code \r\n   * @returns \r\n   */\r\n  checkCustomerCode(token, customer_code) {\r\n    let url = `${this.URL_PRODUCT}/DoiTac/CheckCustomerCode`;\r\n    let json: any = { CustomerCode: customer_code }\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': token }\r\n    }\r\n    return this.http.post(this.URL_SERVER, json, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Lấy danh sách tỉnh / thành phố theo Vnpost\r\n   * @returns \r\n   */\r\n  getProvinceVnpost() {\r\n    let url = `${this.URL_PRODUCT}/TinhThanh/GetAll`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url }\r\n    }\r\n    return this.http.get(this.URL_SERVER, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Lấy danh sách quận/huyện theo Vnpost\r\n   * @returns \r\n   */\r\n  getDistrictVnpost() {\r\n    let url = `${this.URL_PRODUCT}/QuanHuyen/GetAll`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url }\r\n    }\r\n    return this.http.get(this.URL_SERVER, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Lấy danh sách phường/xã theo Vnpost\r\n   * @returns \r\n   */\r\n  getWardVnpost() {\r\n    let url = `${this.URL_PRODUCT}/PhuongXa/GetAll`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url }\r\n    }\r\n    return this.http.get(this.URL_SERVER, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Hàm này lấy danh sách tên các phương thức vận chuyển\r\n   */\r\n  getServiceNameVnpost(token, json: any) {\r\n    let url = `${this.URL_PRODUCT}/DoiTac/TinhCuocTatCaDichVu`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': token }\r\n    }\r\n    return this.http.post(this.URL_SERVER, json, opptions).toPromise();\r\n  }\r\n\r\n  /**\r\n   * Tạo order vnpost\r\n   */\r\n  createOrderVnpost(token, json: any) {\r\n    let url = `${this.URL_PRODUCT}/DoiTac/CreateOrder`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': token }\r\n    }\r\n    return this.http.post(this.URL_SERVER, json, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Tạo order vnpost\r\n   */\r\n  getDetailOrderById(token: string, Id: string) {\r\n    let url = `${this.URL_PRODUCT}/Order/GetOrder/${Id}`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': token }\r\n    }\r\n    return this.http.post(this.URL_SERVER, null, opptions).toPromise()\r\n  }\r\n  /**\r\n   * Delelte order vnpost\r\n   */\r\n  deleteOrderVnpostByID(token: string, Id: string) {\r\n    let url = `${this.URL_PRODUCT}/DoiTac/CancelOrder`;\r\n    let json = { OrderId: Id }\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': token }\r\n    }\r\n    return this.http.post(this.URL_SERVER, json, opptions).toPromise()\r\n  }\r\n\r\n  // --------------------------------CÁC HÀM XỬ LÝ DỮ LIỆU-------------------------------------------\r\n  /**\r\n   * Hàm này để custom dữ liệu cho hàm getServiceNameVnpost\r\n   */\r\n  renderFormatService(infoSend, infoRecei, infoProd, infoDeli, CustomerCode) {\r\n    return {\r\n      SenderDistrictId: infoSend.SenderDistrictId, SenderProvinceId: infoSend.SenderProvinceId,\r\n      ReceiverDistrictId: infoRecei.ReceiverDistrictId, ReceiverProvinceId: infoRecei.ReceiverProvinceId,\r\n      Weight: infoProd.WeightEvaluation, Width: infoProd.WidthEvaluation,\r\n      Length: infoProd.LengthEvaluation, Height: infoProd.HeightEvaluation,\r\n      CodAmount: +infoDeli.CodAmountEvaluation, IsReceiverPayFreight: infoDeli.IsReceiverPayFreight,\r\n      OrderAmount: +infoDeli.OrderAmountEvaluation, UseBaoPhat: false, UseHoaDon: false,\r\n      UseNhanTinSmsNguoiNhanTruocPhat: false, UseNhanTinSmsNguoiNhanSauPhat: false,\r\n      CustomerCode: CustomerCode\r\n    }\r\n  }\r\n  /**\r\n   * Hàm này để custom dữ liệu cho hàm createOrderVnpost\r\n   */\r\n  renderFormatCreateOrder(infoSend, infoRecei, infoProd, infoDeli, CustomerCode, bill_code) {\r\n    return {\r\n      SenderDistrictId: infoSend.SenderDistrictId, SenderProvinceId: infoSend.SenderProvinceId,\r\n      SenderTel: infoSend.SenderTel, SenderFullname: infoSend.SenderFullname, SenderAddress: infoSend.SenderAddress,\r\n      SenderWardId: infoSend.SenderWardId, ReceiverTel: infoRecei.ReceiverTel, ReceiverFullname: infoRecei.ReceiverFullname,\r\n      ReceiverAddress: infoRecei.ReceiverAddress, ReceiverWardId: infoRecei.ReceiverWardId,\r\n      ReceiverAddressType: infoDeli.ReceiverAddressType == 0 ? null : infoDeli.ReceiverAddressType, ServiceName: infoDeli.ServiceName, OrderCode: bill_code,\r\n      CustomerNote: infoDeli.CustomerNote, PickupType: 1,\r\n      ReceiverDistrictId: infoRecei.ReceiverDistrictId, ReceiverProvinceId: infoRecei.ReceiverProvinceId,\r\n      WeightEvaluation: infoProd.WeightEvaluation, WidthEvaluation: infoProd.WidthEvaluation,\r\n      LengthEvaluation: infoProd.LengthEvaluation, HeightEvaluation: infoProd.HeightEvaluation,\r\n      CodAmountEvaluation: +infoDeli.CodAmountEvaluation, IsReceiverPayFreight: infoDeli.IsReceiverPayFreight,\r\n      OrderAmountEvaluation: +infoDeli.OrderAmountEvaluation, UseBaoPhat: false, UseHoaDon: false,\r\n      PickupPoscode: \"\", CustomerCode: CustomerCode,\r\n      UseNhanTinSmsNguoiNhanTruocPhat: false, UseNhanTinSmsNguoiNhanSauPhat: false\r\n\r\n    }\r\n  }\r\n  renderFormatPrintOrder(delivery) {\r\n    \r\n    return {\r\n      created: delivery.CreateTime, customer_fullname: delivery.ReceiverFullname,\r\n      customer_tel: delivery.ReceiverTel, address: delivery.ReceiverFullAddress,\r\n      ship_money: delivery.TotalFreightIncludeVatEvaluation, insurance: 0,\r\n      is_freeship: delivery.IsReceiverPayFreight ? 0 : 1, CodAmountEvaluation: delivery.CodAmountEvaluation\r\n    }\r\n  }\r\n  // --------------------------------CÁC HÀM XỬ LÝ DỮ LIỆU-------------------------------------------\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///"}