{"version":3,"file":"default-src_app_sales_components_bill-type_bill-type-38_bill-type-38_module_ts.js","mappings":"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","sources":["./src/app/sales/components/bill-type/bill-type-38/add/add.component.ts","./src/app/sales/components/bill-type/bill-type-38/add/add.component.html","./src/app/sales/components/bill-type/bill-type-38/bill-type-38.module.ts","./src/app/sales/components/bill-type/bill-type-38/dettail/dettail.component.ts","./src/app/sales/components/bill-type/bill-type-38/dettail/dettail.component.html","./src/app/sales/components/bill-type/bill-type-38/edit/edit.component.ts","./src/app/sales/components/bill-type/bill-type-38/edit/edit.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\n\r\nimport { DestroyProductK57Col3Component } from 'src/app/sales/components/print/destroy-product/destroy-product-k57-col3/destroy-product-k57-col3.component';\r\nimport { DestroyProductK80Col3Component } from 'src/app/sales/components/print/destroy-product/destroy-product-k80-col3/destroy-product-k80-col3.component';\r\nimport { DestroyProductK80Col4Component } from 'src/app/sales/components/print/destroy-product/destroy-product-k80-col4/destroy-product-k80-col4.component';\r\nimport { DestroyProductA5Component } from 'src/app/sales/components/print/destroy-product/destroy-product-a5/destroy-product-a5.component';\r\nimport { DestroyProductA4Component } from 'src/app/sales/components/print/destroy-product/destroy-product-a4/destroy-product-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\n\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { VhBillType38Add, VhBillType38DetailAdd } from '../bill-type38-interface';\r\n\r\n\r\n@Component({\r\n  selector: 'bill-type38-add',\r\n  templateUrl: './add.component.html',\r\n  styleUrls: ['./add.component.scss']\r\n})\r\nexport class AddComponent implements OnInit {\r\n  display_promotion_selling_price: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').display_promotion_selling_price\r\n  invoice: VhBillType38Add = {\r\n    bill_type: 38,\r\n    date: new Date(),\r\n    id_branch: this.vhQuerySales.getDefaultBranch()._id,\r\n    id_employee: this.vhAuth.getUser()._id,\r\n    note: '',\r\n    total: 0,\r\n    bill_code: '',\r\n    tax: 0\r\n  }\r\n  invoice_detail: VhBillType38DetailAdd[] = []\r\n\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore\r\n\r\n  employee: any = {};\r\n  pickerTime = new Date();\r\n\r\n  printer: any;\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    private vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhAuth: VhAuth,\r\n    private fncService: FunctionService\r\n  ) {\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    // ------bắt sự kiện nhấn phím nóng-----\r\n    this.eventKeypress();\r\n  }\r\n  ngOnInit(): void {\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_destroy_product')\r\n    this.printer = printer ? printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)] : { discount_hidden: false, note_hidden: false, fee_hidden: false, tax_hidden: false, debt_hidden: false };\r\n    this.checkPrinter = this.printer.enable;\r\n\r\n\r\n\r\n  }\r\n  event: any // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n  }\r\n  checkPrinter: boolean = false;\r\n  /**\r\n   * lắng nghe sk nhấn f1 f2 f3 f4 trên bàn phím\r\n   * @example \r\n   */\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113) event.preventDefault();\r\n      if (keycode === 115) this.searchProductList = !this.searchProductList;\r\n      else if (this.invoice_detail.length > 0) {\r\n        switch (keycode) {\r\n          case 112: this.payInvoice(38, false)\r\n            break;\r\n          case 113: {\r\n            if (this.checkPrinter) this.payInvoice(38, true)\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  /**\r\n   *  hàm xóa sp trong bill_detail\r\n   * @param detail\r\n   * @example  this.deleteGoods(bill_detail_selected)\r\n   */\r\n  deleteGoods(detail: VhBillType38DetailAdd) {\r\n    this.vhComponent.alertConfirm(\"\", \"\", `${this.lang.translate(\"Delete\")} ${detail.name}?`, \"OK\", this.lang.translate(\"Cancel\"))\r\n      .then(() => this.removeInvoiceDetail(detail.id_product), () => { })\r\n  }\r\n  searchProductList: boolean = false;\r\n  /**\r\n * mở component chọn sp\r\n * @example this.openSearchProductList()\r\n */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n  /**\r\n   * nhận output từ component chọn sp (app-search-product)\r\n   * @param data sp được chọn để thêm vào bill\r\n   * @example this.closeSearchProductList(product_selected)\r\n   */\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      if (data.manylot && !data.lot_number) this.openModalChooseLot(data)\r\n      else\r\n        this.addInvoiceDetail(data);\r\n    }\r\n\r\n    this.searchProductList = false;\r\n  }\r\n  /**\r\n   * trở về trang quản lý hóa đơn xuất hủy\r\n   * @example this.goBack()\r\n   */\r\n  goBack() {\r\n    this.vhComponent.alertConfirm(`${this.lang.translate(\"Confirm\")}`, \"\", `${this.lang.translate(\"Bạn muốn thoát và không lưu hóa đơn này\")} ?`, \"OK\", this.lang.translate('Cancel'))\r\n      .then(() => { this.isExit = true; this.router.navigate([\"/sales/dashboard/manage/stock/destroy-product\"], { state: this.dataRestore }) }, () => { })\r\n  }\r\n  /**\r\n   * bắt sk thay đổi số lượng sp trong bill\r\n   * @param product \r\n   * @param event : giá trị thay đổi\r\n   * @example this.checkQuantityProduct(bill_detail_selected, 1)\r\n   */\r\n  checkQuantityProduct(product: VhBillType38DetailAdd, event) {\r\n    if (!event) product.quantity = 1;\r\n    ;\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi đơn vị của bill_detail\r\n   * @param ev  ratio được chọn\r\n   * @param item\r\n   * @example  this.changeUnit(24, bill_detail_selected)\r\n   */\r\n  changeUnit(ev, item) {\r\n    let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n    if (unit) {\r\n      item.unit = unit.unit\r\n      item.price = parseFloat(unit.price)\r\n      item.ratio = parseFloat(unit.ratio)\r\n      item.price_origin = parseFloat(unit.price)\r\n    }\r\n\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhBillType38DetailAdd;\r\n  /**\r\n  * mở modal thay đổi giá bán sản phẩm trong bill\r\n  * @param detail \r\n  * @example this.openEditUnitPrice(bilL_detail_selected)\r\n  */\r\n  openEditUnitPrice(detail: VhBillType38DetailAdd) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n  /**\r\n   * bắt sk nhấn nút Ok modal giảm giá sp\r\n   * @example this.handleEditUnit()\r\n   */\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      ;\r\n      this.isVisibleEditUnitPrice = false;\r\n    } else { this.vhComponent.showToast(2000, this.lang.translate(\"Invalid data, please check again\"), \"alert-toast\") }\r\n  }\r\n  /**\r\n   * tắt modal giảm giá sp\r\n   * @example this.handleCancelEditUnit()\r\n   */\r\n  handleCancelEditUnit() { this.isVisibleEditUnitPrice = false }\r\n  // -------set employee-------\r\n  /**\r\n   * bắt sk thay đổi nv bán hàng\r\n   * @param event id_employee selected\r\n   */\r\n  closeAndReceiveEmployee(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n    }\r\n  }\r\n  /**\r\n   * bắt sk thay đổi date của hóa đơn , gán lại giá trị date mới cho đơn\r\n   * @example this.setPickerTime('2023-06-12T08:02:27.697Z')\r\n   */\r\n  setPickerTime(event) {\r\n    if (new Date(event).getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.lang.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 5000)\r\n      this.pickerTime = new Date(this.invoice.date)\r\n      this.invoice.date = (new Date(this.pickerTime));\r\n    }\r\n    else this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        this.invoice.date = (event);\r\n      }\r\n      else {\r\n        this.pickerTime = new Date(validitydate)\r\n        this.invoice.date = (new Date(this.pickerTime));\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.lang.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  /**\r\n   * trờ về trang danh sách hóa đơn sau khi đã thanh toán xong\r\n   * @example this.handle(true)\r\n   */\r\n  handle() {\r\n    this.isExit = true;\r\n    this.router.navigate(['/sales/dashboard/manage/stock/destroy-product'], { state: this.dataRestore })\r\n  }\r\n  note: string;\r\n  /**\r\n   * bắt sk thay đổi note của bill\r\n   * @example this.edit_note()\r\n   */\r\n  edit_note() {\r\n    if (this.note) {\r\n      this.invoice.note = (this.note)\r\n    }\r\n  }\r\n  save_enable = true;\r\n\r\n  /**\r\n    * xử lý sk nhấn nút thanh toán hoặc lưu tạm\r\n    * @param bill_type \r\n    * @param print biến cờ để check in hay ko\r\n    * @example this.payInvoice(1)\r\n    */\r\n  payInvoice(bill_type: 38, print?) {\r\n    if (this.vhAuth.checkMyPermission(\"purchase_enable_payment\")) {\r\n      this.vhComponent.alertConfirm(\r\n        `${this.lang.translate(\"Complete\")} ?`,\r\n        \"\", \"\", \"OK\", this.lang.translate(\"Cancel\")\r\n      ).then(() => {\r\n        if (this.save_enable) {\r\n          this.save_enable = false;\r\n          this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n            var arrayProcess: any[] = [this.createOrUpdate(bill_type)];\r\n            Promise.all(arrayProcess)\r\n              .then((bill) => {\r\n                this.save_enable = true;\r\n                this.vhComponent.hideLoading(0).then(() => {\r\n                  this.vhComponent.showToast(2000, `${this.lang.translate(\"Hóa đơn xuất hủy\")} ${bill[0].bill_code || this.invoice.bill_code} ${this.lang.translate(\"has been created successfully\")}`, \"success-toast\")\r\n                  if (print) this.handlePrint()\r\n                  else this.handle()\r\n                })\r\n              })\r\n          }).catch(err => { this.save_enable = true;this.vhComponent.hideLoading(0) })\r\n        }\r\n      }, () => { })\r\n    }\r\n    else this.vhComponent.showToast(1500, this.lang.translate('You do not have this rights'), \"alert-toast\")\r\n  }\r\n  /**\r\n   * tạo bill lên DB\r\n   * @param bill_type \r\n   * @returns \r\n   */\r\n  createOrUpdate(bill_type: 38) {\r\n    return this.vhQuerySales.createBill_Billdetail(this.invoice, this.getCreateUpdateInvoiceDetail())\r\n  }\r\n\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_destroy_product')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n  /**\r\n   * kiểm tra dữ liệu thông tin máy in và mở component in\r\n   * @example this.handlePrint()\r\n   */\r\n  handlePrint() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice_detail: this.invoice_detail, invoice: this.invoice }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.handle())\r\n        })\r\n    }, (err) =>\r\n      this.vhComponent.alertMessage(this.lang.translate(\"Function\"), \"\", this.lang.translate(\"Please turn on the printer function\"), \"OK\")\r\n        .then(() => this.handle())\r\n    )\r\n  }\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return (DestroyProductK57Col3Component)\r\n      case 'print_size_k80_3c': return (DestroyProductK80Col3Component)\r\n      case 'print_size_k80_4c': return (DestroyProductK80Col4Component)\r\n      case 'print_size_a5': return (DestroyProductA5Component)\r\n      case 'print_size_a4': return (DestroyProductA4Component)\r\n      default: return (DestroyProductA4Component)\r\n    }\r\n  }\r\n  // ------thoát trang-----\r\n  isExit: boolean = false;\r\n  show_modal_select_lots = false;\r\n  list_search_lot = [];\r\n\r\n  /**\r\n   * trả về tên lô theo id_lot được chọn\r\n   * @param lots \r\n   * @param _id \r\n   * @returns string\r\n   * @example this.getLotNumber([], 'DJWOIDHIEUGHWDSJDNWIHD')\r\n   */\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id);\r\n    return lot.lot_number\r\n  }\r\n  /**\r\n   * lọc danh sách lô của sp theo số lô (lot_number)\r\n   * @param value \r\n   */\r\n  searchLot(value) {\r\n    this.tempDetail.lots = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.list_search_lot, ['lot_number'])\r\n  }\r\n  /**\r\n   * mở modal chọn lô cho sp\r\n   * @param data \r\n   * @example this.openModalChooseLot(bill_detail_selected)\r\n   */\r\n  openModalChooseLot(data) {\r\n    this.tempDetail = data\r\n    this.list_search_lot = this.tempDetail.lots\r\n    if (!this.list_search_lot.length) this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Sản phẩm này không có lô khả dụng để bán!\"))\r\n    else this.show_modal_select_lots = true;\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi id_lotnumber của bill-detail\r\n   * @param e id_lotnumber thay đổi\r\n   * @example this.changeLot('DNIUHWIDCHBIQOHSDOIHW')\r\n   */\r\n  changeLot(e) {\r\n    this.tempDetail.lot_number = this.tempDetail.lots.find(item => item._id == e).lot_number\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút ok của modal chọn lô sp\r\n   * @example this.handleChooseLot()\r\n   */\r\n  handleChooseLot() {\r\n    \r\n\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot;\r\n    if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút hủy modal chọn lô sp\r\n   * @example this.handleCancelChooseLot()\r\n   */\r\n  handleCancelChooseLot() {\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot\r\n  }\r\n\r\n  /**Thêm sản phẩm vô bill detail */\r\n  public addInvoiceDetail(value: any) {\r\n    if (value['id_subproduct']) {\r\n      if (value.lot_number) {\r\n        let index = this.invoice_detail.findIndex(detail => detail['lot_number'] == value['lot_number'] && detail['id_lotproduct'] == value['id_lotproduct'])\r\n        if (index != -1) {\r\n          if (this.invoice_detail[index]['quantity'] < 9999999999) this.invoice_detail[index]['quantity'] += 1\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n      else {\r\n        let index = this.invoice_detail.findIndex(detail => detail['id_subproduct'] == value['id_subproduct'] && detail['ratio'] == value['ratio'])\r\n        if (index != -1) {\r\n          if (this.invoice_detail[index]['quantity'] < 9999999999) this.invoice_detail[index]['quantity'] += 1\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n    }\r\n    else {\r\n      if (value.lot_number) {\r\n        let index = this.invoice_detail.findIndex(detail => detail['lot_number'] == value['lot_number'] && detail['id_lotproduct'] == value['id_lotproduct'])\r\n        if (index != -1) {\r\n          if (this.invoice_detail[index]['quantity'] < 9999999999) this.invoice_detail[index]['quantity'] += 1\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n      else {\r\n        let index = this.invoice_detail.findIndex(detail => detail['id_product'] == value['_id'] && detail['ratio'] == value['ratio'])\r\n        if (index != -1) {\r\n          if (this.invoice_detail[index]['quantity'] < 9999999999) this.invoice_detail[index]['quantity'] += 1\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n  }\r\n\r\n  /**\r\n   * xử lý các trường của sp được chọn và thêm vào mảng local\r\n   * @param value \r\n   * @param new_price \r\n   * @example  this.addBill_Detail(product_selected)\r\n   */\r\n  addBill_Detail(value) {\r\n    this.invoice_detail.unshift({\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      unit: value.unit,\r\n      units: value.units,\r\n      ratio: value.ratio ? value.ratio : 1,\r\n      ptype: value.type,\r\n      price: 0,\r\n      price_origin: value.price_import,\r\n      id_subproduct: value.id_subproduct,\r\n      lots: value.lots,\r\n      lot_number: value.lot_number,\r\n      id_lotproduct: value.id_lotproduct,\r\n\r\n    })\r\n\r\n\r\n  }\r\n  /**Thêm sản phẩm vô bill detail */\r\n  public addInvoiceDetailMutilLine(value: any) {\r\n    this.invoice_detail.push({\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      unit: value.unit,\r\n      units: value.units,\r\n      ratio: value.ratio ? value.ratio : 1,\r\n      ptype: value.type,\r\n      price: 0,\r\n      price_origin: value.price_import,\r\n      id_subproduct: value.id_subproduct,\r\n      lots: value.lots,\r\n      lot_number: value.lot_number,\r\n      id_lotproduct: value.id_lotproduct,\r\n\r\n    })\r\n\r\n\r\n\r\n  }\r\n  /**\r\n   * xóa 1 bill_detail trong local\r\n   * @param id id_bill_detail selected\r\n   * @param notSetSub \r\n   */\r\n  removeInvoiceDetail(id: string) {\r\n    let index = this.invoice_detail.findIndex(detail => detail['id_product'] == id)\r\n    if (index != -1) {\r\n      this.invoice_detail.splice(index, 1);\r\n\r\n    }\r\n  }\r\n  /**\r\n   * trả về dữ liệu thông tin bill_detail clean để lưu DB\r\n   * @returns array[object]\r\n   *  @example let bill_details = this.getCreateUpdateInvoiceDetail()\r\n   */\r\n  public getCreateUpdateInvoiceDetail(): VhBillType38DetailAdd[] {\r\n    return this.invoice_detail.map(item => {\r\n      let detail: VhBillType38DetailAdd = {\r\n        id_product: item.id_product,\r\n        price: item.price,\r\n        quantity: item.quantity,\r\n        ptype: item.ptype,\r\n        ratio: item.ratio ? item.ratio : 1,\r\n      }\r\n      if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct\r\n      if (item.id_subproduct) detail['id_subproduct'] = item.id_subproduct\r\n      if (item.price < item.price_origin) detail['price_origin'] = item.price_origin\r\n      return detail\r\n    })\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}} |  <b> {{'Create cancellation order' | translate}}</b>\r\n</div>\r\n\r\n<nz-layout>\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{\"Select product\" | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n                    <div>\r\n                        <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                            (click)=\"openSearchProductList()\">\r\n                            <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                            {{'Search (F4)' | translate}}\r\n                        </button>\r\n                    </div> \r\n                </div>\r\n\r\n                <div *ngIf=\"!invoice_detail.length\" class=\"no-data\">\r\n                    <p>{{'Please select a product' | translate}}</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\" *ngFor=\"let item of invoice_detail,index as i\">\r\n                    <div nz-row>\r\n                        <div (click)=\"deleteGoods(item,i)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"12\" class=\"center-col\">\r\n                            <p class=\"max-width-two-line\">\r\n                                <b>{{item.name}}</b>  <br>\r\n                                <ng-container *ngIf=\"item.id_lotproduct\">\r\n                                    <pre  style=\"color:var(--ion-color-vh-green);cursor: pointer;\"  (click)=\"openModalChooseLot(item)\">\r\n                                        {{getLotNumber(item.lots, item.id_lotproduct)}}\r\n                                    </pre>\r\n                                    \r\n                                  </ng-container>\r\n                            </p> \r\n                        </div>\r\n                        <div nz-col nzSpan=\"6\" style=\"align-self: center;\">\r\n                            <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.ratio\"\r\n                                (ngModelChange)=\"changeUnit($event,item)\">\r\n                                <!-- <nz-option [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option> -->\r\n                                <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\"\r\n                                    [nzValue]=\"i.ratio\"></nz-option>\r\n                            </nz-select>\r\n                        </div>\r\n                        <div class=\"text-align-self\" nz-col nzSpan=\"5\">\r\n                            <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                (ngModelChange)=\"checkQuantityProduct(item,$event)\"></nz-input-number>\r\n                        </div>\r\n                        <!-- <div (click)=\"openEditUnitPrice(item)\" class=\"invoiceDetail-item-quantity text-end\" nz-col\r\n                            nzSpan=\"4\">\r\n                            <p class=\"max-width-two-line\"><span>{{vhAlgorithm.vhcurrencyunit(item.price)}}</span>\r\n                                <del style=\"font-size: 0.7rem;\">\r\n                                    {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin)\r\n                                    : ''}}\r\n                                </del>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"4\" class=\"money-sub\">\r\n                            <p class=\"max-width-two-line\">\r\n                                <b>{{vhAlgorithm.vhcurrencyunit(item.price*item.quantity)}}</b>\r\n                            </p>\r\n                        </div> -->\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Employee' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_employee\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveEmployee($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Note' | translate}}</b>\r\n                \r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\" *ngIf=\"!printer.note_hidden\">\r\n                    <textarea class=\"nz-hover-border\" [(ngModel)]=\"note\" (blur)=\"edit_note()\" nz-input\r\n                        placeholder=\"{{'Enter note...' | translate}}\"\r\n                        [nzAutosize]=\"{ minRows: 2, maxRows: 4 }\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!invoice_detail.length  || !checkPrinter\"\r\n                    (click)=\"payInvoice(38,true)\" nz-button class=\"order-and-print\">\r\n                    {{\"Complete & Print\"|translate}} (F2)\r\n                </button>\r\n                <button [disabled]=\"!invoice_detail.length \"\r\n                    (click)=\"payInvoice(38,false)\" nz-button class=\"order\">\r\n                    {{\"Complete\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n\r\n<!-- -----nz-drawer list-product-------- -->\r\n<app-search-product-import [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product-import>\r\n\r\n<!--Modal edit inut price-->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Edit unit price' | translate}}\" (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Unit price' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\" [value]=\"tempDetail.price\" nz-input\r\n                    placeholder=\"{{'Enter unit price' | translate}}\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- modal chọn lô/HSD -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice2\" [(nzVisible)]=\"show_modal_select_lots\"\r\n    nzTitle=\"{{'Select lot number' | translate}}\" (nzOnCancel)=\"handleCancelChooseLot()\" (nzOnOk)=\"handleChooseLot()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input type=\"text\" nz-input placeholder=\"{{'Find lot number' | translate}}\" #searchValue (keyup)=\"searchLot(searchValue.value )\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <nz-radio-group [(ngModel)]=\"tempDetail.id_lotproduct\" (ngModelChange)=\"changeLot($event)\" style=\"width:100%;\">\r\n            <div nz-row *ngFor=\"let item of tempDetail.lots\" >\r\n                <div nz-col nzSpan=\"24\">\r\n                    <label class=\"radio-purchase\" nz-radio [nzValue]=\"item._id\" style=\"width:100%;\">\r\n                        <div nz-row>\r\n                            <div nz-col nzSpan=\"8\">\r\n                                {{item.lot_number}}\r\n                            </div>\r\n                            \r\n                            <div nz-col nzSpan=\"8\">\r\n                                NSX: {{item.date_mfg | date : 'dd/MM/yyyy'}}\r\n                             </div>\r\n                             <div nz-col nzSpan=\"8\">\r\n                                HSD: {{item.date_exp | date : 'dd/MM/yyyy'}}\r\n                             </div>\r\n                        </div>\r\n                        \r\n                    </label>\r\n                </div>\r\n                \r\n            </div>\r\n        </nz-radio-group>\r\n        <div  *ngIf=\"!tempDetail.lots.length\" style=\"text-align: center;\">{{'No data' | translate}}</div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice2>\r\n        <div>\r\n            <button nz-button class=\"nz-hover-border\"\r\n                style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\"\r\n                nzType=\"default\" (click)=\"handleCancelChooseLot()\">{{\"Cancel\"\r\n                |translate}}</button>\r\n            <button nz-button class=\"nz-hover-border\" [disabled]=\"!tempDetail.id_lotproduct\"\r\n                style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n                class=\"nz-hover-border-green\" (click)=\"handleChooseLot()\">{{\"Ok\" | translate}}</button>\r\n        </div>\r\n    </ng-template>\r\n</nz-modal>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { AddComponent } from './add/add.component';\r\nimport { EditComponent } from './edit/edit.component';\r\nimport { DettailComponent } from './dettail/dettail.component';\r\nimport { NgZorroAntModule } from 'src/app/ng-zorro-ant.module';\r\nimport { ComponentsBillType2Module } from 'src/app/sales/menu/manage/invoices/purchase/components/components.module';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { SearchModule } from '../../search/search.module';\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddComponent,\r\n    EditComponent,\r\n    DettailComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    NgZorroAntModule,\r\n    ComponentsBillType2Module,\r\n    TranslateModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    SearchModule\r\n  ],\r\n  exports: [\r\n    AddComponent,\r\n    EditComponent,\r\n    DettailComponent\r\n  ],\r\n})\r\nexport class BillType38Module { }\r\n","\r\nimport { ChangeDetectorRef, Component, Input } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { DestroyProductK57Col3Component } from 'src/app/sales/components/print/destroy-product/destroy-product-k57-col3/destroy-product-k57-col3.component';\r\nimport { DestroyProductK80Col3Component } from 'src/app/sales/components/print/destroy-product/destroy-product-k80-col3/destroy-product-k80-col3.component';\r\nimport { DestroyProductK80Col4Component } from 'src/app/sales/components/print/destroy-product/destroy-product-k80-col4/destroy-product-k80-col4.component';\r\nimport { DestroyProductA5Component } from 'src/app/sales/components/print/destroy-product/destroy-product-a5/destroy-product-a5.component';\r\nimport { DestroyProductA4Component } from 'src/app/sales/components/print/destroy-product/destroy-product-a4/destroy-product-a4.component';\r\n\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { VhBillType38Edit, VhBillType38DetailEdit, } from '../bill-type38-interface';\r\n\r\n@Component({\r\n  selector: 'bill-type38-detail',\r\n  templateUrl: './dettail.component.html',\r\n  styleUrls: ['./dettail.component.scss']\r\n})\r\nexport class DettailComponent {\r\n  @Input() url = '';\r\n\r\n  printer: any;\r\n  tableHeight: string;\r\n  public invoiceInfo: any;\r\n  invoice_detail: VhBillType38DetailEdit[] = []\r\n  public invoice: VhBillType38Edit\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore\r\n\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private vhQuerySales: VhQuerySales,\r\n    private lang: LanguageService,\r\n    private vhAuth: VhAuth,\r\n    private vhComponent: VhComponent,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private cdRef: ChangeDetectorRef,\r\n    private fncService: FunctionService\r\n  ) {\r\n    this.getDataInvoice(this.router.getCurrentNavigation().extras.state.id)\r\n\r\n\r\n  }\r\n\r\n  /**\r\n   * gán bill và bill-detail get được vào biến và get các thông tin của nv, khách hàng, phương thức thanh toán\r\n   * @example this.init(bill, bill-deails)\r\n   */\r\n  init(invoice: VhBillType38Edit = null, invoiceDetail: VhBillType38DetailEdit[] = null) {\r\n    \r\n\r\n    this.invoice = invoice\r\n    this.invoice_detail = invoiceDetail\r\n    if (invoice && invoiceDetail) {\r\n      this.invoiceInfo = {\r\n        employee: this.vhAuth.getlocalEmployee(this.invoice.id_employee),\r\n      }\r\n    } else this.invoiceInfo = { employee: {} }\r\n\r\n  }\r\n\r\n  /**\r\n   * get dữ liệu bill từ DB\r\n   * @param id : nhận từ state truyền qua\r\n   * @example this.getDataInvoice('DHIWHNXDIWODUHIWDHOWID')\r\n   */\r\n  private getDataInvoice(id) {\r\n    this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n      Promise.all([\r\n        this.vhQuerySales.getBill(id),\r\n        this.vhQuerySales.getBill_details_byId_bill(id)\r\n      ]).then(([invoice, invoiceDetail]: any) => {\r\n        if (!invoiceDetail.length)\r\n          this.init(invoice, [])\r\n        else {\r\n          invoiceDetail = this.vhAlgorithm.sortVietnamesebyASC(invoiceDetail, 'name');\r\n          this.init(invoice, invoiceDetail)\r\n        }\r\n        this.vhComponent.hideLoading(0)\r\n      })\r\n    })\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * trả về tên unit của sản phẩm theo ratio truyền vào\r\n   * @param units \r\n   * @param ratio \r\n   * @returns string\r\n   * @example let unit_name = this.getUnit([object], 1)\r\n   */\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit\r\n  }\r\n\r\n  /**\r\n   * trả về chuỗi thông tin lô theo id lô truyền vào\r\n   * @param lots \r\n   * @param _id \r\n   * @returns string\r\n   * @example let lot = this.getLotNumber([], 'DNIWUHNDKLJWHDIWUOH')\r\n   */\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id)\r\n    return lot.lot_number + '\\n' + this.fncService.formatDate(lot.date_mfg) + ' - ' + this.fncService.formatDate(lot.date_exp)\r\n  }\r\n  /**\r\n   * xóa hóa đơn lên DB\r\n   * @example this.deleteInvoice()\r\n   */\r\n  deleteInvoice() {\r\n    this.vhQuerySales.getValidityDate(this.invoice.date).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        this.vhComponent.alertConfirm(this.lang.translate(\"Confirm\"), \"\", `${this.lang.translate(\"Delete\")}?`, \"OK\", this.lang.translate(\"Cancel\"))\r\n          .then(() => {\r\n            this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n              this.vhQuerySales.deleteBill_Billdetail(this.invoice._id).then(() => {\r\n                this.vhComponent.hideLoading(0).then(() => {\r\n                  this.dataRestore.invoice = this.dataRestore.invoice.filter(e => e._id != this.invoice._id)\r\n                  this.vhComponent.showToast(2000,\r\n                    `${this.lang.translate(\"Hóa đơn xuất hủy\")} ${this.invoice.bill_code} ${this.lang.translate(\"has been cancelled successfully\")}`, \"success-toast\")\r\n                  this.router.navigate([this.url])\r\n                })\r\n              })\r\n            })\r\n          }, () => { })\r\n      }\r\n      else {\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.lang.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n\r\n  }\r\n  public goToCart() {\r\n    this.vhQuerySales.getValidityDate(this.invoice.date).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        this.router.navigate([this.url + '/edit'], { state: { invoiceDetail: this.invoice_detail, invoice: this.invoice, dataRestore: this.dataRestore, } })\r\n      }\r\n      else {\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.lang.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n\r\n  }\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_destroy_product')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n\r\n  /**\r\n   * kiểm tra thông tin dữ liệu trang in và mở component in\r\n   * @example this.printInvoice()\r\n   */\r\n  printInvoice() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice_detail: this.invoice_detail, invoice: this.invoice }, false, false, `modal-print-${printer['_id']}`)\r\n    }, (err) => {\r\n      let state: any = \"Xuất hủy hàng hóa\"\r\n      this.vhComponent.alertMessage(this.lang.translate(\"Function\"), \"\", this.lang.translate(\"Please turn on the printer function\"), \"OK\")\r\n        .then(() => this.router.navigate(['/sales/dashboard/manage/printer', 'page_desktop_destroy_product'], { state: state }))\r\n    })\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return (DestroyProductK57Col3Component)\r\n      case 'print_size_k80_3c': return (DestroyProductK80Col3Component)\r\n      case 'print_size_k80_4c': return (DestroyProductK80Col4Component)\r\n      case 'print_size_a5': return (DestroyProductA5Component)\r\n      case 'print_size_a4': return (DestroyProductA4Component)\r\n      default: return (DestroyProductA4Component)\r\n    }\r\n  }\r\n  goBack() {\r\n    this.router.navigate([this.url], { state: this.dataRestore })\r\n  }\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\"#delivery-good-detail-invoice\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".delivery-good-detail-invoice-header\") && document.querySelector(\".ant-table-pagination\")) {\r\n      this.tableHeight = document.querySelector(\"#delivery-good-detail-invoice\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".delivery-good-detail-invoice-header\").clientHeight - document.querySelector(\".ant-table-pagination\").clientHeight - 40 + \"px\";\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n<nz-layout id=\"purchase-invoice-detail-today\" *ngIf=\"invoice\">\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header sales-invoice-detail-today-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{'Destroy goods' | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"center-all-content\">\r\n                    <button (click)=\"goToCart()\" class=\"btn-data nz-hover-border center-all-content\" nz-button nzType=\"default\">\r\n                        <ion-icon style=\"margin-right: 5px;\" src=\"assets/icon/Iconfeather-edit.svg\"></ion-icon>\r\n                        {{'Edit' | translate}}\r\n                      </button>\r\n                    <button (click)=\"printInvoice()\" class=\"btn-data nz-hover-border center-all-content\" nz-button nzType=\"default\">\r\n                        <ion-icon style=\"margin-right: 5px;\" src=\"assets/icon/management/printer.svg\"></ion-icon>\r\n                        {{'Print' | translate}}\r\n                    </button>\r\n                    <button   (click)=\"deleteInvoice()\" class=\"btn-data nz-hover-border center-all-content\" nz-button nzType=\"default\">\r\n                        <ion-icon style=\"margin-right: 5px;\" name=\"trash-outline\"></ion-icon>\r\n                        {{'Delete' | translate}}\r\n                    </button>\r\n                </div> \r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\">\r\n                    <nz-table [nzScroll]=\"{ y: tableHeight }\" [nzData]=\"invoice_detail\" #rowSelectionTable nzShowSizeChanger nzNoResult=\"{{'No data' | translate}}\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th nzWidth=\"30%\"><b>{{'Product name' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='center'><b>{{'Unit' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='center'><b>{{'Quantity' | translate}}</b></th>\r\n                                <th nzWidth=\"20%\" nzAlign='right'><b>{{'Unit price' | translate}}</b></th>\r\n                                \r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr *ngFor=\"let item of rowSelectionTable.data\" style=\"cursor: pointer;\">\r\n                                <td>{{item.name}} <br>  <ng-container *ngIf=\"item.id_lotproduct\">\r\n                                    <span style=\"font-size: 0.85rem;\">\r\n                                        {{getLotNumber(item.lots, item.id_lotproduct)}}\r\n                                       \r\n                                    </span> \r\n                                    <span style=\"font-size: 0.85rem;\">\r\n                                       <br> {{getDateLotNumber(item.lots, item.id_lotproduct)}} \r\n                                    </span> \r\n                                  </ng-container></td>\r\n                                <td nzAlign='center'>{{getUnit(item.units, item.ratio)}}</td>\r\n                                <td nzAlign='center'>{{item.quantity}}</td>\r\n                                <td nzAlign='right'>\r\n                                    {{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n                                    <del style=\"font-size: 0.7rem;\">\r\n                                        {{item.price_origin > item.price ?\r\n                                        vhAlgorithm.vhcurrencyunit(item.price_origin): ''}}\r\n                                    </del>\r\n                                </td>\r\n                                \r\n                            </tr>\r\n                        </tbody>\r\n                    </nz-table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills not-continue-sell\" >\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div>\r\n                    <b>{{'Invoice code' | translate}}</b>\r\n                    <div> {{invoice.bill_code}}</div>\r\n                </div>\r\n                <div>\r\n                    <b>{{'Employee' | translate}}</b>\r\n                    <div>{{invoiceInfo.employee.name}}</div>\r\n                </div>\r\n                <div>\r\n                    <b>{{'Date' | translate}}</b>\r\n                    <div>{{invoice.date | date: 'dd/MM/yyyy HH:mm'}}</div>\r\n                </div>\r\n            </div> \r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                 \r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\"  >\r\n                    <span>{{'Note' | translate}}</span>\r\n                    <div>{{invoice.note}}</div>\r\n                </div>\r\n            </div> \r\n        </div>\r\n    </div>\r\n</nz-layout>","import { Component, Input, OnInit } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { DestroyProductK57Col3Component } from 'src/app/sales/components/print/destroy-product/destroy-product-k57-col3/destroy-product-k57-col3.component';\r\nimport { DestroyProductK80Col3Component } from 'src/app/sales/components/print/destroy-product/destroy-product-k80-col3/destroy-product-k80-col3.component';\r\nimport { DestroyProductK80Col4Component } from 'src/app/sales/components/print/destroy-product/destroy-product-k80-col4/destroy-product-k80-col4.component';\r\nimport { DestroyProductA5Component } from 'src/app/sales/components/print/destroy-product/destroy-product-a5/destroy-product-a5.component';\r\nimport { DestroyProductA4Component } from 'src/app/sales/components/print/destroy-product/destroy-product-a4/destroy-product-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\n\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { VhBillType38Edit, VhBillType38DetailEdit, VhBillType38DetailAdd } from '../bill-type38-interface';\r\n@Component({\r\n  selector: 'bill-type38-edit',\r\n  templateUrl: './edit.component.html',\r\n  styleUrls: ['./edit.component.scss']\r\n})\r\nexport class EditComponent {\r\n   \r\n  invoice: VhBillType38Edit =   this.router.getCurrentNavigation().extras.state.invoice\r\n  invoice_detail: VhBillType38DetailAdd[] =  this.router.getCurrentNavigation().extras.state.invoiceDetail\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore\r\n  @Input() url = '';\r\n  employee: any = {};\r\n  pickerTime = new Date();\r\n   \r\n   \r\n  printer: any;\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    private vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhAuth: VhAuth,\r\n    private fncService: FunctionService\r\n  ) {\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee); \r\n    // ------bắt sự kiện nhấn phím nóng-----\r\n    this.eventKeypress();\r\n  }\r\n  ngOnInit(): void {\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_destroy_product')\r\n    this.printer = printer ? printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)] : { discount_hidden: false, note_hidden: false, fee_hidden: false, tax_hidden: false, debt_hidden: false };\r\n    this.checkPrinter = this.printer.enable;\r\n\r\n\r\n\r\n  }\r\n  event: any // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n  }\r\n  checkPrinter: boolean = false;\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113) event.preventDefault();\r\n      if (keycode === 115) this.searchProductList = !this.searchProductList;\r\n      else if (this.invoice_detail.length > 0) {\r\n        switch (keycode) {\r\n          case 112: this.payInvoice(38, false)\r\n            break;\r\n          case 113: {\r\n            if (this.checkPrinter) this.payInvoice(38, true)\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  deleteGoods(detail: VhBillType38DetailAdd) {\r\n    this.vhComponent.alertConfirm(\"\", \"\", `${this.lang.translate(\"Delete\")} ${detail.name}?`, \"OK\", this.lang.translate(\"Cancel\"))\r\n      .then(() => this.removeInvoiceDetail(detail.id_product), () => { })\r\n  }\r\n  searchProductList: boolean = false;\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      if (data.manylot && !data.lot_number) this.openModalChooseLot(data)\r\n      else\r\n        this.addInvoiceDetail(data);\r\n    }\r\n\r\n    this.searchProductList = false;\r\n  }\r\n  goBack() {\r\n    this.vhComponent.alertConfirm(`${this.lang.translate(\"Confirm\")}`, \"\", `${this.lang.translate(\"Bạn muốn thoát và không lưu hóa đơn này\")} ?`, \"OK\", this.lang.translate('Cancel'))\r\n      .then(() => { this.isExit = true; this.router.navigate([this.url], { state: this.dataRestore }) }, () => { })\r\n  }\r\n  checkQuantityProduct(product: VhBillType38DetailAdd, event) {\r\n    if (!event) product.quantity = 1;\r\n    ;\r\n  }\r\n\r\n  changeUnit(ev, item) {\r\n    let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n    if (unit) {\r\n      item.unit = unit.unit\r\n      item.price = parseFloat(unit.price)\r\n      item.ratio = parseFloat(unit.ratio)\r\n      item.price_origin = parseFloat(unit.price)\r\n    }\r\n    \r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhBillType38DetailAdd;\r\n  openEditUnitPrice(detail: VhBillType38DetailAdd) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      ;\r\n      this.isVisibleEditUnitPrice = false;\r\n    } else { this.vhComponent.showToast(2000, this.lang.translate(\"Invalid data, please check again\"), \"alert-toast\") }\r\n  }\r\n  handleCancelEditUnit() { this.isVisibleEditUnitPrice = false }\r\n  // -------set employee-------\r\n  closeAndReceiveEmployee(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n    }\r\n  }\r\n  setPickerTime(event) {\r\n    if (new Date(event).getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.lang.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 5000)\r\n      this.pickerTime = new Date(this.invoice.date)\r\n      this.invoice.date = (new Date(this.pickerTime));\r\n    }\r\n    else this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        this.invoice.date = (event);\r\n      }\r\n      else {\r\n        this.pickerTime = new Date(validitydate)\r\n        this.invoice.date = (new Date(this.pickerTime));\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.lang.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  handle() {\r\n    this.isExit = true;\r\n    this.router.navigate([this.url], { state: this.dataRestore })\r\n  }\r\n  note: string;\r\n  edit_note() {\r\n    if (this.note) {\r\n      this.invoice.note = (this.note)\r\n    }\r\n  }\r\n\r\n  payInvoice(bill_type: 38, print?) {\r\n    if (this.vhAuth.checkMyPermission(\"purchase_enable_payment\")) {\r\n      this.vhComponent.alertConfirm(\r\n        `${this.lang.translate(\"Complete\")} ?`,\r\n        \"\", \"\", \"OK\", this.lang.translate(\"Cancel\")\r\n      ).then(() => {\r\n        this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n          var arrayProcess: any[] = [this.createOrUpdate(bill_type)];\r\n          Promise.all(arrayProcess)\r\n            .then((bill) => {\r\n              this.vhComponent.hideLoading(0).then(() => {\r\n                this.vhComponent.showToast(2000, `${this.lang.translate(\"Hóa đơn xuất hủy\")} ${bill[0].bill_code || this.invoice.bill_code} ${this.lang.translate(\"has been updated successfully\")}`, \"success-toast\")\r\n                if (print) this.handlePrint()\r\n                else this.handle()\r\n              })\r\n            })\r\n        }).catch(err => { this.vhComponent.hideLoading(0) })\r\n      }, () => { })\r\n    }\r\n    else this.vhComponent.showToast(1500, this.lang.translate('You do not have this rights'), \"alert-toast\")\r\n  }\r\n  createOrUpdate(bill_type: 38) {\r\n    return this.vhQuerySales.updateBill_Billdetail(this.invoice._id, this.invoice, this.getCreateUpdateInvoiceDetail())\r\n  }\r\n\r\n   /**\r\n   * lấy thông tin dữ liệu trang in\r\n   * @returns Promise<any>\r\n   * @example this.checkPrint()\r\n   */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_destroy_product')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n  handlePrint() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer,invoice_detail : this.invoice_detail, invoice: this.invoice }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.handle())\r\n        })\r\n    }, (err) =>\r\n      this.vhComponent.alertMessage(this.lang.translate(\"Function\"), \"\", this.lang.translate(\"Please turn on the printer function\"), \"OK\")\r\n        .then(() => this.handle())\r\n    )\r\n  }\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return (DestroyProductK57Col3Component)\r\n      case 'print_size_k80_3c': return (DestroyProductK80Col3Component)\r\n      case 'print_size_k80_4c': return (DestroyProductK80Col4Component)\r\n      case 'print_size_a5': return (DestroyProductA5Component)\r\n      case 'print_size_a4': return (DestroyProductA4Component)\r\n      default: return (DestroyProductA4Component)\r\n    }\r\n  }\r\n  // ------thoát trang-----\r\n  isExit: boolean = false; \r\n  show_modal_select_lots = false;\r\n  list_search_lot = [];\r\n\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id);\r\n    return lot.lot_number\r\n  }\r\n  searchLot(value) {\r\n    this.tempDetail.lots = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.list_search_lot, ['lot_number'])\r\n  }\r\n  openModalChooseLot(data) {\r\n    this.tempDetail = data\r\n    this.list_search_lot = this.tempDetail.lots\r\n    if (!this.list_search_lot.length) this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Sản phẩm này không có lô khả dụng để bán!\"))\r\n    else this.show_modal_select_lots = true;\r\n  }\r\n\r\n  changeLot(e) {\r\n    this.tempDetail.lot_number = this.tempDetail.lots.find(item => item._id == e).lot_number\r\n  }\r\n\r\n  handleChooseLot() {\r\n    \r\n\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot;\r\n    if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n  }\r\n\r\n  handleCancelChooseLot() {\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot\r\n  }\r\n\r\n  /**Thêm sản phẩm vô bill detail */\r\n  public addInvoiceDetail(value: any) {\r\n    if (value['id_subproduct']) {\r\n      if (value.lot_number) {\r\n        let index = this.invoice_detail.findIndex(detail => detail['lot_number'] == value['lot_number'] && detail['id_lotproduct'] == value['id_lotproduct'])\r\n        if (index != -1) {\r\n          if (this.invoice_detail[index]['quantity'] < 9999999999) this.invoice_detail[index]['quantity'] += 1\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n      else {\r\n        let index = this.invoice_detail.findIndex(detail => detail['id_subproduct'] == value['id_subproduct'] && detail['ratio'] == value['ratio'])\r\n        if (index != -1) {\r\n          if (this.invoice_detail[index]['quantity'] < 9999999999) this.invoice_detail[index]['quantity'] += 1\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n    }\r\n    else {\r\n      if (value.lot_number) {\r\n        let index = this.invoice_detail.findIndex(detail => detail['lot_number'] == value['lot_number'] && detail['id_lotproduct'] == value['id_lotproduct'])\r\n        if (index != -1) {\r\n          if (this.invoice_detail[index]['quantity'] < 9999999999) this.invoice_detail[index]['quantity'] += 1\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n      else {\r\n        let index = this.invoice_detail.findIndex(detail => detail['id_product'] == value['_id'] && detail['ratio'] == value['ratio'])\r\n        if (index != -1) {\r\n          if (this.invoice_detail[index]['quantity'] < 9999999999) this.invoice_detail[index]['quantity'] += 1\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n  }\r\n\r\n  addBill_Detail(value) {\r\n    this.invoice_detail.unshift({\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      unit: value.unit,\r\n      units: value.units,\r\n      ratio: value.ratio ? value.ratio : 1,\r\n      ptype: value.type,\r\n      price: 0,\r\n      price_origin: value.price_import,\r\n      id_subproduct: value.id_subproduct,\r\n      lots: value.lots,\r\n      lot_number: value.lot_number,\r\n      id_lotproduct: value.id_lotproduct,\r\n\r\n    })\r\n\r\n    \r\n  }\r\n  /**Thêm sản phẩm vô bill detail */\r\n  public addInvoiceDetailMutilLine(value: any) {\r\n    this.invoice_detail.push({\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      unit: value.unit,\r\n      units: value.units,\r\n      ratio: value.ratio ? value.ratio : 1,\r\n      ptype: value.type,\r\n      price: 0,\r\n      price_origin: value.price_import,\r\n      id_subproduct: value.id_subproduct,\r\n      lots: value.lots,\r\n      lot_number: value.lot_number,\r\n      id_lotproduct: value.id_lotproduct,\r\n\r\n    })\r\n\r\n    \r\n\r\n  }\r\n  removeInvoiceDetail(id: string) {\r\n    let index = this.invoice_detail.findIndex(detail => detail['id_product'] == id)\r\n    if (index != -1) {\r\n      this.invoice_detail.splice(index, 1);\r\n      \r\n    }\r\n  } \r\n  public getCreateUpdateInvoiceDetail(): VhBillType38DetailAdd[] {\r\n    return this.invoice_detail.map(item => {\r\n      let detail: VhBillType38DetailAdd = {\r\n        id_product: item.id_product,\r\n        price: item.price,\r\n        quantity: item.quantity,\r\n        ptype: item.ptype,\r\n        ratio: item.ratio ? item.ratio : 1,\r\n      }\r\n      if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct\r\n      if (item.id_subproduct) detail['id_subproduct'] = item.id_subproduct\r\n      if (item.price < item.price_origin) detail['price_origin'] = item.price_origin\r\n      return detail\r\n    })\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}} |  <b> {{'Edit cancellation order' | translate}}</b>\r\n</div>\r\n\r\n<nz-layout>\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{\"Select product\" | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n                    <div>\r\n                        <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                            (click)=\"openSearchProductList()\">\r\n                            <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                            {{'Search (F4)' | translate}}\r\n                        </button>\r\n                    </div> \r\n                </div>\r\n\r\n                <div *ngIf=\"!invoice_detail.length\" class=\"no-data\">\r\n                    <p>{{'Please select a product' | translate}}</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\" *ngFor=\"let item of invoice_detail,index as i\">\r\n                    <div nz-row>\r\n                        <div (click)=\"deleteGoods(item,i)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"12\" class=\"center-col\">\r\n                            <p class=\"max-width-two-line\">\r\n                                <b>{{item.name}}</b>  <br>\r\n                                <ng-container *ngIf=\"item.id_lotproduct\">\r\n                                    <pre  style=\"color:var(--ion-color-vh-green);cursor: pointer;\"  (click)=\"openModalChooseLot(item)\">\r\n                                        {{getLotNumber(item.lots, item.id_lotproduct)}}\r\n                                    </pre>\r\n                                    \r\n                                  </ng-container>\r\n                            </p> \r\n                        </div>\r\n                        <div nz-col nzSpan=\"6\" style=\"align-self: center;\">\r\n                            <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.ratio\"\r\n                                (ngModelChange)=\"changeUnit($event,item)\">\r\n                                <!-- <nz-option [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option> -->\r\n                                <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\"\r\n                                    [nzValue]=\"i.ratio\"></nz-option>\r\n                            </nz-select>\r\n                        </div>\r\n                        <div class=\"text-align-self\" nz-col nzSpan=\"5\">\r\n                            <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                (ngModelChange)=\"checkQuantityProduct(item,$event)\"></nz-input-number>\r\n                        </div>\r\n                        <!-- <div (click)=\"openEditUnitPrice(item)\" class=\"invoiceDetail-item-quantity text-end\" nz-col\r\n                            nzSpan=\"4\">\r\n                            <p class=\"max-width-two-line\"><span>{{vhAlgorithm.vhcurrencyunit(item.price)}}</span>\r\n                                <del style=\"font-size: 0.7rem;\">\r\n                                    {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin)\r\n                                    : ''}}\r\n                                </del>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"4\" class=\"money-sub\">\r\n                            <p class=\"max-width-two-line\">\r\n                                <b>{{vhAlgorithm.vhcurrencyunit(item.price*item.quantity)}}</b>\r\n                            </p>\r\n                        </div> -->\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Employee' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_employee\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveEmployee($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Note' | translate}}</b>\r\n                \r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\" *ngIf=\"!printer.note_hidden\">\r\n                    <textarea class=\"nz-hover-border\" [(ngModel)]=\"note\" (blur)=\"edit_note()\" nz-input\r\n                        placeholder=\"{{'Enter note...' | translate}}\"\r\n                        [nzAutosize]=\"{ minRows: 2, maxRows: 4 }\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!invoice_detail.length  || !checkPrinter\"\r\n                    (click)=\"payInvoice(38,true)\" nz-button class=\"order-and-print\">\r\n                    {{\"Complete & Print\"|translate}} (F2)\r\n                </button>\r\n                <button [disabled]=\"!invoice_detail.length \"\r\n                    (click)=\"payInvoice(38,false)\" nz-button class=\"order\">\r\n                    {{\"Complete\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n\r\n<!-- -----nz-drawer list-product-------- -->\r\n<app-search-product-import [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product-import>\r\n\r\n<!--Modal edit inut price-->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Edit unit price' | translate}}\" (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Unit price' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\" [value]=\"tempDetail.price\" nz-input\r\n                    placeholder=\"{{'Enter unit price' | translate}}\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- modal chọn lô/HSD -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice2\" [(nzVisible)]=\"show_modal_select_lots\"\r\n    nzTitle=\"{{'Select lot number' | translate}}\" (nzOnCancel)=\"handleCancelChooseLot()\" (nzOnOk)=\"handleChooseLot()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input type=\"text\" nz-input placeholder=\"{{'Find lot number' | translate}}\" #searchValue (keyup)=\"searchLot(searchValue.value )\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <nz-radio-group [(ngModel)]=\"tempDetail.id_lotproduct\" (ngModelChange)=\"changeLot($event)\" style=\"width:100%;\">\r\n            <div nz-row *ngFor=\"let item of tempDetail.lots\" >\r\n                <div nz-col nzSpan=\"24\">\r\n                    <label class=\"radio-purchase\" nz-radio [nzValue]=\"item._id\" style=\"width:100%;\">\r\n                        <div nz-row>\r\n                            <div nz-col nzSpan=\"8\">\r\n                                {{item.lot_number}}\r\n                            </div>\r\n                            \r\n                            <div nz-col nzSpan=\"8\">\r\n                                NSX: {{item.date_mfg | date : 'dd/MM/yyyy'}}\r\n                             </div>\r\n                             <div nz-col nzSpan=\"8\">\r\n                                HSD: {{item.date_exp | date : 'dd/MM/yyyy'}}\r\n                             </div>\r\n                        </div>\r\n                        \r\n                    </label>\r\n                </div>\r\n                \r\n            </div>\r\n        </nz-radio-group>\r\n        <div  *ngIf=\"!tempDetail.lots.length\" style=\"text-align: center;\">{{'No data' | translate}}</div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice2>\r\n        <div>\r\n            <button nz-button class=\"nz-hover-border\"\r\n                style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\"\r\n                nzType=\"default\" (click)=\"handleCancelChooseLot()\">{{\"Cancel\"\r\n                |translate}}</button>\r\n            <button nz-button class=\"nz-hover-border\" [disabled]=\"!tempDetail.id_lotproduct\"\r\n                style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n                class=\"nz-hover-border-green\" (click)=\"handleChooseLot()\">{{\"Ok\" | translate}}</button>\r\n        </div>\r\n    </ng-template>\r\n</nz-modal>\r\n"],"names":[],"sourceRoot":"webpack:///"}