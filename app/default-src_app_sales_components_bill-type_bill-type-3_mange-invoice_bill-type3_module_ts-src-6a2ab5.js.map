{"version":3,"file":"default-src_app_sales_components_bill-type_bill-type-3_mange-invoice_bill-type3_module_ts-src-6a2ab5.js","mappings":"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","sources":["./src/app/sales/components/bill-type/bill-type-3/mange-invoice/add/add.component.ts","./src/app/sales/components/bill-type/bill-type-3/mange-invoice/add/add.component.html","./src/app/sales/components/bill-type/bill-type-3/mange-invoice/bill-type3.module.ts","./src/app/sales/components/bill-type/bill-type-3/mange-invoice/detail/detail.component.ts","./src/app/sales/components/bill-type/bill-type-3/mange-invoice/detail/detail.component.html","./src/app/sales/components/bill-type/bill-type-3/mange-invoice/edit/edit.component.ts","./src/app/sales/components/bill-type/bill-type-3/mange-invoice/edit/edit.component.html","./src/app/sales/menu/manage/delivery/services/ahamoveService/ahamove.service.ts","./src/app/sales/menu/manage/delivery/services/ghnService/ghn.service.ts","./src/app/sales/menu/manage/delivery/services/ghtkService/ghtk.service.ts","./src/app/sales/menu/manage/delivery/services/vnpostPost/vnpost-service.service.ts"],"sourcesContent":["import { ChangeDetectorRef, Component, OnInit, HostListener, ViewChild, ElementRef } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { Observable } from 'rxjs';\r\nimport { CustomerReturnedA4Component } from 'src/app/sales/components/print/customer-returned/customer-returned-a4/customer-returned-a4.component';\r\nimport { CustomerReturnedA5Component } from 'src/app/sales/components/print/customer-returned/customer-returned-a5/customer-returned-a5.component';\r\nimport { CustomerReturnedK80Col4Component } from 'src/app/sales/components/print/customer-returned/customer-returned-k80-col4/customer-returned-k80-col4.component';\r\nimport { CustomerReturnedK80Col3Component } from 'src/app/sales/components/print/customer-returned/customer-returned-k80-col3/customer-returned-k80-col3.component';\r\nimport { CustomerReturnedK57Col3Component } from 'src/app/sales/components/print/customer-returned/customer-returned-k57-col3/customer-returned-k57-col3.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { VhReturnCustomerInvoiceAdd, VhReturnCustomerInvoiceDetailCombo, VhReturnCustomerInvoiceDetail } from '../bill-type3-interface';\r\n\r\n@Component({\r\n  selector: 'bill-type3-add',\r\n  templateUrl: './add.component.html',\r\n  styleUrls: ['./add.component.scss']\r\n})\r\nexport class AddComponent implements OnInit {\r\n  display_promotion_selling_price: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').display_promotion_selling_price\r\n  invoice: VhReturnCustomerInvoiceAdd = {\r\n    bill_type: 3,\r\n    payment_type: 1,\r\n    id_customer: 'id_retail',\r\n    id_branch: '',\r\n    id_employee: '',\r\n    id_wallet: 'id_cash',\r\n    date: new Date(),\r\n    total: 0,\r\n    payment: 0,\r\n    tax: 0,\r\n    discount: 0,\r\n    fee: 0,\r\n    note: '',\r\n    price_type: 1,\r\n  }\r\n  invoiceDetail = [];\r\n  subTotal = 0;\r\n  taxValue = 0\r\n  listTax: any[] = this.vhQuerySales.getlocalTaxs().filter(tax => tax.status);\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore\r\n  employee: any = {};\r\n  pickerTime = new Date();\r\n  customer: any;\r\n  printer: any;\r\n  percent_discount_bill: number = 0;\r\n  is_discount_bill: boolean = false;\r\n  default_price_type: number\r\n  showModalChangePriceType: boolean = false;\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private languageService: LanguageService,\r\n    private vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    public vhAuth: VhAuth,\r\n    private cdRef: ChangeDetectorRef,\r\n    private fncService: FunctionService,\r\n    private nzModalService: NzModalService\r\n  ) {\r\n    this.invoice.id_employee = this.vhAuth.getUser()._id\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    this.invoice.id_branch = (this.vhQuerySales.getDefaultBranch()._id)\r\n    if (this.vhAuth.checkMyPermission('default_price_type_1')) this.default_price_type = 1;\r\n    else if (this.vhAuth.checkMyPermission('default_price_type_2')) this.default_price_type = 2;\r\n    // ------bắt sự kiện nhấn phím nóng-----\r\n    this.eventKeypress();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    let tax = this.listTax.find(item => item.default);\r\n    if (tax) {\r\n      this.id_tax = tax._id\r\n      this.invoice.tax = (tax['value']);\r\n    }\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_customer_returned')\r\n    this.printer = printer ? printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)] : { discount_hidden: false, note_hidden: false, fee_hidden: false, tax_hidden: false, debt_hidden: false };\r\n  }\r\n  event: any // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n  }\r\n  checkPrinter: boolean = false\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113 || keycode === 114) event.preventDefault();\r\n      if (keycode === 115) this.searchProductList = !this.searchProductList;\r\n      else if (this.invoiceDetail.length > 0) {\r\n        switch (keycode) {\r\n          case 112: this.payInvoice(3, false)\r\n            break;\r\n          case 113: {\r\n            if (this.checkPrinter) this.payInvoice(3, true)\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  ngAfterViewInit() {\r\n    this.checkPrinter = this.printer.enable;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      if (document.querySelector(\".discount-price\")) this.discount_price = this.vhAlgorithm.vhnumeral(\".discount-price\");\r\n      if (document.querySelector(\".invoice-fee\")) this.invoice_fee = this.vhAlgorithm.vhnumeral(\".invoice-fee\")\r\n    })\r\n\r\n  }\r\n  ngAfterViewChecked() {\r\n    this.cdRef.detectChanges();\r\n  }\r\n  deleteGoods(detail: VhReturnCustomerInvoiceDetail, index) {\r\n    this.vhComponent.alertConfirm(\"\", \"\", `${this.languageService.translate(\"Delete\")} ${detail.name}?`, \"OK\", this.languageService.translate(\"Cancel\"))\r\n      .then(() => {\r\n        this.invoiceDetail.splice(index, 1);\r\n        this.setSubTotal();\r\n      }, () => { })\r\n  }\r\n  searchProductList: boolean = false;\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit\r\n  }\r\n  closeSearchProductList(data) {\r\n    \r\n\r\n    if (data) {\r\n      if (data.manylot && !data.id_lotproduct) this.openModalChooseLot(data)\r\n      else\r\n        if (data.combos && data.combos.filter(e => e.lots && !e.id_lotproduct).length) {\r\n          this.tempDetail = data;\r\n          this.show_modal_select_lots_combo = true;\r\n        }\r\n        else\r\n          if (!this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').show_product_mutil_line_customer_return)\r\n            this.addInvoiceDetail(data);\r\n          else\r\n            this.addInvoiceDetailMultiLine(data);\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n  checkQuantityProduct(product: VhReturnCustomerInvoiceDetail, event) {\r\n    if (!event) product.quantity = 1;\r\n    this.setSubTotal();\r\n  }\r\n  changeUnit(ev, item) {\r\n    if (this.default_price_type == 1) {\r\n      let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n      if (unit) {\r\n        item.unit = unit.unit\r\n        item.price = parseFloat(unit.price)\r\n        item.ratio = parseFloat(unit.ratio)\r\n        item.price_origin = parseFloat(unit.price)\r\n      }\r\n    }\r\n    else {\r\n      let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n      if (unit) {\r\n        item.unit = unit.unit\r\n        item.price = parseFloat(unit.price2)\r\n        item.ratio = parseFloat(unit.ratio)\r\n        item.price_origin = parseFloat(unit.price2)\r\n      }\r\n    }\r\n    this.setSubTotal()\r\n  }\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhReturnCustomerInvoiceDetail;\r\n  openEditUnitPrice(detail: VhReturnCustomerInvoiceDetail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      this.setSubTotal();\r\n      this.isVisibleEditUnitPrice = false;\r\n    } else { this.vhComponent.showToast(2000, this.languageService.translate(\"Invalid data, please check again\"), \"alert-toast\") }\r\n  }\r\n  handleCancelEditUnit() { this.isVisibleEditUnitPrice = false }\r\n  // -------set employee-------\r\n  closeAndReceiveEmployee(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n    }\r\n  }\r\n  // ----set customer-----\r\n  radioValue: 1 | 2| 3 = 1;\r\n  closeAndReceiveCustomer(event) {\r\n    if (event) {\r\n      this.invoice.id_customer = (event);\r\n      if (!this.vhQuerySales.getlocalCustomer(event).debt_enable) this.invoice.payment = (this.getTotalATax());\r\n    }\r\n  }\r\n  changeCustomerType(event) {\r\n    if (this.radioValue == 1) {\r\n\r\n      this.invoice.id_customer = (\"id_retail\");\r\n      this.invoice.payment = (this.getTotalATax());\r\n    } \r\n    if (event == 2 && this.invoice.retail_name) {\r\n      this.nzModalService.confirm({\r\n        nzTitle: `${this.languageService.translate('Retail customer information will be lost')}?`,\r\n        nzCancelText: this.languageService.translate(\"Cancel\"),\r\n        nzOkText: \"Ok\",\r\n        nzOnOk: () => { this.clearRetailCustomer() },\r\n        nzOnCancel: () => { this.radioValue = 1 },\r\n      }\r\n      )\r\n    }\r\n  }\r\n  clearRetailCustomer() {\r\n    this.invoice.retail_address = ('')\r\n    this.invoice.retail_name = ('')\r\n    this.invoice.retail_phone = ('')\r\n  }\r\n  setPickerTime(event) {\r\n    if (new Date(event).getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 5000)\r\n      this.pickerTime = new Date(this.invoice.date)\r\n      this.invoice.date = (new Date(this.pickerTime));\r\n    }\r\n    else this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        this.invoice.date = (event);\r\n      }\r\n      else {\r\n        this.pickerTime = new Date(validitydate)\r\n        this.invoice.date = (new Date(this.pickerTime));\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n  }\r\n  // -------change tax------\r\n  id_tax: string;\r\n  changeTax(event) {\r\n    let tax = this.listTax.find(item => item._id == event);\r\n    this.invoice.tax = (tax.value);\r\n    this.setTaxValue();\r\n  }\r\n  closeAndGetValuePayment(event) {\r\n    if (event[0] == 1 || event[0] == 2) {\r\n      this.setPaymentType(event[0])\r\n    }\r\n    else if (event[0] == 3) {\r\n      this.setPaymentType(event[0], event[1]);\r\n    }\r\n  }\r\n  setPaymentType(type: 1 | 2 | 3, id_wallet?) {\r\n    this.invoice.payment_type = (type)\r\n    switch (type) {\r\n      case 1: {\r\n        this.invoice.id_wallet = ('id_cash');\r\n        this.invoice.payment = (this.invoice.payment ? this.invoice.payment : this.invoice.total + this.taxValue);\r\n\r\n        break;\r\n      }\r\n      case 2: {\r\n        this.invoice.payment = (0); this.invoice.id_wallet = (null);\r\n\r\n\r\n        break;\r\n      }\r\n      case 3: {\r\n        if (id_wallet) {\r\n          this.invoice.id_wallet = (id_wallet)\r\n          this.invoice.payment = (this.invoice.payment ? this.invoice.payment : this.invoice.total + this.taxValue);\r\n\r\n          break;\r\n        }\r\n      }\r\n    };\r\n  }\r\n  // -------------- discount\r\n  discount_price: any;\r\n  editDiscount() {\r\n    if (this.discount_price.getRawValue() && this.discount_price.getRawValue() >= 0 && this.discount_price.getRawValue() <= this.subTotal) {\r\n      this.invoice.discount = (parseFloat(this.discount_price.getRawValue()));\r\n      this.percent_discount_bill = this.subTotal ? (this.invoice.discount / this.subTotal) * 100 : 0\r\n    } else {\r\n      document.getElementById(\"discount-price\")['value'] = this.invoice.discount;\r\n      this.discount_price = this.vhAlgorithm.vhnumeral('.discount-price');\r\n    }\r\n    this.setTotal()\r\n  }\r\n\r\n  editPercentDiscount(value) {\r\n    if (parseFloat(value) > 100)\r\n      document.getElementById(\"percent-discount-price\")['value'] = 0\r\n    else this.percent_discount_bill = value;\r\n    this.invoice.discount = this.subTotal * (this.percent_discount_bill / 100)\r\n    this.setTotal()\r\n  }\r\n  invoice_fee: any;\r\n  editFee() {\r\n    if (this.invoice_fee.getRawValue() && this.invoice_fee.getRawValue() >= 0) {\r\n      this.invoice.fee = (parseFloat(this.invoice_fee.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"invoice-fee\")['value'] = this.invoice.fee;\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral('.invoice-fee');\r\n    }\r\n    this.setTotal()\r\n  }\r\n  // -------modal edit pay---------\r\n  edit_pay: boolean = false;\r\n  edit_paytotal: any;\r\n  showModalEditTotalPay() {\r\n    if (this.invoice.payment_type != 2 && this.vhQuerySales.getlocalCustomer(this.invoice.id_customer).debt_enable) {\r\n      this.vhAlgorithm.waitingStack().then(() => {\r\n        this.edit_paytotal = this.vhAlgorithm.vhnumeral(\".edit-pay\");\r\n      })\r\n      this.edit_pay = true;\r\n    }\r\n    else if (!this.vhQuerySales.getlocalCustomer(this.invoice.id_customer).debt_enable) {\r\n      this.vhComponent.showToast(5000,\r\n        this.languageService.translate(\"This customer is not allowed to debt\"), \"alert-toast\"\r\n      )\r\n    }\r\n  }\r\n  handleEditPay() {\r\n    if (this.edit_paytotal.getRawValue() >= 0 && this.edit_paytotal.getRawValue() <= this.getTotalATax()) {\r\n      this.invoice.payment = (parseFloat(this.edit_paytotal.getRawValue()))\r\n    }\r\n    this.edit_pay = false;\r\n  }\r\n  handleCancelEditPay() {\r\n    this.edit_pay = false;\r\n  }\r\n\r\n  goBack() {\r\n    this.isExit = true\r\n    this.router.navigate(['/sales/dashboard/manage/invoice/customer-return'], { state: this.dataRestore })\r\n  }\r\n  handleGoBack() {\r\n    this.vhComponent.alertConfirm(`${this.languageService.translate(\"Confirm\")}`, \"\", `${this.languageService.translate(\"Are you sure to cancel the customer returned order\")}?`, \"OK\", this.languageService.translate('Cancel'))\r\n      .then(() => { this.isExit = true, this.router.navigate(['/sales/dashboard/manage/invoice/customer-return'], { state: this.dataRestore }) }, () => { })\r\n  }\r\n  note: string;\r\n  edit_note() {\r\n    if (this.note) {\r\n      this.invoice.note = (this.note)\r\n    }\r\n  }\r\n\r\n  //--------------visible drawer info customer-----------\r\n  visibleInfoCustomer: boolean = false;\r\n  openInfoSupplier() {\r\n    if (this.invoice.id_customer) {\r\n      this.customer = this.vhQuerySales.getlocalSupplier(this.invoice.id_customer);\r\n      this.visibleInfoCustomer = true;\r\n    }\r\n  }\r\n  closeInfoSupplier(event) {\r\n    this.visibleInfoCustomer = false;\r\n  }\r\n  save_enable = true;\r\n  payInvoice(bill_type: 3 | 23, print?) {\r\n    this.vhComponent.alertConfirm((!print ? `${this.languageService.translate(\"Pay\")}?` : `${this.languageService.translate(\"Pay & Print\")}?`), \"\", \"\", \"OK\", this.languageService.translate(\"Cancel\"))\r\n      .then(() => {\r\n        if (this.save_enable) {\r\n          this.save_enable = false;\r\n          this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n            this.createOrUpdate(bill_type).then(bill => {\r\n              this.save_enable = true;\r\n              this.vhComponent.hideLoading(0).then(() => {\r\n                this.vhComponent.showToast(2000,\r\n                  `${this.languageService.translate(\"Customer returned invoice\")} ${bill.bill_code} ${this.languageService.translate(\"has been created successfully\")}`, \"success-toast\"\r\n                )\r\n\r\n                if (print) this.handlePrint()\r\n                else this.goBack()\r\n              })\r\n            })\r\n          })\r\n        }\r\n      }, () => { })\r\n  }\r\n  createOrUpdate(bill_type: 3 | 23) {\r\n    return this.vhQuerySales.createBill_Billdetail({...this.getCreateUpdateInvoice(bill_type), id_shop: 'local'}, this.getCreateUpdateInvoiceDetail())\r\n  }\r\n\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_customer_returned')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n  handlePrint() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice: this.invoice, invoice_detail: this.invoiceDetail }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.goBack())\r\n        })\r\n    }, (err) => {\r\n      this.vhComponent.alertMessage(this.languageService.translate(\"Function\"), \"\", this.languageService.translate(\"Please turn on the printer function\"), \"OK\")\r\n        .then(() => this.goBack())\r\n    })\r\n  }\r\n\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return CustomerReturnedK57Col3Component\r\n      case 'print_size_k80_3c': return CustomerReturnedK80Col3Component\r\n      case 'print_size_k80_4c': return CustomerReturnedK80Col4Component\r\n      case 'print_size_a5': return CustomerReturnedA5Component\r\n      case 'print_size_a4': return CustomerReturnedA4Component\r\n      default: return CustomerReturnedA4Component\r\n    }\r\n  }\r\n  //--------------visible drawer info customer-----------\r\n  openInfoCustomer() {\r\n    if (this.invoice.id_customer != 'id_retail') {\r\n      this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n      this.visibleInfoCustomer = true;\r\n    }\r\n  }\r\n  closeInfoCustomer(event) {\r\n    this.visibleInfoCustomer = false;\r\n  }\r\n  // ------thoát trang-----\r\n  isExit: boolean = false;\r\n  checkDeactivate(currentRoute: ActivatedRouteSnapshot, currentState: RouterStateSnapshot, nextState?: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    return nextState.url == '/login' ? true : (this.isExit ? this.isExit : this.vhComponent.alertConfirm(this.languageService.translate(\"Confirm\"), \"\", this.languageService.translate(\"Are you sure to cancel the sales order\"), \"OK\", (this.languageService.translate(\"Cancel\"))).then(() => { return true }).catch(() => { return false }))\r\n  }\r\n  /**add customer */\r\n  showDrawerAddCusomer: boolean = false;\r\n  showDrawerAddRetail: boolean = false\r\n  openDrawerAddCustomerOrRetail() {\r\n    if (this.radioValue == 1) this.showDrawerAddRetail = true\r\n    else this.showDrawerAddCusomer = true\r\n  }\r\n  closeAddCustomer(result) {\r\n    if (this.radioValue == 1) {\r\n      if (result) {\r\n        this.invoice.retail_name = (result.retail_name)\r\n        this.invoice.retail_phone = (result.retail_phone)\r\n        this.invoice.retail_address = (result.retail_address)\r\n      }\r\n      this.showDrawerAddRetail = false\r\n    } else this.showDrawerAddCusomer = false\r\n  }\r\n\r\n  barcode: string = ''\r\n  barcode_array = [];\r\n  @HostListener(\"window: keypress\", [\"$event\"])\r\n  /**\r\n   * Sự kiện nhận barcode\r\n   */\r\n  getKeyUp(_event: KeyboardEvent) {\r\n    if (this.router.url === \"/sales/dashboard/manage/invoice/customer-return/add-customer-return\") {\r\n      // if (!this.showSearchBar && !this.showPayInfo) {\r\n      if (_event.key == \"Enter\") {\r\n        this.barcode_array.forEach((i, index) => {\r\n          if (i == \"Shift\") {\r\n            this.barcode_array[index + 1] = this.barcode_array[\r\n              index + 1\r\n            ].toUpperCase();\r\n            this.barcode_array.splice(index, 1);\r\n          }\r\n        });\r\n        // this.scanBarcode(this.barcode_array.join(\"\"));\r\n        this.barcode = this.barcode_array.join(\"\");\r\n        setTimeout(() => {\r\n          \r\n\r\n          if (this.barcode) {\r\n            let detailproduct = this.vhQuerySales.getlocalDetailProduct_byBarcode(this.barcode);\r\n            if (detailproduct) {\r\n              this.closeSearchProductList({ ...detailproduct, ...this.vhQuerySales.getUnit_byRatio(detailproduct.units, detailproduct.ratio) });\r\n            }\r\n            else {\r\n              this.quantity?.nativeElement.blur();\r\n              if (this.barcode.length > 3) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Not found\"))\r\n            }\r\n          } else\r\n            this.quantity?.nativeElement.blur();\r\n          this.barcode_array = [];\r\n        }, 100);\r\n\r\n      } else {\r\n        this.barcode_array.push(_event.key);\r\n      }\r\n      // }\r\n    }\r\n  }\r\n\r\n\r\n  show_modal_select_lots = false;\r\n  list_search_lot = [];\r\n\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id);\r\n    return lot.lot_number\r\n  }\r\n  searchLot(value) {\r\n    this.tempDetail.lots = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.list_search_lot, ['lot_number'])\r\n  }\r\n  openModalChooseLot(data) {\r\n    this.tempDetail = data\r\n    this.list_search_lot = this.tempDetail.lots\r\n    if (!this.list_search_lot.length) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Sản phẩm này không có lô khả dụng để bán!\"))\r\n    else this.show_modal_select_lots = true;\r\n  }\r\n\r\n  changeLot(e) {\r\n    this.tempDetail.lot_number = this.tempDetail.lots.find(item => item._id == e).lot_number\r\n  }\r\n\r\n  handleChooseLot() {\r\n    \r\n\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot;\r\n    if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n  }\r\n\r\n  handleCancelChooseLot() {\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot\r\n  }\r\n  show_modal_select_lots_combo = false;\r\n  handleChooseLotCombo() {\r\n    if (this.tempDetail.combos.filter(item => item.lots && !item.id_lotproduct).length)\r\n      this.vhComponent.alertMessageDesktop(\"warning\", this.languageService.translate(\"Vui lòng chọn lô cho sản phẩm thuộc combo này\"))\r\n    else {\r\n      this.show_modal_select_lots_combo = false;\r\n      this.closeSearchProductList(this.tempDetail)\r\n    }\r\n  }\r\n  getTotalATax(): number {\r\n    return this.invoice.total + this.taxValue\r\n  }\r\n\r\n  removeInvoiceDetail(id: string, notSetSub?: boolean) {\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == id)\r\n    if (index != -1) {\r\n      this.invoiceDetail.splice(index, 1);\r\n      if (!notSetSub) this.setSubTotal()\r\n    }\r\n  }\r\n\r\n  setSubTotal() {\r\n\r\n    this.subTotal = this.invoiceDetail.reduce((prev: number, next) => prev + next.quantity * next.price, 0);\r\n    this.setTotal();\r\n  }\r\n\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee\r\n    this.setTaxValue()\r\n\r\n  }\r\n\r\n  setTaxValue() {\r\n    this.taxValue = this.invoice.total * (this.invoice.tax / 100)\r\n    this.setPayment()\r\n  }\r\n  setPayment(value?: number) {\r\n\r\n    if (this.invoice.payment_type == 2) {\r\n      this.invoice.payment = 0\r\n    } else {\r\n      if (value != null)\r\n        this.invoice.payment = value\r\n      else\r\n        this.invoice.payment = this.invoice.total + this.taxValue\r\n    }\r\n\r\n  }\r\n\r\n  getCreateUpdateInvoice(bill_type: 3 | 23) {\r\n    if (bill_type) this.invoice.bill_type = (bill_type)\r\n    return this.invoice\r\n  }\r\n\r\n  public getCreateUpdateInvoiceDetail(): VhReturnCustomerInvoiceDetail[] {\r\n    return this.invoiceDetail.map(item => {\r\n      let detail: VhReturnCustomerInvoiceDetail = {\r\n        id_product: item.id_product, price: item.price, quantity: item.quantity,\r\n        ptype: item.ptype,\r\n        ratio: item.ratio,\r\n        note: item.note,\r\n      }\r\n      if (item.ptype == 5) detail['combos'] = item.combos.map(e => {\r\n        let product: VhReturnCustomerInvoiceDetailCombo = {\r\n          id_product: e.id_product,\r\n          price: e.price, quantity: e.quantity, ptype: e.ptype,\r\n          ratio: e.ratio ? e.ratio : 1\r\n        }\r\n        if (e.id_lotproduct) product['id_lotproduct'] = e.id_lotproduct\r\n        if (e['id_subproduct']) product['id_subproduct'] = e.id_subproduct\r\n        return product;\r\n      })\r\n      if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct\r\n      if (item['id_subproduct']) detail['id_subproduct'] = item.id_subproduct\r\n      if (item.price < item.price_origin) detail['price_origin'] = item.price_origin\r\n      return detail\r\n    })\r\n  }\r\n  addInvoiceDetail(value: any) {\r\n    if (value['id_subproduct']) {\r\n      if (value.lot_number) {\r\n        let index = this.invoiceDetail.findIndex(detail => detail['lot_number'] == value['lot_number'] && detail['id_lotproduct'] == value['id_lotproduct'])\r\n        if (index != -1) {\r\n          if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n          this.setSubTotal()\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n      else {\r\n        let index = this.invoiceDetail.findIndex(detail => detail['id_subproduct'] == value['id_subproduct'] && detail['ratio'] == value['ratio'])\r\n        if (index != -1) {\r\n          if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n          this.setSubTotal()\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n    }\r\n    else {\r\n      if (value.lot_number) {\r\n        let index = this.invoiceDetail.findIndex(detail => detail['lot_number'] == value['lot_number'] && detail['id_lotproduct'] == value['id_lotproduct'])\r\n        if (index != -1) {\r\n          if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n          this.setSubTotal()\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n      else {\r\n        let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == value['_id'] && detail['ratio'] == value['ratio'])\r\n        if (index != -1) {\r\n          if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n          this.setSubTotal()\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  addBill_Detail(value) {\r\n    let detail: any = {\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      unit: value.unit,\r\n      units: value.units,\r\n      ratio: value.ratio,\r\n      ptype: value.type,\r\n      price: value.price,\r\n      price_origin: value.price,\r\n      id_category: value.id_category\r\n    }\r\n\r\n    if (value.lot_number) detail['lot_number'] = value.lot_number;\r\n    if (value.lots) detail['lots'] = value.lots;\r\n    if (value.id_lotproduct) detail['id_lotproduct'] = value.id_lotproduct;\r\n    if (value['id_subproduct']) detail['id_subproduct'] = value.id_subproduct\r\n    if (value.type == 5) {\r\n      detail['subComboName'] = value.subComboName\r\n      detail['combos'] = [...value.combos.map(item => {\r\n        let product: VhReturnCustomerInvoiceDetailCombo = {\r\n          id_product: item.id_product, name: item.name, ptype: item.type,\r\n          price: item.price, quantity: item.quantity,\r\n          unit: item.unit, units: item.units, ratio: item.ratio ? item.ratio : 1,\r\n          lots: item.lots ? item.lots : [],\r\n          id_lotproduct: item.id_lotproduct,\r\n        }\r\n        if (item.lot_number) product['lot_number'] = item.lot_number;\r\n        if (item.lots) product['lots'] = item.lots;\r\n        if (item.id_lotproduct) product['id_lotproduct'] = item.id_lotproduct;\r\n        if (item['id_subproduct']) product['id_subproduct'] = item.id_subproduct\r\n        return product;\r\n      })]\r\n    }\r\n    this.invoiceDetail.unshift(detail)\r\n    if (this.auto_active_quantity_input) {\r\n      setTimeout(() => {\r\n\r\n        this.quantity.nativeElement.focus();\r\n        this.quantity.nativeElement.select();\r\n      }, 0);\r\n    }\r\n    this.setSubTotal()\r\n  }\r\n\r\n  auto_active_quantity_input: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').auto_active_quantity_input;\r\n  @ViewChild('quantity') quantity: ElementRef;\r\n  public addInvoiceDetailMultiLine(value: any) {\r\n    let detail: any = {\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      unit: value.unit,\r\n      units: value.units,\r\n      ratio: value.ratio,\r\n      ptype: value.type,\r\n      price: value.price,\r\n      price_origin: value.price,\r\n      id_category: value.id_category\r\n    }\r\n\r\n    if (value.lot_number) detail['lot_number'] = value.lot_number;\r\n    if (value.lots) detail['lots'] = value.lots;\r\n    if (value.id_lotproduct) detail['id_lotproduct'] = value.id_lotproduct;\r\n    if (value['id_subproduct']) detail['id_subproduct'] = value.id_subproduct\r\n    if (value.type == 5) {\r\n      detail['subComboName'] = value.subComboName\r\n      detail['combos'] = [...value.combos.map(item => {\r\n        let product: VhReturnCustomerInvoiceDetailCombo = {\r\n          id_product: item.id_product, name: item.name, ptype: item.type,\r\n          price: item.price, quantity: item.quantity,\r\n          unit: item.unit, units: item.units, ratio: item.ratio ? item.ratio : 1,\r\n          lots: item.lots ? item.lots : [],\r\n          id_lotproduct: item.id_lotproduct,\r\n        }\r\n        if (item.lot_number) product['lot_number'] = item.lot_number;\r\n        if (item.lots) product['lots'] = item.lots;\r\n        if (item.id_lotproduct) product['id_lotproduct'] = item.id_lotproduct;\r\n        if (item['id_subproduct']) product['id_subproduct'] = item.id_subproduct\r\n        return product;\r\n      })]\r\n    }\r\n\r\n    this.invoiceDetail.unshift(detail)\r\n    if (this.auto_active_quantity_input) {\r\n      setTimeout(() => {\r\n\r\n        this.quantity.nativeElement.focus();\r\n        this.quantity.nativeElement.select();\r\n      }, 0);\r\n    }\r\n\r\n    this.setSubTotal()\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"handleGoBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}} |  <b> {{'Create customer returned' | translate}}</b>\r\n</div>\r\n\r\n<nz-layout>\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{\"Select product\" | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"4\" class=\"center-all-content\">\r\n\r\n                </div>\r\n                <div nz-col nzSpan=\"8\" class=\"center-all-content\">\r\n                    <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                        (click)=\"openSearchProductList()\">\r\n                        <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                        {{'Search (F4)' | translate}}</button>\r\n                </div>\r\n                <div *ngIf=\"!invoiceDetail.length\" class=\"no-data\">\r\n                    <p>{{'Please select a product' | translate}}</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\" *ngFor=\"let item of invoiceDetail,index as i\">\r\n                    <div nz-row>\r\n                        <div (click)=\"deleteGoods(item,i)\" nz-col nzSpan=\"1\">\r\n                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"8\">\r\n                            <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                            <ng-container *ngIf=\"item.id_lotproduct\">\r\n                                <pre style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                    (click)=\"openModalChooseLot(item)\">{{getLotNumber(item.lots, item.id_lotproduct)}}</pre>\r\n                            </ng-container>\r\n                            <ng-container *ngIf=\"item.ptype == 5\">\r\n                                <span class=\"sub-name\" *ngFor=\"let combo of item.combos\">{{combo.quantity}}x\r\n                                    {{combo.name}}\r\n                                    ({{getUnit(combo.units,combo.ratio)}}), </span><br>\r\n                            </ng-container>\r\n                            <!-- Ghi chú -->\r\n                            <div *ngIf=\"vhAuth.localStorageGET('show_note_for_each_product')\">\r\n                                <input nz-input nzBorderless class=\"bill-detail-note\" style=\"text-align: left !important;\"\r\n                                    [placeholder]=\"'Note' | translate\" \r\n                                    [(ngModel)]=\"item.note\" />\r\n                            </div>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"3\">\r\n                            <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.ratio\"\r\n                                (ngModelChange)=\"changeUnit($event,item)\">\r\n                                <!-- <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option> -->\r\n                                <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\"\r\n                                    [nzValue]=\"i.ratio\"></nz-option>\r\n                            </nz-select>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                            <!-- <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                (ngModelChange)=\"checkQuantityProduct(item,$event)\"></nz-input-number> -->\r\n                            <input id=\"quantity\" #quantity [min]=\"0.1\" [max]=\"9999999999\" placeholder=\"Nhập số lượng\"\r\n                                [(ngModel)]=\"item.quantity\"   (ngModelChange)=\"checkQuantityProduct(item,$event)\" type=\"number\" />\r\n                        </div>\r\n                        <div (click)=\"openEditUnitPrice(item)\" class=\"invoiceDetail-item-quantity text-end\" nz-col\r\n                            nzSpan=\"4\">\r\n                            <p class=\"max-width-two-line\" style=\"border-bottom: 1px var(--ion-color-vh-gray) solid;\r\n                            margin-left: 16px;\">\r\n                                <span>{{vhAlgorithm.vhcurrencyunit(item.price)}}</span>\r\n                                <del style=\"font-size: 0.7rem;\" *ngIf=\"display_promotion_selling_price\">\r\n                                    {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin) :\r\n                                    ''}}\r\n                                </del>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                            <p class=\"max-width-two-line\">\r\n                                <b>{{vhAlgorithm.vhcurrencyunit(item.price*item.quantity)}}</b>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Employee' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_employee\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveEmployee($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Return date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\" nz-row style=\"overflow: visible;\">\r\n                <div class=\"sales-bills-customer-title\">\r\n                    <b>{{'Customer information' | translate}}</b>\r\n                    <ion-icon (click)=\"openDrawerAddCustomerOrRetail()\"\r\n                        style=\"color: var(--ion-color-vh-white);padding-right: 5px;\"\r\n                        [src]=\"invoice.retail_name ? 'assets/icon/eye.svg':'assets/icon/add.svg'\">\r\n                    </ion-icon>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <nz-radio-group [(ngModel)]=\"radioValue\" (ngModelChange)=\"changeCustomerType($event)\"\r\n                        nzName=\"radiogroup\">\r\n                        <label nz-radio [nzValue]=1>{{'Retail customer' | translate}}</label>\r\n                        <label nz-radio [nzValue]=2>{{'Member' | translate}}</label>\r\n                        <label nz-radio [nzValue]=3>{{'Search customer' | translate}}</label>\r\n                    </nz-radio-group>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <ng-container *ngIf=\"radioValue == 1 && invoice.retail_name\">\r\n                        {{invoice.retail_name}} - {{invoice.retail_phone}} {{invoice.retail_address ? '-':\r\n                        ''}} {{invoice.retail_address}}\r\n                    </ng-container>\r\n                    <ng-container *ngIf=\"radioValue == 2\">\r\n                        <app-customer [id_customer]=\"invoice.id_customer\"\r\n                            (closeAndReceiveCustomer)=\"closeAndReceiveCustomer($event)\"></app-customer>\r\n                        <i (click)=\"openInfoCustomer()\"\r\n                            [ngClass]=\"invoice.id_customer !='id_retail' ? 'active' : 'deactive'\"\r\n                            style=\"cursor: pointer;\" nz-icon nzType=\"info-circle\" nzTheme=\"outline\"></i>\r\n                    </ng-container>\r\n                    <ng-container *ngIf=\"radioValue == 3\">\r\n                        <app-search-customer [id_customer]=\"invoice.id_customer\"\r\n                            (closeAndReceiveCustomer)=\"closeAndReceiveCustomer($event)\"></app-search-customer>\r\n                        <i (click)=\"openInfoCustomer()\"\r\n                            [ngClass]=\"invoice.id_customer !='id_retail' ? 'active' : 'deactive'\"\r\n                            style=\"cursor: pointer;\" nz-icon nzType=\"info-circle\" nzTheme=\"outline\"></i>\r\n                    </ng-container>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div>{{'SubTotal' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n                <ng-container *ngIf=\"invoice.order_number_ecommerce; else elseTemplate\">\r\n                    <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                        <div>{{'Platform fee' | translate}}</div>\r\n                        <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                            class=\"nz-no-border discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\"\r\n                            nz-input />\r\n                    </div>\r\n                </ng-container>\r\n                <ng-template #elseTemplate>\r\n                    <!-- <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\" *ngIf=\"!printer.discount_hidden\">\r\n                        <div>{{'Discount' | translate}}</div>\r\n                        <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                            class=\"nz-no-border discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\"\r\n                            nz-input />\r\n                    </div> -->\r\n                    <div class=\"sales-bills-content-discount\"\r\n                        style=\"display: flex;justify-content: space-between;align-items: center;\" nz-col nzSpan=\"24\">\r\n                        <div style=\"width: auto;\">{{'Discount value' | translate}}</div>\r\n                        <div>\r\n                            <input id=\"percent-discount-price\" style=\"width: 50px;\" #percentDiscount type=\"number\"\r\n                                max=\"100\" min=\"0\" step=\"0.01\" (blur)=\"editPercentDiscount(percentDiscount.value)\"\r\n                                [value]=\"percent_discount_bill | number:'1.0-2'\" class=\"border_bottom \" maxlength=\"3\"\r\n                                nz-input />%\r\n                        </div>\r\n                        <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                            class=\"border_bottom discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\"\r\n                            nz-input />\r\n                    </div>\r\n                </ng-template>\r\n\r\n\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_fee')\">\r\n                    <div>{{'Fee' | translate}}</div>\r\n                    <input (blur)=\"editFee()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.fee)\"\r\n                        class=\"border_bottom invoice-fee\" type=\"text\" maxlength=\"15\" id=\"invoice-fee\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-tax\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_tax')\">\r\n                    <span>{{'Tax' | translate}}</span>\r\n                    <div>\r\n                        <nz-select *ngIf=\"listTax.length\" [(ngModel)]=\"id_tax\" (ngModelChange)=\"changeTax($event)\"\r\n                            nzBorderless>\r\n                            <nz-option *ngFor=\"let item of listTax\" nzValue=\"{{item._id}}\"\r\n                                nzLabel=\"{{vhAlgorithm.vhpercent(item.value/100)}}\">\r\n                            </nz-option>\r\n                        </nz-select>\r\n                        <span class=\"not-found\" *ngIf=\"!listTax.length\">0.00%</span>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"7\" style=\"text-align: end;\">\r\n                        {{vhAlgorithm.vhcurrencyunit(taxValue)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Total' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(getTotalATax())}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <div>\r\n                        <b>{{'Pay' | translate}}</b>\r\n\r\n                    </div>\r\n                    <div> {{vhAlgorithm.vhcurrencyunit(invoice.payment)}}<img (click)=\"showModalEditTotalPay()\"\r\n                            *ngIf=\"invoice.payment_type != 2\" style=\"width: 16px;margin-left:10px\"\r\n                            src=\"assets/icon/Iconfeather-edit.svg\" /></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_rest')\">\r\n                    <div>{{'Rest' | translate}}</div>\r\n                    <div> {{vhAlgorithm.vhcurrencyunit_symbol(getTotalATax() - invoice.payment)}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"sales-bills-content-payment_type\" nz-col nzSpan=\"24\">\r\n                    <app-tax [payment_type]=\"invoice.payment_type\" [id_wallet]=\"invoice.id_wallet\"\r\n                        [id_customer]=\"invoice.id_customer\" (closeAndGetValuePayment)=\"closeAndGetValuePayment($event)\">\r\n                    </app-tax>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\" *ngIf=\"!printer.note_hidden\">\r\n                    <textarea class=\"nz-hover-border\" [(ngModel)]=\"note\" (blur)=\"edit_note()\" nz-input\r\n                        placeholder=\"{{'Enter note...' | translate}}\"\r\n                        [nzAutosize]=\"{ minRows: 2, maxRows: 4 }\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!invoiceDetail.length || !invoice.id_customer || !checkPrinter\"\r\n                    (click)=\"payInvoice(3,true)\" nz-button class=\"order-and-print\">\r\n                    {{\"Pay & Print\"|translate}} (F2)\r\n                </button>\r\n                <button [disabled]=\"!invoiceDetail.length || !invoice.id_customer\" (click)=\"payInvoice(3,false)\"\r\n                    nz-button class=\"order\">\r\n                    {{\"Pay\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n\r\n<!-- -----nz-drawer list-product-------- -->\r\n<app-search-product [searchProductList]=\"searchProductList\" [default_price_type]=\"default_price_type\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!--Modal edit inut price-->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Edit unit price' | translate}}\" (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Unit price' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\" [value]=\"tempDetail.price\" nz-input\r\n                    placeholder=\"{{'Enter unit price' | translate}}\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!--Modal edit pay-->\r\n<nz-modal [(nzVisible)]=\"edit_pay\" [nzFooter]=\"modalFooterEditPay\" nzTitle=\"{{'Edit' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditPay()\" (nzOnOk)=\"handleEditPay()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Pay' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input [value]=\"vhAlgorithm.vhcurrencyunit(invoice.payment)\" class=\"edit-pay\" type=\"text\" maxlength=\"15\"\r\n                    nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditPay>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditPay()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditPay()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!-- --------------visible drawer info customer----------- -->\r\n<app-customer-profile *ngIf=\"visibleInfoCustomer\" [visibleInfoCustomer]=\"visibleInfoCustomer\" [customer]=\"customer\"\r\n    (closeInfoCustomer)=\"closeInfoCustomer($event)\"></app-customer-profile>\r\n\r\n<!-- --------------------add customer---------------------- -->\r\n<app-add-customer *ngIf=\"showDrawerAddCusomer\" [showDrawerAddCusomer]=\"showDrawerAddCusomer\"\r\n    (closeAddCustomer)=\"closeAddCustomer($event)\"></app-add-customer>\r\n<app-retail-info *ngIf=\"showDrawerAddRetail\" [showDrawerAddRetail]=\"showDrawerAddRetail\"\r\n    [retail_name]=\"invoice.retail_name\" [retail_phone]=\"invoice.getRetailPhone()\"\r\n    [retail_address]=\"invoice.getRetailAddress()\" (closeAddCustomer)=\"closeAddCustomer($event)\"></app-retail-info>\r\n\r\n\r\n<!-- modal chọn lô/HSD -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice2\" [(nzVisible)]=\"show_modal_select_lots\"\r\n    nzTitle=\"{{'Select lot number' | translate}}\" (nzOnCancel)=\"handleCancelChooseLot()\" (nzOnOk)=\"handleChooseLot()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input type=\"text\" nz-input placeholder=\"{{'Find lot number' | translate}}\" #searchValue\r\n                    (keyup)=\"searchLot(searchValue.value )\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <nz-radio-group [(ngModel)]=\"tempDetail.id_lotproduct\" (ngModelChange)=\"changeLot($event)\"\r\n            style=\"width:100%;padding: 8px 0;\">\r\n            <ng-container *ngFor=\"let item of tempDetail.lots\">\r\n                <div nz-row *ngIf=\"!item.hidden\">\r\n                    <div nz-col nzSpan=\"24\">\r\n                        <label class=\"radio-purchase\" nz-radio [nzValue]=\"item._id\" style=\"width:100%;\">\r\n                            <div nz-row>\r\n                                <div nz-col nzSpan=\"8\">\r\n                                    {{item.lot_number}}\r\n                                </div>\r\n\r\n                                <div nz-col nzSpan=\"8\">\r\n                                    NSX: {{item.date_mfg | date : 'dd/MM/yyyy'}}\r\n                                </div>\r\n                                <div nz-col nzSpan=\"8\">\r\n                                    HSD: {{item.date_exp | date : 'dd/MM/yyyy'}}\r\n                                </div>\r\n                            </div>\r\n\r\n                        </label>\r\n                    </div>\r\n\r\n                </div>\r\n            </ng-container>\r\n        </nz-radio-group>\r\n        <div *ngIf=\"!tempDetail.lots.length\" style=\"text-align: center;\">{{'No data' | translate}}</div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice2>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelChooseLot()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\" [disabled]=\"!tempDetail.id_lotproduct\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLot()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- modal chọn lô/HSD cho combo-->\r\n<nz-modal nzWidth=\"70vw\" *ngIf=\"show_modal_select_lots_combo\" [nzFooter]=\"modalFooterEditUnitPrice3\"\r\n    [(nzVisible)]=\"show_modal_select_lots_combo\"\r\n    nzTitle=\"{{'Select lot number for products in combo' | translate}}: {{tempDetail.name}}\"\r\n    (nzOnCancel)=\"show_modal_select_lots_combo = false\" (nzOnOk)=\"handleChooseLotCombo()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"tempDetail.combos\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{{\"Product name\" | translate}}</th>\r\n                    <th>{{'Lot number' | translate}}</th>\r\n                    <th>{{'Unit' | translate}}</th>\r\n                    <th>{{'Quantity' | translate}}</th>\r\n                    <th>{{'Unit price' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let data of basicTable.data\">\r\n                    <ng-container *ngIf=\"data.lots\">\r\n\r\n                        <tr>\r\n                            <td>{{ data.name }}</td>\r\n                            <td>\r\n                                <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                    [(ngModel)]=\"data.id_lotproduct\">\r\n                                    <nz-option *ngFor=\"let element of data.lots\"\r\n                                        nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp | date: 'dd/MM/yyyy'}\"\r\n                                        [nzValue]=\"element._id\"></nz-option>\r\n                                </nz-select>\r\n                            </td>\r\n                            <td>{{getUnit(data.units, data.ratio)}}</td>\r\n                            <td>{{ data.quantity }}</td>\r\n                            <td>\r\n                                {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n\r\n                            </td>\r\n                        </tr>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice3>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"show_modal_select_lots_combo = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLotCombo()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { AddComponent } from './add/add.component';\r\nimport { EditComponent } from './edit/edit.component';\r\nimport { DetailComponent } from './detail/detail.component';\r\nimport { ComponentsModule } from 'src/app/sales/sale-desktop/components/components.module';\r\nimport { NgZorroAntModule } from 'src/app/ng-zorro-ant.module';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { SearchModule } from '../../../search/search.module';\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddComponent,\r\n    EditComponent,\r\n    DetailComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    ComponentsModule,\r\n    NgZorroAntModule,\r\n    TranslateModule,\r\n    FormsModule,\r\n    SearchModule,\r\n    IonicModule\r\n  ],\r\n  exports: [AddComponent,\r\n    EditComponent,\r\n    DetailComponent]\r\n})\r\nexport class BillType3Module { }\r\n","\r\n\r\n\r\nimport { ChangeDetectorRef, Component, Input, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { VhReturnCustomerInvoiceDetail, VhReturnCustomerInvoiceEdit } from '../bill-type3-interface';\r\nimport { CustomerReturnedA4Component } from 'src/app/sales/components/print/customer-returned/customer-returned-a4/customer-returned-a4.component';\r\nimport { CustomerReturnedA5Component } from 'src/app/sales/components/print/customer-returned/customer-returned-a5/customer-returned-a5.component';\r\nimport { CustomerReturnedK80Col4Component } from 'src/app/sales/components/print/customer-returned/customer-returned-k80-col4/customer-returned-k80-col4.component';\r\nimport { CustomerReturnedK80Col3Component } from 'src/app/sales/components/print/customer-returned/customer-returned-k80-col3/customer-returned-k80-col3.component';\r\nimport { CustomerReturnedK57Col3Component } from 'src/app/sales/components/print/customer-returned/customer-returned-k57-col3/customer-returned-k57-col3.component';\r\n\r\n@Component({\r\n  selector: 'bill-type3-detail',\r\n  templateUrl: './detail.component.html',\r\n  styleUrls: ['./detail.component.scss']\r\n})\r\nexport class DetailComponent {\r\n  tableHeight: string;\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore\r\n  @Input() url = '';\r\n  public invoiceInfo: any;\r\n  public invoice: VhReturnCustomerInvoiceEdit = null;\r\n  invoice_detail: VhReturnCustomerInvoiceDetail[]\r\n  subTotal = 0;\r\n  constructor(\r\n    private router: Router,\r\n    private vhQuerySales: VhQuerySales,\r\n    private lang: LanguageService,\r\n    private vhAuth: VhAuth,\r\n    private vhComponent: VhComponent,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private cdRef: ChangeDetectorRef,\r\n    private fncService: FunctionService\r\n  ) {\r\n    this.getDataInvoice(this.router.getCurrentNavigation().extras.state.id)\r\n\r\n\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    //Called after the constructor, initializing input properties, and the first call to ngOnChanges.\r\n    //Add 'implements OnInit' to the class.\r\n    \r\n\r\n  }\r\n\r\n  init(invoice: VhReturnCustomerInvoiceEdit = null, invoiceDetail: VhReturnCustomerInvoiceDetail[] = null) {\r\n    \r\n\r\n    this.invoice = invoice\r\n    this.invoice_detail = invoiceDetail\r\n    if (invoice && invoiceDetail) {\r\n      this.invoiceInfo = {\r\n        employee: this.vhAuth.getlocalEmployee(this.invoice.id_employee),\r\n        partner: this.vhQuerySales.getlocalCustomer(this.invoice.id_customer),\r\n        paymentName: this.setPaymentName(this.invoice.payment_type)\r\n      }\r\n    } else this.invoiceInfo = { employee: {}, partner: {}, paymentName: '' }\r\n    this.setSubTotal()\r\n  }\r\n\r\n  private getDataInvoice(id) {\r\n    this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n      Promise.all([\r\n        this.vhQuerySales.getBill(id),\r\n        this.vhQuerySales.getBill_details_byId_bill(id)\r\n      ]).then(([invoice, invoiceDetail]: any) => {\r\n        if (!invoiceDetail.length)\r\n          this.init(invoice, [])\r\n        else {\r\n          invoiceDetail = this.vhAlgorithm.sortVietnamesebyASC(invoiceDetail, 'name');\r\n          this.init(invoice, invoiceDetail)\r\n        }\r\n        this.vhComponent.hideLoading(0)\r\n      })\r\n    })\r\n  }\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoice_detail) {\r\n      subTotal += (i.price ? i.price * i.quantity : 0)\r\n    }\r\n    this.subTotal = subTotal;\r\n  }\r\n  public setPaymentName(type: 1 | 2 | 3) {\r\n    switch (type) {\r\n      case 1: return this.lang.translate(\"Cash\")\r\n      case 2: return this.lang.translate(\"Debit\")\r\n      case 3: return this.vhQuerySales.getlocalWallet(this.invoice.id_wallet).name\r\n    }\r\n  }\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit\r\n  }\r\n\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id)\r\n    return lot.lot_number + '\\n' + this.fncService.formatDate(lot.date_mfg) + ' - ' + this.fncService.formatDate(lot.date_exp)\r\n  }\r\n  public renderAddress(partner) {\r\n    return (partner.address ? partner.address : '') +\r\n      (partner.district ? ', ' + partner.district : '') +\r\n      (partner.province ? ', ' + partner.province : '') +\r\n      (partner.country ? ', ' + partner.country : '')\r\n  }\r\n\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_customer_returned')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n  printInvoice() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice: this.invoice, invoice_detail: this.invoice_detail }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.goBack())\r\n        })\r\n    }, (err) => {\r\n      this.vhComponent.alertMessage(this.lang.translate(\"Function\"), \"\", this.lang.translate(\"Please turn on the printer function\"), \"OK\")\r\n        .then(() => this.goBack())\r\n    })\r\n  }\r\n\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return CustomerReturnedK57Col3Component\r\n      case 'print_size_k80_3c': return CustomerReturnedK80Col3Component\r\n      case 'print_size_k80_4c': return CustomerReturnedK80Col4Component\r\n      case 'print_size_a5': return CustomerReturnedA5Component\r\n      case 'print_size_a4': return CustomerReturnedA4Component\r\n      default: return CustomerReturnedA4Component\r\n    }\r\n  }\r\n  goBack() {\r\n    this.router.navigate([this.url], { state: this.dataRestore });\r\n  }\r\n  ngAfterViewChecked() {\r\n    if (document.getElementById('sales-invoice-detail-today') && document.querySelector(\".sales-cart-header\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".ant-table-pagination\")) {\r\n      this.tableHeight = document.getElementById('sales-invoice-detail-today').clientHeight - document.querySelector(\".sales-cart-header\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".ant-table-pagination\").clientHeight - 40 + \"px\";\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n  goToCart() {\r\n    this.vhQuerySales.getValidityDate(this.invoice.date).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        if (this.vhAuth.checkMyPermission(\"customer_return_enable_edit_bill\"))\r\n          this.router.navigate([this.url + '/edit-customer-return'], { state: { dataRestore: this.dataRestore, invoiceDetail: this.invoice_detail, invoice: this.invoice, } })\r\n        else this.vhComponent.showToast(1500, this.lang.translate('You do not have this rights'), \"alert-toast\")\r\n      }\r\n      else {\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.lang.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n\r\n  }\r\n  deleteInvoice() {\r\n    this.vhQuerySales.getValidityDate(this.invoice.date).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        if (this.vhAuth.checkMyPermission(\"return_enable_cancel_customer\")) {\r\n          this.vhComponent.alertConfirm(this.lang.translate(\"Confirm\"), \"\", `${this.lang.translate(\"Are you sure to cancel the purchase invoice\")}?`, \"OK\", this.lang.translate(\"Cancel\"))\r\n            .then(() => {\r\n              this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n                this.dataRestore.invoice = this.dataRestore.invoice.filter(e => e._id != this.invoice._id)\r\n                this.vhQuerySales.deleteBill_Billdetail(this.invoice._id).then(() => {\r\n                  this.vhComponent.hideLoading(0).then(() => {\r\n                    this.vhComponent.showToast(2000,\r\n                      `${this.lang.translate(\"Customer returned invoice\")} ${this.invoice.bill_code} ${this.lang.translate(\"has been cancelled successfully\")}`, \"success-toast\")\r\n                    this.goBack();\r\n                  })\r\n                })\r\n              })\r\n            }, () => { })\r\n        }\r\n        else this.vhComponent.showToast(1500, this.lang.translate('You do not have this rights'), \"alert-toast\")\r\n      }\r\n      else {\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.lang.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n\r\n\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n<nz-layout id=\"sales-invoice-detail-today\" *ngIf=\"invoice\">\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{'Customer returned' | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n                    <div>\r\n                        <button (click)=\"goToCart()\" class=\"btn-data nz-hover-border center-all-content\" nz-button\r\n                            nzType=\"default\">\r\n                            <span nz-icon nzType=\"edit\" nzTheme=\"outline\"></span>\r\n                            {{'Edit' | translate}}\r\n                        </button>\r\n                    </div>\r\n                    <div style=\"margin-left:4px\">\r\n                        <button (click)=\"printInvoice()\" class=\"btn-data nz-hover-border center-all-content\" nz-button\r\n                            nzType=\"default\">\r\n                            <span nz-icon nzType=\"printer\" nzTheme=\"outline\"></span>\r\n                            {{'Print' | translate}}\r\n                        </button>\r\n                    </div>\r\n                    <div style=\"margin-left:4px\">\r\n                        <button (click)=\"deleteInvoice()\" class=\"btn-data nz-hover-border center-all-content\" nz-button\r\n                            nzType=\"default\">\r\n                            <span nz-icon nzType=\"delete\" nzTheme=\"outline\"></span>\r\n                            {{'Delete' | translate}}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\">\r\n                    <nz-table [nzScroll]=\"{ y: tableHeight }\" [nzData]=\"invoice_detail || []\" #rowSelectionTable\r\n                        nzShowSizeChanger nzNoResult=\"{{'No data' | translate}}\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th nzWidth=\"35%\"><b>{{'Product name' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='center'><b>{{'Unit' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='center'><b>{{'Quantity' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='right'><b>{{'Unit price' | translate}}</b></th>\r\n                                <th nzWidth=\"20%\" nzAlign='right'><b>{{'Total' | translate}}</b></th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr *ngFor=\"let item of rowSelectionTable.data\" style=\"cursor: pointer;\">\r\n                                <td>{{item.name}} <br>\r\n                                    <ng-container *ngIf=\"item.lots\">\r\n                                        <pre>{{getLotNumber(item.lots, item.id_lotproduct)}}</pre>\r\n                                    </ng-container>\r\n                                    <ng-container *ngIf=\"item.ptype == 5\">\r\n                                        <span class=\"sub-name\" *ngFor=\"let combo of item.combos\">{{combo.quantity}}x\r\n                                            {{combo.name}}\r\n                                            ({{getUnit(combo.units,combo.ratio)}}), </span><br>\r\n                                    </ng-container>\r\n                                </td>\r\n                                <td nzAlign='center'>\r\n                                    {{getUnit(item.units, item.ratio)}}\r\n                                </td>\r\n                                <td nzAlign='center'>{{item.quantity}}</td>\r\n                                <td nzAlign='right'>{{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n                                    <del style=\"font-size: 0.7rem;\">\r\n                                        {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin)\r\n                                        : ''}}\r\n                                    </del>\r\n                                </td>\r\n                                <td nzAlign='right'><b>{{vhAlgorithm.vhcurrencyunit(item.quantity * item.price)}}</b>\r\n                                </td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </nz-table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills not-continue-sell\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div>\r\n                    <b>{{'Invoice code' | translate}}</b>\r\n                    <div> {{invoice.bill_code}}</div>\r\n                </div>\r\n                <div>\r\n                    <b>{{'Salesman' | translate}}</b>\r\n                    <div>{{invoiceInfo.employee.name}}</div>\r\n                </div>\r\n                <div>\r\n                    <b>{{'Sales date' | translate}}</b>\r\n                    <div>{{invoice.date | date: 'dd/MM/yyyy HH:mm'}}</div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\" nz-row>\r\n                <b>{{'Customer information' | translate}}</b>\r\n                <div *ngIf=\"invoiceInfo.partner._id == 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{invoiceInfo.partner.name | translate}}\r\n                </div>\r\n                <div *ngIf=\"invoiceInfo.partner._id != 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{invoiceInfo.partner.name | translate}} - {{invoiceInfo.partner.phone}}\r\n                </div>\r\n                <div *ngIf=\"invoiceInfo.partner._id != 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{renderAddress(invoiceInfo.partner)}}\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <span>{{'SubTotal' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Discount' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.discount)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Fee' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.fee)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-tax\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Tax' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhpercent(invoice.tax/ 100)}}</div>\r\n                    <div>\r\n                        {{vhAlgorithm.vhcurrencyunit(invoice.total * (invoice.tax / 100))}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Total' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.total + invoice.total * (invoice.tax / 100))}}</div>\r\n\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Pay' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit_symbol(invoice.payment)}}</div>\r\n\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Rest' | translate}}</span>\r\n                    <div style=\"color: var(--ion-color-vh-red);\">{{vhAlgorithm.vhcurrencyunit_symbol(invoice.total * (1+invoice.tax / 100) -\r\n                        invoice.payment)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-payment_type\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Payment method' | translate}}</span>\r\n                    <div>{{setPaymentName(this.invoice.payment_type)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Note' | translate}}</span>\r\n                    <div>{{invoice.note}}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>","\r\n\r\nimport { ChangeDetectorRef, Component, OnInit, HostListener, Input } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { Observable } from 'rxjs';\r\nimport { CustomerReturnedA4Component } from 'src/app/sales/components/print/customer-returned/customer-returned-a4/customer-returned-a4.component';\r\nimport { CustomerReturnedA5Component } from 'src/app/sales/components/print/customer-returned/customer-returned-a5/customer-returned-a5.component';\r\nimport { CustomerReturnedK80Col4Component } from 'src/app/sales/components/print/customer-returned/customer-returned-k80-col4/customer-returned-k80-col4.component';\r\nimport { CustomerReturnedK80Col3Component } from 'src/app/sales/components/print/customer-returned/customer-returned-k80-col3/customer-returned-k80-col3.component';\r\nimport { CustomerReturnedK57Col3Component } from 'src/app/sales/components/print/customer-returned/customer-returned-k57-col3/customer-returned-k57-col3.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { VhReturnCustomerInvoiceEdit, VhReturnCustomerInvoiceDetailCombo, VhReturnCustomerInvoiceDetail } from '../bill-type3-interface';\r\n\r\n\r\n@Component({\r\n  selector: 'bill-type3-edit',\r\n  templateUrl: './edit.component.html',\r\n  styleUrls: ['./edit.component.scss']\r\n})\r\nexport class EditComponent implements OnInit {\r\n  display_promotion_selling_price: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').display_promotion_selling_price\r\n  invoice: VhReturnCustomerInvoiceEdit = this.router.getCurrentNavigation().extras.state.invoice\r\n  invoiceDetail = this.router.getCurrentNavigation().extras.state.invoiceDetail\r\n  subTotal = 0;\r\n  taxValue = 0\r\n  listTax: any[] = this.vhQuerySales.getlocalTaxs().filter(tax => tax.status);\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore\r\n  employee: any = {};\r\n  pickerTime = new Date();\r\n  customer: any;\r\n  printer: any;\r\n  percent_discount_bill: number = 0;\r\n  is_discount_bill: boolean = false;\r\n  default_price_type: number\r\n  showModalChangePriceType: boolean = false;\r\n  @Input() url = '';\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private languageService: LanguageService,\r\n    private vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    public vhAuth: VhAuth,\r\n    private cdRef: ChangeDetectorRef,\r\n    private fncService: FunctionService,\r\n    private nzModalService: NzModalService\r\n  ) {\r\n\r\n  }\r\n\r\n  ngOnInit(): void {\r\n\r\n\r\n    // this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    this.default_price_type = this.invoice.price_type;\r\n    this.pickerTime = new Date(this.invoice.date)\r\n    this.id_tax = this.listTax.find(item => item.value == this.invoice.tax)._id;\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_customer_returned')\r\n    this.printer = printer ? printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)] : { discount_hidden: false, note_hidden: false, fee_hidden: false, tax_hidden: false, debt_hidden: false };\r\n\r\n    //tính tổng tiền\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      subTotal += (i.price ? i.price * i.quantity : 0)\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.taxValue = this.invoice.total * (this.invoice.tax / 100)\r\n    this.radioValue = this.invoice.id_customer == 'id_retail' ? 1 : 2\r\n\r\n  }\r\n  event: any // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n  }\r\n  checkPrinter: boolean = false\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113 || keycode === 114) event.preventDefault();\r\n      if (keycode === 115) this.searchProductList = !this.searchProductList;\r\n      else if (this.invoiceDetail.length > 0) {\r\n        switch (keycode) {\r\n          case 112: this.payInvoice(3, false)\r\n            break;\r\n          case 113: {\r\n            if (this.checkPrinter) this.payInvoice(3, true)\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  ngAfterViewInit() {\r\n    this.checkPrinter = this.printer.enable;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      if (document.querySelector(\".discount-price\")) this.discount_price = this.vhAlgorithm.vhnumeral(\".discount-price\");\r\n      if (document.querySelector(\".invoice-fee\")) this.invoice_fee = this.vhAlgorithm.vhnumeral(\".invoice-fee\")\r\n    })\r\n    // ------bắt sự kiện nhấn phím nóng-----\r\n    this.eventKeypress();\r\n  }\r\n  ngAfterViewChecked() {\r\n    this.cdRef.detectChanges();\r\n  }\r\n  deleteGoods(detail: VhReturnCustomerInvoiceDetail, index) {\r\n    this.vhComponent.alertConfirm(\"\", \"\", `${this.languageService.translate(\"Delete\")} ${detail.name}?`, \"OK\", this.languageService.translate(\"Cancel\"))\r\n      .then(() => {\r\n        this.invoiceDetail.splice(index, 1);\r\n        this.setSubTotal();\r\n      }, () => { })\r\n  }\r\n  searchProductList: boolean = false;\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit\r\n  }\r\n  closeSearchProductList(data) {\r\n\r\n\r\n    if (data) {\r\n      if (data.manylot && !data.id_lotproduct) this.openModalChooseLot(data)\r\n      else\r\n        if (data.combos && data.combos.filter(e => e.lots && !e.id_lotproduct).length) {\r\n          this.tempDetail = data;\r\n          this.show_modal_select_lots_combo = true;\r\n        }\r\n        else\r\n          if (!this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').show_product_mutil_line_customer_return)\r\n            this.addInvoiceDetail(data);\r\n          else\r\n            this.addInvoiceDetailMultiLine(data);\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n  checkQuantityProduct(product: VhReturnCustomerInvoiceDetail, event) {\r\n    if (!event) product.quantity = 1;\r\n    this.setSubTotal();\r\n  }\r\n  changeUnit(ev, item) {\r\n    if (this.default_price_type == 1) {\r\n      let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n      if (unit) {\r\n        item.unit = unit.unit\r\n        item.price = parseFloat(unit.price)\r\n        item.ratio = parseFloat(unit.ratio)\r\n        item.price_origin = parseFloat(unit.price)\r\n      }\r\n    }\r\n    else {\r\n      let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n      if (unit) {\r\n        item.unit = unit.unit\r\n        item.price = parseFloat(unit.price2)\r\n        item.ratio = parseFloat(unit.ratio)\r\n        item.price_origin = parseFloat(unit.price2)\r\n      }\r\n    }\r\n    this.setSubTotal()\r\n  }\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhReturnCustomerInvoiceDetail;\r\n  openEditUnitPrice(detail: VhReturnCustomerInvoiceDetail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      this.setSubTotal();\r\n      this.isVisibleEditUnitPrice = false;\r\n    } else { this.vhComponent.showToast(2000, this.languageService.translate(\"Invalid data, please check again\"), \"alert-toast\") }\r\n  }\r\n  handleCancelEditUnit() { this.isVisibleEditUnitPrice = false }\r\n  // -------set employee-------\r\n  closeAndReceiveEmployee(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n    }\r\n  }\r\n  // ----set customer-----\r\n  radioValue: 1 | 2 | 3 = 1;\r\n  closeAndReceiveCustomer(event) {\r\n    if (event) {\r\n      this.invoice.id_customer = (event);\r\n      if (!this.vhQuerySales.getlocalCustomer(event).debt_enable) this.invoice.payment = (this.getTotalATax());\r\n    }\r\n  }\r\n  changeCustomerType(event) {\r\n    if (this.radioValue == 1) {\r\n\r\n      this.invoice.id_customer = (\"id_retail\");\r\n      this.invoice.payment = (this.getTotalATax());\r\n    } if (event == 2 && this.invoice.retail_name) {\r\n      this.nzModalService.confirm({\r\n        nzTitle: `${this.languageService.translate('Retail customer information will be lost')}?`,\r\n        nzCancelText: this.languageService.translate(\"Cancel\"),\r\n        nzOkText: \"Ok\",\r\n        nzOnOk: () => { this.clearRetailCustomer() },\r\n        nzOnCancel: () => { this.radioValue = 1 },\r\n      }\r\n      )\r\n    }\r\n  }\r\n  clearRetailCustomer() {\r\n    this.invoice.retail_address = ('')\r\n    this.invoice.retail_name = ('')\r\n    this.invoice.retail_phone = ('')\r\n  }\r\n  setPickerTime(event) {\r\n    if (new Date(event).getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 5000)\r\n      this.pickerTime = new Date(this.invoice.date)\r\n      this.invoice.date = (new Date(this.pickerTime));\r\n    }\r\n    else this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        this.invoice.date = (event);\r\n      }\r\n      else {\r\n        this.pickerTime = new Date(validitydate)\r\n        this.invoice.date = (new Date(this.pickerTime));\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n  }\r\n  // -------change tax------\r\n  id_tax: string;\r\n  changeTax(event) {\r\n    let tax = this.listTax.find(item => item._id == event);\r\n    this.invoice.tax = (tax.value);\r\n    this.setTaxValue();\r\n  }\r\n  closeAndGetValuePayment(event) {\r\n    if (event[0] == 1 || event[0] == 2) {\r\n      this.setPaymentType(event[0])\r\n    }\r\n    else if (event[0] == 3) {\r\n      this.setPaymentType(event[0], event[1]);\r\n    }\r\n  }\r\n  setPaymentType(type: 1 | 2 | 3, id_wallet?) {\r\n    this.invoice.payment_type = (type)\r\n    switch (type) {\r\n      case 1: {\r\n        this.invoice.id_wallet = ('id_cash');\r\n        this.invoice.payment = (this.invoice.payment ? this.invoice.payment : this.invoice.total + this.taxValue);\r\n\r\n        break;\r\n      }\r\n      case 2: {\r\n        this.invoice.payment = (0); this.invoice.id_wallet = (null);\r\n\r\n\r\n        break;\r\n      }\r\n      case 3: {\r\n        if (id_wallet) {\r\n          this.invoice.id_wallet = (id_wallet)\r\n          this.invoice.payment = (this.invoice.payment ? this.invoice.payment : this.invoice.total + this.taxValue);\r\n\r\n          break;\r\n        }\r\n      }\r\n    };\r\n  }\r\n  // -------------- discount\r\n  discount_price: any;\r\n  editDiscount() {\r\n    if (this.discount_price.getRawValue() && this.discount_price.getRawValue() >= 0 && this.discount_price.getRawValue() <= this.subTotal) {\r\n      this.invoice.discount = (parseFloat(this.discount_price.getRawValue()));\r\n      this.percent_discount_bill = this.subTotal ? (this.invoice.discount / this.subTotal) * 100 : 0\r\n    } else {\r\n      document.getElementById(\"discount-price\")['value'] = this.invoice.discount;\r\n      this.discount_price = this.vhAlgorithm.vhnumeral('.discount-price');\r\n    }\r\n    this.setTotal()\r\n  }\r\n\r\n  editPercentDiscount(value) {\r\n    if (parseFloat(value) > 100)\r\n      document.getElementById(\"percent-discount-price\")['value'] = 0\r\n    else this.percent_discount_bill = value;\r\n    this.invoice.discount = this.subTotal * (this.percent_discount_bill / 100)\r\n    this.setTotal()\r\n  }\r\n  invoice_fee: any;\r\n  editFee() {\r\n    if (this.invoice_fee.getRawValue() && this.invoice_fee.getRawValue() >= 0) {\r\n      this.invoice.fee = (parseFloat(this.invoice_fee.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"invoice-fee\")['value'] = this.invoice.fee;\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral('.invoice-fee');\r\n    }\r\n    this.setTotal()\r\n  }\r\n  // -------modal edit pay---------\r\n  edit_pay: boolean = false;\r\n  edit_paytotal: any;\r\n  showModalEditTotalPay() {\r\n    if (this.invoice.payment_type != 2 && this.vhQuerySales.getlocalCustomer(this.invoice.id_customer).debt_enable) {\r\n      this.vhAlgorithm.waitingStack().then(() => {\r\n        this.edit_paytotal = this.vhAlgorithm.vhnumeral(\".edit-pay\");\r\n      })\r\n      this.edit_pay = true;\r\n    }\r\n    else if (!this.vhQuerySales.getlocalCustomer(this.invoice.id_customer).debt_enable) {\r\n      this.vhComponent.showToast(5000,\r\n        this.languageService.translate(\"This customer is not allowed to debt\"), \"alert-toast\"\r\n      )\r\n    }\r\n  }\r\n  handleEditPay() {\r\n    if (this.edit_paytotal.getRawValue() >= 0 && this.edit_paytotal.getRawValue() <= this.getTotalATax()) {\r\n      this.invoice.payment = (parseFloat(this.edit_paytotal.getRawValue()))\r\n    }\r\n    this.edit_pay = false;\r\n  }\r\n  handleCancelEditPay() {\r\n    this.edit_pay = false;\r\n  }\r\n\r\n  goBack() {\r\n    this.isExit = true\r\n    this.router.navigate([this.url], { state: this.dataRestore })\r\n  }\r\n  handleGoBack() {\r\n    this.vhComponent.alertConfirm(`${this.languageService.translate(\"Confirm\")}`, \"\", `${this.languageService.translate(\"Bạn muốn thoát và không lưu hóa đơn này\")}?`, \"OK\", this.languageService.translate('Cancel'))\r\n      .then(() => { this.isExit = true, this.router.navigate([this.url], { state: this.dataRestore }) }, () => { })\r\n  }\r\n  note: string;\r\n  edit_note() {\r\n    if (this.note) {\r\n      this.invoice.note = (this.note)\r\n    }\r\n  }\r\n\r\n  //--------------visible drawer info customer-----------\r\n  visibleInfoCustomer: boolean = false;\r\n  openInfoSupplier() {\r\n    if (this.invoice.id_customer) {\r\n      this.customer = this.vhQuerySales.getlocalSupplier(this.invoice.id_customer);\r\n      this.visibleInfoCustomer = true;\r\n    }\r\n  }\r\n  closeInfoSupplier(event) {\r\n    this.visibleInfoCustomer = false;\r\n  }\r\n  payInvoice(bill_type: 3 | 23, print?) {\r\n    this.vhComponent.alertConfirm((!print ? `${this.languageService.translate(\"Pay\")}?` : `${this.languageService.translate(\"Pay & Print\")}?`), \"\", \"\", \"OK\", this.languageService.translate(\"Cancel\"))\r\n      .then(() => {\r\n        this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n          this.createOrUpdate(bill_type).then(bill => {\r\n            this.vhComponent.hideLoading(0).then(() => {\r\n              this.vhComponent.showToast(2000,\r\n                `${this.languageService.translate(\"Customer returned invoice\")} ${this.invoice.bill_code} ${this.languageService.translate(\"has been updated successfully\")}`, \"success-toast\"\r\n              )\r\n\r\n              if (print) this.handlePrint()\r\n              else this.goBack()\r\n            })\r\n          })\r\n        })\r\n      }, () => { })\r\n  }\r\n  createOrUpdate(bill_type: 3 | 23) {\r\n    return this.vhQuerySales.updateBill_Billdetail(this.invoice._id, this.getCreateUpdateInvoice(bill_type), this.getCreateUpdateInvoiceDetail())\r\n  }\r\n\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_customer_returned')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n  handlePrint() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice: this.invoice, invoice_detail: this.invoiceDetail }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.goBack())\r\n        })\r\n    }, (err) => {\r\n      this.vhComponent.alertMessage(this.languageService.translate(\"Function\"), \"\", this.languageService.translate(\"Please turn on the printer function\"), \"OK\")\r\n        .then(() => this.goBack())\r\n    })\r\n  }\r\n\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return CustomerReturnedK57Col3Component\r\n      case 'print_size_k80_3c': return CustomerReturnedK80Col3Component\r\n      case 'print_size_k80_4c': return CustomerReturnedK80Col4Component\r\n      case 'print_size_a5': return CustomerReturnedA5Component\r\n      case 'print_size_a4': return CustomerReturnedA4Component\r\n      default: return CustomerReturnedA4Component\r\n    }\r\n  }\r\n  //--------------visible drawer info customer-----------\r\n  openInfoCustomer() {\r\n    if (this.invoice.id_customer != 'id_retail') {\r\n      this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n      this.visibleInfoCustomer = true;\r\n    }\r\n  }\r\n  closeInfoCustomer(event) {\r\n    this.visibleInfoCustomer = false;\r\n  }\r\n  // ------thoát trang-----\r\n  isExit: boolean = false;\r\n  checkDeactivate(currentRoute: ActivatedRouteSnapshot, currentState: RouterStateSnapshot, nextState?: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    return nextState.url == '/login' ? true : (this.isExit ? this.isExit : this.vhComponent.alertConfirm(this.languageService.translate(\"Confirm\"), \"\", this.languageService.translate(\"Are you sure to cancel the sales order\"), \"OK\", (this.languageService.translate(\"Cancel\"))).then(() => { return true }).catch(() => { return false }))\r\n  }\r\n  /**add customer */\r\n  showDrawerAddCusomer: boolean = false;\r\n  showDrawerAddRetail: boolean = false\r\n  openDrawerAddCustomerOrRetail() {\r\n    if (this.radioValue == 1) this.showDrawerAddRetail = true\r\n    else this.showDrawerAddCusomer = true\r\n  }\r\n  closeAddCustomer(result) {\r\n    if (this.radioValue == 1) {\r\n      if (result) {\r\n        this.invoice.retail_name = (result.retail_name)\r\n        this.invoice.retail_phone = (result.retail_phone)\r\n        this.invoice.retail_address = (result.retail_address)\r\n      }\r\n      this.showDrawerAddRetail = false\r\n    } else this.showDrawerAddCusomer = false\r\n  }\r\n\r\n  barcode: string = ''\r\n  barcode_array = [];\r\n  @HostListener(\"window: keypress\", [\"$event\"])\r\n  /**\r\n   * Sự kiện nhận barcode\r\n   */\r\n  getKeyUp(_event: KeyboardEvent) {\r\n    if (this.router.url === \"/sales/dashboard/manage/invoice/customer-return/add-customer-return\") {\r\n      // if (!this.showSearchBar && !this.showPayInfo) {\r\n      if (_event.key == \"Enter\") {\r\n        this.barcode_array.forEach((i, index) => {\r\n          if (i == \"Shift\") {\r\n            this.barcode_array[index + 1] = this.barcode_array[\r\n              index + 1\r\n            ].toUpperCase();\r\n            this.barcode_array.splice(index, 1);\r\n          }\r\n        });\r\n        // this.scanBarcode(this.barcode_array.join(\"\"));\r\n        this.barcode = this.barcode_array.join(\"\");\r\n        setTimeout(() => {\r\n          let detailproduct = this.vhQuerySales.getlocalDetailProduct_byBarcode(this.barcode);\r\n          if (detailproduct) this.closeSearchProductList({ ...detailproduct, ...this.vhQuerySales.getUnit_byRatio(detailproduct.units, detailproduct.ratio) });\r\n          this.barcode_array = [];\r\n        }, 100);\r\n\r\n      } else {\r\n        this.barcode_array.push(_event.key);\r\n      }\r\n      // }\r\n    }\r\n  }\r\n\r\n\r\n  show_modal_select_lots = false;\r\n  list_search_lot = [];\r\n\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id);\r\n    return lot.lot_number\r\n  }\r\n  searchLot(value) {\r\n    this.tempDetail.lots = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.list_search_lot, ['lot_number'])\r\n  }\r\n  openModalChooseLot(data) {\r\n    this.tempDetail = data\r\n    this.list_search_lot = this.tempDetail.lots\r\n    if (!this.list_search_lot.length) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Sản phẩm này không có lô khả dụng để bán!\"))\r\n    else this.show_modal_select_lots = true;\r\n  }\r\n\r\n  changeLot(e) {\r\n    this.tempDetail.lot_number = this.tempDetail.lots.find(item => item._id == e).lot_number\r\n  }\r\n\r\n  handleChooseLot() {\r\n\r\n\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot;\r\n    if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n  }\r\n\r\n  handleCancelChooseLot() {\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot\r\n  }\r\n  show_modal_select_lots_combo = false;\r\n  handleChooseLotCombo() {\r\n    if (this.tempDetail.combos.filter(item => item.lots && !item.id_lotproduct).length)\r\n      this.vhComponent.alertMessageDesktop(\"warning\", this.languageService.translate(\"Vui lòng chọn lô cho sản phẩm thuộc combo này\"))\r\n    else {\r\n      this.show_modal_select_lots_combo = false;\r\n      this.closeSearchProductList(this.tempDetail)\r\n    }\r\n  }\r\n  getTotalATax(): number {\r\n    return this.invoice.total + this.taxValue\r\n  }\r\n\r\n  removeInvoiceDetail(id: string, notSetSub?: boolean) {\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == id)\r\n    if (index != -1) {\r\n      this.invoiceDetail.splice(index, 1);\r\n      if (!notSetSub) this.setSubTotal()\r\n    }\r\n  }\r\n\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      let total_product_gift = 0;\r\n      let total_products = 0;\r\n      if (i.products_gift) {\r\n        total_product_gift = i.products_gift.filter(item => item.choose).reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n\r\n      }\r\n      else if (i.products) {\r\n\r\n        total_products = i.products.reduce((prev: number, next) => prev + next.quantity * next.price, 0)\r\n      }\r\n      subTotal += total_products + total_product_gift + (i.price ? i.price * i.quantity : 0)\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal();\r\n  }\r\n\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee\r\n    this.setTaxValue()\r\n\r\n  }\r\n\r\n  setTaxValue() {\r\n    this.taxValue = this.invoice.total * (this.invoice.tax / 100)\r\n    this.setPayment()\r\n  }\r\n  setPayment(value?: number) {\r\n\r\n    if (this.invoice.payment_type == 2) {\r\n      this.invoice.payment = 0\r\n    } else {\r\n      if (value != null)\r\n        this.invoice.payment = value\r\n      else\r\n        this.invoice.payment = this.invoice.total + this.taxValue\r\n    }\r\n\r\n  }\r\n  getCreateUpdateInvoice(bill_type: 3 | 23) {\r\n    if (bill_type) this.invoice.bill_type = (bill_type)\r\n    return this.invoice\r\n  }\r\n\r\n  public getCreateUpdateInvoiceDetail(): VhReturnCustomerInvoiceDetail[] {\r\n    return this.invoiceDetail.map(item => {\r\n      let detail: VhReturnCustomerInvoiceDetail = {\r\n        id_product: item.id_product, price: item.price, quantity: item.quantity,\r\n        ptype: item.ptype,\r\n        ratio: item.ratio,\r\n        note: item.note,\r\n      }\r\n      if (item.ptype == 5) detail['combos'] = item.combos.map(e => {\r\n        let product: VhReturnCustomerInvoiceDetailCombo = {\r\n          id_product: e.id_product,\r\n          price: e.price, quantity: e.quantity, ptype: e.ptype,\r\n          ratio: e.ratio ? e.ratio : 1\r\n        }\r\n        if (e.id_lotproduct) product['id_lotproduct'] = e.id_lotproduct\r\n        if (e['id_subproduct']) product['id_subproduct'] = e.id_subproduct\r\n        return product;\r\n      })\r\n      if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct\r\n      if (item['id_subproduct']) detail['id_subproduct'] = item.id_subproduct\r\n      if (item.price < item.price_origin) detail['price_origin'] = item.price_origin\r\n      return detail\r\n    })\r\n  }\r\n  addInvoiceDetail(value: any) {\r\n    if (value['id_subproduct']) {\r\n      if (value.lot_number) {\r\n        let index = this.invoiceDetail.findIndex(detail => detail['lot_number'] == value['lot_number'] && detail['id_lotproduct'] == value['id_lotproduct'])\r\n        if (index != -1) {\r\n          if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n          this.setSubTotal()\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n      else {\r\n        let index = this.invoiceDetail.findIndex(detail => detail['id_subproduct'] == value['id_subproduct'] && detail['ratio'] == value['ratio'])\r\n        if (index != -1) {\r\n          if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n          this.setSubTotal()\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n    }\r\n    else {\r\n      if (value.lot_number) {\r\n        let index = this.invoiceDetail.findIndex(detail => detail['lot_number'] == value['lot_number'] && detail['id_lotproduct'] == value['id_lotproduct'])\r\n        if (index != -1) {\r\n          if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n          this.setSubTotal()\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n      else {\r\n        let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == value['_id'] && detail['ratio'] == value['ratio'])\r\n        if (index != -1) {\r\n          if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1\r\n          this.setSubTotal()\r\n        } else {\r\n          this.addBill_Detail(value)\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  addBill_Detail(value) {\r\n    let detail: any = {\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      unit: value.unit,\r\n      units: value.units,\r\n      ratio: value.ratio,\r\n      ptype: value.type,\r\n      price: value.price,\r\n      price_origin: value.price,\r\n      id_category: value.id_category\r\n    }\r\n\r\n    if (value.lot_number) detail['lot_number'] = value.lot_number;\r\n    if (value.lots) detail['lots'] = value.lots;\r\n    if (value.id_lotproduct) detail['id_lotproduct'] = value.id_lotproduct;\r\n    if (value['id_subproduct']) detail['id_subproduct'] = value.id_subproduct\r\n    if (value.type == 5) {\r\n      detail['subComboName'] = value.subComboName\r\n      detail['combos'] = [...value.combos.map(item => {\r\n        let product: VhReturnCustomerInvoiceDetailCombo = {\r\n          id_product: item.id_product, name: item.name, ptype: item.type,\r\n          price: item.price, quantity: item.quantity,\r\n          unit: item.unit, units: item.units, ratio: item.ratio ? item.ratio : 1,\r\n          lots: item.lots ? item.lots : [],\r\n          id_lotproduct: item.id_lotproduct,\r\n        }\r\n        if (item.lot_number) product['lot_number'] = item.lot_number;\r\n        if (item.lots) product['lots'] = item.lots;\r\n        if (item.id_lotproduct) product['id_lotproduct'] = item.id_lotproduct;\r\n        if (item['id_subproduct']) product['id_subproduct'] = item.id_subproduct\r\n        return product;\r\n      })]\r\n    }\r\n    this.invoiceDetail.unshift(detail)\r\n    this.setSubTotal()\r\n  }\r\n\r\n  public addInvoiceDetailMultiLine(value: any) {\r\n    let detail: any = {\r\n      name: value.name,\r\n      id_product: value._id,\r\n      quantity: 1,\r\n      unit: value.unit,\r\n      units: value.units,\r\n      ratio: value.ratio,\r\n      ptype: value.type,\r\n      price: value.price,\r\n      price_origin: value.price,\r\n      id_category: value.id_category\r\n    }\r\n\r\n    if (value.lot_number) detail['lot_number'] = value.lot_number;\r\n    if (value.lots) detail['lots'] = value.lots;\r\n    if (value.id_lotproduct) detail['id_lotproduct'] = value.id_lotproduct;\r\n    if (value['id_subproduct']) detail['id_subproduct'] = value.id_subproduct\r\n    if (value.type == 5) {\r\n      detail['subComboName'] = value.subComboName\r\n      detail['combos'] = [...value.combos.map(item => {\r\n        let product: VhReturnCustomerInvoiceDetailCombo = {\r\n          id_product: item.id_product, name: item.name, ptype: item.type,\r\n          price: item.price, quantity: item.quantity,\r\n          unit: item.unit, units: item.units, ratio: item.ratio ? item.ratio : 1,\r\n          lots: item.lots ? item.lots : [],\r\n          id_lotproduct: item.id_lotproduct,\r\n        }\r\n        if (item.lot_number) product['lot_number'] = item.lot_number;\r\n        if (item.lots) product['lots'] = item.lots;\r\n        if (item.id_lotproduct) product['id_lotproduct'] = item.id_lotproduct;\r\n        if (item['id_subproduct']) product['id_subproduct'] = item.id_subproduct\r\n        return product;\r\n      })]\r\n    }\r\n\r\n    this.invoiceDetail.unshift(detail)\r\n\r\n    this.setSubTotal()\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"handleGoBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}} |  <b> {{'Edit customer returned' | translate}}</b>\r\n</div>\r\n\r\n<nz-layout>\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{\"Select product\" | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"4\" class=\"center-all-content\">\r\n\r\n                </div>\r\n                <div nz-col nzSpan=\"8\" class=\"center-all-content\">\r\n                    <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                        (click)=\"openSearchProductList()\">\r\n                        <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                        {{'Search (F4)' | translate}}</button>\r\n                </div>\r\n                <div *ngIf=\"!invoiceDetail.length\" class=\"no-data\">\r\n                    <p>{{'Please select a product' | translate}}</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\" *ngFor=\"let item of invoiceDetail,index as i\">\r\n                    <div nz-row>\r\n                        <div (click)=\"deleteGoods(item,i)\" nz-col nzSpan=\"1\">\r\n                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"8\">\r\n                            <p style=\"font-weight: bold; margin-bottom: 0;\">{{item.name}}</p>\r\n                            <ng-container *ngIf=\"item.id_lotproduct\">\r\n                                <pre  style=\"color:var(--ion-color-vh-green);cursor: pointer;\"  (click)=\"openModalChooseLot(item)\">{{getLotNumber(item.lots, item.id_lotproduct)}}</pre> \r\n                              </ng-container>\r\n                            <ng-container *ngIf=\"item.ptype == 5\">\r\n                                <span class=\"sub-name\" *ngFor=\"let combo of item.combos\">{{combo.quantity}}x {{combo.name}}\r\n                                  ({{getUnit(combo.units,combo.ratio)}}), </span><br>\r\n                              </ng-container>\r\n                            <!-- Ghi chú -->\r\n                            <div *ngIf=\"vhAuth.localStorageGET('show_note_for_each_product')\">\r\n                                <input nz-input nzBorderless class=\"bill-detail-note\" style=\"text-align: left !important;\"\r\n                                    [placeholder]=\"'Note' | translate\" \r\n                                    [(ngModel)]=\"item.note\" />\r\n                            </div>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"3\" >\r\n                            <nz-select style=\"width: 100%;\" [(ngModel)]=\"item.ratio\" (ngModelChange)=\"changeUnit($event,item)\">\r\n                                <!-- <nz-option  [nzLabel]=\"item.unit\" [nzValue]=\"-1\"></nz-option> -->\r\n                                <nz-option *ngFor=\"let i of item.units,index as idx\" [nzLabel]=\"i.unit\" [nzValue]=\"i.ratio\"></nz-option>\r\n                            </nz-select>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                            <nz-input-number [nzMax]=\"9999999999\" [nzMin]=\"0.1\" [nzStep]=\"1\" [(ngModel)]=\"item.quantity\"\r\n                                (ngModelChange)=\"checkQuantityProduct(item,$event)\"></nz-input-number>\r\n                        </div>\r\n                        <div (click)=\"openEditUnitPrice(item)\" class=\"invoiceDetail-item-quantity text-end\" nz-col\r\n                            nzSpan=\"4\">\r\n                            <p class=\"max-width-two-line\" style=\"border-bottom: 1px var(--ion-color-vh-gray) solid;\r\n                            margin-left: 16px;\">\r\n                                <span>{{vhAlgorithm.vhcurrencyunit(item.price)}}</span>\r\n                                <del style=\"font-size: 0.7rem;\" *ngIf=\"display_promotion_selling_price\">\r\n                                    {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin) :\r\n                                    ''}}\r\n                                </del>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"4\" style=\"text-align: right;\">\r\n                            <p class=\"max-width-two-line\">\r\n                                <b>{{vhAlgorithm.vhcurrencyunit(item.price*item.quantity)}}</b>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Employee' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_employee\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveEmployee($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Return date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\" nz-row style=\"overflow: visible;\">\r\n                <div class=\"sales-bills-customer-title\">\r\n                    <b>{{'Customer information' | translate}}</b>\r\n                    <ion-icon (click)=\"openDrawerAddCustomerOrRetail()\"\r\n                        style=\"color: var(--ion-color-vh-white);padding-right: 5px;\"\r\n                        [src]=\"invoice.retail_name ? 'assets/icon/eye.svg':'assets/icon/add.svg'\">\r\n                    </ion-icon>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <nz-radio-group [(ngModel)]=\"radioValue\" (ngModelChange)=\"changeCustomerType($event)\"\r\n                        nzName=\"radiogroup\">\r\n                        <label nz-radio [nzValue]=1>{{'Retail customer' | translate}}</label>\r\n                        <label nz-radio [nzValue]=2>{{'Member' | translate}}</label>\r\n                        <label nz-radio [nzValue]=3>{{'Search customer' | translate}}</label>\r\n                    </nz-radio-group>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <ng-container *ngIf=\"radioValue == 1 && invoice.retail_name\">\r\n                        {{invoice.retail_name}} - {{invoice.retail_phone}} {{invoice.retail_address ? '-':\r\n                        ''}} {{invoice.retail_address}}\r\n                    </ng-container>\r\n                    <ng-container *ngIf=\"radioValue == 2\">\r\n                        <app-customer [id_customer]=\"invoice.id_customer\"\r\n                            (closeAndReceiveCustomer)=\"closeAndReceiveCustomer($event)\"></app-customer>\r\n                        <i (click)=\"openInfoCustomer()\"\r\n                            [ngClass]=\"invoice.id_customer !='id_retail' ? 'active' : 'deactive'\"\r\n                            style=\"cursor: pointer;\" nz-icon nzType=\"info-circle\" nzTheme=\"outline\"></i>\r\n                    </ng-container>\r\n                    <ng-container *ngIf=\"radioValue == 3\">\r\n                        <app-search-customer [id_customer]=\"invoice.id_customer\"\r\n                            (closeAndReceiveCustomer)=\"closeAndReceiveCustomer($event)\"></app-search-customer>\r\n                        <i (click)=\"openInfoCustomer()\"\r\n                            [ngClass]=\"invoice.id_customer !='id_retail' ? 'active' : 'deactive'\"\r\n                            style=\"cursor: pointer;\" nz-icon nzType=\"info-circle\" nzTheme=\"outline\"></i>\r\n                    </ng-container>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div>{{'SubTotal' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n                <ng-container *ngIf=\"invoice.order_number_ecommerce; else elseTemplate\">\r\n                    <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                        <div>{{'Platform fee' | translate}}</div>\r\n                        <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                            class=\"nz-no-border discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\"\r\n                            nz-input />\r\n                    </div>\r\n                </ng-container>\r\n                <ng-template #elseTemplate>\r\n                    <!-- <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\" *ngIf=\"!printer.discount_hidden\">\r\n                        <div>{{'Discount' | translate}}</div>\r\n                        <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                            class=\"nz-no-border discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\"\r\n                            nz-input />\r\n                    </div> -->\r\n                    <div class=\"sales-bills-content-discount\"\r\n                    style=\"display: flex;justify-content: space-between;align-items: center;\" nz-col nzSpan=\"24\">\r\n                    <div style=\"width: auto;\">{{'Discount value' | translate}}</div>\r\n                    <div>\r\n                        <input id=\"percent-discount-price\" style=\"width: 50px;\" #percentDiscount type=\"number\"\r\n                            max=\"100\" min=\"0\" step=\"0.01\"\r\n                            (blur)=\"editPercentDiscount(percentDiscount.value)\"\r\n                            [value]=\"percent_discount_bill | number:'1.0-2'\" class=\"border_bottom \" maxlength=\"3\"\r\n                            nz-input />%\r\n                    </div>\r\n                    <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                        class=\"border_bottom discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\"\r\n                        nz-input />\r\n                </div>\r\n                </ng-template>\r\n\r\n\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_fee')\">\r\n                    <div>{{'Fee' | translate}}</div>\r\n                    <input (blur)=\"editFee()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.fee)\"\r\n                        class=\"border_bottom invoice-fee\" type=\"text\" maxlength=\"15\" id=\"invoice-fee\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-tax\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_tax')\">\r\n                    <span>{{'Tax' | translate}}</span>\r\n                    <div>\r\n                        <nz-select *ngIf=\"listTax.length\" [(ngModel)]=\"id_tax\" (ngModelChange)=\"changeTax($event)\"\r\n                            nzBorderless>\r\n                            <nz-option *ngFor=\"let item of listTax\" nzValue=\"{{item._id}}\"\r\n                                nzLabel=\"{{vhAlgorithm.vhpercent(item.value/100)}}\">\r\n                            </nz-option>\r\n                        </nz-select>\r\n                        <span class=\"not-found\" *ngIf=\"!listTax.length\">0.00%</span>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"7\" style=\"text-align: end;\">\r\n                        {{vhAlgorithm.vhcurrencyunit(taxValue)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Total' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(getTotalATax())}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <div>\r\n                        <b>{{'Pay' | translate}}</b>\r\n                     \r\n                    </div>\r\n                    <div> {{vhAlgorithm.vhcurrencyunit(invoice.payment)}}<img (click)=\"showModalEditTotalPay()\"\r\n                            *ngIf=\"invoice.payment_type != 2\" style=\"width: 16px;margin-left:10px\"\r\n                            src=\"assets/icon/Iconfeather-edit.svg\" /></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_rest')\">\r\n                    <div>{{'Rest' | translate}}</div>\r\n                    <div> {{vhAlgorithm.vhcurrencyunit_symbol(getTotalATax() - invoice.payment)}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"sales-bills-content-payment_type\" nz-col nzSpan=\"24\">\r\n                    <app-tax [payment_type]=\"invoice.payment_type\" [id_wallet]=\"invoice.id_wallet\"\r\n                        [id_customer]=\"invoice.id_customer\"\r\n                        (closeAndGetValuePayment)=\"closeAndGetValuePayment($event)\">\r\n                    </app-tax>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\" *ngIf=\"!printer.note_hidden\">\r\n                    <textarea class=\"nz-hover-border\" [(ngModel)]=\"note\" (blur)=\"edit_note()\" nz-input\r\n                        placeholder=\"{{'Enter note...' | translate}}\"\r\n                        [nzAutosize]=\"{ minRows: 2, maxRows: 4 }\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!invoiceDetail.length || !invoice.id_customer || !checkPrinter\"\r\n                    (click)=\"payInvoice(3,true)\" nz-button class=\"order-and-print\">\r\n                    {{\"Save & Print\"|translate}} (F2)\r\n                </button>\r\n                <button [disabled]=\"!invoiceDetail.length || !invoice.id_customer\"\r\n                    (click)=\"payInvoice(3,false)\" nz-button class=\"order\">\r\n                    {{\"Save\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n\r\n<!-- -----nz-drawer list-product-------- -->\r\n<app-search-product [searchProductList]=\"searchProductList\"  [default_price_type]=\"default_price_type\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\"  >\r\n</app-search-product>\r\n\r\n<!--Modal edit inut price-->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Edit unit price' | translate}}\" (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Unit price' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\" [value]=\"tempDetail.price\" nz-input\r\n                    placeholder=\"{{'Enter unit price' | translate}}\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!--Modal edit pay-->\r\n<nz-modal [(nzVisible)]=\"edit_pay\" [nzFooter]=\"modalFooterEditPay\" nzTitle=\"{{'Edit' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditPay()\" (nzOnOk)=\"handleEditPay()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Pay' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input [value]=\"vhAlgorithm.vhcurrencyunit(invoice.payment)\" class=\"edit-pay\" type=\"text\"\r\n                    maxlength=\"15\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditPay>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditPay()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditPay()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!-- --------------visible drawer info customer----------- -->\r\n<app-customer-profile *ngIf=\"visibleInfoCustomer\" [visibleInfoCustomer]=\"visibleInfoCustomer\" [customer]=\"customer\"\r\n    (closeInfoCustomer)=\"closeInfoCustomer($event)\"></app-customer-profile>\r\n\r\n<!-- --------------------add customer---------------------- -->\r\n<app-add-customer *ngIf=\"showDrawerAddCusomer\" [showDrawerAddCusomer]=\"showDrawerAddCusomer\"\r\n    (closeAddCustomer)=\"closeAddCustomer($event)\"></app-add-customer>\r\n<app-retail-info *ngIf=\"showDrawerAddRetail\" [showDrawerAddRetail]=\"showDrawerAddRetail\"\r\n    [retail_name]=\"invoice.retail_name\" [retail_phone]=\"invoice.getRetailPhone()\"\r\n    [retail_address]=\"invoice.getRetailAddress()\" (closeAddCustomer)=\"closeAddCustomer($event)\"></app-retail-info>\r\n\r\n    \r\n<!-- modal chọn lô/HSD -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice2\" [(nzVisible)]=\"show_modal_select_lots\"\r\nnzTitle=\"{{'Select lot number' | translate}}\" (nzOnCancel)=\"handleCancelChooseLot()\" (nzOnOk)=\"handleChooseLot()\">\r\n<ng-container *nzModalContent>\r\n    <div nz-row>\r\n        <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n            <input type=\"text\" nz-input placeholder=\"{{'Find lot number' | translate}}\" #searchValue\r\n                (keyup)=\"searchLot(searchValue.value )\" />\r\n        </nz-input-group>\r\n        <ng-template #suffixIconSearch>\r\n            <i nz-icon nzType=\"search\"></i>\r\n        </ng-template>\r\n    </div>\r\n    <nz-radio-group [(ngModel)]=\"tempDetail.id_lotproduct\" (ngModelChange)=\"changeLot($event)\" style=\"width:100%;padding: 8px 0;\">\r\n        <div nz-row *ngFor=\"let item of tempDetail.lots\">\r\n            <div nz-col nzSpan=\"24\">\r\n                <label class=\"radio-purchase\" nz-radio [nzValue]=\"item._id\" style=\"width:100%;\">\r\n                    <div nz-row>\r\n                        <div nz-col nzSpan=\"8\">\r\n                            {{item.lot_number}}\r\n                        </div>\r\n\r\n                        <div nz-col nzSpan=\"8\">\r\n                            NSX: {{item.date_mfg | date : 'dd/MM/yyyy'}}\r\n                        </div>\r\n                        <div nz-col nzSpan=\"8\">\r\n                            HSD: {{item.date_exp | date : 'dd/MM/yyyy'}}\r\n                        </div>\r\n                    </div>\r\n\r\n                </label>\r\n            </div>\r\n\r\n        </div>\r\n    </nz-radio-group>\r\n    <div *ngIf=\"!tempDetail.lots.length\" style=\"text-align: center;\">{{'No data' | translate}}</div>\r\n</ng-container>\r\n<ng-template #modalFooterEditUnitPrice2>\r\n    <button nz-button class=\"nz-hover-border\"\r\n        style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n        (click)=\"handleCancelChooseLot()\">{{\"Cancel\"\r\n        |translate}}</button>\r\n    <button nz-button class=\"nz-hover-border\" [disabled]=\"!tempDetail.id_lotproduct\"\r\n        style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n        class=\"nz-hover-border-green\" (click)=\"handleChooseLot()\">{{\"Ok\" | translate}}</button>\r\n</ng-template>\r\n</nz-modal>\r\n\r\n<!-- modal chọn lô/HSD cho combo-->\r\n<nz-modal  nzWidth=\"70vw\"  *ngIf=\"show_modal_select_lots_combo\" [nzFooter]=\"modalFooterEditUnitPrice3\"\r\n    [(nzVisible)]=\"show_modal_select_lots_combo\"\r\n    nzTitle=\"{{'Select lot number for products in combo' | translate}}: {{tempDetail.name}}\"\r\n    (nzOnCancel)=\"show_modal_select_lots_combo = false\" (nzOnOk)=\"handleChooseLotCombo()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"tempDetail.combos\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{{\"Product name\" | translate}}</th>\r\n                    <th>{{'Lot number' | translate}}</th>\r\n                    <th>{{'Unit' | translate}}</th>\r\n                    <th>{{'Quantity' | translate}}</th>\r\n                    <th>{{'Unit price' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let data of basicTable.data\">\r\n                    <ng-container *ngIf=\"data.lots\">\r\n\r\n                        <tr>\r\n                            <td>{{ data.name }}</td>\r\n                            <td>\r\n                                <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                    [(ngModel)]=\"data.id_lotproduct\">\r\n                                    <nz-option *ngFor=\"let element of data.lots\"  nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp | date: 'dd/MM/yyyy'}}\"\r\n                                        [nzValue]=\"element._id\"></nz-option>\r\n                                </nz-select>\r\n                            </td>\r\n                            <td>{{getUnit(data.units, data.ratio)}}</td>\r\n                            <td>{{ data.quantity }}</td>\r\n                            <td>\r\n                                {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n\r\n                            </td>\r\n                        </tr>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice3>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"show_modal_select_lots_combo = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLotCombo()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { VhQuerySales } from 'ionic-vhframeworks';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AhamoveService {\r\n  private URL: string = this.vhQuerySales.getShippingAhamoveURL()\r\n  // api_key = '183a9baa5176ebbaa9c10fe67fc02161d63f6849'; //dev\r\n  api_key = 'fc0ee646897ef09f19fd61075337728c61bc9480'; //production\r\n  constructor(\r\n    private http: HttpClient,\r\n    private vhQuerySales: VhQuerySales\r\n  ) { }\r\n\r\n  getTokenAhaMove(phone) {\r\n\r\n    const options = {\r\n      params: {\r\n        \"url\": 'https://api.ahamove.com/v1/partner/register_account',\r\n        \"mobile\": phone,\r\n        \"api_key\": this.api_key,\r\n        \"name\": \"Viethas\",\r\n        \"address\": \"Khách hàng\"\r\n      }\r\n    }\r\n    return this.http.get(this.URL, options).toPromise();\r\n  }\r\n  getAllServiceAhaMove(city_id) {\r\n\r\n    const options = {\r\n      params: {\r\n        \"url\": `https://api.ahamove.com/v1/order/service_types?city_id=${city_id}`,\r\n      }\r\n    }\r\n    return this.http.get(this.URL, options).toPromise();\r\n  }\r\n  calculateFeeAhamove(data) {\r\n    \r\n    const options = {\r\n      params: {\r\n        \"url\": \"https://api.ahamove.com/v2/order/estimated_fee\",\r\n      }\r\n    }\r\n    const body = {\r\n      \"token\": data.token,\r\n      \"order_time\": 0,\r\n      \"path\": data.path,\r\n      \"services\": data.services,\r\n      \"payment_method\": \"CASH\"\r\n    }\r\n    return this.http.post(this.URL, body, options).toPromise();\r\n  }\r\n  createOrderAhamove(data) {\r\n\r\n    let x = `[{\"address\":\"${data.pick_address}\",\"name\":\"${data.pick_name}\",\"mobile\":\"${data.pick_tel}\"},{\"address\":\"${data.address}\",\"name\":\"${data.name}\",\"mobile\":\"${data.phone}\",\"cod\":${data.cod},\"remarks\":\"${data.note}\"}]`;\r\n    const options = {\r\n      params: {\r\n        \"url\": \"https://api.ahamove.com/v1/order/create\",\r\n        \"token\": data.token,\r\n        \"order_time\": data.order_time,\r\n        \"service_id\": data.service_id,\r\n        \"payment_method\": \"CASH\",\r\n        \"path\": x\r\n      }\r\n    }\r\n    return this.http.get(this.URL, options).toPromise();\r\n  }\r\n  getDetailBillAhamove(token, order_id) {\r\n\r\n    const options = {\r\n      params: {\r\n        \"url\": `https://api.ahamove.com/v1/order/detail`,\r\n        \"token\": token,\r\n        \"order_id\": order_id\r\n      }\r\n    }\r\n    return this.http.get(this.URL, options).toPromise();\r\n  }\r\n  cancelOrderAhamove(token, order_id) {\r\n\r\n    const options = {\r\n      params: {\r\n        \"url\": `https://api.ahamove.com/v1/order/cancel`,\r\n        \"token\": token,\r\n        \"order_id\": order_id,\r\n        \"comment\": \"No comment\"\r\n      }\r\n    }\r\n    return this.http.get(this.URL, options).toPromise();\r\n  }\r\n}\r\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GhnService {\r\n\r\n  constructor(private http: HttpClient) { }\r\n  /**\r\n  * kiểm tra token của giao hàng nhanh có hợp lệ hay không\r\n  * @example : this.transportService.connectTokenGhn(token).then(res =>{\r\n  * @param : tokenName\r\n  * @return :\r\n  **/\r\n  connectTokenGhn(token) {\r\n    let urlGhn = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shop/all';\r\n    const options = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n      })\r\n    }\r\n    return this.http.get(urlGhn, options).toPromise();\r\n  }\r\n  /**\r\n  * get các tỉnh trong nước Việt Nam\r\n  * @param token\r\n  * @example this.transportService.getProvinceGhn().then(res =>{})\r\n  * @return\r\n  **/\r\n  getProvinceGhn(token) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/master-data/province';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n      })\r\n    }\r\n    return this.http.get(url, opptions).toPromise();\r\n  }\r\n  /**\r\n  * get các huyện trong tỉnh của Việt Nam\r\n  * @param token ,province_id\r\n  * @example this.transportService.getDistrictGhn().then(res =>{})\r\n  * @return\r\n  **/\r\n  getDistrictGhn(token, province_id?) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/master-data/district';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n\r\n      }),\r\n      params: {\r\n        \"province_id\": province_id ? province_id : 0\r\n      }\r\n    }\r\n    return this.http.get(url, opptions).toPromise();\r\n  }\r\n  /**\r\n  * get các xã trong huyện của Việt Nam\r\n  * @param token ,district_id\r\n  * @example this.transportService.getWardGhn().then(res =>{})\r\n  * @return\r\n  **/\r\n  getWardGhn(token, district_id) {\r\n    let url = `https://online-gateway.ghn.vn/shiip/public-api/master-data/ward?${district_id}`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n      }),\r\n      params: {\r\n        \"district_id\": district_id\r\n      }\r\n    }\r\n    return this.http.get(url, opptions).toPromise();\r\n  }\r\n  /**\r\n  * tính phí vận chuyển\r\n  * @param token,data\r\n  * @example this.transportService.calculate_delivery_fee().then(res =>{})\r\n  * @return\r\n  **/\r\n  calculate_delivery_fee(token, data) {\r\n    let url = \"https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/fee\";\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n        \"ShopId\": data.shop_id.toString()\r\n      }),\r\n      params: {\r\n        \"service_id\": data.service_id,\r\n        \"to_ward_code\": data.to_ward_code,\r\n        \"from_district_id\": data.from_district_id,\r\n        \"height\": data.height,\r\n        \"length\": data.length,\r\n        \"weight\": data.weight,\r\n        \"width\": data.width,\r\n        \"insurance_value\": data.insurance_value,\r\n        \"to_district_id\": data.to_district_id\r\n      }\r\n    }\r\n    return this.http.get(url, opptions).toPromise();\r\n  }\r\n  /**\r\n  * chọn service : đi bộ, bay...\r\n  * @param token,data\r\n  * @example this.transportService.calculate_delivery_fee().then(res =>{})\r\n  * @return result { data : [service_id,short_name,service_type_id]}\r\n  **/\r\n  getServiceDelivery(token, data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/available-services';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n      }),\r\n      params: {\r\n        \"shop_id\": data.shop_id,\r\n        \"from_district\": data.from_district_id,\r\n        \"to_district\": data.to_district_id\r\n      }\r\n    }\r\n    return this.http.get(url, opptions).toPromise();\r\n  }\r\n  /**\r\n  * tạo đơn giao hàng\r\n  * @param data\r\n  * @example this.transportService.createOrderGhn().then(res =>{})\r\n  * @return\r\n  **/\r\n  createOrderGhn(data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/create';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Token\": data.token,\r\n        \"Content-Type\": \"application/json\",\r\n        \"ShopId\": data.shop_id.toString()\r\n      }),\r\n    }\r\n    let params = {\r\n      \"to_name\": data.to_name,\r\n      \"to_phone\": data.to_phone,\r\n      \"to_address\": data.to_address,\r\n      \"to_ward_code\": data.to_ward_code,\r\n      \"to_district_id\": data.to_district_id,\r\n      \"weight\": data.weight,\r\n      \"height\": data.height,\r\n      \"length\": data.length,\r\n      \"width\": data.width,\r\n      \"payment_type_id\": data.payment_type_id,\r\n      \"required_note\": data.required_note,\r\n      \"items\": data.items,\r\n      \"service_id\": data.service_id,\r\n      \"cod_amount\": data.cod_amount,\r\n      \"insurance_value\": data.insurance_value,\r\n      \"note\": data.note ? data.note : ''\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Tính (đoán) ngày vận chuyển hàng hoàn thành\r\n  * @param data;\r\n  * @example : this.transportService.calculateTheExpectedDeliveryTime().then(res =>{})\r\n  * @return :\r\n  **/\r\n  calculateTheExpectedDeliveryTime(token, data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/leadtime';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n        \"ShopId\": data.shop_id.toString()\r\n      }),\r\n    }\r\n    let params = {\r\n      \"from_district_id\": data.from_district_id,\r\n      \"from_ward_code\": data.from_ward_code,\r\n      \"to_district_id\": data.to_district_id,\r\n      \"to_ward_code\": data.to_ward_code,\r\n      \"service_id\": data.service_id\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n  getInfoOrder(token, order_code) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/detail';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": token,\r\n      }),\r\n    }\r\n    let params = {\r\n      \"order_code\": order_code\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n  cancelOrder(data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/switch-status/cancel';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": data.token,\r\n        \"ShopId\": data.shop_id.toString(),\r\n      }),\r\n    }\r\n    let params = {\r\n      \"order_codes\": data.order_code\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n  getOtpGhn(data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shop/affiliateOTP';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": \"5c8844f1-17f6-11eb-afc8-92a278719a56\", //gán cứng token\r\n      }),\r\n    }\r\n    let params = {\r\n      \"phone\": data.phone\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n  addStaffToStore(data) {\r\n    let url = 'https://online-gateway.ghn.vn/shiip/public-api/v2/shop/affiliateCreateWithShop';\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n        \"Token\": \"5c8844f1-17f6-11eb-afc8-92a278719a56\",  //gán cứng token\r\n      }),\r\n    }\r\n    let params = {\r\n      \"phone\": data.phone,\r\n      \"otp\": data.otp,\r\n      \"shop_id\": data.shop_id\r\n    }\r\n    return this.http.post(url, params, opptions).toPromise();\r\n  }\r\n}\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { VhQuerySales } from 'ionic-vhframeworks';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GhtkService {\r\n  private URL: string = this.vhQuerySales.getShippingGHTKURL()\r\n  constructor(\r\n    private http: HttpClient,\r\n    private vhQuerySales: VhQuerySales\r\n  ) { }\r\n\r\n\r\n  /**\r\n  * kiểm tra token của giao hàng tiết kiệm có hợp lệ hay không và lấy thông tin kho\r\n  * @example : this.transportService.connectTokenGhtk(token).then(res =>{\r\n  * @param : tokenName\r\n  * @return :\r\n  **/\r\n  getWareHouseGhtk(token) {\r\n    // let options:any = {\r\n    //   method: 'GET',\r\n    //   url: 'http://115.78.100.57:8013/miscellaneous/ghtk',                       \r\n    //   params: {\r\n    //     token:token,\r\n    //     url: 'https://services.giaohangtietkiem.vn/services/shipment/list_pick_add'\r\n    //   }            \r\n    // };          \r\n    // return axios.request(options);\r\n    \r\n    const opptions = {\r\n      params: {\r\n        \"token\": token,\r\n        \"url\": 'https://services.giaohangtietkiem.vn/services/shipment/list_pick_add'\r\n      }\r\n    }\r\n\r\n    return this.http.get(this.URL, opptions).toPromise();\r\n  }\r\n  /**\r\n  * tính toán phí vận chuyển\r\n  * @example : this.transportService.calculateFeeGhtk(data,transport).then(res =>{\r\n  * @param : data,transport\r\n  * @return :\r\n  **/\r\n  calculateFeeGhtk(data, transport) {\r\n\r\n    const opptions = {\r\n      params: {\r\n        \"token\": data.token,\r\n        \"url\": \"https://services.giaohangtietkiem.vn/services/shipment/fee\"\r\n      }\r\n    }\r\n    let params = {\r\n      \"pick_address_id\": data.shop_id,\r\n      \"province\": data.province,\r\n      \"district\": data.district,\r\n      \"weight\": data.weight * 1000,\r\n      \"value\": data.insurance_value,\r\n      \"transport\": transport\r\n    }\r\n    \r\n    return this.http.post(this.URL, params, opptions).toPromise();\r\n  }\r\n  /**\r\n  * tính toán phí vận chuyển\r\n  * @example : this.transportService.calculateFeeGhtk(data,transport).then(res =>{\r\n  * @param : data,transport\r\n  * @return :\r\n  **/\r\n  createOrderGhtk(token, products, order) {\r\n\r\n    const opptions = {\r\n      params: {\r\n        \"token\": token,\r\n        \"url\": \"https://services.giaohangtietkiem.vn/services/shipment/order/?ver=1.6.3\"\r\n      }\r\n    }\r\n    let params = {\r\n      \"products\": products,\r\n      \"order\": order\r\n    }\r\n    return this.http.post(this.URL, params, opptions).toPromise();\r\n  }\r\n  getStatusBill(token, order_code) {\r\n\r\n    const opptions = {\r\n      params: {\r\n        \"token\": token,\r\n        \"url\": `https://services.giaohangtietkiem.vn/services/shipment/v2/${order_code}`\r\n      }\r\n    }\r\n    return this.http.get(this.URL, opptions).toPromise();\r\n  }\r\n  cancelOrder(token, order_code) {\r\n\r\n    const opptions = {\r\n      params: {\r\n        \"token\": token,\r\n        \"url\": `https://services.giaohangtietkiem.vn/services/shipment/cancel/${order_code}`\r\n      }\r\n    }\r\n    let params = {}\r\n    return this.http.post(this.URL, params, opptions).toPromise();\r\n  }\r\n}\r\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class VnpostService {\r\n  private URL_TEST = 'https://donhang-uat.vnpost.vn/api/api'\r\n  private URL_PRODUCT = 'https://donhang.vnpost.vn/api/api'\r\n  private URL_SERVER = 'https://us-central1-servers-1b3fe.cloudfunctions.net/app/shippingclouds/vietnampost'\r\n  private TenDangNhap: string = '0909925354'\r\n  private MatKhau: string = '123456'\r\n  constructor(\r\n    private http: HttpClient\r\n  ) {\r\n\r\n  }\r\n  getTokenVnpost() {\r\n    let url = `${this.URL_PRODUCT}/MobileAuthentication/GetAccessToken`;\r\n    let json: any = {\r\n      TenDangNhap: this.TenDangNhap,\r\n      MatKhau: this.MatKhau\r\n    }\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': 'none' }\r\n    }\r\n    return this.http.post(this.URL_SERVER, json, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Kiểm tra xem liệu khách hàng đã có mã CRM và đã ủy quyền cho Viethas đẩy đơn hay chưa\r\n   * @param token\r\n   * @param customer_code \r\n   * @returns \r\n   */\r\n  checkCustomerCode(token, customer_code) {\r\n    let url = `${this.URL_PRODUCT}/DoiTac/CheckCustomerCode`;\r\n    let json: any = { CustomerCode: customer_code }\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': token }\r\n    }\r\n    return this.http.post(this.URL_SERVER, json, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Lấy danh sách tỉnh / thành phố theo Vnpost\r\n   * @returns \r\n   */\r\n  getProvinceVnpost() {\r\n    let url = `${this.URL_PRODUCT}/TinhThanh/GetAll`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url }\r\n    }\r\n    return this.http.get(this.URL_SERVER, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Lấy danh sách quận/huyện theo Vnpost\r\n   * @returns \r\n   */\r\n  getDistrictVnpost() {\r\n    let url = `${this.URL_PRODUCT}/QuanHuyen/GetAll`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url }\r\n    }\r\n    return this.http.get(this.URL_SERVER, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Lấy danh sách phường/xã theo Vnpost\r\n   * @returns \r\n   */\r\n  getWardVnpost() {\r\n    let url = `${this.URL_PRODUCT}/PhuongXa/GetAll`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url }\r\n    }\r\n    return this.http.get(this.URL_SERVER, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Hàm này lấy danh sách tên các phương thức vận chuyển\r\n   */\r\n  getServiceNameVnpost(token, json: any) {\r\n    let url = `${this.URL_PRODUCT}/DoiTac/TinhCuocTatCaDichVu`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': token }\r\n    }\r\n    return this.http.post(this.URL_SERVER, json, opptions).toPromise();\r\n  }\r\n\r\n  /**\r\n   * Tạo order vnpost\r\n   */\r\n  createOrderVnpost(token, json: any) {\r\n    let url = `${this.URL_PRODUCT}/DoiTac/CreateOrder`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': token }\r\n    }\r\n    return this.http.post(this.URL_SERVER, json, opptions).toPromise();\r\n  }\r\n  /**\r\n   * Tạo order vnpost\r\n   */\r\n  getDetailOrderById(token: string, Id: string) {\r\n    let url = `${this.URL_PRODUCT}/Order/GetOrder/${Id}`;\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': token }\r\n    }\r\n    return this.http.post(this.URL_SERVER, null, opptions).toPromise()\r\n  }\r\n  /**\r\n   * Delelte order vnpost\r\n   */\r\n  deleteOrderVnpostByID(token: string, Id: string) {\r\n    let url = `${this.URL_PRODUCT}/DoiTac/CancelOrder`;\r\n    let json = { OrderId: Id }\r\n    const opptions = {\r\n      headers: new HttpHeaders({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      params: { 'url': url, 'h-token': token }\r\n    }\r\n    return this.http.post(this.URL_SERVER, json, opptions).toPromise()\r\n  }\r\n\r\n  // --------------------------------CÁC HÀM XỬ LÝ DỮ LIỆU-------------------------------------------\r\n  /**\r\n   * Hàm này để custom dữ liệu cho hàm getServiceNameVnpost\r\n   */\r\n  renderFormatService(infoSend, infoRecei, infoProd, infoDeli, CustomerCode) {\r\n    return {\r\n      SenderDistrictId: infoSend.SenderDistrictId, SenderProvinceId: infoSend.SenderProvinceId,\r\n      ReceiverDistrictId: infoRecei.ReceiverDistrictId, ReceiverProvinceId: infoRecei.ReceiverProvinceId,\r\n      Weight: infoProd.WeightEvaluation, Width: infoProd.WidthEvaluation,\r\n      Length: infoProd.LengthEvaluation, Height: infoProd.HeightEvaluation,\r\n      CodAmount: +infoDeli.CodAmountEvaluation, IsReceiverPayFreight: infoDeli.IsReceiverPayFreight,\r\n      OrderAmount: +infoDeli.OrderAmountEvaluation, UseBaoPhat: false, UseHoaDon: false,\r\n      UseNhanTinSmsNguoiNhanTruocPhat: false, UseNhanTinSmsNguoiNhanSauPhat: false,\r\n      CustomerCode: CustomerCode\r\n    }\r\n  }\r\n  /**\r\n   * Hàm này để custom dữ liệu cho hàm createOrderVnpost\r\n   */\r\n  renderFormatCreateOrder(infoSend, infoRecei, infoProd, infoDeli, CustomerCode, bill_code) {\r\n    return {\r\n      SenderDistrictId: infoSend.SenderDistrictId, SenderProvinceId: infoSend.SenderProvinceId,\r\n      SenderTel: infoSend.SenderTel, SenderFullname: infoSend.SenderFullname, SenderAddress: infoSend.SenderAddress,\r\n      SenderWardId: infoSend.SenderWardId, ReceiverTel: infoRecei.ReceiverTel, ReceiverFullname: infoRecei.ReceiverFullname,\r\n      ReceiverAddress: infoRecei.ReceiverAddress, ReceiverWardId: infoRecei.ReceiverWardId,\r\n      ReceiverAddressType: infoDeli.ReceiverAddressType == 0 ? null : infoDeli.ReceiverAddressType, ServiceName: infoDeli.ServiceName, OrderCode: bill_code,\r\n      CustomerNote: infoDeli.CustomerNote, PickupType: 1,\r\n      ReceiverDistrictId: infoRecei.ReceiverDistrictId, ReceiverProvinceId: infoRecei.ReceiverProvinceId,\r\n      WeightEvaluation: infoProd.WeightEvaluation, WidthEvaluation: infoProd.WidthEvaluation,\r\n      LengthEvaluation: infoProd.LengthEvaluation, HeightEvaluation: infoProd.HeightEvaluation,\r\n      CodAmountEvaluation: +infoDeli.CodAmountEvaluation, IsReceiverPayFreight: infoDeli.IsReceiverPayFreight,\r\n      OrderAmountEvaluation: +infoDeli.OrderAmountEvaluation, UseBaoPhat: false, UseHoaDon: false,\r\n      PickupPoscode: \"\", CustomerCode: CustomerCode,\r\n      UseNhanTinSmsNguoiNhanTruocPhat: false, UseNhanTinSmsNguoiNhanSauPhat: false\r\n\r\n    }\r\n  }\r\n  renderFormatPrintOrder(delivery) {\r\n    \r\n    return {\r\n      created: delivery.CreateTime, customer_fullname: delivery.ReceiverFullname,\r\n      customer_tel: delivery.ReceiverTel, address: delivery.ReceiverFullAddress,\r\n      ship_money: delivery.TotalFreightIncludeVatEvaluation, insurance: 0,\r\n      is_freeship: delivery.IsReceiverPayFreight ? 0 : 1, CodAmountEvaluation: delivery.CodAmountEvaluation\r\n    }\r\n  }\r\n  // --------------------------------CÁC HÀM XỬ LÝ DỮ LIỆU-------------------------------------------\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///"}