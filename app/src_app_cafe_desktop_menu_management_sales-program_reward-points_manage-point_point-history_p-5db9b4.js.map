{"version":3,"file":"src_app_cafe_desktop_menu_management_sales-program_reward-points_manage-point_point-history_p-5db9b4.js","mappings":"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","sources":["./src/app/cafe/desktop/menu/management/sales-program/reward-points/manage-point/point-history/point-history.component.ts","./src/app/cafe/desktop/menu/management/sales-program/reward-points/manage-point/point-history/point-history.component.html","./src/app/cafe/desktop/menu/management/sales-program/reward-points/manage-point/point-history/point-history.module.ts"],"sourcesContent":["import { VhAlgorithm, VhQueryCafe } from 'ionic-vhframeworks';\r\nimport { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhComponent } from 'src/app/cafe/components/vh-component/vh-component';\r\n\r\n@Component({\r\n  selector: 'app-point-history',\r\n  templateUrl: './point-history.component.html',\r\n  styleUrls: ['./point-history.component.scss']\r\n})\r\nexport class PointHistoryComponent implements OnInit {\r\n  date: Date =new Date()\r\n  root: any;\r\n  list_data: any = [];\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private cdRef: ChangeDetectorRef,\r\n    private vhQueryCafe: VhQueryCafe,\r\n    private vhAlgorithm: VhAlgorithm,\r\n  ) {\r\n    this.date.setHours(0, 0, 0, 0)\r\n    this.root = this.router.getCurrentNavigation().extras.state;\r\n    if(this.root.list_data ) this.list_data =this.root.list_data\r\n  }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n  heightScroll: string;\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\"#product-list\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".product-list-header\")) {\r\n      this.heightScroll = document.querySelector(\"#product-list\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".product-list-header\").clientHeight - 50 + \"px\";\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n  goBack() {\r\n    this.router.navigate(['/cafe/dashboard/management/sales-program/reward-points'])\r\n  }\r\n\r\n  /**\r\n   * get bill thuộc khách hàng và có tính điểm\r\n   */\r\n  getReport() {\r\n    this.vhComponent.showLoading('').then(() =>{\r\n      this.vhQueryCafe.getBills_byFields({ id_customer: { $eq: this.root._id }, earning_point_bill: { $ne: 0 }})\r\n      .then((bills: any) => {\r\n        this.list_data = this.vhAlgorithm.sortDatebyDESC(bills.filter (ele => new Date(ele.date) >= this.date), 'date').map(item => {\r\n          return { ...item, content: \"Cộng điểm hóa đơn bán hàng \" + item.bill_code }\r\n        })\r\n        this.vhComponent.hideLoading(0)\r\n      })\r\n    })\r\n\r\n  }\r\n\r\n  gotoBillDetail(data) {\r\n    // this.router.navigate(['/cafe/dashboard/management/sales-program/reward-points/manage-point/point-history/detail'], { state: { id: data._id , root :{ ...this.root, list_data: this.list_data}} })\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{'Back' | translate}}\r\n</div>\r\n<nz-layout id=\"product-list\" class=\"height-layout\">\r\n    <div nz-row class=\"product-list-header\">\r\n        <div nz-col nzSpan=\"4\" class=\"title left-all-content\">\r\n            <b>{{'Manage accumulated points' | translate}}</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"8\" class=\"title left-all-content\">\r\n             \r\n        </div>\r\n        <div nz-col nzSpan=\"8\" class=\"title center-all-content\">\r\n            <nz-date-picker [(ngModel)]=\"date\"></nz-date-picker> \r\n        </div>\r\n        <div nz-col nzSpan=\"4\" class=\"right-all-content\">\r\n            <button class=\"btn-add\" nz-button nzType=\"default\" (click)=\"getReport()\">\r\n                <ion-icon src=\"assets/icon/management/view.svg\"></ion-icon>\r\n                {{'View'|translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <nz-table [nzScroll]=\"{ y: heightScroll  }\" #dataShow [nzShowPagination]=\"false\"\r\n        nzNoResult=\"{{'No data'| translate}}\" [nzData]=\"list_data\">\r\n        <thead>\r\n            <tr>\r\n                <th nzWidth=\"15%\"><b>{{'Date' | translate}}</b></th>\r\n                <th  nzAlign=\"center\"><b>{{'Content' | translate}}</b></th>\r\n                <!-- <th nzWidth=\"200px\"><b>{{'Applied program' | translate}}</b></th>\r\n                <th nzWidth=\"25%\"><b>{{'Customer group' | translate}}</b></th> -->\r\n                <th  nzAlign=\"right\"><b>{{'Adjusted points' | translate}}</b></th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            <tr *ngFor=\"let data of dataShow.data\" style=\"cursor: pointer;\" (click)=\"gotoBillDetail(data)\">\r\n                <td>\r\n                    {{ data.date | date:\"dd/MM/yyyy\"}}\r\n                </td>\r\n                <td nzAlign=\"center\"> {{ data.content}}</td>\r\n                <td nzAlign=\"right\">\r\n                    {{data.earning_point_bill}}\r\n                    \r\n                </td>\r\n                <!-- <td>\r\n                    {{data.class_name}}\r\n                </td>\r\n                <td>\r\n                    {{data.earning_point || 0}}\r\n                </td> -->\r\n            </tr>\r\n        </tbody>\r\n    </nz-table>\r\n</nz-layout>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { PointHistoryComponent } from './point-history.component';\r\nimport { RouterModule, Routes } from '@angular/router'; \r\nimport { IonicModule } from '@ionic/angular';\r\nimport { TranslateModule } from '@ngx-translate/core'; \r\nimport { FormsModule } from '@angular/forms'; \r\nimport { NgZorroAntModule } from 'src/app/cafe/desktop/ng-zorro-ant.module';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: PointHistoryComponent\r\n  }, \r\n]\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    PointHistoryComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,  \r\n    RouterModule.forChild(routes),\r\n    NgZorroAntModule,\r\n    IonicModule,\r\n    TranslateModule,\r\n    FormsModule\r\n  ]\r\n})\r\nexport class PointHistoryModule { }\r\n"],"names":[],"sourceRoot":"webpack:///"}