{"version":3,"file":"src_app_cafe_desktop_menu_management_stock_manage-lots_manage-lots_module_ts.js","mappings":"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","sources":["./src/app/cafe/desktop/menu/management/stock/manage-lots/manage-lots.component.ts","./src/app/cafe/desktop/menu/management/stock/manage-lots/manage-lots.component.html","./src/app/cafe/desktop/menu/management/stock/manage-lots/manage-lots.module.ts"],"sourcesContent":["import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQueryCafe } from 'ionic-vhframeworks';\r\nimport { LanguageService } from 'src/app/cafe/services/language.service';\r\n@Component({\r\n  selector: 'app-manage-lots',\r\n  templateUrl: './manage-lots.component.html',\r\n  styleUrls: ['./manage-lots.component.scss']\r\n})\r\nexport class ManageLotsComponent implements OnInit {\r\n  list_show_product = this.vhQueryCafe.getlocalDetailProducts().filter(item => item.manylot).map(e=> {return {...e, unit : e.units.find(unit => unit.default).unit}})\r\n  list_product = []\r\n  productCol = false;          // chọn sort cột tên sản phẩm\r\n  keySearch = ''\r\n  id_branch = this.vhQueryCafe.getDefaultBranch()._id\r\n  constructor(\r\n    private router: Router,\r\n    private vhQueryCafe: VhQueryCafe,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private languageService: LanguageService,\r\n    private cdRef: ChangeDetectorRef) { }\r\n\r\n  ngOnInit(): void {\r\n    this.list_show_product.forEach(element => {\r\n      element.lots = element.lots?.map(lot => {\r\n        return { ...lot, time_remaining: this.getNumberOfDay(new Date(lot.date_exp), new Date()) }\r\n      })\r\n      if(element.lots.find(e => e.time_remaining < element.days_exp_warning)) element['waring'] = true;\r\n    });\r\n    this.list_product = this.list_show_product\r\n    console.log(this.list_show_product);\r\n  }\r\n  /**\r\n   * trả về khoảng cách giữa 2 ngày \r\n   * vd : getNumberOfDay(15/02/2022, 10/02/2022) => return 5\r\n   * */\r\n  getNumberOfDay(date1, date2) {\r\n    return (date1.getTime() - date2.getTime()) / (24 * 3600 * 1000) > 0 ? (date1.getTime() - date2.getTime()) / (24 * 3600 * 1000) : 0\r\n  }\r\n\r\n  heightScroll: string;\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\"#product-list\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".product-list-header\")) {\r\n      this.heightScroll = document.querySelector(\"#product-list\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".product-list-header\").clientHeight - 30 + \"px\";\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n  /**\r\n   * sắp xếp tên sp\r\n   */\r\n  sortTable(colName) {\r\n    if (this.productCol) {\r\n      this.list_show_product = this.vhAlgorithm.sortVietnamesebyASC([...this.list_show_product], colName)\r\n    } else {\r\n      this.list_show_product = this.vhAlgorithm.sortVietnamesebyDESC([...this.list_show_product], colName)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * lọc sp theo tên\r\n   */\r\n  search_Products(value) {\r\n    let tempVal: string = this.vhAlgorithm.changeAlias(value.toLowerCase());\r\n    if (value.length)\r\n      this.list_show_product = this.vhAlgorithm.searchList(tempVal, this.list_product, ['name'])\r\n    else this.list_show_product = this.list_product\r\n  }\r\n\r\n  goBack() {\r\n    this.router.navigate(['/cafe/dashboard/management/stock']);\r\n  }\r\n\r\n  getTotalStock() {\r\n    return this.list_show_product.reduce((prev: number, next) => prev + next.quantity, 0)\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n  <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{'Back' | translate}}\r\n</div>\r\n<nz-layout id=\"product-list\" class=\"height-layout\">\r\n  <div nz-row class=\"product-list-header\">\r\n    <div nz-col nzSpan=\"6\" class=\"title left-all-content\">\r\n      <b>{{'Products list' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n      <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n        <input #box [value]=\"keySearch\" type=\"text\" nz-input\r\n          placeholder=\"{{'Search for product name, barcode' | translate}}\" (keyup)=\"search_Products(box.value)\" />\r\n      </nz-input-group>\r\n      <ng-template #suffixIconSearch>\r\n        <i nz-icon nzType=\"search\"></i>\r\n      </ng-template>\r\n    </div>\r\n    <div nz-col nzSpan=\"6\" class=\"title left-all-content\">\r\n    </div>\r\n  </div>\r\n  <div>\r\n    <nz-table class=\"allow-sales\" [nzPageSize]=\"20\" [nzPageSizeOptions]=\"[20, 30, 40, 50, 100, 200]\"\r\n      [nzScroll]=\"{ y: heightScroll }\" #allowSale nzShowPagination nzShowSizeChanger nzBordered\r\n      [nzData]=\"list_show_product\">\r\n      <thead>\r\n        <tr>\r\n          <th nzWidth=\"40%\" rowspan=\"2\" (click)=\"productCol = !productCol;sortTable('name')\">\r\n            <b>{{'Product name' | translate}}</b>\r\n            <i nz-icon [nzType]=\"productCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n          </th>\r\n          <th nzWidth=\"10%\" rowspan=\"2\" nzAlign='center'><b>{{'Unit' | translate}}</b></th>\r\n          <th colspan=\"2\" nzAlign=\"center\"><b>{{'Batch information' | translate}}</b></th>\r\n          <th nzWidth=\"20%\" rowspan=\"2\"><b>{{\"Status\" | translate}}</b></th>\r\n        </tr>\r\n        <tr>\r\n          <th nzWidth=\"15%\">\r\n            <b>{{'Barcode' | translate}}</b>\r\n          </th>\r\n          <th nzWidth=\"15%\">\r\n            <b>{{'Stock' | translate}}</b>\r\n          </th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <ng-container *ngFor=\"let data of allowSale.data\">\r\n          <tr style=\"cursor: pointer;\" (click)=\" data.expand = !data.expand\">\r\n            <td>\r\n              <i style=\"cursor: pointer;font-size: 0.8rem;\" nz-icon [nzType]=\"data.expand ? 'minus' : 'plus'\"\r\n                nzTheme=\"outline\"></i>\r\n              <b [ngStyle]=\"{'color':  data.waring ? 'red' : 'var(--ion-color-vh-green)'}\">{{ data.name }}</b>\r\n            </td>\r\n            <td>\r\n              {{ data.unit }}\r\n            </td>\r\n            <td>\r\n            </td>\r\n            <td nzAlign=\"center\">\r\n              <b>{{data.quantity_branch[id_branch]}}</b>\r\n            </td>\r\n            <td></td>\r\n          </tr>\r\n          <ng-container *ngIf=\"data.expand\">\r\n            <tr *ngFor=\"let lot of data.lots\">\r\n              <td>\r\n                {{ 'Lot number' | translate}}: {{ lot.lot_number }} <br>\r\n                <span style=\"font-size:0.8rem;color:gray;\">\r\n                  {{ lot.date_mfg | date:\"dd/MM/yyyy\" }} - {{ lot.date_exp | date:\"dd/MM/yyyy\" }}\r\n                </span>\r\n              </td>\r\n              <td></td>\r\n              <td>{{ lot.barcode }}</td>\r\n              <td nzAlign=\"center\">{{ lot.quantity_branch[id_branch] }}</td>\r\n              <td [ngStyle]=\"{'color': lot.time_remaining < data.days_exp_warning ? 'red' : 'black'}\">\r\n                {{'Remaining_' | translate}}: {{ lot.time_remaining | number :'1.0-0'}} {{'days' | translate}}\r\n              </td>\r\n            </tr>\r\n          </ng-container>\r\n        </ng-container>\r\n      </tbody>\r\n    </nz-table>\r\n  </div>\r\n</nz-layout>\r\n","\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { ManageLotsComponent } from './manage-lots.component';\r\nimport { RouterModule, Routes } from '@angular/router'; \r\nimport { IonicModule } from '@ionic/angular';\r\nimport { TranslateModule } from '@ngx-translate/core'; \r\nimport { NgZorroAntModule } from 'src/app/cafe/desktop/ng-zorro-ant.module';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ManageLotsComponent\r\n  }, \r\n]\r\n@NgModule({\r\n  declarations: [\r\n    ManageLotsComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    RouterModule.forChild(routes),\r\n    NgZorroAntModule,\r\n    IonicModule,\r\n    TranslateModule\r\n  ]\r\n})\r\nexport class ManageLotsModule { }\r\n"],"names":[],"sourceRoot":"webpack:///"}