{"version":3,"file":"src_app_dealer_dashboard_manage-keys_manage-keys_module_ts.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEsE;;;;;;;;;;;;;;;;;;;ICe1D,6EAAyG;;;IACzG,0EAAuF;IAAA,gGACvF;IAAA,4DAAM;;;IA4BU,wEAA8D;IAC1D,uEAAM;IAAA,uDAA8B;;IAAA,4DAAO;IAC/C,qEAAe;;IADL,0DAA8B;IAA9B,oKAA8B;;;IAGxC,wEAAuC;IACnC,2EAA0B;IAAA,uDAA4B;;IAAA,4DAAO;IACjE,qEAAe;;IADe,0DAA4B;IAA5B,kKAA4B;;;IAG1D,wEAA+D;IAC3D,uEAAM;IAAA,uDAAgC;;IAAA,4DAAO;IACjD,qEAAe;;IADL,0DAAgC;IAAhC,iKAAgC;;;;IApBlD,qEAA+E;IAC3E,yEAAoC;IAAA,uDAAe;IAAA,4DAAK;IACxD,yEAAuD;IAAA,uDAC1B;;IAAA,4DAAK;IAClC,yEAEsC;IAAlC,iYAAiC;IAAC,uDAAgB;IAAA,4DAAK;IAC3D,yEAC+E;IAG3E,wIAEe;IAEf,0IAEe;IAEf,0IAEe;IACnB,4DAAK;IAEL,0EAAuD;IAAA,wDACvD;;IAAA,4DAAK;IAMT,4DAAK;;;IA9BmC,0DAAe;IAAf,+EAAe;IACI,0DAC1B;IAD0B,uKAC1B;IAGS,0DAAgB;IAAhB,gFAAgB;IAElD,0DAA0E;IAA1E,iIAA0E;IAG3D,0DAA6C;IAA7C,+GAA6C;IAI7C,0DAAsB;IAAtB,qFAAsB;IAItB,0DAA8C;IAA9C,gHAA8C;IAKV,0DACvD;IADuD,yKACvD;;AD/CjB,MAAM,mBAAmB;IAkB9B,YACU,MAAc,EACd,KAAoB,EACrB,MAAiB,EAChB,SAAsB,EACtB,aAA4B,EAC5B,WAAwB;QALxB,WAAM,GAAN,MAAM,CAAQ;QACd,UAAK,GAAL,KAAK,CAAe;QACrB,WAAM,GAAN,MAAM,CAAW;QAChB,cAAS,GAAT,SAAS,CAAa;QACtB,kBAAa,GAAb,aAAa,CAAe;QAC5B,gBAAW,GAAX,WAAW,CAAa;QArBlC,kBAAkB;QAEX,SAAI,GAAW,CAAC,IAAI,IAAI,EAAE,EAAE,IAAI,IAAI,EAAE,CAAC,CAAC;QAC/C,cAAS,GAAW,CAAC,CAAC;QACtB,aAAQ,GAAW,EAAE,CAAC;QACtB,aAAQ,GAAW,CAAC,CAAC;QACrB,cAAS,GAAW,EAAE,CAAC;QACvB,mBAAc,GAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;QAC9C,SAAI,GAAQ,EAAE,CAAC;QAEf,YAAO,GAAY,KAAK,CAAC;QACzB,uBAAkB,GAAG,KAAK,CAAC;QAC3B,aAAQ,GAAG,EAAE;QAEb,iBAAY,GAAQ,EAAE;QAoEtB,2BAA2B;QAC3B,YAAO,GAAG,KAAK,CAAC;QA5Dd,sEAAsE;QACtE,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE;YACxC,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC;YACtC,IAAI,CAAC,IAAI,GAAG,EAAE;QAChB,CAAC,CAAC,CAAC;QACH,8HAA8H;IAChI,CAAC;IAED,QAAQ;IAER,CAAC;IAED,8BAA8B,CAAC,OAAO;QACpC,IAAI,OAAO;YAAE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACjC,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;QAEf,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,EAAE,cAAc,EAAE,EAAE,GAAG,EAAE,IAAI,CAAC,YAAY,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;aAC7M,IAAI,CAAC,CAAC,IAAS,EAAE,EAAE;YAClB,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;YACrB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC;YACjB,IAAI,IAAI,EAAE;gBACR,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE;oBACnC,uCAAY,IAAI,KAAE,EAAE,EAAE,CAAC,KAAK,IAAI,CAAC,CAAC,EAAE,YAAY,EAAE,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,IAAG;gBACnG,CAAC,CAAC,CAAC;gBACH,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBACtB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAExB;QACH,CAAC,EACC,CAAC,GAAG,EAAE,EAAE;YACN,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC,CAAC;QAC3C,CAAC,CACF,CAAC;IACN,CAAC;IAED,kBAAkB,CAAC,IAAY;QAC7B,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC;QAC9C,OAAO,KAAK,CAAC,CAAC,CAAC,eAAe,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,iBAAiB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;IACvE,CAAC;IAED,QAAQ,CAAC,QAAQ;QACf,MAAM,CAAC,IAAI,CAAC,mBAAmB,QAAQ,EAAE,CAAC,CAAC;IAC7C,CAAC;IACD,kBAAkB;IAClB,gBAAgB,CAAC,KAAgB;QAC/B,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC,SAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;QACjD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;QAChD,OAAO,KAAK,CAAC;IACf,CAAC;IAEM,SAAS,CAAC,KAAK;QACpB,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACrC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,EAAE;YACnC,kBAAkB,EAAE,QAAQ;YAC5B,gBAAgB,EAAE,KAAK;YACvB,QAAQ,EAAE,IAAI;SACf,CAAC,CAAC;IACL,CAAC;IAID;;;OAGG;IACH,SAAS,CAAC,OAAO;QACf,QAAQ,OAAO,EAAE;YACf,KAAK,MAAM;gBACT,IAAI,IAAI,CAAC,OAAO,EAAE;oBAChB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC,CAAC;iBACrE;qBAAM;oBACL,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC,CAAC;iBACtE;gBACD,MAAM;SACT;IACH,CAAC;;sFArGU,mBAAmB;iHAAnB,mBAAmB;kEAEnB,qEAAY;;;;;QChBzB,yEAA2B;QACvB,yEAAwG;QAEpG,oEAAG;QAAA,oGAAqB;QAAA,4DAAI;QAE5B,yEAAkF;QAE9E,qFAAgF;QAAnB,+LAAkB;QAC/E,4DAAkB;QAClB,4EACqD;QADY,2IAAS,mCAA+B,IAAI,CAAC,IAAC;QAE3G,gEACJ;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,yEAA8D;QAC1D,yEAA2C;QACvC,iIAAyG;QACzG,iHACM;QAEN,4EAAqB;QACjB,yEAAO;QACH,sEAAI;QACA,0EAAgB;QAAA,6DAAC;QAAA,4DAAK;QACtB,0EAA+D;QAA/C,oKAA4B,cAAU,MAAM,CAAC,IAAC;QAAC,0EAAS;QAAA,oEACW;QAAA,4DAAK;QACxF,0EAAgB;QAAA,uEAAM;QAAA,4DAAK;QAC3B,0EAAgB;QAAA,gFAAU;QAAA,4DAAK;QAC/B,0EAAgB;QAAA,wEAAO;QAAA,4DAAK;QAIhC,4DAAK;QACT,4DAAQ;QACR,yEAAO;QACH,kHA+BK;;QACT,4DAAQ;QACZ,4DAAQ;QACZ,4DAAM;QACN,2EAAqC;QACjC,qFACmE;QAAlC,uJAAQ,4BAAwB,IAAC;QAClE,4DAAgB;QACpB,4DAAM;QACV,4DAAM;QACV,4DAAM;;QAtEmE,0DAAkB;QAAlB,6EAAkB;QAUpD,0DAAa;QAAb,6EAAa;QACe,0DAA8B;QAA9B,kGAA8B;QAQjE,0DAAoD;QAApD,mHAAoD;QAUvC,0DAAuC;QAAvC,4KAAuC;QAoCzD,0DAAsB;QAAtB,mFAAsB;;;;;;;;;;;;;;;;;;;;;;;;;ACvEF;AACF;AACU;AACD;AACY;AAEU;AAUd;AACP;;;AATvD,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,uEAAmB;KAC/B;CAEF;AAsBM,MAAM,gBAAgB;;gFAAhB,gBAAgB;6GAAhB,gBAAgB;iHAXlB;YACP,yDAAY;YACZ,uDAAW;YACX,uDAAW;YACX,+DAAmB;YACnB,sFAAgB;YAChB,gEAAe;YACf,4DAAc;YACd,kEAAqB,CAAC,MAAM,CAAC;SAC9B;mIAEU,gBAAgB,mBAbzB,uEAAmB,aAGnB,yDAAY;QACZ,uDAAW;QACX,uDAAW;QACX,+DAAmB;QACnB,sFAAgB;QAChB,gEAAe;QACf,4DAAc","sources":["./src/app/dealer/dashboard/manage-keys/manage-keys.component.ts","./src/app/dealer/dashboard/manage-keys/manage-keys.component.html","./src/app/dealer/dashboard/manage-keys/manage-keys.module.ts"],"sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatPaginator, PageEvent } from '@angular/material/paginator';\r\n\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationStart, Route, Router } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQueryDealer, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { filter } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-manage-keys',\r\n  templateUrl: './manage-keys.component.html',\r\n  styleUrls: ['./manage-keys.component.scss']\r\n})\r\nexport class ManageKeysComponent implements OnInit {\r\n\r\n  @ViewChild(MatPaginator) paginator: MatPaginator;\r\n  /// panigatior ///\r\n\r\n  public date: Date[] = [new Date(), new Date()];\r\n  pageIndex: number = 0;\r\n  pageSize: number = 20;\r\n  lowValue: number = 0;\r\n  highValue: number = 20;\r\n  pageSizeOption: any = [20, 50, 100, 200, 500];\r\n  data: any = [];\r\n\r\n  loading: boolean = false;\r\n  isVisibleExtendUse = false;\r\n  key_code = ''\r\n  customer: any;\r\n  main_package: any = ''\r\n  constructor(\r\n    private router: Router,\r\n    private route:ActivatedRoute,\r\n    public dialog: MatDialog,\r\n    private _snackBar: MatSnackBar,\r\n    private vhQueryDealer: VhQueryDealer,\r\n    private vhAlgorithm: VhAlgorithm\r\n  ) {\r\n    // Nghe sự kiện navigation để cập nhật state nếu router không thay đổi\r\n    this.route.queryParams.subscribe(params => {\r\n      this.main_package = params['package'];\r\n      this.data = []\r\n    });\r\n    // this.main_package = this.router.getCurrentNavigation().extras.state ? this.router.getCurrentNavigation().extras.state : '';\r\n  }\r\n\r\n  ngOnInit(): void {\r\n\r\n  }\r\n\r\n  getEndUsersAPP_byTime_byDealer(loading) {\r\n    if (loading) this.loading = true;\r\n    this.data = [];\r\n\r\n    this.vhQueryDealer.getLicenseKEYs({ date: { $gte: new Date(this.date[0].setHours(0, 0, 0, 0)), $lte: new Date(this.date[1].setHours(23, 59, 59, 59)) }, id_restriction: { $eq: this.main_package } }, {}, {}, 0)\r\n      .then((data: any) => {\r\n        this.loading = false;\r\n        console.log(data)\r\n        if (data) {\r\n          this.data = data.map((item, index) => {\r\n            return { ...item, no: (index += 1), package_name: this.extractPackageType(item.id_restriction) };\r\n          });\r\n          this.sortTable('date')\r\n          console.log(this.data);\r\n\r\n        }\r\n      },\r\n        (err) => {\r\n          console.log(err), (this.loading = false);\r\n        }\r\n      );\r\n  }\r\n\r\n  extractPackageType(text: string): string | null {\r\n    const match = text.match(/main_package_(.*)/);\r\n    return match ? 'Gói phần mềm ' + match[1].toLocaleUpperCase() : null;\r\n  }\r\n\r\n  openZalo(customer) {\r\n    window.open(`https://zalo.me/${customer}`);\r\n  }\r\n  // slice panigator\r\n  getPaginatorData(event: PageEvent): PageEvent {\r\n    this.lowValue = event.pageIndex * event.pageSize;\r\n    this.highValue = this.lowValue + event.pageSize;\r\n    return event;\r\n  }\r\n\r\n  public copyValue(value) {\r\n    navigator.clipboard.writeText(value);\r\n    this._snackBar.open('Copied', value, {\r\n      horizontalPosition: 'center',\r\n      verticalPosition: 'top',\r\n      duration: 2000\r\n    });\r\n  }\r\n\r\n  /** hàm sort cho các cột */\r\n  dateCol = false;\r\n  /** Hàm thực hiện sắp xếp theo collection\r\n   *\r\n   * @param colName       // tên cột muôn sắp xếp\r\n   */\r\n  sortTable(colName) {\r\n    switch (colName) {\r\n      case 'date':\r\n        if (this.dateCol) {\r\n          this.data = this.vhAlgorithm.sortDatebyASC([...this.data], colName);\r\n        } else {\r\n          this.data = this.vhAlgorithm.sortDatebyDESC([...this.data], colName);\r\n        }\r\n        break;\r\n    }\r\n  }\r\n}\r\n","<div style=\"height: 100%;\">\r\n    <div style=\"height: 8%;display: flex; width: 100%; align-items: center;justify-content: space-between;\">\r\n\r\n        <b>Quản lý KEY bản quyền</b>\r\n\r\n        <div style=\"display: flex; align-items: center; width: 40%;justify-content: end;\">\r\n\r\n            <nz-range-picker nzFormat='dd/MM/yyyy' nzFormat=\"dd/MM/yyyy\" [(ngModel)]=\"date\">\r\n            </nz-range-picker>\r\n            <button  style=\"margin-left: 8px;   \" nz-button nzType=\"primary\" (click)=\"getEndUsersAPP_byTime_byDealer(true)\"\r\n                class=\"bg-success text-white px-3 mx-2 btn-view\">\r\n                Xem\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div style=\"height: 91%; margin-top: 1%; overflow-y: hidden;\">\r\n        <div class=\"body-tab\" style=\"height: 92%;\">\r\n            <mat-spinner color=\"warn\" *ngIf=\"loading\" style=\"top: 50%; left: 50%; position: absolute;\"></mat-spinner>\r\n            <div style=\"top: 50%; left: 50%; position: absolute;\" *ngIf=\"!data.length && !loading\">Không có dữ liệu\r\n            </div>\r\n\r\n            <table class=\"table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th scope=\"col\">#</th>\r\n                        <th scope=\"col\" (click)=\"dateCol = !dateCol;sortTable('date')\">Ngày mua <i nz-icon\r\n                                [nzType]=\"dateCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i></th>\r\n                        <th scope=\"col\">Mã KEY</th>\r\n                        <th scope=\"col\">Trạng thái</th>\r\n                        <th scope=\"col\">Gói mua</th>\r\n\r\n                        <!-- <th style=\"width: 20%\" style=\"text-align: center;\" scope=\"col\">Chức năng</th> -->\r\n                        <!-- <th style=\"text-align: center;\" scope=\"col\">Đại lý</th> -->\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr *ngFor=\"let customer of data | slice: lowValue : highValue; let i = index\">\r\n                        <td style=\"word-break: break-word;\">{{customer.no}}</td>\r\n                        <td style=\"word-break: break-word;text-align: center;\">{{customer.date |\r\n                            date:'dd/MM/yyyy,HH:mm'}}</td>\r\n                        <td nz-tooltip nzTooltipTitle=\"Click to copy\"\r\n                            style=\"word-break: break-word; cursor: pointer;text-align: center;\"\r\n                            (click)=\"copyValue(customer._id)\">{{customer._id}}</td>\r\n                        <td style=\"word-break: break-word;text-align: center;\"\r\n                            [style.color]=\"customer.activated ? 'var(--ion-color-vh-green)' : 'black'\">\r\n                            \r\n                            <!-- đã kich hoạt và có id_store -->\r\n                            <ng-container *ngIf=\"customer.activated && !customer.invalid\">\r\n                                <span>{{'Đã kích hoạt' | translate}}</span>\r\n                            </ng-container>\r\n                            <!-- chưa kich hoạt và có id_store -->\r\n                            <ng-container *ngIf=\"customer.invalid\">\r\n                                <span style=\"color: red;\">{{'Đã vô hiệu' | translate}}</span>\r\n                            </ng-container>\r\n                            <!-- chưa kich hoạt và có id_store -->\r\n                            <ng-container *ngIf=\"!customer.activated && !customer.invalid\">\r\n                                <span>{{'Chưa kích hoạt' | translate}}</span>\r\n                            </ng-container>\r\n                        </td>\r\n\r\n                        <td style=\"word-break: break-word;text-align: center;\">{{customer.day}} {{ 'day'| translate}}\r\n                        </td>\r\n\r\n                        <!-- <td style=\"word-break: break-word;width: 20%;\">\r\n                            <button nz-button nzType=\"primary\" (click)=\"openModalExtendedUse(customer)\">Gia hạn</button>\r\n                            <button nz-button nzType=\"default\">Xem lịch sử</button>\r\n                        </td> -->\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <div style=\"height: 8%;width: 100%;\">\r\n            <mat-paginator [length]=\"data.length\" [pageSizeOptions]=\"pageSizeOption\" [pageSize]=\"pageSize\"\r\n                showFirstLastButtons=\"false\" (page)=\"getPaginatorData($event)\">\r\n            </mat-paginator>\r\n        </div>\r\n    </div>\r\n</div>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\n\r\nimport { NgZorroAntModule } from 'src/app/cafe/desktop/ng-zorro-ant.module';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ManageKeysComponent,\r\n  },\r\n\r\n]\r\n\r\nimport { ManageKeysComponent } from './manage-keys.component';\r\nimport { MaterialModule } from '../../material.module';\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ManageKeysComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    IonicModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    NgZorroAntModule,\r\n    TranslateModule,\r\n    MaterialModule,\r\n    RouterModule.forChild(routes)\r\n  ]\r\n})\r\nexport class ManageKeysModule { }\r\n"],"names":[],"sourceRoot":"webpack:///"}