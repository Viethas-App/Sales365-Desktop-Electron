{"version":3,"file":"src_app_sales_bill-web-app_sales-order-voucher_sales-order-voucher_module_ts.js","mappings":"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","sources":["./src/app/sales/bill-web-app/sales-order-voucher/create-bill/create-bill.component.ts","./src/app/sales/bill-web-app/sales-order-voucher/create-bill/create-bill.component.html","./src/app/sales/bill-web-app/sales-order-voucher/sales-order-voucher.component.html","./src/app/sales/bill-web-app/sales-order-voucher/sales-order-voucher.component.ts","./src/app/sales/bill-web-app/sales-order-voucher/sales-order-voucher.module.ts"],"sourcesContent":["\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { Component, OnInit, HostListener, ChangeDetectorRef } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuery, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { Observable } from 'rxjs';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { SalesVoucherK57Col3Component } from 'src/app/sales/components/print/sales-voucher/sales-voucher-k57-col3/sales-voucher-k57-col3.component';\r\nimport { SalesVoucherK80Col3Component } from 'src/app/sales/components/print/sales-voucher/sales-voucher-k80-col3/sales-voucher-k80-col3.component';\r\nimport { SalesVoucherK80Col4Component } from 'src/app/sales/components/print/sales-voucher/sales-voucher-k80-col4/sales-voucher-k80-col4.component';\r\nimport { SalesVoucherA5Component } from 'src/app/sales/components/print/sales-voucher/sales-voucher-a5/sales-voucher-a5.component';\r\nimport { SalesVoucherA4Component } from 'src/app/sales/components/print/sales-voucher/sales-voucher-a4/sales-voucher-a4.component';\r\nimport { VhBillType40DetailAdd, VhBillType40DetailEdit, VhBillType40Edit } from 'src/app/sales/components/bill-type/bill-type-40/bill-type40-interface';\r\n\r\n@Component({\r\n  selector: 'app-create-bill',\r\n  templateUrl: './create-bill.component.html',\r\n  styleUrls: ['./create-bill.component.scss']\r\n})\r\nexport class CreateBillComponent implements OnInit {\r\n\r\n  public root: any; // biến nhận state truyền qua\r\n  public invoice: VhBillType40Edit;\r\n  invoice_detail: VhBillType40DetailEdit[] = []\r\n  public listTax: any[] = this.vhQuerySales.getlocalTaxs().filter(tax => tax.status);\r\n  public employee: any = {};\r\n  public pickerTime = new Date();\r\n  public customer: any;\r\n  public checkPrinter: boolean = false;\r\n  public closerBrower: any;\r\n  public id_product_delete: string = '';\r\n  public percent_discount_bill: number = 0;\r\n  subTotal = 0;\r\n  taxValue = 0\r\n  customer_online: any;\r\n  invoiceToday: any;\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private languageService: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    public vhAuth: VhAuth,\r\n    private nzModalService: NzModalService,\r\n    private fncService: FunctionService,\r\n    private cdf: ChangeDetectorRef,\r\n    private vhQuery: VhQuery\r\n  ) {\r\n    this.root = this.router.getCurrentNavigation().extras.state;\r\n    this.customer_online = this.root.customer;\r\n    this.invoiceToday = this.root.invoiceToday\r\n    this.getDataInvoice(this.root.bill);\r\n  }\r\n\r\n  ngOnInit(): void {\r\n\r\n  }\r\n\r\n  private getDataInvoice(bill) {\r\n    this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n      Promise.all([\r\n        this.vhQuerySales.getBill_details_byId_bill(bill._id)\r\n      ]).then(([invoiceDetail]: any) => {\r\n        \r\n        if (!invoiceDetail.length)\r\n          this.init(bill, [])\r\n        else {\r\n          let promise = []\r\n          for (let i in invoiceDetail) {\r\n            promise[i] = this.vhQuerySales.getVoucher_Code_Name_Release(invoiceDetail[i].id_voucher_code)\r\n          }\r\n          Promise.all(promise).then((array) => {\r\n            \r\n\r\n            invoiceDetail = invoiceDetail.map((e, index) => {\r\n              return { ...e, price: array[index].units[0].price, ...array[index], name: array[index].name_voucher }\r\n            })\r\n            this.init(bill, invoiceDetail)\r\n          })\r\n\r\n        }\r\n      })\r\n    })\r\n  }\r\n\r\n  init(invoice: VhBillType40Edit = null, invoiceDetail: VhBillType40DetailEdit[] = null) {\r\n    this.vhComponent.hideLoading(0)\r\n    this.invoice = invoice;\r\n    this.invoice_detail = invoiceDetail\r\n    if (invoice && invoiceDetail) {\r\n      // set nhân viên mặc định\r\n      if (!this.invoice.id_employee)\r\n        this.invoice.id_employee = (this.vhAuth.getUser()._id)\r\n      this.invoice.date = new Date()\r\n      this.invoice.payment = (invoice.total)\r\n      this.invoice.discount = 0\r\n      this.invoice.cash = 0\r\n      this.note = this.invoice.note;\r\n      this.pickerTime = new Date();\r\n      this.percent_discount_bill = this.subTotal ? (this.invoice.discount / this.subTotal) * 100 : 0\r\n      this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n      let tax = this.listTax.find(item => item.default);\r\n      if (tax) {\r\n        this.id_tax = tax._id\r\n        this.invoice.tax = (tax['value']);\r\n      }\r\n      this.subTotal = this.invoice_detail.reduce((prev: number, next) => prev + 1 * next.price, 0)\r\n      this.vhAlgorithm.waitingStack().then(() => {\r\n        this.invoice_fee = document.querySelector(\".invoice-fee\") ? this.vhAlgorithm.vhnumeral(\".invoice-fee\") : 0\r\n        this.discount_price = document.querySelector(\".discount-price\") ? this.vhAlgorithm.vhnumeral(\".discount-price\") : 0\r\n      })\r\n    }\r\n  }\r\n  event: any // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n    // window.removeEventListener('beforeunload', this.closerBrower, false)\r\n  }\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113 || keycode === 114) event.preventDefault();\r\n      if (keycode === 115) this.searchProductList = !this.searchProductList;\r\n      else if (this.invoice_detail.length > 0) {\r\n        switch (keycode) {\r\n          case 113: {\r\n            if (this.checkPrinter) this.payInvoice(40, true)\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  ngAfterViewInit() {\r\n\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales_voucher')\r\n    if (printer) this.checkPrinter = printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable;\r\n\r\n\r\n    // ------bắt sự kiện nhấn phím nóng-----\r\n    this.eventKeypress();\r\n  }\r\n\r\n  ngAfterViewChecked(): void {\r\n    this.cdf.detectChanges()\r\n  }\r\n\r\n\r\n  // chuổi danh sách sản phẩm\r\n  getStringName(products: any[]) {\r\n    let name = ''\r\n    products.forEach(element => {\r\n      let product = this.vhQuerySales.getlocalDetailProduct(element.id_subproduct ? element.id_subproduct : element.id_product)\r\n      name += '- ' + element.quantity + 'x ' + product.name + ' (' + this.vhQuerySales.getUnit_byRatio(product.units, element.ratio).unit + ') \\n';\r\n    });\r\n    return name\r\n  }\r\n\r\n\r\n  // edit giá voucher\r\n  editVoucherPrice(nameClass, position) {\r\n    let price = this.vhAlgorithm.vhnumeral(\"#\" + nameClass);\r\n    this.invoice_detail[position].price = parseFloat(price.getRawValue() ? price.getRawValue() : 0)\r\n    this.setSubTotal();\r\n  }\r\n\r\n\r\n  deleteGoods(detail: VhBillType40DetailAdd, index?) {\r\n    if (detail) {\r\n      this.id_product_delete = detail.id_voucher_code\r\n      this.removeInvoiceDetail(detail.id_voucher_code)\r\n\r\n    }\r\n  }\r\n  // -------change tax------\r\n  id_tax: string;\r\n  changeTax(event) {\r\n    let tax = this.listTax.find(item => item._id == event);\r\n    this.invoice.tax = (tax.value);\r\n    this.setTaxValue();\r\n  }\r\n\r\n  searchProductList: boolean = false;\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n\r\n  // tạo danh sách voucher bán\r\n  closeSearchProductList(data) {\r\n    if (typeof data === 'boolean') {\r\n      this.searchProductList = false;\r\n    } else {\r\n      if (data) {\r\n        if (!this.invoice_detail.includes(data)) {\r\n          this.addInvoiceDetail(data)\r\n          this.vhComponent.alertMessageDesktop(\"success\", this.languageService.translate(\"Thêm voucher thành công\"))\r\n        } else {\r\n          this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Mã voucher đã được chọn !\"))\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  public setPaymentName(type: 1 | 2 | 3) {\r\n    switch (type) {\r\n      case 1: return this.languageService.translate(\"Cash\")\r\n      case 2: return this.languageService.translate(\"Debit\")\r\n      case 3: return this.vhQuerySales.getlocalWallet(this.invoice.id_wallet).name\r\n    }\r\n  }\r\n\r\n\r\n  goBack() {\r\n    this.router.navigate(['/sales/bill-web-app/sales-order-voucher'], { state: { invoiceToday: this.invoiceToday } });\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhBillType40DetailAdd;\r\n  openEditUnitPrice(detail: VhBillType40DetailAdd) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      this.setSubTotal();\r\n\r\n      this.isVisibleEditUnitPrice = false;\r\n    } else { this.vhComponent.showToast(5000, this.languageService.translate(\"Invalid data, please check again\"), \"alert-toast\") }\r\n  }\r\n  handleCancelEditUnit() { this.isVisibleEditUnitPrice = false }\r\n  // -------set employee-------\r\n  employees = this.vhAuth.getlocalEmployees();\r\n  closeAndReceiveEmployee(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n    }\r\n  }\r\n  // ----set customer-----\r\n  radioValue: 1 | 2 = 1;\r\n  closeAndReceiveCustomer(event) {\r\n    if (event) {\r\n      this.invoice.id_customer = (event);\r\n      if (!this.vhQuerySales.getlocalCustomer(event).debt_enable) this.invoice.payment = (this.getTotalATax());\r\n    }\r\n    this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n  }\r\n  changeCustomerType(event) {\r\n    if (this.radioValue == 1) {\r\n      this.invoice.id_customer = (\"id_retail\");\r\n      this.invoice.payment = (this.getTotalATax());\r\n    } if (event == 2) {\r\n      this.clearRetailCustomer()\r\n      this.radioValue = 2\r\n    }\r\n  }\r\n\r\n  clearRetailCustomer() {\r\n    this.invoice.retail_address = ('')\r\n    this.invoice.retail_name = ('')\r\n    this.invoice.retail_phone = ('')\r\n  }\r\n  closeAndGetValuePayment(event) {\r\n    if (event[0] == 1 || event[0] == 2) {\r\n      this.setPaymentType(event[0]);\r\n    }\r\n    else if (event[0] == 3) {\r\n      this.setPaymentType(event[0], event[1]);\r\n    }\r\n  }\r\n  setPaymentType(type: 1 | 2 | 3, id_wallet?) {\r\n    this.invoice.payment_type = (type)\r\n    switch (type) {\r\n      case 1: {\r\n        this.invoice.id_wallet = ('id_cash');\r\n        this.invoice.payment = (this.invoice.payment ? this.invoice.payment : this.invoice.total + this.taxValue);\r\n\r\n        break;\r\n      }\r\n      case 2: {\r\n        this.invoice.payment = (0); this.invoice.id_wallet = (null);\r\n        this.invoice.cash = (0);\r\n\r\n        break;\r\n      }\r\n      case 3: {\r\n        if (id_wallet) {\r\n          this.invoice.id_wallet = (id_wallet)\r\n          this.invoice.payment = (this.invoice.payment ? this.invoice.payment : this.invoice.total + this.taxValue);\r\n\r\n          break;\r\n        }\r\n      }\r\n    };\r\n  }\r\n  setPickerTime(event) {\r\n    if (new Date(event).getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 5000)\r\n      this.pickerTime = new Date(this.invoice.date)\r\n      this.invoice.date = (new Date(this.pickerTime));\r\n    }\r\n    else this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n      if (validitydate == null) {\r\n        this.invoice.date = (event);\r\n      }\r\n      else {\r\n        this.pickerTime = new Date(validitydate)\r\n        this.invoice.date = (new Date(this.pickerTime));\r\n        this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 5000)\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  discount_price: any;\r\n  editDiscount() {\r\n    if (this.discount_price.getRawValue() && this.discount_price.getRawValue() >= 0 && this.discount_price.getRawValue() <= this.subTotal) {\r\n      this.invoice.discount = (parseFloat(this.discount_price.getRawValue()));\r\n      this.percent_discount_bill = this.subTotal ? (this.invoice.discount / this.subTotal) * 100 : 0\r\n    } else {\r\n      document.getElementById(\"discount-price\")['value'] = this.invoice.discount;\r\n      this.discount_price = this.vhAlgorithm.vhnumeral('.discount-price');\r\n    }\r\n    this.setTotal()\r\n  }\r\n\r\n  // -------change tax------\r\n\r\n  invoice_fee: any;\r\n  editFee() {\r\n    if (this.invoice_fee.getRawValue() && this.invoice_fee.getRawValue() >= 0) {\r\n      this.invoice.fee = (parseFloat(this.invoice_fee.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"invoice-fee\")['value'] = this.invoice.fee;\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral('.invoice-fee');\r\n    }\r\n    this.setTotal()\r\n  }\r\n\r\n  // -------modal edit pay---------\r\n  edit_pay: boolean = false;\r\n  edit_paytotal: any;\r\n  showModalEditTotalPay() {\r\n    if (this.invoice.payment_type != 2 && this.vhQuerySales.getlocalCustomer(this.invoice.id_customer).debt_enable) {\r\n      this.vhAlgorithm.waitingStack().then(() => {\r\n        this.edit_paytotal = this.vhAlgorithm.vhnumeral(\".edit-pay\");\r\n      })\r\n      this.edit_pay = true;\r\n    }\r\n    else if (!this.vhQuerySales.getlocalCustomer(this.invoice.id_customer).debt_enable) {\r\n      this.vhComponent.showToast(5000,\r\n        this.languageService.translate(\"This customer is not allowed to debt\"), \"alert-toast\"\r\n      )\r\n    }\r\n  }\r\n  handleEditPay() {\r\n    if (this.edit_paytotal.getRawValue() >= 0 && this.edit_paytotal.getRawValue() <= this.getTotalATax()) {\r\n      this.invoice.payment = (parseFloat(this.edit_paytotal.getRawValue()))\r\n    }\r\n    this.edit_pay = false;\r\n  }\r\n  handleCancelEditPay() {\r\n    this.edit_pay = false;\r\n  }\r\n  updateCash(cash: any) {\r\n    this.invoice.cash = parseFloat(cash.replaceAll(',', ''))\r\n  }\r\n\r\n  editPercentDiscount(value) {\r\n    if (parseFloat(value) > 100)\r\n      document.getElementById(\"percent-discount-price\")['value'] = 0\r\n    else this.percent_discount_bill = value;\r\n    this.invoice.discount = this.subTotal * (this.percent_discount_bill / 100)\r\n    this.setTotal()\r\n  }\r\n\r\n  payInvoice(bill_type: 40, print?) {\r\n    if (this.vhAuth.checkMyPermission(\"sales_enable_payment\")) {\r\n      if (print) {\r\n        if (this.checkPrinter) {\r\n          this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n            this.createOrUpdate()\r\n            // .then(() => {\r\n            //   this.vhComponent.hideLoading(0).then(() => {\r\n            //     this.vhComponent.showToast(5000,\r\n            //       `${this.languageService.translate(\"Sales invoice\")} ${this.invoice.getBillCode()} ${this.languageService.translate(\"has been created successfully\")}`, \"success-toast\"\r\n            //     )\r\n            //     this.handlePrint()\r\n            //   })\r\n            // })\r\n          })\r\n        }\r\n        else {\r\n          this.nzModalService.confirm({\r\n            nzTitle: '<i>' + this.languageService.translate(\"Function\") + '</i>',\r\n            nzContent: '<b>' + this.languageService.translate(\"Please open the function in\") + ' ' + '<i>' + '\"' + this.languageService.translate(\"Sales page settings\") + '\"' + '</i>' + ' ' + ' -> ' + '<i>' + '\"' + this.languageService.translate('Print page') + '\"' + '</i>' + '</b>',\r\n            nzIconType: \"info-circle\",\r\n            nzCancelText: null,\r\n            nzOnOk: () => { }\r\n          })\r\n        }\r\n      }\r\n      else {\r\n        this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n          this.createOrUpdate()\r\n          // .then(() => {\r\n\r\n          //   this.vhComponent.hideLoading(0).then(() => {\r\n          //     this.vhComponent.showToast(5000,\r\n          //       `${this.languageService.translate(\"Sales invoice\")} ${this.invoice.getBillCode()} ${this.languageService.translate(\"has been created successfully\")}`, \"success-toast\"\r\n          //     )\r\n          //     this.goBack()\r\n          //   })\r\n          // })\r\n        })\r\n      }\r\n    }\r\n    else this.vhComponent.showToast(5000, this.languageService.translate('You do not have this rights'), \"alert-toast\")\r\n  }\r\n\r\n\r\n  createOrUpdate() {\r\n    // let invoice = { ...this.invoice.getCreateUpdateInvoice(40) }\r\n    // return this.vhQuerySales.saveBill_Billdetail(this.invoice.getID(),40)\r\n    // return new Promise(resolve => {\r\n    let invoice = { ...this.invoice }\r\n\r\n    this.vhQuerySales.updateBill_Billdetail(this.invoice._id, invoice, this.getCreateUpdateInvoiceDetail())\r\n      .then(() => {\r\n        \r\n        this.vhQuerySales.saveBill_Billdetail(this.invoice._id, 40)\r\n          .then(() => {\r\n            \r\n            this.invoiceToday = this.invoiceToday.filter(item => item._id != this.invoice._id)\r\n            this.vhComponent.hideLoading(0).then(() => {\r\n              this.vhComponent.showToast(5000,\r\n                `${this.languageService.translate(\"Hóa đơn bán voucher\")} ${this.invoice.bill_code} ${this.languageService.translate(\"has been created successfully\")}`, \"success-toast\"\r\n              )\r\n              this.goBack()\r\n            })\r\n          })\r\n      })\r\n    // })\r\n  }\r\n\r\n  deleteInvoice() {\r\n    this.vhComponent.showLoading('')\r\n      .then(() => {\r\n        this.vhQuerySales.deleteBill_Billdetail(this.invoice._id)\r\n          .then((bool) => {\r\n            if (bool) {\r\n              this.vhComponent.hideLoading(0)\r\n              \r\n              this.invoiceToday = this.invoiceToday.filter(item => item._id != this.invoice._id)\r\n              this.goBack()\r\n            } else {\r\n              \r\n            }\r\n          }, (error: any) => {\r\n            \r\n          })\r\n      })\r\n\r\n  }\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getlocalPrinters().find(item => item.name == \"DESKTOP\")\r\n      if (printer && printer.voucher.enable) resolve(printer.voucher)\r\n      else resolve(false)\r\n      if (!printer) rejects(false)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return SalesVoucherK57Col3Component\r\n      case 'print_size_k80_3c': return SalesVoucherK80Col3Component\r\n      case 'print_size_k80_4c': return SalesVoucherK80Col4Component\r\n      case 'print_size_a5': return SalesVoucherA5Component\r\n      case 'print_size_a4': return SalesVoucherA4Component\r\n      default: return SalesVoucherA4Component\r\n    }\r\n  }\r\n\r\n\r\n  handlePrint() {\r\n    let print = this.vhQuerySales.getLocalPrintPage('page_desktop_sales_voucher')\r\n    if (print && print.print_sizes[print.print_sizes.findIndex(e => e._id == print.print_size_default)].enable) {\r\n      let printer = print.print_sizes[print.print_sizes.findIndex(e => e._id == print.print_size_default)]\r\n      if (printer) {\r\n        let type = printer._id;\r\n        this.vhComponent.showModal(this.renderPrintPage(type), { printer: printer, invoice: this.invoice }, false, false, `modal-print-${type}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.goBack())\r\n        })\r\n      }\r\n    }\r\n  }\r\n  note: string;\r\n  edit_note() {\r\n    if (this.note) {\r\n      this.invoice.note = (this.note)\r\n    }\r\n  }\r\n\r\n  //--------------visible drawer info customer-----------\r\n  visibleInfoCustomer: boolean = false;\r\n  openInfoCustomer() {\r\n    if (this.invoice.id_customer != 'id_retail') {\r\n      this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n      this.visibleInfoCustomer = true;\r\n    }\r\n  }\r\n  closeInfoCustomer(event) {\r\n    this.visibleInfoCustomer = false;\r\n  }\r\n\r\n\r\n  /**add customer */\r\n  showDrawerAddCusomer: boolean = false;\r\n  showDrawerAddRetail: boolean = false\r\n  openDrawerAddCustomerOrRetail() {\r\n    if (this.radioValue == 1) this.showDrawerAddRetail = true\r\n    else this.showDrawerAddCusomer = true\r\n  }\r\n  closeAddCustomer(result) {\r\n    if (this.radioValue == 1) {\r\n      if (result) {\r\n        this.invoice.retail_name = (result.retail_name)\r\n        this.invoice.retail_phone = (result.retail_phone)\r\n        this.invoice.retail_address = (result.retail_address)\r\n      }\r\n      this.showDrawerAddRetail = false\r\n    }\r\n    else this.showDrawerAddCusomer = false\r\n  }\r\n\r\n  barcode: string = ''\r\n  barcode_array = [];\r\n  @HostListener(\"window: keypress\", [\"$event\"])\r\n  /**\r\n   * Sự kiện nhận barcode\r\n   */\r\n  getKeyUp(_event: KeyboardEvent) {\r\n    if (this.router.url === \"/sales/bill-web-app/sales-order-voucher/add\") {\r\n      // if (!this.showSearchBar && !this.showPayInfo) {\r\n      if (_event.key == \"Enter\") {\r\n        this.barcode_array.forEach((i, index) => {\r\n          if (i == \"Shift\") {\r\n            this.barcode_array[index + 1] = this.barcode_array[\r\n              index + 1\r\n            ].toUpperCase();\r\n            this.barcode_array.splice(index, 1);\r\n          }\r\n        });\r\n        // this.scanBarcode(this.barcode_array.join(\"\"));\r\n        this.barcode = this.barcode_array.join(\"\");\r\n        setTimeout(() => {\r\n          this.barcode_array = [];\r\n        }, 100);\r\n\r\n      } else {\r\n        this.barcode_array.push(_event.key);\r\n      }\r\n      // }\r\n    }\r\n  }\r\n  setSubTotal() {\r\n    this.subTotal = this.invoice_detail.reduce((prev: number, next) => prev + 1 * next.price, 0)\r\n    this.setTotal();\r\n  }\r\n\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee\r\n    this.setTaxValue()\r\n  }\r\n\r\n  setTaxValue() {\r\n    this.taxValue = this.invoice.total * (this.invoice.tax / 100)\r\n    this.setPayment()\r\n  }\r\n\r\n  setPayment(value?: number) {\r\n\r\n    if (this.invoice.payment_type == 2) {\r\n      this.invoice.payment = 0\r\n    } else {\r\n      if (value != null)\r\n        this.invoice.payment = value\r\n      else\r\n        this.invoice.payment = this.invoice.total + this.taxValue\r\n    }\r\n    this.setCash(this.invoice.cash);\r\n  }\r\n  setCash(value) {\r\n    if (this.invoice.payment_type == 2) this.invoice.cash = 0\r\n    else {\r\n      if (value) this.invoice.cash = parseFloat(value);\r\n      else this.invoice.cash = 0\r\n    }\r\n  }\r\n  getTotalATax(): number {\r\n    return this.invoice.total + this.taxValue\r\n  }\r\n  addInvoiceDetail(value: any) {\r\n    let detail: any = {\r\n      id_voucher_code: value.id_voucher_code,\r\n      name: value.name,\r\n      id_voucher: value.id_voucher,\r\n      code: value.code,\r\n      id_bill: value.id_bill,\r\n      vtype: 1,\r\n      price: value.price,\r\n      products: value.products,\r\n      name_voucher_release: value.name_voucher_release\r\n    }\r\n    this.invoice_detail.push(detail)\r\n    this.setSubTotal()\r\n  }\r\n  removeInvoiceDetail(id: string, notSetSub?: boolean) {\r\n    let index = this.invoice_detail.findIndex(detail => detail.id_voucher_code == id)\r\n    if (index != -1) {\r\n      this.invoice_detail.splice(index, 1);\r\n    }\r\n    this.setSubTotal()\r\n  }\r\n  getCreateUpdateInvoiceDetail(): VhBillType40DetailEdit[] {\r\n    return this.invoice_detail.map(item => {\r\n      let detail: VhBillType40DetailEdit = {\r\n        _id: item._id,\r\n        id_bill: item.id_bill,\r\n        id_voucher_code: item.id_voucher_code,\r\n        id_voucher: item.id_voucher,\r\n        code: item.code,\r\n        vtype: 1,\r\n        ratio: 1,\r\n        quantity: 1,\r\n        price: item.price,\r\n        products: item.products.map(pro => {\r\n          let data = {\r\n            id_product: pro.id_product,\r\n            ptype: pro.ptype,\r\n            ratio: pro.ratio,\r\n            quantity: pro.quantity,\r\n            price: 0,\r\n          }\r\n          if (pro.id_subproduct) data['id_subproduct'] = pro.id_subproduct\r\n          if (pro.combos) {\r\n            data['combos'] = pro.combos.map(combo => {\r\n              let product = {\r\n                id_product: combo.id_product,\r\n                price: combo.price,\r\n                quantity: combo.quantity,\r\n                ptype: combo.ptype,\r\n                ratio: combo.ratio ? combo.ratio : 1,\r\n              }\r\n              if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct\r\n              if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct\r\n              return product;\r\n            })\r\n          }\r\n          return data\r\n        }),\r\n      }\r\n\r\n      return detail\r\n    })\r\n  }\r\n}","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{'Back' | translate}}\r\n</div>\r\n<nz-layout  *ngIf=\"invoice\">\r\n    <div class=\"sales hide-best-selling\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{'Select voucher' | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n\r\n                    <div>\r\n                        <button style=\"width: 97%;\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                            (click)=\"openSearchProductList()\">\r\n                            <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                            {{'Search voucher (F4)' | translate}}</button>\r\n                    </div>\r\n                    \r\n                    <div>\r\n                        <button (click)=\"deleteInvoice()\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\">\r\n                          <i nz-icon nzType=\"save\" nzTheme=\"outline\"></i>\r\n                          {{'Delete' | translate}} (F3)</button>\r\n                    </div>\r\n                </div>\r\n                <div *ngIf=\"!invoice_detail.length\" class=\"no-data\">\r\n                    <p>{{'Please select a product' | translate}}</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\">\r\n                    <table style=\"width: 100%\" *ngIf=\"invoice_detail.length\">\r\n                        <thead>\r\n                            <th style=\"width: 5%\"></th>\r\n                            <th style=\"width: 35%\"><b>{{'Voucher name' | translate}}</b></th>\r\n                            <th style=\"width: 15%\"><b>{{'Voucher code' | translate}}</b></th>\r\n                            <th style=\"width: 15%\" nzAlign='right'><b>{{'Unit price' | translate}}</b></th>\r\n                            <th style=\"width: 30%\" nzAlign='right'><b>{{'Total' | translate}}</b></th>\r\n                        </thead>\r\n                        <tbody>\r\n                            <ng-container *ngFor=\"let item of invoice_detail; index as i\">\r\n                                <tr>\r\n                                    <td>\r\n                                        <div nz-popconfirm\r\n                                            nzPopconfirmTitle=\"{{'Are you sure to delete' | translate}} {{item.code}}\"\r\n                                            (nzOnConfirm)=\"deleteGoods(item,i)\" nzPopconfirmPlacement=\"bottomLeft\"\r\n                                            nz-col nzSpan=\"1\">\r\n                                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td>\r\n                                        <b>{{item.name_voucher_release}} ({{item.name}})</b> <br>\r\n\r\n                                    </td>\r\n                                    <td>{{item.code}}</td>\r\n                                    <td nzAlign='right'>\r\n                                        <input (keyup)=\"editVoucherPrice('voucher-price'+i,i)\"\r\n                                            [value]=\"vhAlgorithm.vhcurrencyunit(item.price)\" class=\"border_bottom\"\r\n                                            style=\"text-align: right !important\" type=\"text\" maxlength=\"15\"\r\n                                            [id]=\"'voucher-price'+i\" nz-input />\r\n                                    </td>\r\n                                    <td nzAlign='right'><b>{{vhAlgorithm.vhcurrencyunit(item.price)}}</b>\r\n                                    </td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td colspan=\"5\" style=\"padding: 0 8px;\">\r\n                                        <ng-container *ngIf=\"item.products\">\r\n                                            <!-- <span *ngFor=\"let product of item.products\">\r\n                                                {{ product.name}} {{ '('+product.unit +')'}} x {{product.quantity}} <br>\r\n                                            </span> -->\r\n                                            <pre style=\"white-space: pre-line;font-family: 'Roboto';margin: 0;\"  > {{getStringName(item.products)}}\r\n                                            </pre>\r\n                                        </ng-container>\r\n                                    </td>\r\n                                </tr>\r\n\r\n                            </ng-container>\r\n\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Salesman' | translate}}</b>\r\n                        <!-- <app-staff [id_employee]=\"invoice.getIdEmployee()\" (closeAndReceiveEmployee)=\"closeAndReceiveEmployee($event)\"></app-staff> -->\r\n                        <nz-select nzPlaceHolder=\"{{'Select employee' | translate}}\" [ngModel]=\"invoice.id_employee\"\r\n                            (ngModelChange)=\"closeAndReceiveEmployee($event)\" nzBorderless class=\"cus-select\" nzShowSearch>\r\n                            <nz-option *ngFor=\"let item of employees\" nzValue=\"{{item._id}}\" nzLabel=\"{{item.name}}\">\r\n                            </nz-option>\r\n                        </nz-select>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Sales date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\" nz-row>\r\n                <div class=\"sales-bills-customer-title\">\r\n                    <b>{{'Customer information' | translate}}\r\n                    </b>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    {{customer_online.name}} - {{customer_online.phone}} {{customer_online.address ? '-':\r\n                    ''}}  \r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <div nz-col nzSpan=\"24\" style=\"display: flex;justify-content: space-between;\">\r\n                    <b>{{'Payment information' | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div>{{'SubTotal' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n\r\n                <ng-container>\r\n                    <div class=\"sales-bills-content-discount\"\r\n                        style=\"display: flex;justify-content: space-between;align-items: center;\" nz-col nzSpan=\"24\">\r\n                        <div style=\"width: auto;\">{{'Discount value' | translate}}</div>\r\n                        <div>\r\n                            <input id=\"percent-discount-price\" style=\"width: 50px;\" #percentDiscount type=\"number\"\r\n                                max=\"100\" min=\"0\" step=\"1\"\r\n                                (blur)=\"  editPercentDiscount(percentDiscount.value)\"\r\n                                [value]=\"percent_discount_bill | number:'1.0-2'\" class=\"border_bottom \" maxlength=\"3\"\r\n                                nz-input />%\r\n                        </div>\r\n                        <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                            class=\"border_bottom discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\"\r\n                            nz-input />\r\n                    </div>\r\n                </ng-container>\r\n\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_fee')\">\r\n                    <div>{{'Fee' | translate}}</div>\r\n                    <input (blur)=\"editFee()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.fee)\"\r\n                        class=\"border_bottom invoice-fee\" type=\"text\" maxlength=\"15\" id=\"invoice-fee\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-tax\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_tax')\">\r\n                    <span>{{'Tax' | translate}}</span>\r\n                    <div>\r\n                        <nz-select *ngIf=\"listTax.length\" [(ngModel)]=\"id_tax\" (ngModelChange)=\"changeTax($event)\"\r\n                            nzBorderless>\r\n                            <nz-option *ngFor=\"let item of listTax\" nzValue=\"{{item._id}}\"\r\n                                nzLabel=\"{{vhAlgorithm.vhpercent(item.value/100)}}\">\r\n                            </nz-option>\r\n                        </nz-select>\r\n                        <span class=\"not-found\" *ngIf=\"!listTax.length\">0.00%</span>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"7\" style=\"text-align: end;\">\r\n                        {{vhAlgorithm.vhcurrencyunit(taxValue)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Total' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(getTotalATax())}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <div><b>{{'Pay' | translate}}</b></div>\r\n                    <div> {{vhAlgorithm.vhcurrencyunit(invoice.payment)}}<img (click)=\"showModalEditTotalPay()\"\r\n                            *ngIf=\"invoice.payment_type != 2\" style=\"width: 16px;margin-left:10px\"\r\n                            src=\"assets/icon/Iconfeather-edit.svg\" /></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_rest')\">\r\n                    <div>{{'Rest' | translate}}</div>\r\n                    <div> {{vhAlgorithm.vhcurrencyunit_symbol(getTotalATax() - invoice.payment)}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"sales-bills-content-payment_type\" nz-col nzSpan=\"24\">\r\n                    <app-tax [payment_type]=\"invoice.payment_type\" [id_wallet]=\"invoice.id_wallet\"\r\n                        [id_customer]=\"invoice.id_customer\"\r\n                        (closeAndGetValuePayment)=\"closeAndGetValuePayment($event)\">\r\n                    </app-tax>\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_cash')\"\r\n                    style=\"margin-top: 10px;\">\r\n                    <div>{{'cash' | translate}}</div>\r\n                    <input style=\"text-align: end;width: 35%;\" type=\"text\" #cash maxlength=\"15\" nz-input\r\n                        [disabled]=\"invoice.payment_type == 2\"\r\n                        [value]=\"vhAlgorithm.vhcurrencyunit(invoice.cash)\" class=\"customerPay border_bottom\"\r\n                        (keyup)=\"updateCash(cash.value)\" />\r\n                </div>\r\n                <div nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_cash')\">\r\n                    <div>{{'Change' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.cash - invoice.payment > 0 ? this.invoice.cash -\r\n                        invoice.payment : 0)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\" *ngIf=\"vhAuth.localStorageGET('show_note')\">\r\n                    <textarea class=\"nz-hover-border\" [(ngModel)]=\"note\" (blur)=\"edit_note()\" nz-input\r\n                        placeholder=\"{{'Enter note...' | translate}}\"\r\n                        [nzAutosize]=\"{ minRows: 2, maxRows: 4 }\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!invoice_detail.length\" (click)=\"payInvoice(40,true)\" nz-button\r\n                    class=\"order-and-print\">\r\n                    {{\"Complete & Print\"|translate}} (F2)\r\n                </button>\r\n                <button style=\"margin: auto;\" [disabled]=\"!invoice_detail.length\"\r\n                    (click)=\"payInvoice(40,false)\" nz-button class=\"order\">\r\n                    {{\"Complete\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n\r\n<!-- -----nz-drawer list-product-------- -->\r\n<!-- Search product -->\r\n<!-- <app-search-product [searchProductList]=\"searchProductList\" [barcode]=\"barcode\" (clearBarcode)=\"barcode = ''\" (closeSearchProductList)=\"closeSearchProductList($event)\" [default_price_type]=\"default_price_type\"> -->\r\n<!-- </app-search-product > -->\r\n<app-search-voucher [searchProductList]=\"searchProductList\" [barcode]=\"barcode\" (clearBarcode)=\"barcode = ''\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\" [id_product_delete]=\"id_product_delete\">\r\n</app-search-voucher>\r\n\r\n<!--Modal edit pay-->\r\n<nz-modal [(nzVisible)]=\"edit_pay\" [nzFooter]=\"modalFooterEditPay\" nzTitle=\"{{'Edit' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditPay()\" (nzOnOk)=\"handleEditPay()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Pay' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input [value]=\"vhAlgorithm.vhcurrencyunit(invoice.payment)\" class=\"edit-pay\" type=\"text\"\r\n                    maxlength=\"15\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditPay>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditPay()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditPay()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>"," \r\n    <nz-layout id=\"sales-invoice-today\" >\r\n        <div class=\"sales-invoice-today-header\" style=\"padding: 8px;  background: white;\" nz-row>\r\n            <div nz-col nzSpan=\"4\" class=\"title left-all-content\">\r\n                <b>{{'Voucher purchase order' | translate}}</b>\r\n            </div>\r\n            <div nz-col nzSpan=\"6\" class=\"right-all-content\">\r\n                <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                    <input [(ngModel)]=\"searchValue\" (ngModelChange)=\"searchBill($event)\" type=\"text\" nz-input placeholder=\"{{'Search for invoice code, customer name, payment, status,phone' | translate}}\" />\r\n                </nz-input-group>\r\n                <ng-template #suffixIconSearch>\r\n                    <i nz-icon nzType=\"search\"></i>\r\n                </ng-template>\r\n               \r\n            </div>\r\n            <div nz-col nzSpan=\"8\" class=\"right-all-content\" style=\"padding-right: 16px;\">\r\n                <nz-range-picker nzFormat='dd/MM/yyyy' [(ngModel)]=\"date\" (ngModelChange)=\"changeTime($event)\"></nz-range-picker>\r\n                <button class=\" btn-add\"   nz-button nzType=\"default\" (click)=\"getInvoiceToday()\">\r\n                    <ion-icon src=\"assets/icon/management/view.svg\"></ion-icon>\r\n                    {{'View' | translate}}\r\n                </button>\r\n            </div>\r\n            <div nz-col nzSpan=\"6\" >\r\n               <app-header-account-info></app-header-account-info>\r\n            </div>\r\n        </div>\r\n    \r\n        <div nz-row style=\"height: 100%; margin-top: 8px;\">\r\n            <div nz-col nzSpan=\"24\" style=\"padding: 0 160px;\">\r\n                <div nz-row *ngIf=\"!invoiceShow.length\" style=\"height: 100%;\">\r\n                    <div nz-col nzSpan=\"24\" class=\"center-all-content\">\r\n                        <p>{{'No invoice today' | translate}}</p>\r\n                    </div>\r\n                </div>\r\n                <div *ngIf=\"invoiceShow.length\" style=\"padding: 8px; background-color: white;height: 100%;border-radius: 5px;\">\r\n                    <div class='total-item'>{{'Total' |translate}}<span style=\"color:var(--ion-color-vh-red)\">\r\n                            {{invoiceShow.length}}\r\n                        </span>{{'invoices today' | translate}}\r\n                    </div>\r\n                    <nz-table [nzScroll]=\"{ y: tableHeight }\" [nzData]=\"invoiceShow\" #tableSales nzShowPagination [nzPageSize]=\"20\" [nzPageSizeOptions]=\"[20, 30, 40, 50, 100, 200]\" nzShowSizeChanger [nzNoResult]=\"noBill\" (nzCurrentPageDataChange)=\"onCurrentPageDataChange($event)\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th style=\"cursor: pointer;\" nzWidth=\"14%\" nzAlign='left' (click)=\"dateCol = !dateCol;sortTable('date')\">\r\n                                    <b>{{'Date' | translate}}</b>\r\n                                    <i nz-icon [nzType]=\"dateCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n                                </th>\r\n                                <th style=\"cursor: pointer;\" nzWidth=\"14%\" nzAlign='left' (click)=\"bill_codeCol = !bill_codeCol;sortTable('bill_code')\">\r\n                                    <b>{{'Invoice code' | translate}}</b>\r\n                                    <i nz-icon [nzType]=\"bill_codeCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n                                </th>\r\n                                <th style=\"cursor: pointer;\" nzWidth=\"14%\" nzAlign='left' (click)=\"partner_nameCol = !partner_nameCol;sortTable('partner_name')\">\r\n                                    <b>{{'Customer' | translate}}</b>\r\n                                    <i nz-icon [nzType]=\"partner_nameCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n                                </th>\r\n                                <th nzWidth=\"15%\" nzAlign='left'><b>{{'Note' | translate}}</b></th>\r\n                                <th style=\"cursor: pointer;\" nzWidth=\"15%\" nzAlign='right' (click)=\"sum_priceCol = !sum_priceCol;sortTable('sum_price')\">\r\n                                    <b>{{'Total' | translate}}</b>\r\n                                    <i nz-icon [nzType]=\"sum_priceCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n                                </th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr *ngFor=\"let invoice of tableSales.data\" style=\"cursor: pointer;\" (click)=\"goToDetail(invoice)\">\r\n                                <td nzAlign='left'>{{invoice.date | date: 'dd/MM/yyyy HH:mm'}}</td>\r\n                                <td nzAlign='left'>{{invoice.bill_code}} <i (click)=\"$event.stopPropagation();vhComponent.copyValue(invoice.bill_code)\" nz-icon nzType=\"copy\" nzTheme=\"outline\"></i></td>\r\n                                <td nzAlign='left'>{{(invoice.customer ? invoice.customer['name'] : 'Not found') | translate}} \r\n                                </td>\r\n                                \r\n                                <td nzAlign='left'>{{invoice.note}}</td> \r\n                                <td class=\"money-right\">\r\n                                    {{vhAlgorithm.vhcurrencyunit_symbol(invoice.total*(1+invoice.tax/100))}}</td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </nz-table>\r\n                    <ng-template #noBill>\r\n                        <div class=\"pos-content-empty\">\r\n                            <div>\r\n                                <div>\r\n                                    <ion-icon style=\"font-size: 230px;\" src=\"assets/icon/pos/undraw_add_to_cart_vkjp.svg\">\r\n                                    </ion-icon>\r\n                                </div>\r\n                                {{'No data' | translate}}\r\n                            </div>\r\n                        </div>\r\n                    </ng-template>\r\n    \r\n                </div>\r\n            </div> \r\n        </div>\r\n    </nz-layout>\r\n   \r\n    ","import { NzMessageService } from 'ng-zorro-antd/message';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { ChangeDetectorRef, Component, OnInit, HostListener } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhDisplayLEDService, VhQuery, VhQuerySales } from 'ionic-vhframeworks'; \r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport {  VhSaleInvoices } from 'src/app/sales/interface/vh-sale-invoice';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { FunctionService } from 'src/app/sales/services/function.service'; \r\nimport { Platform } from '@ionic/angular';\r\nimport { NzNotificationService } from 'ng-zorro-antd/notification';\r\n@Component({\r\n  selector: 'app-sales-order-voucher',\r\n  templateUrl: './sales-order-voucher.component.html',\r\n  styleUrls: ['./sales-order-voucher.component.scss']\r\n})\r\nexport class SalesOrderVoucherComponent implements OnInit {\r\n  useBranch: boolean = this.functionService.checkUsingBranch()\r\n  public searchValue: string = ''\r\n  public invoiceShow: any[] = []\r\n  public invoiceToday: any[];\r\n  tableHeight: string;\r\n  public date: Date[] = [new Date(), new Date()];\r\n\r\n  public invoiceInfo: any;\r\n  public invoice: VhSaleInvoices // bill được chọn để xem chi tiết\r\n\r\n  constructor(\r\n    private vhQuery: VhQuery,\r\n    private router: Router,\r\n    public vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    public vhComponent: VhComponent,\r\n    private languageService: LanguageService,\r\n    public vhAuth: VhAuth,\r\n    private cdRef: ChangeDetectorRef,\r\n    private functionService: FunctionService,\r\n    private notification: NzNotificationService,\r\n    private plaform: Platform,\r\n    private vhDisplayLEDService: VhDisplayLEDService,\r\n    private fncService: FunctionService\r\n  ) {\r\n    this.date[0].setHours(0, 0, 0, 0)\r\n    this.date[1].setHours(23, 59, 59, 59)\r\n    if(this.router.getCurrentNavigation().extras.state){\r\n      this.invoiceToday = this.router.getCurrentNavigation().extras.state.invoiceToday;\r\n      \r\n      this.invoiceShow =  this.invoiceToday \r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n\r\n  }\r\n\r\n\r\n  changeTime(event) {\r\n    if (new Date(event[1].setHours(0, 0, 0, 0)).getTime() - new Date(event[0].setHours(0, 0, 0, 0)).getTime() <= this.fncService.checkDateReport() * 86000000) {\r\n      //this.getTransferList();\r\n    } else {\r\n      this.vhComponent.showToast(4000, this.languageService.translate(\"The time limit to view is\") + \" \" + this.fncService.checkDateReport() + \" \" + this.languageService.translate(\"days\"), \"alert-toast\")\r\n      this.date = [new Date(event[0]), new Date(event[0].getTime() + this.fncService.checkDateReport() * 86000000)]\r\n    }\r\n  }\r\n\r\n\r\n  getInvoiceToday() {\r\n    this.vhComponent.showLoading('').then(() => {\r\n      this.vhQuerySales.getBills_byFields( { date: { $gte: new Date(this.date[0].setHours(0, 0, 0)), $lte: new Date(this.date[1].setHours(23, 59, 59, 59)) }, bill_type: { $in: [42] }, id_branch: { $eq: this.vhQuerySales.getDefaultBranch()._id } }, {})\r\n        .then((invoice: any[]) => {\r\n          \r\n          let promise = new Array();\r\n          for (let i = 0; i < invoice.length; i++) {\r\n            promise[i] = this.vhQuerySales.getCustomer(invoice[i].id_customer)\r\n          }\r\n          this.vhQuery.asyncPromiseAll(promise).then((array) => {\r\n            this.invoiceToday = invoice.map((item,index) => { \r\n              return { ...item, customer: array[index],  sum_price: item.total * (1 + item.tax / 100),   }\r\n            })\r\n            this.searchBill(this.searchValue)\r\n          }, error => {  })\r\n          this.vhComponent.hideLoading(0);\r\n\r\n        })\r\n    })\r\n  }\r\n  searchBill(value: string) {\r\n    if (value.length) {\r\n      let val: string = this.vhAlgorithm.changeAlias(value.trim().toLowerCase())\r\n      this.invoiceShow = this.vhAlgorithm.searchList(val, this.invoiceToday, ['bill_code', 'partner_name', 'employee_name', 'payment_name', 'status', 'phone'])\r\n    } else this.invoiceShow = [...this.invoiceToday]\r\n    \r\n\r\n  }\r\n  /* -----Pagination----- */\r\n  onCurrentPageDataChange(value) {\r\n  }\r\n\r\n  goToDetail(bill) {\r\n    \r\n    \r\n    if (this.vhAuth.checkMyPermission(\"sales_enable_view_bill_today\")) {\r\n      this.router.navigate([\"/bill-web-app/sales-order-voucher/add\"], { state: { bill: bill, invoiceToday :  this.invoiceToday , customer : bill.customer} })\r\n    }\r\n    else this.vhComponent.showToast(1500, this.languageService.translate('You do not have this rights'), \"alert-toast\")\r\n  } \r\n  public renderAddress(partner) {\r\n    return (partner.address ? partner.address : '') +\r\n      (partner.district ? ', ' + partner.district : '') +\r\n      (partner.province ? ', ' + partner.province : '') +\r\n      (partner.country ? ', ' + partner.country : '')\r\n  }\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\"#sales-invoice-today\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".sales-invoice-today-header\") && document.querySelector(\".ant-table-pagination\")) {\r\n      this.tableHeight = document.querySelector(\"#sales-invoice-today\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".sales-invoice-today-header\").clientHeight - 110 + \"px\";\r\n    }\r\n    this.cdRef.detectChanges();\r\n  } \r\n\r\n  deleteBill() {\r\n    let bill: any = { ...this.invoice }\r\n    this.invoiceShow = this.invoiceShow.filter(item => item._id != bill._id)\r\n  }\r\n\r\n\r\n  /** hàm sort cho các cột */\r\n  dateCol = false;\r\n  bill_codeCol = false;\r\n  partner_nameCol = false;\r\n  payment_nameCol = false;\r\n  name_employeeCol = false;\r\n  sum_priceCol = false;\r\n  /** Hàm thực hiện sắp xếp theo collection\r\n   *\r\n   * @param colName       // tên cột muôn sắp xếp\r\n   */\r\n  sortTable(colName) {\r\n    switch (colName) {\r\n      case 'date':\r\n        if (this.dateCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortDatebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortDatebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n      case 'bill_code':\r\n        if (this.bill_codeCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n      case 'partner_name':\r\n        if (this.partner_nameCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n      case 'payment_name':\r\n        if (this.payment_nameCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n\r\n      case 'sum_price':\r\n        if (this.sum_priceCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortNumberbyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortNumberbyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { SalesOrderVoucherComponent } from './sales-order-voucher.component';\r\nimport { CreateBillComponent } from './create-bill/create-bill.component';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { TranslateModule } from '@ngx-translate/core'; \r\nimport { IonicModule } from '@ionic/angular';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { NgZorroAntModule } from 'src/app/ng-zorro-ant.module';\r\nimport { HeaderAccountInfoModule } from '../header-account-info/header-account-info.module'; \r\n \r\nimport { ScrollingModule } from '@angular/cdk/scrolling';\r\nimport { ComponentModule } from 'src/app/sales/sales-voucher/component/component.module';\r\nimport { ComponentsModule } from 'src/app/sales/sale-desktop/components/components.module';\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: SalesOrderVoucherComponent,\r\n  }, \r\n  {\r\n    path: 'add',\r\n    component: CreateBillComponent,\r\n  }\r\n]\r\n\r\n@NgModule({\r\n  declarations: [SalesOrderVoucherComponent,CreateBillComponent, ],\r\n  imports: [\r\n    CommonModule,\r\n    RouterModule.forChild(routes),\r\n    NgZorroAntModule, \r\n    TranslateModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    IonicModule,\r\n    HeaderAccountInfoModule,\r\n    ComponentModule,\r\n    ComponentsModule,\r\n    ScrollingModule\r\n  ]\r\n})\r\nexport class SalesOrderVoucherModule { }\r\n"],"names":["i0","$event","ctx_r11","ctx_r14","ctx_r15","ctx_r16","ctx_r17","ctx_r3","_r6","SalesOrderVoucherComponent","constructor","vhQuery","router","vhQuerySales","vhAlgorithm","vhComponent","languageService","vhAuth","cdRef","functionService","notification","plaform","vhDisplayLEDService","fncService","checkUsingBranch","Date","date","setHours","getCurrentNavigation","extras","state","invoiceToday","invoiceShow","ngOnInit","changeTime","event","getTime","checkDateReport","showToast","translate","getInvoiceToday","showLoading","then","getBills_byFields","$gte","$lte","bill_type","$in","id_branch","$eq","getDefaultBranch","_id","invoice","promise","Array","i","length","getCustomer","id_customer","asyncPromiseAll","array","map","item","index","customer","sum_price","total","tax","searchBill","searchValue","error","hideLoading","value","val","changeAlias","trim","toLowerCase","searchList","onCurrentPageDataChange","goToDetail","bill","checkMyPermission","navigate","renderAddress","partner","address","district","province","country","ngAfterViewChecked","document","querySelector","tableHeight","clientHeight","detectChanges","deleteBill","filter","sortTable","colName","dateCol","sortDatebyASC","sortDatebyDESC","bill_codeCol","sortVietnamesebyASC","sortVietnamesebyDESC","partner_nameCol","payment_nameCol","sum_priceCol","sortNumberbyASC","sortNumberbyDESC","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"webpack:///"}