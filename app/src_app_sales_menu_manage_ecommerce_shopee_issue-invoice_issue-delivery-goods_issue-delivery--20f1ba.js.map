{"version":3,"file":"src_app_sales_menu_manage_ecommerce_shopee_issue-invoice_issue-delivery-goods_issue-delivery--20f1ba.js","mappings":"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","sources":["./src/app/sales/components/bill-type/bill-type-1/shopee/add/add.component.ts","./src/app/sales/components/bill-type/bill-type-1/shopee/add/add.component.html","./src/app/sales/components/bill-type/bill-type-1/shopee/bill-type1-shopee.module.ts","./src/app/sales/components/bill-type/bill-type-1/shopee/detail/detail.component.ts","./src/app/sales/components/bill-type/bill-type-1/shopee/detail/detail.component.html","./src/app/sales/components/bill-type/bill-type-1/shopee/edit/edit.component.ts","./src/app/sales/components/bill-type/bill-type-1/shopee/edit/edit.component.html","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/add/add.component.ts","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/add/add.component.html","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/detailShopee/detail.component.html","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/detailShopee/detail.component.ts","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/detail/detail.component.ts","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/detail/detail.component.html","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/edit/edit.component.ts","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/edit/edit.component.html","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/issue-delivery-goods.component.ts","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/issue-delivery-goods.component.html","./src/app/sales/menu/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/issue-delivery-goods.module.ts"],"sourcesContent":["import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhEcommerce, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { Observable } from 'rxjs';\r\nimport { SalesK57Col3Component } from 'src/app/sales/components/print/sales/sales-k57-col3/sales-k57-col3.component';\r\nimport { SalesK80Col3Component } from 'src/app/sales/components/print/sales/sales-k80-col3/sales-k80-col3.component';\r\nimport { SalesK80Col4Component } from 'src/app/sales/components/print/sales/sales-k80-col4/sales-k80-col4.component';\r\nimport { SalesA5Component } from 'src/app/sales/components/print/sales/sales-a5/sales-a5.component';\r\nimport { SalesA4Component } from 'src/app/sales/components/print/sales/sales-a4/sales-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhSaleShopeeInvoiceAdd, VhSaleShopeeInvoiceDetail, VhSaleShopeeInvoiceDetailCombo } from '../shopee-interface';\r\nimport { VhType } from 'src/app/sales/interface/vh-type';\r\n\r\n@Component({\r\n  selector: 'bill-type1-shopee-add',\r\n  templateUrl: './add.component.html',\r\n  styleUrls: ['./add.component.scss']\r\n})\r\nexport class AddComponent implements OnInit {\r\n  invoice: VhSaleShopeeInvoiceAdd = {\r\n    bill_type: 1,\r\n    cqt_status: 1,\r\n    payment_type: 2,\r\n    id_customer: '',\r\n    id_branch: '',\r\n    id_employee: '',\r\n    id_wallet: 'id_cash',\r\n    date: '',\r\n    total: 0,\r\n    payment: 0,\r\n    tax: 0,\r\n    discount: 0,\r\n    fee: 0,\r\n    note: '',\r\n    price_type: 0,\r\n    order_number_ecommerce: '',\r\n    ecommerce_fee_paid_by_seller: 0,\r\n    id_shop: '',\r\n    tax_buyerDisplayName: '',\r\n    tax_buyerLegalName: '',\r\n    tax_buyerTaxCode: '',\r\n    tax_buyerAddressLine: '',\r\n    tax_buyerEmail: ''\r\n  };\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore; //nhớ dữ liệu truyền từ trang trước\r\n  billShopee: any = this.router.getCurrentNavigation().extras.state.billShopee;\r\n  employee: any = {};\r\n  customer: any = {};\r\n  pickerTime = new Date();\r\n  checkPrinter: boolean = false;\r\n  closerBrower: any;\r\n  validProdDetail: boolean = true;//nếu biến này = false tức có sp shopee chưa được liên kết với app\r\n  id_branch: string = this.vhQuerySales.getDefaultBranch()._id;\r\n  invoiceDetail = [];\r\n  subTotal = 0;\r\n  taxValue = 0;\r\n  isOpenModalTaxCustomer = false;\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private languageService: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhAuth: VhAuth,\r\n    private fncService: FunctionService,\r\n    private nzModalService: NzModalService,\r\n    private cdf: ChangeDetectorRef,\r\n    private vhEcommerce: VhEcommerce\r\n  ) {\r\n\r\n  }\r\n  /**Khởi tạo hóa đơn và merge sp của shopee vào billDetail */\r\n  async initBill() {\r\n    let infoShop = this.vhEcommerce.getlocalShopListShopee().find(item => item._id == this.dataRestore.id_shop_selected);\r\n    const escrowShopee: any = await this.vhEcommerce.getEscrowShopee(this.billShopee.order_sn, infoShop.access_token, this.dataRestore['id_shop_selected']);\r\n    this.invoice.date = this.pickerTime.toISOString();\r\n    this.invoice.id_employee = this.vhAuth.getUser()._id;\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    this.invoice.id_branch = (this.vhQuerySales.getDefaultBranch()._id);\r\n    this.invoice.id_customer = (this.vhEcommerce.getlocalShopListShopee().find(item => item._id == this.dataRestore.id_shop_selected).data.id_customer);\r\n    this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n    this.invoice.payment_type = (2); //set bill công nợ\r\n    this.addInvoiceDetail(this.billShopee.item_list);\r\n    this.setSubTotal();\r\n\r\n    this.invoice.discount = escrowShopee.order_income.voucher_from_seller || 0;\r\n    this.invoice.fee = escrowShopee.order_income.actual_shipping_fee - escrowShopee.order_income.shopee_shipping_rebate;\r\n    this.invoice.ecommerce_fee_paid_by_seller = escrowShopee.order_income.seller_transaction_fee + escrowShopee.order_income.shipping_seller_protection_fee_amount + escrowShopee.order_income.commission_fee;\r\n    this.invoice.order_number_ecommerce = (this.billShopee['order_sn'].toString());\r\n    this.invoice.id_shop = (this.dataRestore['id_shop_selected']);\r\n    this.invoice.note = (`${this.languageService.translate(\"Order number\")} Shopee ${this.billShopee.order_sn}`);\r\n    this.invoice.tax_buyerDisplayName = this.invoice.tax_buyerDisplayName ? this.invoice.tax_buyerDisplayName : 'Người mua không lấy hóa đơn';\r\n    this.invoice.cqt_status = this.billShopee.cqt_status ? this.billShopee.cqt_status : 1;\r\n    for (let item of this.invoiceDetail) {\r\n      if (!item.id_product) {\r\n        this.validProdDetail = false;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * tính và gán lại cộng tiền (subTotal) của đơn\r\n   * @example this.setSubTotal()\r\n   */\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      subTotal += (i.price ? i.price * i.quantity : 0);\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal();\r\n  }\r\n\r\n  /**\r\n   * tính và gán lại tổng tiền (total) của đơn\r\n   * @example this.setTotal()\r\n   */\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee > 0 ? this.subTotal - this.invoice.discount + this.invoice.fee : 0;\r\n    this.cdf.detectChanges();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n\r\n    this.initBill();\r\n    this.eventKeypress();\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales');\r\n    if (printer) this.checkPrinter = printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.discount_price = this.vhAlgorithm.vhnumeral(\".discount-price\");\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral(\".invoice-fee\");\r\n    });\r\n  }\r\n  event: any; // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n    window.removeEventListener('beforeunload', this.closerBrower, false);\r\n  }\r\n  /**\r\n   * lắng nghe sk nhấn f1 f2 f3 f4 trên bàn phím\r\n   * @example\r\n   */\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113) event.preventDefault();\r\n      switch (keycode) {\r\n        case 112: this.payInvoice(false);\r\n          break;\r\n        case 113: {\r\n          if (this.checkPrinter) this.payInvoice(true);\r\n          break;\r\n        }\r\n        case 114: {\r\n          this.searchProductList = !this.searchProductList;\r\n          break;\r\n        }\r\n      }\r\n    };\r\n    //sự kiện f5, close tab...\r\n    this.closerBrower = (event: BeforeUnloadEvent) => {\r\n      (event || window.event).returnValue = 'Changes you made may not be saved';\r\n      return 'Changes you made may not be saved';\r\n    };\r\n    window.addEventListener('beforeunload', this.closerBrower);\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  /**\r\n   * trở về trang phát hành hóa đơn lazada\r\n   * @example this.goBack()\r\n   */\r\n  goBack() {\r\n    this.vhComponent.alertConfirm(`${this.languageService.translate(\"Confirm\")}`, \"\", `${this.languageService.translate(\"Bạn muốn thoát và không lưu đơn này\")}?`, \"OK\", this.languageService.translate('Cancel'))\r\n      .then(() => { this.isExit = true; this.router.navigate([\"/sales/dashboard/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods\"], { state: { dataRestore: this.dataRestore } }); }, () => { });\r\n  }\r\n  // -------set employee-------\r\n  /**\r\n   * nhận sk ouput từ component app-staff bắt sk thay đổi nv\r\n   * @param event : id_employee thay đổi\r\n   * @example this.closeAndReceiveEmployee('DNHWIUYGBDGUIWQYGD&W')\r\n   */\r\n  closeAndReceiveEmployee(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n    }\r\n  }\r\n  /**\r\n   * bắt sk thay đổi date của hóa đơn , gán lại giá trị date mới cho đơn\r\n   * @example this.setPickerTime('2023-06-12T08:02:27.697Z')\r\n   */\r\n  setPickerTime(event) {\r\n    if (event.getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 8000);\r\n      this.pickerTime = new Date(this.invoice.date);\r\n      this.invoice.date = (this.pickerTime.toISOString());\r\n    }\r\n    else\r\n      this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n\r\n        if (validitydate == null) this.invoice.date = (event);\r\n        else {\r\n          this.pickerTime = new Date(this.invoice.date);\r\n          this.invoice.date = (this.pickerTime.toISOString());\r\n          this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 8000);\r\n        }\r\n      });\r\n  }\r\n  discount_price: any;\r\n  /**\r\n   * bắt sk thay đổi giảm giá của hóa đơn , gán lại giá trị giảm giá mới cho đơn\r\n   * @example this.editDiscount()\r\n   */\r\n  editDiscount() {\r\n    if (this.discount_price.getRawValue() && this.discount_price.getRawValue() >= 0) {\r\n      this.invoice.discount = (parseFloat(this.discount_price.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"discount-price\")['value'] = this.invoice.discount;\r\n      this.discount_price = this.vhAlgorithm.vhnumeral('.discount-price');\r\n    }\r\n    this.setTotal();\r\n  }\r\n  invoice_fee: any;\r\n  /**\r\n   * bắt sk thay đổi phí của hóa đơn , gán lại giá trị phí mới cho đơn\r\n   * @example this.editFee()\r\n   */\r\n  editFee() {\r\n    if (this.invoice_fee.getRawValue() && this.invoice_fee.getRawValue() >= 0) {\r\n      this.invoice.fee = (parseFloat(this.invoice_fee.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"invoice-fee\")['value'] = this.invoice.fee;\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral('.invoice-fee');\r\n    }\r\n    this.setTotal();\r\n  }\r\n\r\n  /**\r\n   * so sánh subtotal trước khi tạo bill để chắc chắn có thay đổ bill_detail thì vẫn đúng số liệu\r\n   * @returns boolean\r\n   * @example let bool = this.compareSubTotal()\r\n   */\r\n  compareSubTotal() {\r\n    let sub = this.invoiceDetail.reduce((prev: number, next) => prev + next.quantity * next.price, 0);\r\n    if (sub == this.subTotal) return true;\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * trả về danh sách bill_detail đã format theo đúng chuẩn các trường để lưu DB\r\n   * @returns array bill_detail\r\n   * @example let bill_details = getCreateUpdateInvoiceDetail()\r\n   */\r\n  getCreateUpdateInvoiceDetail(): VhSaleShopeeInvoiceDetail[] {\r\n    return this.invoiceDetail.map(item => {\r\n\r\n      let detail: VhSaleShopeeInvoiceDetail = {\r\n        id_product: item.id_product,\r\n        ptype: item.ptype,\r\n        price: item.price,\r\n        quantity: item.quantity,\r\n        ratio: item.ratio,\r\n        price_origin: item.price_origin,\r\n      };\r\n      if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct;\r\n      if (item.id_subproduct) detail['id_subproduct'] = item.id_subproduct;\r\n\r\n      if (item.ptype == 5) {\r\n        detail['combos'] = item.combos.map(combo => {\r\n          let product: VhSaleShopeeInvoiceDetailCombo = {\r\n            id_product: combo.id_product,\r\n            price: combo.price,\r\n            quantity: combo.quantity,\r\n            ptype: combo.ptype || combo.type,\r\n            ratio: combo.ratio ? combo.ratio : 1,\r\n          };\r\n          if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct;\r\n          if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct;\r\n          return product;\r\n        });\r\n      }\r\n      return detail;\r\n\r\n    }).filter(item => item);\r\n\r\n  }\r\n  save_enable = true;\r\n  /**\r\n   * bắt sk nhấn nút thanh toán hóa đơn\r\n   * @param print biến check in hay ko\r\n   * @example this.payInvoice('print')\r\n   */\r\n  payInvoice(print?) {\r\n    // if (this.vhAuth.checkMyPermission(\"sales_enable_payment\")) {\r\n    if (this.compareSubTotal()) {\r\n      this.vhComponent.alertConfirm(\r\n        !print ? `${this.languageService.translate(\"Pay\")}?` : `${this.languageService.translate(\"Pay & Print\")}?`,\r\n        \"\", \"\", \"OK\", this.languageService.translate(\"Cancel\")\r\n      )\r\n        .then(() => {\r\n          if (this.save_enable) {\r\n            this.save_enable = false;\r\n            this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n              this.createOrUpdate(1).then((bill: any) => {\r\n                this.save_enable = true;\r\n\r\n                if (this.invoice.cqt_status !== 1) {\r\n                  this.vhQuerySales.updateBill(bill._id, { cqt_status: this.invoice.cqt_status });\r\n                }\r\n\r\n                let update = async () => await\r\n                  this.vhEcommerce.updateSalesOrderShopee(this.dataRestore['id_shop_selected'], this.billShopee['order_sn'].toString(), { id_bill_delivered_goods: bill._id });\r\n                update();\r\n\r\n                this.vhComponent.hideLoading(0).then(() => {\r\n                  this.vhComponent.showToast(2000,\r\n                    `${this.languageService.translate(\"Issue invoice\")} ${this.languageService.translate(\"Successfully\").toLocaleLowerCase()}`, \"success-toast\"\r\n                  );\r\n                  if (print) this.handlePrint();\r\n                  else this.handle(true);\r\n                });\r\n              }).catch(err => { this.vhComponent.hideLoading(0); this.vhComponent.showToast(2000, err); });\r\n            });\r\n          }\r\n        }, () => { });\r\n    } else this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"The total price of the product is not equal to the subtotal\"));\r\n\r\n    // }\r\n    // else this.vhComponent.showToast(1500, this.languageService.translate('You do not have this rights'), \"alert-toast\")\r\n  }\r\n\r\n  /**\r\n   * tạo bill lên DB\r\n   * @returns Promise<any>\r\n   * @example  this.createOrUpdate()\r\n   * .then((bill: any) => {\r\n   *\r\n   * })\r\n   */\r\n  createOrUpdate(bill_type: 1) {\r\n    return new Promise((resolve, reject) => {\r\n      this.vhQuerySales.createBill_Billdetail({ ...this.invoice }, this.getCreateUpdateInvoiceDetail()).then(res => resolve(res)).catch(err => reject(err));\r\n    });\r\n  }\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales');\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)]);\r\n      else rejects(\"No\");\r\n    });\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return SalesK57Col3Component;\r\n      case 'print_size_k80_3c': return SalesK80Col3Component;\r\n      case 'print_size_k80_4c': return SalesK80Col4Component;\r\n      case 'print_size_a5': return SalesA5Component;\r\n      case 'print_size_a4': return SalesA4Component;\r\n      default: return SalesA4Component;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * trờ về trang phát hành hóa đơn sau khi đã thanh toán xong\r\n   * @example this.handle(true)\r\n   */\r\n  handle(update?: boolean) {\r\n    this.isExit = true;\r\n    if (update) this.dataRestore['update'] = true;\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods'], { state: { dataRestore: this.dataRestore } });\r\n  }\r\n  /**\r\n   * kiểm tra dữ liệu thông tin máy in và mở component in\r\n   * @example this.handlePrint()\r\n   */\r\n  handlePrint() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice: this.invoice, invoice_detail: this.invoiceDetail }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.handle(true));\r\n        });\r\n    }, (err) => this.handle(true));\r\n  }\r\n  // ------thoát trang-----\r\n  isExit: boolean = false;\r\n  checkDeactivate(currentRoute: ActivatedRouteSnapshot, currentState: RouterStateSnapshot, nextState?: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    return nextState.url == '/login' ? true : (this.isExit ? this.isExit : this.vhComponent.alertConfirm(this.languageService.translate(\"Confirm\"), \"\", this.languageService.translate(\"Are you sure to cancel the sales order\"), \"OK\", (this.languageService.translate(\"Cancel\"))).then(() => { return true; }).catch(() => { return false; }));\r\n  }\r\n  /**Phần thêm sản phẩm bổ sung\r\n   * Note : không tính tiền sản phẩm này\r\n   */\r\n  searchProductList: boolean = false;\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      if (data.manylot && !data.id_lotproduct) this.openModalChooseLot(data);\r\n      else\r\n        if (data.combos && data.combos.filter(e => e.lots && !e.id_lotproduct).length) {\r\n          this.tempDetail = data;\r\n          this.show_modal_select_lots_combo = true;\r\n        }\r\n        else\r\n          this.addInvoiceDetailExtraEcommerce(data);\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n\r\n  /**\r\n   * thêm sp vô mảng invoice_detail\r\n   * @param value\r\n   * @example  this.addInvoiceDetailExtraEcommerce(data_product);\r\n   */\r\n  addInvoiceDetailExtraEcommerce(value: any) {\r\n\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == value['_id'] && detail['free']);\r\n    if (index != -1) {\r\n      if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1;\r\n    } else {\r\n      let detail: any = {\r\n        name: value.name,\r\n        id_product: value._id,\r\n        quantity: 1,\r\n        ptype: value.type,\r\n        unit: value.unit,\r\n        units: value.units,\r\n        ratio: value.ratio,\r\n        price: 0,\r\n        price_origin: value.price,\r\n        id_category: value.id_category,\r\n        free: true, //nếu có trường này thì được quyền chỉnh số lượng\r\n        id_subproduct: value.id_subproduct,\r\n        lots: value.lots,\r\n        id_lotproduct: value.id_lotproduct,\r\n      };\r\n\r\n      if (value.type == 5) {\r\n        detail['subComboName'] = value.subComboName;\r\n        detail['combos'] = [...value.combos.map(item => {\r\n          let product: any = {\r\n            id_product: item.id_product, name: item.name, ptype: item.type,\r\n            price: 0, quantity: item.quantity, id_subproduct: item.id_subproduct,\r\n            lots: item.lots,\r\n            id_lotproduct: item.id_lotproduct, units: item.units, ratio: item.ratio,\r\n            free: true//nếu có trường này thì được quyền chỉnh số lượng\r\n          };\r\n          return product;\r\n        })];\r\n      }\r\n\r\n      this.invoiceDetail.unshift(detail);\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi quantity của bill_detail\r\n   * @param product bill-detail được chọn\r\n   * @param event số lượng thay đổi\r\n   * @example this.checkQuantityProduct(product, 1)\r\n   */\r\n  checkQuantityProduct(product: VhSaleShopeeInvoiceDetail, event) {\r\n    const MIN_PRICE = 1;\r\n\r\n    const oldQuantity = product.quantity;\r\n    const oldPrice = product.price;\r\n    const originalTotal = oldQuantity * oldPrice;\r\n\r\n    const newQuantity = event || 1;\r\n    const newPrice = originalTotal / newQuantity;\r\n\r\n    if (newPrice < MIN_PRICE) {\r\n      return;\r\n    }\r\n\r\n    product.quantity = newQuantity;\r\n    product.price = newPrice;\r\n\r\n    this.setSubTotal();\r\n    this.cdf.detectChanges();\r\n  }\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhSaleShopeeInvoiceDetail;\r\n  /**\r\n  * mở modal chỉnh sửa giá bán của bill_detail\r\n  * @param detail\r\n  * @example this.openEditUnitPrice(bill_detail)\r\n  */\r\n  openEditUnitPrice(detail: VhSaleShopeeInvoiceDetail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút ok của modal chỉnh sửa giá bán\r\n   * @example this.handleEditUnit()\r\n   */\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      this.isVisibleEditUnitPrice = false;\r\n      this.setSubTotal();\r\n    } else { this.vhComponent.showToast(2000, this.languageService.translate(\"Invalid data, please check again\"), \"alert-toast\"); }\r\n  }\r\n  /**\r\n   * bắt sk nhấn nút xóa bill-detail\r\n   * @param detail\r\n   * @example this.deleteGoods(bill-detail)\r\n   */\r\n  deleteGoods(detail: VhSaleShopeeInvoiceDetail) {\r\n    this.vhComponent.alertConfirm(\"\", \"\", `${this.languageService.translate(\"Delete\")} ${detail.name}?`, \"OK\", this.languageService.translate(\"Cancel\"))\r\n      .then(() => this.removeInvoiceDetail(detail.id_product), () => { });\r\n  }\r\n\r\n  /**\r\n   * xóa bill-detail trong mảng local invoice_detail\r\n   * @param id\r\n   * @example this.removeInvoiceDetail(bill_detail.id_product)\r\n   */\r\n  removeInvoiceDetail(id: string) {\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == id);\r\n    if (index != -1) {\r\n      this.invoiceDetail.splice(index, 1);\r\n      this.setSubTotal();\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Thêm sản phẩm đã bán vào cart\r\n   * Sản phẩm này là sp đã bán trên sàn\r\n  */\r\n  addInvoiceDetail(item_list: Array<any>) {\r\n    let products: Array<any> = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden).filter(item => item[this.id_branch] && item[this.id_branch].shopees && item[this.id_branch].shopees.length >= 0);\r\n    for (let item of item_list) {\r\n      let findSuccess: boolean = false;\r\n      for (let productOfBranch of products) {\r\n        let findProduct = productOfBranch[this.id_branch].shopees.find(data => data.item_id == item.item_id);\r\n        if (findProduct) {\r\n\r\n          if (findProduct.model && findProduct.model.length && item.model_id != 0) {\r\n            let indexModel = findProduct.model.findIndex(model => model.model_id == item.model_id);\r\n            if (indexModel >= 0) {\r\n              this.addInvoiceDetailShopee(item.model_discounted_price, item.model_original_price, item.model_quantity_purchased, productOfBranch, true);\r\n              findSuccess = true;\r\n              break;\r\n            }\r\n          } else {\r\n            this.addInvoiceDetailShopee(item.model_discounted_price, item.model_original_price, item.model_quantity_purchased, productOfBranch, true);\r\n            findSuccess = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      if (!findSuccess) {\r\n        this.addInvoiceDetailShopee(item.model_discounted_price, item.model_original_price, item.model_quantity_purchased, { name: item.item_name }, false);\r\n        this.validProdDetail = false;\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   *\r\n   * @param price\r\n   * @param product\r\n   * @param exist\r\n   * @example addInvoiceDetailShopee(price_on_shopee, product, false)\r\n   */\r\n  addInvoiceDetailShopee(price, price_origin, quantity, product, exist) {\r\n    if (exist) {\r\n      const productToAdd = {\r\n        name: product.name,\r\n        id_product: product._id,\r\n        quantity: quantity,\r\n        ptype: product.type,\r\n        unit: product.unit,\r\n        ratio: 1,\r\n        units: product.units,\r\n        price: price,\r\n        price_origin: price_origin,\r\n        id_subproduct: product.id_subproduct,\r\n        lots: product.lots,\r\n        id_lotproduct: product.id_lotproduct,\r\n        free: false, //nếu có trường này true thì được quyền chỉnh số lượng\r\n      }\r\n      if(product.type == VhType.COMBO) {\r\n        productToAdd['combos'] = product.combos;\r\n      }\r\n      this.invoiceDetail.unshift(productToAdd);\r\n    } else {\r\n      this.invoiceDetail.unshift({\r\n        id_product: null,\r\n        quantity: quantity,\r\n        price: price,\r\n        ptype: 1,\r\n        ratio: 1,\r\n        name: product.name\r\n      });\r\n    }\r\n  }\r\n\r\n  warning_lot_expried: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').warning_lot_expried;\r\n  /**\r\n * trả về tên unit của sp\r\n * @param units mảng units của sp\r\n * @param ratio ratio được chọn\r\n * @returns string\r\n * @example let unit_name = this.getUnit([], 1)\r\n */\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit;\r\n  }\r\n\r\n  show_modal_select_lots = false;\r\n  list_search_lot = [];\r\n\r\n  /**\r\n   * trả về số lô của sp\r\n   * @param lots mảng lots của sp\r\n   * @param _id id của lô đã chọn\r\n   * @returns string\r\n   * @example let lot_name = this.getLotNumber([], 'SQOIUGDHBUWYGBDUEYTFTQ')\r\n   */\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id);\r\n    return lot.lot_number;\r\n  }\r\n  /**\r\n   * tìm kiếm lô theo tên lô\r\n   * @param value\r\n   * @example this.searchLot('')\r\n   */\r\n  searchLot(value) {\r\n    this.tempDetail.lots = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.list_search_lot, ['lot_number']);\r\n  }\r\n  /**\r\n   * mở modal chọn lô sp\r\n   * @param data bill-detail được chọn\r\n   * @example this.openModalChooseLot(data)\r\n   */\r\n  openModalChooseLot(data) {\r\n    this.tempDetail = data;\r\n    this.list_search_lot = this.tempDetail.lots;\r\n    if (!this.list_search_lot.length) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Sản phẩm này không có lô khả dụng để bán!\"));\r\n    else this.show_modal_select_lots = true;\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi id_lotnumber của bill-detail\r\n   * @param e id_lotnumber thay đổi\r\n   * @example this.changeLot('DNIUHWIDCHBIQOHSDOIHW')\r\n   */\r\n  changeLot(e) {\r\n    this.tempDetail.lot_number = this.tempDetail.lots.find(item => item._id == e).lot_number;\r\n  }\r\n\r\n\r\n  /**\r\n   * bắt sk nhấn nút ok của modal chọn lô sp\r\n   * @example this.handleChooseLot()\r\n   */\r\n  handleChooseLot() {\r\n    if (this.warning_lot_expried) {\r\n      let lot_select = this.list_search_lot.find(e => e._id == this.tempDetail.id_lotproduct);\r\n      if (new Date().getTime() >= new Date(lot_select.date_exp).getTime()) {\r\n        this.nzModalService.confirm({\r\n          nzTitle: this.languageService.translate(\"Lô này đã hết hạn! Tiếp tục bán sản phẩm này?\"),\r\n          nzOnOk: () => {\r\n            this.show_modal_select_lots = false;\r\n            this.tempDetail.lots = this.list_search_lot;\r\n            if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n          },\r\n          nzOnCancel: () => {\r\n            // this.show_modal_select_lots = false;\r\n            // this.tempDetail.lots = this.list_search_lot;\r\n          }\r\n\r\n        });\r\n      }\r\n      else {\r\n        this.show_modal_select_lots = false;\r\n        this.tempDetail.lots = this.list_search_lot;\r\n        if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n      }\r\n    }\r\n    else {\r\n      this.show_modal_select_lots = false;\r\n      this.tempDetail.lots = this.list_search_lot;\r\n      if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút hủy modal chọn lô sp\r\n   * @example this.handleCancelChooseLot()\r\n   */\r\n  handleCancelChooseLot() {\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot;\r\n  }\r\n\r\n  show_modal_select_lots_combo = false;\r\n  /** bắt sk nhấn nút ok modal chọn lô sp là combo\r\n   * @example this.handleChooseLotCombo()\r\n   */\r\n  handleChooseLotCombo() {\r\n    if (this.tempDetail.combos.filter(item => item.lots && !item.id_lotproduct).length)\r\n      this.vhComponent.alertMessageDesktop(\"warning\", this.languageService.translate(\"Vui lòng chọn lô cho sản phẩm thuộc combo này\"));\r\n    else {\r\n      this.show_modal_select_lots_combo = false;\r\n      this.closeSearchProductList(this.tempDetail);\r\n    }\r\n  }\r\n\r\n  onClose(event) {\r\n    this.isOpenModalTaxCustomer = false;\r\n  }\r\n\r\n  /**\r\n   * Khi ok trong modal chỉnh sửa customer tax\r\n   * @param customerTaxInfo\r\n   */\r\n  onOkEditTax(customerTaxInfo) {\r\n    this.isOpenModalTaxCustomer = false;\r\n    Object.assign(this.invoice, customerTaxInfo);\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n\r\n<nz-layout>\r\n    <div class=\"sales hide-best-selling\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{\"Order number\" | translate}}: <a target=\"_blank\"\r\n                        href=\"https://banhang.shopee.vn/portal/sale/order?search={{billShopee.order_sn}}\">{{billShopee.order_sn}}</a></b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n                    <div>\r\n                        <button style=\"width: 97%;\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                            (click)=\"searchProductList =true\">\r\n                            <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                            {{'Search (F4)' | translate}}</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\" *ngFor=\"let item of invoiceDetail\">\r\n                    <div nz-row>\r\n                        <div (click)=\"deleteGoods(item)\" nz-col nzSpan=\"1\">\r\n                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"8\">\r\n                            <p class=\"invoiceDetail-item-name\">\r\n                                <span class=\"invoiceDetail-item-name-linked\"\r\n                                    *ngIf=\"item.id_product\">{{item.name}}</span>\r\n                                    <ng-container *ngIf=\"item.lots\">\r\n                                        <span *ngIf=\"item.id_lotproduct\" style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(item)\">{{getLotNumber(item.lots, item.id_lotproduct)}}</span>\r\n                                            <span *ngIf=\"!item.id_lotproduct\" style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(item)\">{{'Select lot' | translate}}</span>\r\n                                    </ng-container>\r\n                                    <span *ngFor=\"let combo of item.combos;index as i\"\r\n                                    style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                    {{ i == item.combos.length-1 ? combo.quantity + 'x ' +\r\n                                    combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ' :\r\n                                    combo.quantity + 'x ' + combo.name + ' (' +\r\n                                    getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                    <ng-container *ngIf=\"combo.id_lotproduct\">\r\n                                        <span style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(combo)\">{{getLotNumber(combo.lots, combo.id_lotproduct)}}</span>\r\n                                    </ng-container>\r\n                                </span>\r\n                                <span *ngIf=\"!item.id_product\">{{item.name}}\r\n                                    <span class=\"invoiceDetail-item-name-notlinked\">({{\"The products have not been linked\" | translate}})</span></span>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"5\" style=\"text-align: right;\">\r\n                            <nz-input-number (ngModelChange)=\"checkQuantityProduct(item,$event)\"\r\n                                [ngModel]=\"item.quantity\" [nzMin]=\"0.1\">\r\n                            </nz-input-number>\r\n                        </div>\r\n                        <!-- <div (click)=\"openEditUnitPrice(item)\" class=\"invoiceDetail-item-price text-end\" nz-col -->\r\n                        <div class=\"invoiceDetail-item-price text-end\" nz-col\r\n                            nzSpan=\"5\">\r\n                            <p class=\"max-width-two-line\" style=\"border-bottom: 1px var(--ion-color-vh-gray) solid;\r\n              margin-left: 16px;\">\r\n                                <span>{{vhAlgorithm.vhcurrencyunit(item.price)}}</span>\r\n                                <del style=\"margin-left:5px;font-size: 0.8rem;\">\r\n                                    {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin) :\r\n                                    ''}}\r\n                                </del>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"5\" style=\"text-align: right;\">\r\n                            <p class=\"max-width-two-line\">\r\n                                <b>{{vhAlgorithm.vhcurrencyunit(item.price*item.quantity)}}</b>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Salesman' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_employee\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveEmployee($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Sales date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\" class=\"sales-bills-customer-info\" nz-row>\r\n                    <b style=\"width: 100%;margin-bottom: 12px;\">{{'Customer information' | translate}}</b>\r\n                    <div class=\"sales-bills-customer-info-name\">\r\n                        {{customer.name}}\r\n                    </div>\r\n                    <div class=\"sales-bills-customer-info-phone\">\r\n                        {{customer.phone}}\r\n                    </div>\r\n                </div>\r\n                <div style=\"margin-top: 12px;\" nz-col nzSpan=\"24\" class=\"sales-bills-customer-info\" nz-row>\r\n                    <span (click)=\"isOpenModalTaxCustomer = true\" style=\"width: 100%;margin-bottom: 12px; color: var(--ion-color-vh-green); cursor: pointer;\">\r\n                        <b>{{'Invoice information' | translate}}</b>\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div>{{'SubTotal' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Platform fee' | translate}}<i\r\n                            style=\"font-size: 0.9rem;color: var(--ion-color-vh-red);margin-left: 4px;\"\r\n                            nzTooltipTitle=\"{{'Vui lòng kiểm tra phí sàn chính xác trước khi phát hành hóa đơn'}}\"\r\n                            nzTooltipPlacement=\"top\" nz-tooltip nz-icon nzType=\"exclamation-circle\"\r\n                            nzTheme=\"outline\"></i></div>\r\n                    <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                        class=\"nz-no-border discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Fee' | translate}}</div>\r\n                    <input (blur)=\"editFee()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.fee)\"\r\n                        class=\"nz-no-border invoice-fee\" type=\"text\" maxlength=\"15\" id=\"invoice-fee\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Total' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.total)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <div><b>{{'Pay' | translate}}</b></div>\r\n                    <div> <b>{{vhAlgorithm.vhcurrencyunit(invoice.payment)}}</b></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Rest' | translate}}</div>\r\n                    <div><b> {{vhAlgorithm.vhcurrencyunit_symbol(invoice.total - invoice.payment)}}</b></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\">\r\n                    <textarea class=\"nz-hover-border\" [(ngModel)]=\"invoice.note\" nz-input\r\n                        placeholder=\"{{'Enter note...' | translate}}\"\r\n                        [nzAutosize]=\"{ minRows: 2, maxRows: 4 }\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!validProdDetail || !checkPrinter\" (click)=\"payInvoice(true)\" nz-button\r\n                    class=\"order-and-print\">\r\n                    {{\"Save & Print\"|translate}} (F2)\r\n                </button>\r\n                <button [disabled]=\"!validProdDetail\" (click)=\"payInvoice(false)\" nz-button class=\"order\">\r\n                    {{\"Save\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n<!-- search sp -->\r\n<!-- -----nz-drawer list-product-------- -->\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\" [default_price_type]=\"1\">\r\n</app-search-product>\r\n\r\n\r\n<!--Modal edit unit price-->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Edit unit price' | translate}}\" (nzOnCancel)=\"isVisibleEditUnitPrice = false\"\r\n    (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Unit price' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\" [value]=\"tempDetail.price\" nz-input\r\n                    placeholder=\"{{'Enter unit price' | translate}}\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"isVisibleEditUnitPrice = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- modal chọn lô/HSD -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice2\" [(nzVisible)]=\"show_modal_select_lots\"\r\n    nzTitle=\"{{'Select lot number' | translate}}\" (nzOnCancel)=\"handleCancelChooseLot()\" (nzOnOk)=\"handleChooseLot()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input type=\"text\" nz-input placeholder=\"{{'Find lot number' | translate}}\" #searchValue\r\n                    (keyup)=\"searchLot(searchValue.value )\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <nz-radio-group [(ngModel)]=\"tempDetail.id_lotproduct\" (ngModelChange)=\"changeLot($event)\" style=\"width:100%;\">\r\n            <div nz-row *ngFor=\"let item of tempDetail.lots\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <label class=\"radio-purchase\" nz-radio [nzValue]=\"item._id\" style=\"width:100%;\">\r\n                        <div nz-row>\r\n                            <div nz-col nzSpan=\"8\">\r\n                                {{item.lot_number}}\r\n                            </div>\r\n\r\n                            <div nz-col nzSpan=\"8\">\r\n                                NSX: {{item.date_mfg | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                            <div nz-col nzSpan=\"8\">\r\n                                HSD: {{item.date_exp | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                        </div>\r\n\r\n                    </label>\r\n                </div>\r\n\r\n            </div>\r\n        </nz-radio-group>\r\n        <div *ngIf=\"!tempDetail.lots.length\" style=\"text-align: center;\">{{'No data' | translate}}</div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice2>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelChooseLot()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\" [disabled]=\"!tempDetail.id_lotproduct\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLot()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!-- modal chọn lô/HSD cho combo-->\r\n<nz-modal  nzWidth=\"70vw\"  *ngIf=\"show_modal_select_lots_combo\" [nzFooter]=\"modalFooterEditUnitPrice3\"\r\n    [(nzVisible)]=\"show_modal_select_lots_combo\"\r\n    nzTitle=\"{{'Select lot number for products in combo' | translate}}: {{tempDetail.name}}\"\r\n    (nzOnCancel)=\"show_modal_select_lots_combo = false\" (nzOnOk)=\"handleChooseLotCombo()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"tempDetail.combos\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{{\"Product name\" | translate}}</th>\r\n                    <th>{{'Lot number' | translate}}</th>\r\n                    <th>{{'Unit' | translate}}</th>\r\n                    <th>{{'Quantity' | translate}}</th>\r\n                    <th>{{'Unit price' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let data of basicTable.data\">\r\n                    <ng-container *ngIf=\"data.lots\">\r\n\r\n                        <tr>\r\n                            <td>{{ data.name }}</td>\r\n                            <td>\r\n                                <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                    [(ngModel)]=\"data.id_lotproduct\">\r\n                                    <nz-option *ngFor=\"let element of data.lots\"  nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp | date: 'dd/MM/yyyy'}}\"\r\n                                        [nzValue]=\"element._id\"></nz-option>\r\n                                </nz-select>\r\n                            </td>\r\n                            <td>{{getUnit(data.units, data.ratio)}}</td>\r\n                            <td>{{ data.quantity }}</td>\r\n                            <td>\r\n                                {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n\r\n                            </td>\r\n                        </tr>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice3>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"show_modal_select_lots_combo = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLotCombo()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<app-modal-customer-tax [isOpenModal]=\"isOpenModalTaxCustomer\" [invoice]=\"invoice\"\r\n    (onClose)=\"onClose($event)\" (onOk)=\"onOkEditTax($event)\"></app-modal-customer-tax>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { AddComponent } from './add/add.component';\r\nimport { EditComponent } from './edit/edit.component';\r\nimport { DetailComponent } from './detail/detail.component';\r\nimport { NgZorroAntModule } from 'src/app/ng-zorro-ant.module';\r\nimport { ComponentsModule } from 'src/app/sales/sale-desktop/components/components.module';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { SearchModule } from 'src/app/sales/components/search/search.module';\r\nimport { ModalCustomerTaxModule } from '../components/modal-customer-tax/modal-customer-tax.module';\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddComponent,\r\n    EditComponent,\r\n    DetailComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    ComponentsModule,\r\n    NgZorroAntModule,\r\n    TranslateModule,\r\n    FormsModule,\r\n    SearchModule,\r\n    ModalCustomerTaxModule,\r\n  ],\r\n  exports: [\r\n    AddComponent,\r\n    EditComponent,\r\n    DetailComponent\r\n  ],\r\n})\r\nexport class BillType1ShopeeModule { }\r\n","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { SalesK57Col3Component } from 'src/app/sales/components/print/sales/sales-k57-col3/sales-k57-col3.component';\r\nimport { SalesK80Col3Component } from 'src/app/sales/components/print/sales/sales-k80-col3/sales-k80-col3.component';\r\nimport { SalesK80Col4Component } from 'src/app/sales/components/print/sales/sales-k80-col4/sales-k80-col4.component';\r\nimport { SalesA5Component } from 'src/app/sales/components/print/sales/sales-a5/sales-a5.component';\r\nimport { SalesA4Component } from 'src/app/sales/components/print/sales/sales-a4/sales-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { VhSaleShopeeInvoiceEdit, VhSaleShopeeInvoiceDetail } from '../shopee-interface';\r\n\r\n@Component({\r\n  selector: 'bill-type1-shopee-detail',\r\n  templateUrl: './detail.component.html',\r\n  styleUrls: ['./detail.component.scss']\r\n})\r\nexport class DetailComponent  {\r\n\r\n  tableHeight: string;\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore\r\n  billShopee: any = this.router.getCurrentNavigation().extras.state.billShopee\r\n  public invoiceInfo: any;\r\n  public invoice: VhSaleShopeeInvoiceEdit = null;\r\n  invoice_detail : VhSaleShopeeInvoiceDetail[]\r\n  subTotal = 0;\r\n  constructor(\r\n    private router: Router,\r\n    private vhQuerySales: VhQuerySales,\r\n    private lang: LanguageService,\r\n    private vhAuth: VhAuth,\r\n    private vhComponent: VhComponent,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private cdRef: ChangeDetectorRef,\r\n    private fncService:FunctionService\r\n  ) {\r\n    this.getDataInvoice(this.router.getCurrentNavigation().extras.state.id)\r\n\r\n     \r\n  }\r\n\r\n  /**\r\n   * gán bill và bill-detail get được vào biến và get các thông tin của nv, khách hàng, phương thức thanh toán\r\n   * @example this.init(bill, bill-deails)\r\n   */\r\n  init(invoice: VhSaleShopeeInvoiceEdit = null, invoiceDetail: VhSaleShopeeInvoiceDetail[] = null) {\r\n    this.invoice = invoice\r\n    this.invoice_detail = invoiceDetail\r\n    if (invoice && invoiceDetail) {\r\n      this.invoiceInfo = {\r\n        employee: this.vhAuth.getlocalEmployee(this.invoice.id_employee),\r\n        partner: this.vhQuerySales.getlocalCustomer(this.invoice.id_customer),\r\n        paymentName: this.setPaymentName(this.invoice.payment_type)\r\n      } \r\n    } else this.invoiceInfo = { employee: {}, partner: {}, paymentName: '' }\r\n    this.setSubTotal()\r\n  }\r\n\r\n  /**\r\n   * get dữ liệu bill từ DB\r\n   * @param id : nhận từ state truyền qua\r\n   * @example this.getDataInvoice('DHIWHNXDIWODUHIWDHOWID')\r\n   */\r\n  private getDataInvoice(id) {\r\n    this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n      Promise.all([\r\n        this.vhQuerySales.getBill(id),\r\n        this.vhQuerySales.getBill_details_byId_bill(id)\r\n      ]).then(([invoice, invoiceDetail]: any) => {\r\n        if (!invoiceDetail.length)\r\n          this.init(invoice, [])\r\n        else {\r\n          invoiceDetail = this.vhAlgorithm.sortVietnamesebyASC(invoiceDetail, 'name');\r\n          this.init(invoice, invoiceDetail)\r\n        }\r\n        this.vhComponent.hideLoading(0)\r\n      })\r\n    })\r\n  }\r\n  /**\r\n   * tính cộng tiền hóa đơn\r\n   * @example this.setSubTotal()\r\n   */\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoice_detail) {\r\n      subTotal +=  (i.price ? i.price * i.quantity : 0)\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal();\r\n  }\r\n  /**\r\n   * tính tổng tiền hóa đơn\r\n   * @example this.setTotal()\r\n   */\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee > 0 ? this.subTotal - this.invoice.discount + this.invoice.fee : 0\r\n   \r\n  } \r\n  /**\r\n   * trả về tên phương thức thanh toán\r\n   * @param type \r\n   * @returns string\r\n   * @example this.setPaymentName(1)\r\n   */\r\n  public setPaymentName(type: 1 | 2 | 3) {\r\n    switch (type) {\r\n      case 1: return this.lang.translate(\"Cash\")\r\n      case 2: return this.lang.translate(\"Debit\")\r\n      case 3: return this.vhQuerySales.getlocalWallet(this.invoice.id_wallet).name\r\n    }\r\n  }\r\n  /**\r\n   * trả về tên unit của sản phẩm theo ratio truyền vào\r\n   * @param units \r\n   * @param ratio \r\n   * @returns string\r\n   * @example let unit_name = this.getUnit([object], 1)\r\n   */\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units,ratio).unit\r\n  }\r\n\r\n\r\n  /**\r\n   * trả về chuỗi thông tin lô theo id lô truyền vào\r\n   * @param lots \r\n   * @param _id \r\n   * @returns string\r\n   * @example let lot = this.getLotNumber([], 'DNIWUHNDKLJWHDIWUOH')\r\n   */\r\n  getLotNumber(lots, _id){\r\n    let lot = lots.find(item => item._id == _id)\r\n    return lot.lot_number + '\\n' + this.fncService.formatDate(lot.date_mfg) + ' - ' +  this.fncService.formatDate(lot.date_exp)\r\n  } \r\n\r\n  /**\r\n   * trả về chuỗi thông tin địa chỉ của customer\r\n   * @param partner \r\n   * @returns string\r\n   * @example let addr = this.renderAddress(customer_info)\r\n   */\r\n  public renderAddress(partner) {\r\n    return (partner.address ? partner.address : '') +\r\n      (partner.district ? ', ' + partner.district : '') +\r\n      (partner.province ? ', ' + partner.province : '') +\r\n      (partner.country ? ', ' + partner.country : '')\r\n  }\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n\r\n  /**\r\n   * kiểm tra thông tin dữ liệu trang in và mở component in\r\n   * @example this.printInvoice()\r\n   */\r\n  printInvoice() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer , invoice: this.invoice, invoice_detail: this.invoice_detail }, false, false, `modal-print-${printer['_id']}`)\r\n    }, (err) => {\r\n      let name :any= 'Sales'\r\n      this.vhComponent.alertMessage(this.lang.translate(\"Function\"), \"\", this.lang.translate(\"Please turn on the printer function\"), \"OK\")\r\n        .then(() => this.router.navigate(['/sales/dashboard/manage/printer','page_desktop_sales'],{state : name}))\r\n    })\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return SalesK57Col3Component\r\n      case 'print_size_k80_3c': return SalesK80Col3Component\r\n      case 'print_size_k80_4c': return SalesK80Col4Component\r\n      case 'print_size_a5': return SalesA5Component\r\n      case 'print_size_a4': return SalesA4Component\r\n      default: return SalesA4Component\r\n    }\r\n  }\r\n  /**\r\n   * trở về trang phát hành hóa đơn shopee\r\n   * @example this.goBack()\r\n   */\r\n  goBack() {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods'], { state: { dataRestore: this.dataRestore } });\r\n  }\r\n  ngAfterViewChecked() {\r\n    if (document.getElementById('sales-invoice-detail-today') && document.querySelector(\".sales-cart-header\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".ant-table-pagination\")) {\r\n      this.tableHeight = document.getElementById('sales-invoice-detail-today').clientHeight - document.querySelector(\".sales-cart-header\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".ant-table-pagination\").clientHeight - 40 + \"px\";\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n  /**\r\n   * router trang cập nhật phát hành hóa đơn shopee\r\n   * @example this.goToCart()\r\n   */\r\n  public goToCart() {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/edit'], { state: { dataRestore: this.dataRestore, invoiceDetail: this.invoice_detail, invoice: this.invoice, billShopee: this.billShopee } })\r\n  }\r\n\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n<nz-layout id=\"sales-invoice-detail-today\" *ngIf=\"invoice\">\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{'Issue invoice' | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n                    <div>\r\n                        <button (click)=\"goToCart()\" class=\"btn-data nz-hover-border center-all-content\" nz-button\r\n                            nzType=\"default\">\r\n                            <span nz-icon nzType=\"edit\" nzTheme=\"outline\"></span>\r\n                            {{'Edit' | translate}}\r\n                        </button>\r\n                    </div>\r\n                    <div style=\"margin-left:4px\">\r\n                        <button (click)=\"printInvoice()\" class=\"btn-data nz-hover-border center-all-content\" nz-button\r\n                            nzType=\"default\">\r\n                            <span nz-icon nzType=\"printer\" nzTheme=\"outline\"></span>\r\n                            {{'Print' | translate}}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\">\r\n                    <nz-table [nzScroll]=\"{ y: tableHeight }\" [nzData]=\"invoice_detail || []\" #rowSelectionTable\r\n                        nzShowSizeChanger nzNoResult=\"{{'No data' | translate}}\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th nzWidth=\"35%\"><b>{{'Product name' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='center'><b>{{'Unit' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='center'><b>{{'Quantity' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='right'><b>{{'Unit price' | translate}}</b></th>\r\n                                <th nzWidth=\"20%\" nzAlign='right'><b>{{'Total' | translate}}</b></th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr *ngFor=\"let item of rowSelectionTable.data\" style=\"cursor: pointer;\">\r\n                                <td>{{item.name}} <br>\r\n                                    <ng-container *ngIf=\"item.lots\">\r\n                                        <pre>{{getLotNumber(item.lots, item.id_lotproduct)}}</pre>\r\n                                    </ng-container>\r\n                                    <ng-container *ngIf=\"item.ptype == 5\">\r\n                                        <span class=\"sub-name\" *ngFor=\"let combo of item.combos\">{{combo.quantity}}x\r\n                                            {{combo.name}}\r\n                                            ({{getUnit(combo.units,combo.ratio)}}), </span><br>\r\n                                    </ng-container>\r\n                                </td>\r\n                                <td nzAlign='center'>\r\n                                    {{getUnit(item.units, item.ratio)}}\r\n                                </td>\r\n                                <td nzAlign='center'>{{item.quantity}}</td>\r\n                                <td nzAlign='right'>{{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n                                    <del style=\"font-size: 0.7rem;\">\r\n                                        {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin)\r\n                                        : ''}}\r\n                                    </del>\r\n                                </td>\r\n                                <td nzAlign='right'><b>{{vhAlgorithm.vhcurrencyunit(item.quantity * item.price)}}</b>\r\n                                </td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </nz-table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills not-continue-sell\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div>\r\n                    <b>{{'Invoice code' | translate}}</b>\r\n                    <div> {{invoice.bill_code}}</div>\r\n                </div>\r\n                <div>\r\n                    <b>{{'Salesman' | translate}}</b>\r\n                    <div>{{invoiceInfo.employee.name}}</div>\r\n                </div>\r\n                <div>\r\n                    <b>{{'Sales date' | translate}}</b>\r\n                    <div>{{invoice.date | date: 'dd/MM/yyyy HH:mm'}}</div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\" nz-row>\r\n                <b>{{'Customer information' | translate}}</b>\r\n                <div *ngIf=\"invoiceInfo.partner._id == 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{invoiceInfo.partner.name | translate}}\r\n                </div>\r\n                <div *ngIf=\"invoiceInfo.partner._id != 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{invoiceInfo.partner.name | translate}} - {{invoiceInfo.partner.phone}}\r\n                </div>\r\n                <div *ngIf=\"invoiceInfo.partner._id != 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{renderAddress(invoiceInfo.partner)}}\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <span>{{'SubTotal' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Discount' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.discount)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Fee' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.fee)}}</div>\r\n                </div>\r\n                <!-- <div class=\"sales-bills-content-tax\" nz-col nzSpan=\"24\">\r\n            <span>{{'Tax' | translate}}</span>\r\n            <div>{{vhAlgorithm.vhpercent(invoice.getTax()/100)}}</div>\r\n            <div>\r\n              {{vhAlgorithm.vhcurrencyunit(invoice.getTaxValue())}}</div>\r\n          </div> -->\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Total' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.total)}}</div>\r\n\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Pay' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit_symbol(invoice.payment)}}</div>\r\n\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Rest' | translate}}</span>\r\n                    <div style=\"color: var(--ion-color-vh-red);\">{{vhAlgorithm.vhcurrencyunit_symbol(invoice.total -\r\n                        invoice.payment)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-payment_type\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Payment method' | translate}}</span>\r\n                    <div>{{setPaymentName(this.invoice.payment_type)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Note' | translate}}</span>\r\n                    <div>{{invoice.note}}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhEcommerce, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { Observable } from 'rxjs';\r\nimport { SalesK57Col3Component } from 'src/app/sales/components/print/sales/sales-k57-col3/sales-k57-col3.component';\r\nimport { SalesK80Col3Component } from 'src/app/sales/components/print/sales/sales-k80-col3/sales-k80-col3.component';\r\nimport { SalesK80Col4Component } from 'src/app/sales/components/print/sales/sales-k80-col4/sales-k80-col4.component';\r\nimport { SalesA5Component } from 'src/app/sales/components/print/sales/sales-a5/sales-a5.component';\r\nimport { SalesA4Component } from 'src/app/sales/components/print/sales/sales-a4/sales-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhSaleShopeeInvoiceEdit, VhSaleShopeeInvoiceDetail, VhSaleShopeeInvoiceDetailCombo } from '../shopee-interface';\r\nimport { VhType } from 'src/app/sales/interface/vh-type';\r\n\r\n@Component({\r\n  selector: 'bill-type1-shopee-edit',\r\n  templateUrl: './edit.component.html',\r\n  styleUrls: ['./edit.component.scss']\r\n})\r\nexport class EditComponent implements OnInit {\r\n  invoice: VhSaleShopeeInvoiceEdit = this.router.getCurrentNavigation().extras.state.invoice;\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore; //nhớ dữ liệu truyền từ trang trước\r\n  billShopee: any = this.router.getCurrentNavigation().extras.state.billShopee;\r\n  employee: any = {};\r\n  customer: any = {};\r\n  pickerTime = new Date();\r\n  checkPrinter: boolean = false;\r\n  closerBrower: any;\r\n  validProdDetail: boolean = true;//nếu biến này = false tức có sp shopee chưa được liên kết với app\r\n  id_branch: string = this.vhQuerySales.getDefaultBranch()._id;\r\n  invoiceDetail = this.router.getCurrentNavigation().extras.state.invoiceDetail;\r\n  subTotal = 0;\r\n  taxValue = 0;\r\n  isOpenModalTaxCustomer = false;\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private languageService: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhAuth: VhAuth,\r\n    private fncService: FunctionService,\r\n    private nzModalService: NzModalService,\r\n    private vhEcommerce: VhEcommerce,\r\n    private cdf: ChangeDetectorRef\r\n  ) {\r\n\r\n  }\r\n  /**Khởi tạo hóa đơn và merge sp của shopee vào billDetail */\r\n  initBill() {\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n    this.setSubTotal();\r\n    this.pickerTime = new Date(this.invoice.date);\r\n    this.invoice.tax_buyerDisplayName = this.invoice.tax_buyerDisplayName ? this.invoice.tax_buyerDisplayName : 'Người mua không lấy hóa đơn';\r\n  }\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      subTotal += (i.price ? i.price * i.quantity : 0);\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal();\r\n  }\r\n\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee > 0 ? this.subTotal - this.invoice.discount + this.invoice.fee : 0;\r\n    this.cdf.detectChanges();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n\r\n\r\n    this.initBill();\r\n    this.eventKeypress();\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales');\r\n    if (printer) this.checkPrinter = printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.discount_price = this.vhAlgorithm.vhnumeral(\".discount-price\");\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral(\".invoice-fee\");\r\n    });\r\n  }\r\n  event: any; // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n    window.removeEventListener('beforeunload', this.closerBrower, false);\r\n  }\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113) event.preventDefault();\r\n      switch (keycode) {\r\n        case 112: this.payInvoice(false);\r\n          break;\r\n        case 113: {\r\n          if (this.checkPrinter) this.payInvoice(true);\r\n          break;\r\n        }\r\n        case 114: {\r\n          this.searchProductList = !this.searchProductList;\r\n          break;\r\n        }\r\n      }\r\n    };\r\n    //sự kiện f5, close tab...\r\n    this.closerBrower = (event: BeforeUnloadEvent) => {\r\n      (event || window.event).returnValue = 'Changes you made may not be saved';\r\n      return 'Changes you made may not be saved';\r\n    };\r\n    window.addEventListener('beforeunload', this.closerBrower);\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  goBack() {\r\n    this.vhComponent.alertConfirm(`${this.languageService.translate(\"Confirm\")}`, \"\", `${this.languageService.translate(\"Are you sure to cancel the sales order\")}?`, \"OK\", this.languageService.translate('Cancel'))\r\n      .then(() => { this.isExit = true; this.router.navigate([\"/sales/dashboard/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods\"], { state: { dataRestore: this.dataRestore } }); }, () => { });\r\n  }\r\n  // -------set employee-------\r\n  closeAndReceiveEmployee(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n    }\r\n  }\r\n  setPickerTime(event) {\r\n    if (event.getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 8000);\r\n      this.pickerTime = new Date(this.invoice.date);\r\n      this.invoice.date = (this.pickerTime.toISOString());\r\n    }\r\n    else\r\n      this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n\r\n        if (validitydate == null) this.invoice.date = (event);\r\n        else {\r\n          this.pickerTime = new Date(this.invoice.date);\r\n          this.invoice.date = (this.pickerTime.toISOString());\r\n          this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 8000);\r\n        }\r\n      });\r\n  }\r\n  discount_price: any;\r\n  editDiscount() {\r\n    if (this.discount_price.getRawValue() && this.discount_price.getRawValue() >= 0) {\r\n      this.invoice.discount = (parseFloat(this.discount_price.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"discount-price\")['value'] = this.invoice.discount;\r\n      this.discount_price = this.vhAlgorithm.vhnumeral('.discount-price');\r\n    }\r\n    this.setTotal();\r\n  }\r\n  invoice_fee: any;\r\n  editFee() {\r\n    if (this.invoice_fee.getRawValue() && this.invoice_fee.getRawValue() >= 0) {\r\n      this.invoice.fee = (parseFloat(this.invoice_fee.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"invoice-fee\")['value'] = this.invoice.fee;\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral('.invoice-fee');\r\n    }\r\n    this.setTotal();\r\n  }\r\n\r\n  compareSubTotal() {\r\n    let sub = this.invoiceDetail.reduce((prev: number, next) => prev + next.quantity * next.price, 0);\r\n    if (sub == this.subTotal) return true;\r\n    return false;\r\n  }\r\n\r\n  getCreateUpdateInvoiceDetail(): VhSaleShopeeInvoiceDetail[] {\r\n    return this.invoiceDetail.map(item => {\r\n      if (!item.pmtype) {\r\n        let detail: VhSaleShopeeInvoiceDetail = {\r\n          id_product: item.id_product,\r\n          ptype: item.ptype,\r\n          price: item.price,\r\n          quantity: item.quantity,\r\n          ratio: item.ratio,\r\n          price_origin: item.price_origin,\r\n        };\r\n        if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct;\r\n        if (item.id_subproduct) detail['id_subproduct'] = item.id_subproduct;\r\n\r\n        if (item.ptype == 5) {\r\n          detail['combos'] = item.combos.map(combo => {\r\n            let product: VhSaleShopeeInvoiceDetailCombo = {\r\n              id_product: combo.id_product,\r\n              price: combo.price,\r\n              quantity: combo.quantity,\r\n              ptype: combo.ptype || combo.type,\r\n              ratio: combo.ratio ? combo.ratio : 1,\r\n            };\r\n            if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct;\r\n            if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct;\r\n            return product;\r\n          });\r\n        }\r\n        return detail;\r\n      }\r\n    }).filter(item => item);\r\n\r\n  }\r\n  payInvoice(print?) {\r\n\r\n\r\n\r\n    if (this.vhAuth.checkMyPermission(\"sales_enable_payment\")) {\r\n      if (this.compareSubTotal()) {\r\n        this.vhComponent.alertConfirm(\r\n          !print ? `${this.languageService.translate(\"Pay\")}?` : `${this.languageService.translate(\"Pay & Print\")}?`,\r\n          \"\", \"\", \"OK\", this.languageService.translate(\"Cancel\")\r\n        )\r\n          .then(() => {\r\n            this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n              this.createOrUpdate(1).then((bill: any) => {\r\n\r\n\r\n                let update = async () => await\r\n                  this.vhEcommerce.updateSalesOrderShopee(this.dataRestore['id_shop_selected'], this.billShopee['order_sn'].toString(), { id_bill_delivered_goods: bill._id });\r\n                update();\r\n\r\n                this.vhComponent.hideLoading(0).then(() => {\r\n                  this.vhComponent.showToast(2000,\r\n                    `${this.languageService.translate(\"Issue invoice\")} ${this.languageService.translate(\"Successfully\").toLocaleLowerCase()}`, \"success-toast\"\r\n                  );\r\n                  if (print) this.handlePrint();\r\n                  else this.handle(true);\r\n                });\r\n              }).catch(err => { this.vhComponent.hideLoading(0); this.vhComponent.showToast(2000, err); });\r\n            });\r\n          }, () => { });\r\n      } else this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"The total price of the product is not equal to the subtotal\"));\r\n\r\n    }\r\n    else this.vhComponent.showToast(1500, this.languageService.translate('You do not have this rights'), \"alert-toast\");\r\n  }\r\n\r\n  createOrUpdate(bill_type: 1) {\r\n    return new Promise((resolve, reject) => {\r\n      this.vhQuerySales.updateBill_Billdetail(this.invoice._id, this.invoice, this.getCreateUpdateInvoiceDetail()).then(res => resolve(res)).catch(err => reject(err));\r\n    });\r\n  }\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales');\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)]);\r\n      else rejects(\"No\");\r\n    });\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return SalesK57Col3Component;\r\n      case 'print_size_k80_3c': return SalesK80Col3Component;\r\n      case 'print_size_k80_4c': return SalesK80Col4Component;\r\n      case 'print_size_a5': return SalesA5Component;\r\n      case 'print_size_a4': return SalesA4Component;\r\n      default: return SalesA4Component;\r\n    }\r\n  }\r\n\r\n  handle(update?: boolean) {\r\n    this.isExit = true;\r\n    if (update) this.dataRestore['update'] = true;\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods'], { state: { dataRestore: this.dataRestore } });\r\n  }\r\n  handlePrint() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice: this.invoice, invoice_detail: this.invoiceDetail }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.handle(true));\r\n        });\r\n    }, (err) => this.handle(true));\r\n  }\r\n  // ------thoát trang-----\r\n  isExit: boolean = false;\r\n  checkDeactivate(currentRoute: ActivatedRouteSnapshot, currentState: RouterStateSnapshot, nextState?: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    return nextState.url == '/login' ? true : (this.isExit ? this.isExit : this.vhComponent.alertConfirm(this.languageService.translate(\"Confirm\"), \"\", this.languageService.translate(\"Are you sure to cancel the sales order\"), \"OK\", (this.languageService.translate(\"Cancel\"))).then(() => { return true; }).catch(() => { return false; }));\r\n  }\r\n  /**Phần thêm sản phẩm bổ sung\r\n   * Note : không tính tiền sản phẩm này\r\n   */\r\n  searchProductList: boolean = false;\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      if (data.manylot && !data.id_lotproduct) this.openModalChooseLot(data);\r\n      else\r\n        if (data.combos && data.combos.filter(e => e.lots && !e.id_lotproduct).length) {\r\n          this.tempDetail = data;\r\n          this.show_modal_select_lots_combo = true;\r\n        }\r\n        else\r\n          this.addInvoiceDetailExtraEcommerce(data);\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n\r\n  addInvoiceDetailExtraEcommerce(value: any) {\r\n\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == value['_id'] && detail['free']);\r\n    if (index != -1) {\r\n      if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1;\r\n    } else {\r\n      let detail: any = {\r\n        name: value.name,\r\n        id_product: value._id,\r\n        quantity: 1,\r\n        ptype: value.type,\r\n        unit: value.unit,\r\n        units: value.units,\r\n        ratio: value.ratio,\r\n        price: 0,\r\n        price_origin: value.price,\r\n        id_category: value.id_category,\r\n        free: true, //nếu có trường này thì được quyền chỉnh số lượng\r\n        id_subproduct: value.id_subproduct,\r\n        lots: value.lots,\r\n        id_lotproduct: value.id_lotproduct,\r\n      };\r\n\r\n      if (value.type == 5) {\r\n        detail['subComboName'] = value.subComboName;\r\n        detail['combos'] = [...value.combos.map(item => {\r\n          let product: any = {\r\n            id_product: item.id_product, name: item.name, ptype: item.type,\r\n            price: 0, quantity: item.quantity, id_subproduct: item.id_subproduct,\r\n            lots: item.lots,\r\n            id_lotproduct: item.id_lotproduct, units: item.units, ratio: item.ratio,\r\n            free: true//nếu có trường này thì được quyền chỉnh số lượng\r\n          };\r\n          return product;\r\n        })];\r\n      }\r\n\r\n      this.invoiceDetail.unshift(detail);\r\n    }\r\n\r\n  }\r\n\r\n  checkQuantityProduct(product: VhSaleShopeeInvoiceDetail, event) {\r\n    const MIN_PRICE = 1;\r\n\r\n    const oldQuantity = product.quantity;\r\n    const oldPrice = product.price;\r\n    const originalTotal = oldQuantity * oldPrice;\r\n\r\n    const newQuantity = event || 1;\r\n    const newPrice = originalTotal / newQuantity;\r\n\r\n    if (newPrice < MIN_PRICE) {\r\n      return;\r\n    }\r\n\r\n    product.quantity = newQuantity;\r\n    product.price = newPrice;\r\n\r\n    this.setSubTotal();\r\n    this.cdf.detectChanges();\r\n  }\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhSaleShopeeInvoiceDetail;\r\n  openEditUnitPrice(detail: VhSaleShopeeInvoiceDetail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      this.isVisibleEditUnitPrice = false;\r\n      this.setSubTotal();\r\n    } else { this.vhComponent.showToast(2000, this.languageService.translate(\"Invalid data, please check again\"), \"alert-toast\"); }\r\n  }\r\n  deleteGoods(detail: VhSaleShopeeInvoiceDetail) {\r\n    this.vhComponent.alertConfirm(\"\", \"\", `${this.languageService.translate(\"Delete\")} ${detail.name}?`, \"OK\", this.languageService.translate(\"Cancel\"))\r\n      .then(() => this.removeInvoiceDetail(detail.id_product), () => { });\r\n  }\r\n\r\n  removeInvoiceDetail(id: string) {\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == id);\r\n    if (index != -1) {\r\n      this.invoiceDetail.splice(index, 1);\r\n      this.setSubTotal();\r\n    }\r\n  }\r\n  /**\r\n   * Thêm sản phẩm đã bán vào cart\r\n   * Công thức tính free ship max = 4,5% * (giá trị sp - giá trị NBH tài trợ) * 1.1 (tối đa 16.5k trên 1sp)\r\n   * Phí thanh toán = 2.002% x (giá sản phẩm – chi phí nhà bán hàng tài trợ + phí vận chuyển trả bởi khách hàng)\r\n   */\r\n  addInvoiceDetail(billShopee: any) {\r\n    let order_items: Array<any> = billShopee.order_items.filter(e => !e.reason);\r\n    let freeShipMax: number = 0;\r\n    let paymet_fee: number = 0;\r\n    let products: Array<any> = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden).filter(item => item[this.id_branch] && item[this.id_branch].shopees && item[this.id_branch].shopees.length >= 0);\r\n    for (let order_item of order_items) {\r\n      paymet_fee += parseFloat((0.02002 * (order_item.item_price - order_item.voucher_seller + order_item.shipping_amount)).toFixed(2));\r\n      freeShipMax += parseFloat((0.045 * (order_item.item_price - order_item.voucher_seller) * 1.1).toFixed(2));\r\n      let findSuccess: boolean = false;\r\n      for (let productApp of products) {\r\n        for (let productShopee of productApp[this.id_branch].shopees) {\r\n          let findProd = productShopee.skus.find(sku => sku.SkuId == order_item.sku_id);\r\n          if (findProd) {\r\n            findSuccess = true;\r\n            this.addInvoiceDetailShopee(order_item.item_price, productApp, true);\r\n            break;\r\n          }\r\n        }\r\n        if (findSuccess) break;\r\n      }\r\n      if (!findSuccess) {\r\n        this.addInvoiceDetailShopee(order_item.item_price, { name: order_item.name }, false);\r\n        this.validProdDetail = false;\r\n      }\r\n\r\n    }\r\n    let fee = parseFloat(freeShipMax.toFixed(2));\r\n    this.invoice.discount = ((fee > 16500 ? 16500 : fee) + parseFloat(paymet_fee.toFixed(2)) + billShopee.shipping_fee_discount_seller);\r\n  }\r\n  addInvoiceDetailShopee(price, product, exist) {\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == product['_id'] && product['_id'] != null);\r\n    if (index != -1) {\r\n      if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1;\r\n    }\r\n    else {\r\n      if (exist) {\r\n        const productToAdd = {\r\n          name: product.name,\r\n          id_product: product._id,\r\n          quantity: 1,\r\n          ptype: product.type,\r\n          unit: product.unit,\r\n          ratio: 1,\r\n          units: product.units,\r\n          price: price,\r\n          price_origin: product.price_origin || null,\r\n          id_subproduct: product.id_subproduct,\r\n          lots: product.lots,\r\n          id_lotproduct: product.id_lotproduct,\r\n\r\n          free: false //nếu có trường này true thì được quyền chỉnh số lượng\r\n        }\r\n        if(product.type == VhType.COMBO) {\r\n          productToAdd['combos'] = product.combos;\r\n        }\r\n        this.invoiceDetail.unshift(productToAdd);\r\n      } else {\r\n        this.invoiceDetail.unshift({\r\n          id_product: null,\r\n          quantity: 1,\r\n          price: price,\r\n          ptype: 1,\r\n\r\n          ratio: 1,\r\n          name: product.name\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  warning_lot_expried: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').warning_lot_expried;\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit;\r\n  }\r\n\r\n  show_modal_select_lots = false;\r\n  list_search_lot = [];\r\n\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id);\r\n    return lot.lot_number;\r\n  }\r\n  searchLot(value) {\r\n    this.tempDetail.lots = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.list_search_lot, ['lot_number']);\r\n  }\r\n  openModalChooseLot(data) {\r\n    this.tempDetail = data;\r\n    this.list_search_lot = this.tempDetail.lots;\r\n    if (!this.list_search_lot.length) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Sản phẩm này không có lô khả dụng để bán!\"));\r\n    else this.show_modal_select_lots = true;\r\n  }\r\n\r\n  changeLot(e) {\r\n    this.tempDetail.lot_number = this.tempDetail.lots.find(item => item._id == e).lot_number;\r\n  }\r\n\r\n  handleChooseLot() {\r\n    if (this.warning_lot_expried) {\r\n      let lot_select = this.list_search_lot.find(e => e._id == this.tempDetail.id_lotproduct);\r\n      if (new Date().getTime() >= new Date(lot_select.date_exp).getTime()) {\r\n        this.nzModalService.confirm({\r\n          nzTitle: this.languageService.translate(\"Lô này đã hết hạn! Tiếp tục bán sản phẩm này?\"),\r\n          nzOnOk: () => {\r\n            this.show_modal_select_lots = false;\r\n            this.tempDetail.lots = this.list_search_lot;\r\n            if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n          },\r\n          nzOnCancel: () => {\r\n            // this.show_modal_select_lots = false;\r\n            // this.tempDetail.lots = this.list_search_lot;\r\n          }\r\n\r\n        });\r\n      }\r\n      else {\r\n        this.show_modal_select_lots = false;\r\n        this.tempDetail.lots = this.list_search_lot;\r\n        if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n      }\r\n    }\r\n    else {\r\n      this.show_modal_select_lots = false;\r\n      this.tempDetail.lots = this.list_search_lot;\r\n      if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n    }\r\n  }\r\n\r\n  handleCancelChooseLot() {\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot;\r\n  }\r\n\r\n  show_modal_select_lots_combo = false;\r\n  handleChooseLotCombo() {\r\n    if (this.tempDetail.combos.filter(item => item.lots && !item.id_lotproduct).length)\r\n      this.vhComponent.alertMessageDesktop(\"warning\", this.languageService.translate(\"Vui lòng chọn lô cho sản phẩm thuộc combo này\"));\r\n    else {\r\n      this.show_modal_select_lots_combo = false;\r\n      this.closeSearchProductList(this.tempDetail);\r\n    }\r\n  }\r\n\r\n  onClose(event) {\r\n    this.isOpenModalTaxCustomer = false;\r\n  }\r\n\r\n  /**\r\n   * Khi ok trong modal chỉnh sửa customer tax\r\n   * @param customerTaxInfo\r\n   */\r\n  onOkEditTax(customerTaxInfo) {\r\n    this.isOpenModalTaxCustomer = false;\r\n    Object.assign(this.invoice, customerTaxInfo);\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n\r\n<nz-layout>\r\n    <div class=\"sales hide-best-selling\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{\"Order number\" | translate}}: <a target=\"_blank\"\r\n                        href=\"https://banhang.shopee.vn/portal/sale/order?search={{billShopee.order_sn}}\">{{billShopee.order_sn}}</a></b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n                    <div>\r\n                        <button style=\"width: 97%;\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                            (click)=\"searchProductList =true\">\r\n                            <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                            {{'Search (F4)' | translate}}</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\" *ngFor=\"let item of invoiceDetail\">\r\n                    <div nz-row>\r\n                        <div (click)=\"deleteGoods(item)\" nz-col nzSpan=\"1\">\r\n                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"8\">\r\n                            <p class=\"invoiceDetail-item-name\">\r\n                                <span class=\"invoiceDetail-item-name-linked\"\r\n                                    *ngIf=\"item.id_product\">{{item.name}}</span>\r\n                                    <ng-container *ngIf=\"item.lots\">\r\n                                        <span *ngIf=\"item.id_lotproduct\" style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(item)\">{{getLotNumber(item.lots, item.id_lotproduct)}}</span>\r\n                                            <span *ngIf=\"!item.id_lotproduct\" style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(item)\">{{'Select lot' | translate}}</span>\r\n                                    </ng-container>\r\n                                    <span *ngFor=\"let combo of item.combos;index as i\"\r\n                                    style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                    {{ i == item.combos.length-1 ? combo.quantity + 'x ' +\r\n                                    combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ' :\r\n                                    combo.quantity + 'x ' + combo.name + ' (' +\r\n                                    getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                    <ng-container *ngIf=\"combo.id_lotproduct\">\r\n                                        <span style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(combo)\">{{getLotNumber(combo.lots, combo.id_lotproduct)}}</span>\r\n                                    </ng-container>\r\n                                </span>\r\n                                <span *ngIf=\"!item.id_product\">{{item.name}}\r\n                                    <span class=\"invoiceDetail-item-name-notlinked\">({{\"The products have not been linked\" | translate}})</span></span>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"5\" style=\"text-align: right;\">\r\n                            <nz-input-number (ngModelChange)=\"checkQuantityProduct(item,$event)\"\r\n                                [ngModel]=\"item.quantity\" [nzMin]=\"0.1\">\r\n                            </nz-input-number>\r\n                        </div>\r\n                        <!-- <div (click)=\"openEditUnitPrice(item)\" class=\"invoiceDetail-item-price text-end\" nz-col -->\r\n                        <div class=\"invoiceDetail-item-price text-end\" nz-col\r\n                            nzSpan=\"5\">\r\n                            <p class=\"max-width-two-line\" style=\"border-bottom: 1px var(--ion-color-vh-gray) solid;\r\n              margin-left: 16px;\">\r\n                                <span>{{vhAlgorithm.vhcurrencyunit(item.price)}}</span>\r\n                                <del style=\"margin-left:5px;font-size: 0.8rem;\">\r\n                                    {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin) :\r\n                                    ''}}\r\n                                </del>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"5\" style=\"text-align: right;\">\r\n                            <p class=\"max-width-two-line\">\r\n                                <b>{{vhAlgorithm.vhcurrencyunit(item.price*item.quantity)}}</b>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Salesman' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_employee\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveEmployee($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Sales date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\" class=\"sales-bills-customer-info\" nz-row>\r\n                    <b style=\"width: 100%;margin-bottom: 12px;\">{{'Customer information' | translate}}</b>\r\n                    <div class=\"sales-bills-customer-info-name\">\r\n                        {{customer.name}}\r\n                    </div>\r\n                    <div class=\"sales-bills-customer-info-phone\">\r\n                        {{customer.phone}}\r\n                    </div>\r\n                </div>\r\n                <div style=\"margin-top: 12px;\" nz-col nzSpan=\"24\" class=\"sales-bills-customer-info\" nz-row>\r\n                    <span (click)=\"isOpenModalTaxCustomer = true\" style=\"width: 100%;margin-bottom: 12px; color: var(--ion-color-vh-green); cursor: pointer;\">\r\n                        <b>{{'Invoice information' | translate}}</b>\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div>{{'SubTotal' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Platform fee' | translate}}<i\r\n                            style=\"font-size: 0.9rem;color: var(--ion-color-vh-red);;margin-left: 4px;\"\r\n                            nzTooltipTitle=\"{{'Vui lòng kiểm tra phí sàn chính xác trước khi phát hành hóa đơn'}}\"\r\n                            nzTooltipPlacement=\"top\" nz-tooltip nz-icon nzType=\"exclamation-circle\"\r\n                            nzTheme=\"outline\"></i></div>\r\n                    <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                        class=\"nz-no-border discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Fee' | translate}}</div>\r\n                    <input (blur)=\"editFee()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.fee)\"\r\n                        class=\"nz-no-border invoice-fee\" type=\"text\" maxlength=\"15\" id=\"invoice-fee\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Total' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.total)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <div><b>{{'Pay' | translate}}</b></div>\r\n                    <div> <b>{{vhAlgorithm.vhcurrencyunit(invoice.payment)}}</b></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Rest' | translate}}</div>\r\n                    <div><b> {{vhAlgorithm.vhcurrencyunit_symbol(invoice.total - invoice.payment)}}</b></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\">\r\n                    <textarea class=\"nz-hover-border\" [(ngModel)]=\"invoice.note\" nz-input\r\n                        placeholder=\"{{'Enter note...' | translate}}\"\r\n                        [nzAutosize]=\"{ minRows: 2, maxRows: 4 }\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!validProdDetail || !checkPrinter\" (click)=\"payInvoice(true)\" nz-button\r\n                    class=\"order-and-print\">\r\n                    {{\"Save & Print\"|translate}} (F2)\r\n                </button>\r\n                <button [disabled]=\"!validProdDetail\" (click)=\"payInvoice(false)\" nz-button class=\"order\">\r\n                    {{\"Save\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n<!-- search sp -->\r\n<!-- -----nz-drawer list-product-------- -->\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\" [default_price_type]=\"1\">\r\n</app-search-product>\r\n\r\n\r\n<!--Modal edit unit price-->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Edit unit price' | translate}}\" (nzOnCancel)=\"isVisibleEditUnitPrice = false\"\r\n    (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Unit price' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\" [value]=\"tempDetail.price\" nz-input\r\n                    placeholder=\"{{'Enter unit price' | translate}}\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"isVisibleEditUnitPrice = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- modal chọn lô/HSD -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice2\" [(nzVisible)]=\"show_modal_select_lots\"\r\n    nzTitle=\"{{'Select lot number' | translate}}\" (nzOnCancel)=\"handleCancelChooseLot()\" (nzOnOk)=\"handleChooseLot()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input type=\"text\" nz-input placeholder=\"{{'Find lot number' | translate}}\" #searchValue\r\n                    (keyup)=\"searchLot(searchValue.value )\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <nz-radio-group [(ngModel)]=\"tempDetail.id_lotproduct\" (ngModelChange)=\"changeLot($event)\" style=\"width:100%;\">\r\n            <div nz-row *ngFor=\"let item of tempDetail.lots\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <label class=\"radio-purchase\" nz-radio [nzValue]=\"item._id\" style=\"width:100%;\">\r\n                        <div nz-row>\r\n                            <div nz-col nzSpan=\"8\">\r\n                                {{item.lot_number}}\r\n                            </div>\r\n\r\n                            <div nz-col nzSpan=\"8\">\r\n                                NSX: {{item.date_mfg | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                            <div nz-col nzSpan=\"8\">\r\n                                HSD: {{item.date_exp | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                        </div>\r\n\r\n                    </label>\r\n                </div>\r\n\r\n            </div>\r\n        </nz-radio-group>\r\n        <div *ngIf=\"!tempDetail.lots.length\" style=\"text-align: center;\">{{'No data' | translate}}</div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice2>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelChooseLot()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\" [disabled]=\"!tempDetail.id_lotproduct\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLot()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!-- modal chọn lô/HSD cho combo-->\r\n<nz-modal  nzWidth=\"70vw\"  *ngIf=\"show_modal_select_lots_combo\" [nzFooter]=\"modalFooterEditUnitPrice3\"\r\n    [(nzVisible)]=\"show_modal_select_lots_combo\"\r\n    nzTitle=\"{{'Select lot number for products in combo' | translate}}: {{tempDetail.name}}\"\r\n    (nzOnCancel)=\"show_modal_select_lots_combo = false\" (nzOnOk)=\"handleChooseLotCombo()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"tempDetail.combos\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{{\"Product name\" | translate}}</th>\r\n                    <th>{{'Lot number' | translate}}</th>\r\n                    <th>{{'Unit' | translate}}</th>\r\n                    <th>{{'Quantity' | translate}}</th>\r\n                    <th>{{'Unit price' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let data of basicTable.data\">\r\n                    <ng-container *ngIf=\"data.lots\">\r\n\r\n                        <tr>\r\n                            <td>{{ data.name }}</td>\r\n                            <td>\r\n                                <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                    [(ngModel)]=\"data.id_lotproduct\">\r\n                                    <nz-option *ngFor=\"let element of data.lots\"  nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp | date: 'dd/MM/yyyy'}}\"\r\n                                        [nzValue]=\"element._id\"></nz-option>\r\n                                </nz-select>\r\n                            </td>\r\n                            <td>{{getUnit(data.units, data.ratio)}}</td>\r\n                            <td>{{ data.quantity }}</td>\r\n                            <td>\r\n                                {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n\r\n                            </td>\r\n                        </tr>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice3>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"show_modal_select_lots_combo = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLotCombo()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<app-modal-customer-tax [isOpenModal]=\"isOpenModalTaxCustomer\" [invoice]=\"invoice\"\r\n    (onClose)=\"onClose($event)\" (onOk)=\"onOkEditTax($event)\"></app-modal-customer-tax>\r\n","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\n \r\n\r\n@Component({\r\n  selector: 'app-add',\r\n  templateUrl: './add.component.html',\r\n  styleUrls: ['./add.component.scss']\r\n})\r\nexport class AddComponent   {\r\n  \r\n\r\n\r\n}","<bill-type1-shopee-add></bill-type1-shopee-add>","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{'Back' | translate}}\r\n</div>\r\n<nz-layout id=\"order-status-sendo\" *ngIf=\"bill\">\r\n    <div nz-row class=\"order-status-sendo-header\">\r\n        <div nz-col nzSpan=\"18\" class=\"title\">\r\n            <b>{{'Order number' | translate}}: <span style=\"color: #ee2624;\"\r\n                    (click)=\"vhComponent.copyValue(bill.order_sn)\"> #{{bill.order_sn}} <i nz-icon nzType=\"copy\"\r\n                        nzTheme=\"outline\"></i></span></b>\r\n        </div>\r\n        <div nz-col nzSpan=\"6\" class=\"right-all-content\">\r\n            <button style=\"width: 8vw;\" class=\" center-all-content\" nz-button nzType=\"default\" (click)=\"gotoPrint()\">\r\n                <i nz-icon nzType=\"printer\" nzTheme=\"outline\"></i>\r\n                {{'Print' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div nz-row id=\"bill-info\">\r\n        <div nz-col nzSpan=\"8\">\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"8\">\r\n                    {{'Order day' | translate}}\r\n                </div>\r\n                <div nz-col nzSpan=\"16\">\r\n                    <b> {{bill.create_at | date : \"dd/MM/yyyy HH:mm\"}}</b>\r\n                </div>\r\n            </div>\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"8\">\r\n                    {{'Payment method' | translate}}\r\n                </div>\r\n                <div nz-col nzSpan=\"16\">\r\n                    <b> <span>{{ bill.payment_method}}</span></b>\r\n                </div>\r\n            </div>\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"8\">\r\n                    {{'Status' | translate}}\r\n                </div>\r\n                <div nz-col nzSpan=\"16\">\r\n                    <b> <span>{{ bill.order_status | translate}}</span></b>\r\n                </div>\r\n            </div>\r\n            <div *ngIf=\"bill.cancel_reason\" nz-row>\r\n                <div nz-col nzSpan=\"8\">\r\n                    {{'Reason' | translate}}\r\n                </div>\r\n                <div nz-col nzSpan=\"16\">\r\n                    <b> <span>{{ bill.cancel_reason | translate}}</span></b>\r\n                </div>\r\n            </div>\r\n            <div nz-row *ngIf=\"bill.tracking_number\">\r\n                <div nz-col nzSpan=\"8\">\r\n                    {{'Order code' | translate}}\r\n                </div>\r\n                <div nz-col nzSpan=\"16\">\r\n                    <b> {{bill.tracking_number}}</b>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div nz-col nzSpan=\"8\">\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"8\">\r\n                    {{'Transport Companies' | translate}}\r\n                </div>\r\n                <div nz-col nzSpan=\"16\">\r\n                    <b>{{bill.shipping_carrier}}</b>\r\n                </div>\r\n            </div>\r\n            <!-- <div nz-row>\r\n                <div nz-col nzSpan=\"8\">\r\n                    {{'NVC Hotline' | translate}}\r\n                </div>\r\n                <div nz-col nzSpan=\"16\">\r\n                    <b>{{bill.carrier_phone}}</b>\r\n                </div>\r\n            </div> -->\r\n        </div>\r\n        <div nz-col nzSpan=\"8\">\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"8\">\r\n                    {{'Pickup address' | translate}} :\r\n                </div>\r\n                <div nz-col nzSpan=\"16\">\r\n                    <span>{{infoShop.data?.name}}, {{infoShop.data?.address}}</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <nz-divider></nz-divider>\r\n    <!-- Thông tin người mua -->\r\n    <div nz-row class=\"order-status-sendo-header\">\r\n        <div nz-col nzSpan=\"24\" class=\"title\">\r\n            <b>{{'Buyer information' | translate}}</b>\r\n        </div>\r\n    </div>\r\n    <div nz-row id=\"buyer-info\">\r\n        <div nz-col nzSpan=\"8\">\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"8\">\r\n                    {{'Receiver' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"16\">\r\n                    <b>{{bill.recipient_address.name}}</b>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div nz-col nzSpan=\"8\">\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"8\">\r\n                    {{'Phone number' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"16\">\r\n                    <b>{{bill.recipient_address.phone}}</b>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div nz-col nzSpan=\"8\"> </div>\r\n    </div>\r\n    <div nz-row style=\"margin-bottom: 8px;\">\r\n        <div nz-col nzSpan=\"2\">\r\n            {{'Address' | translate}}\r\n        </div>\r\n        <div nz-col nzSpan=\"22\">\r\n            <b> {{bill.recipient_address.full_address}}</b>\r\n        </div>\r\n    </div>\r\n    <!-- Danh sách sản phẩm -->\r\n    <nz-table *ngIf=\"bill.item_list.length > 0\" [nzScroll]=\"{  y: heightScroll }\" #salesOrder_show nzShowPagination\r\n        nzShowSizeChanger [nzData]=\"bill.item_list\" [nzPageSize]=\"20\" [nzPageSizeOptions]=\"[20, 30, 40, 50, 100, 200]\">\r\n        <thead>\r\n            <tr>\r\n                <th nzLeft nzWidth=\"12%\"><b>{{'Image' | translate}}</b></th>\r\n                <th nzLeft nzWidth=\"34%\"><b>{{'Product information' | translate}}</b></th>\r\n                <!-- <th nzWidth=\"20%\"><b>{{'Properties' | translate}}</b></th> -->\r\n                <th nzWidth=\"8%\"><b>{{\"Quantity\"| translate}}</b></th>\r\n                <th nzWidth=\"13%\"><b>{{\"Unit price\" | translate}}</b></th>\r\n                <th nzWidth=\"13%\"><b>{{\"Total\" | translate}}</b></th>\r\n                <!-- <th nzWidth=\"8%\"><b>{{'In stock' | translate}}</b></th> -->\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            <tr *ngFor=\"let data of salesOrder_show.data\">\r\n                <td nzLeft nzWidth=\"12%\">\r\n                    <img src=\"{{data.image_info.image_url}}\" alt=\"\">\r\n                </td>\r\n                <td nzLeft nzWidth=\"34%\">\r\n                    <b (click)=\"vhComponent.copyValue(data.item_name)\"> {{data.item_name}}</b> <i\r\n                        (click)=\"vhComponent.copyValue(data.item_name)\" nz-icon nzType=\"copy\" nzTheme=\"outline\"></i><br>\r\n                    <span>{{'Weight'}}</span>: <b> {{data.weight}}g</b> <br>\r\n                    <span>{{'SKU'}}</span>:<b> {{data.item_sku}}</b><br />\r\n                    <span>{{'SKU phân loại'}}</span>:<b> {{data.model_sku}}</b>\r\n                </td>\r\n                <!-- <td nzWidth=\"20%\">{{data.description| translate}}</td> -->\r\n                <td nzWidth=\"8%\">{{data.quantity}}</td>\r\n                <td nzRight nzWidth=\"13%\">{{vhAlgorithm.vhcurrencyunit(data.model_discounted_price)}}</td>\r\n                <td nzRight nzWidth=\"13%\">\r\n                    {{vhAlgorithm.vhcurrencyunit(data.model_discounted_price*data.model_quantity_purchased)}}</td>\r\n                <!-- <td nzWidth=\"8%\">\r\n                </td> -->\r\n            </tr>\r\n        </tbody>\r\n    </nz-table>\r\n    <!-- Thông tin thanh toán-->\r\n    <div nz-row id=\"payment-info\" style=\"display: flex;justify-content: space-between;\">\r\n        <div nz-col nzSpan=\"10\">\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"24\" class=\"title\">\r\n                    <b>{{'Buyer payment' | translate}}:</b>\r\n                </div>\r\n            </div>\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Product price' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    {{vhAlgorithm.vhcurrencyunit(bill.sub_total)}}\r\n                </div>\r\n            </div>\r\n            <!-- ĐƠN KHÔNG HỦY -->\r\n            <ng-container *ngIf=\"bill.order_status !== 'CANCELLED'\">\r\n                <!-- Voucher giảm giá từ người bán -->\r\n                <div *ngIf=\"escrowShopee?.order_income?.voucher_from_seller\" nz-row>\r\n                    <div nz-col nzSpan=\"12\">\r\n                        {{'Voucher discount from seller' | translate}}:\r\n                    </div>\r\n                    <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                        -{{vhAlgorithm.vhcurrencyunit(escrowShopee?.order_income?.voucher_from_seller)}}\r\n                    </div>\r\n                </div>\r\n                <!-- Voucher giảm giá từ shopee -->\r\n                <div *ngIf=\"escrowShopee?.order_income?.voucher_from_shopee\" nz-row>\r\n                    <div nz-col nzSpan=\"12\">\r\n                        {{'Voucher discount from Shopee' | translate}}:\r\n                    </div>\r\n                    <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                        -{{vhAlgorithm.vhcurrencyunit(escrowShopee?.order_income?.voucher_from_shopee)}}\r\n                    </div>\r\n                </div>\r\n                <!-- Shopee xu -->\r\n                <div *ngIf=\"escrowShopee?.order_income?.coins\" nz-row>\r\n                    <div nz-col nzSpan=\"12\">\r\n                        {{'Shopee xu' | translate}}:\r\n                    </div>\r\n                    <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                        -{{vhAlgorithm.vhcurrencyunit(escrowShopee?.order_income?.coins ?? 0)}}\r\n                    </div>\r\n                </div>\r\n                <!-- Phí vận chuyển -->\r\n                <div nz-row>\r\n                    <div nz-col nzSpan=\"12\">\r\n                        {{'Shipping Fee' | translate}}:\r\n                    </div>\r\n                    <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                        {{vhAlgorithm.vhcurrencyunit(escrowShopee?.order_income?.buyer_paid_shipping_fee ?? 0)}}\r\n                    </div>\r\n                </div>\r\n            </ng-container>\r\n            <!-- ĐƠN ĐÃ HỦY -->\r\n            <ng-container *ngIf=\"bill.order_status === 'CANCELLED'\">\r\n                <!-- Voucher giảm giá từ người bán -->\r\n                <div *ngIf=\"bill.total_discount_from_voucher_seller\" nz-row>\r\n                    <div nz-col nzSpan=\"12\">\r\n                        {{'Voucher discount from seller' | translate}}:\r\n                    </div>\r\n                    <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                        -{{vhAlgorithm.vhcurrencyunit(bill.total_discount_from_voucher_seller)}}\r\n                    </div>\r\n                </div>\r\n                <!-- Voucher giảm giá từ shopee -->\r\n                <div *ngIf=\"bill.total_discount_from_voucher_shopee\" nz-row>\r\n                    <div nz-col nzSpan=\"12\">\r\n                        {{'Voucher discount from Shopee' | translate}}:\r\n                    </div>\r\n                    <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                        -{{vhAlgorithm.vhcurrencyunit(bill.total_discount_from_voucher_shopee)}}\r\n                    </div>\r\n                </div>\r\n                <!-- Shopee xu -->\r\n                <div *ngIf=\"bill.total_discount_from_coin\" nz-row>\r\n                    <div nz-col nzSpan=\"12\">\r\n                        {{'Shopee xu' | translate}}:\r\n                    </div>\r\n                    <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                        -{{vhAlgorithm.vhcurrencyunit(bill.total_discount_from_coin?? 0)}}\r\n                    </div>\r\n                </div>\r\n                <!-- Phí vận chuyển -->\r\n                <div *ngIf=\"bill.package_list?.[0]?.logistics_status !== 'LOGISTICS_INVALID' && bill.package_list?.[0]?.logistics_status !== 'LOGISTICS_REQUEST_CANCELED' && bill.package_list?.[0]?.logistics_status !== 'LOGISTICS_DELIVERY_FAILED'\" nz-row>\r\n                    <div nz-col nzSpan=\"12\">\r\n                        {{'Shipping Fee' | translate}}:\r\n                    </div>\r\n                    <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                        {{vhAlgorithm.vhcurrencyunit(bill.estimated_shipping_fee ?? 0)}}\r\n                    </div>\r\n                </div>\r\n            </ng-container>\r\n            <!-- <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Shipping fee (PVC)' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    {{vhAlgorithm.vhcurrencyunit(bill.shipping_fee)}}\r\n                </div>\r\n            </div>\r\n            <div nz-row  >\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Shopee Voucher' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    - {{vhAlgorithm.vhcurrencyunit(bill.seller_shipping_fee)}}\r\n                </div>\r\n            </div>\r\n            <div nz-row  >\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Shop discount code' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    - {{vhAlgorithm.vhcurrencyunit(bill.shipping_voucher_amount)}}\r\n                </div>\r\n            </div>\r\n            <div nz-row  >\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Used Shopee Coins' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    - {{bill.mobile_discount_amount}}\r\n                </div>\r\n            </div> -->\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Total payment' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end title\">\r\n                    <b>{{vhAlgorithm.vhcurrencyunit(bill.total_amount)}}</b>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div nz-col nzSpan=\"10\">\r\n            <!-- <div nz-row>\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b> {{'Payment to Shop' | translate}}:</b>\r\n                </div>\r\n            </div> -->\r\n            <!-- <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'total amount' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    {{vhAlgorithm.vhcurrencyunit(bill.sub_total)}}\r\n                </div>\r\n            </div>\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Shipping fee (excluding subsidy)' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    - {{vhAlgorithm.vhcurrencyunit(bill.seller_shipping_fee)}}\r\n                </div>\r\n            </div>\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Transaction fee' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    - {{vhAlgorithm.vhcurrencyunit(bill.mobile_discount_amount)}}\r\n                </div>\r\n            </div>  -->\r\n            <!-- <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Total payment to shop' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end title\" style=\"color: #ee2624;\">\r\n                    <b>{{vhAlgorithm.vhcurrencyunit(bill.total_amount)}}</b>\r\n                </div>\r\n            </div> -->\r\n        </div>\r\n    </div>\r\n\r\n\r\n</nz-layout>","\r\nimport { VhAlgorithm, VhEcommerce } from 'ionic-vhframeworks';\r\nimport { Router } from '@angular/router';\r\nimport { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\n\r\n@Component({\r\n  selector: 'app-detail',\r\n  templateUrl: './detail.component.html',\r\n  styleUrls: ['./detail.component.scss']\r\n})\r\nexport class DetailComponentShopee implements OnInit {\r\n  bill: any;\r\n  dataRestore: any;\r\n  heightScroll: any;\r\n  widthScroll: any;\r\n  price: number = 0;\r\n  payment_fee = 0;\r\n  infoShop: any = {}\r\n  escrowShopee: any;\r\n  constructor(\r\n    private router: Router,\r\n    private vhEcommerce: VhEcommerce,\r\n    private cdRef: ChangeDetectorRef,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    public vhComponent: VhComponent\r\n  ) {\r\n    this.bill = this.router.getCurrentNavigation().extras.state.bill;\r\n    this.dataRestore = this.router.getCurrentNavigation().extras.state.dataRestore;\r\n    this.infoShop = this.vhEcommerce.getlocalShopListShopee().find(item => item._id == this.dataRestore['id_shop_selected'])\r\n  }\r\n\r\n  async ngOnInit() {\r\n    //tính tổng tiền sp\r\n    let sub_total: number = 0\r\n    this.bill['item_list'].forEach(item => {\r\n      sub_total += (item.model_discounted_price || item.model_original_price) * item.model_quantity_purchased\r\n    })\r\n    this.bill['sub_total'] = sub_total\r\n\r\n    this.escrowShopee = await this.vhEcommerce.getEscrowShopee(this.bill.order_sn, this.infoShop.access_token, this.infoShop._id);\r\n    console.log(this.escrowShopee);\r\n    console.log(this.bill);\r\n\r\n    if(this.bill.order_status === 'CANCELLED') {\r\n      let total_discount_from_voucher_seller = 0;\r\n      let total_discount_from_voucher_shopee = 0;\r\n      let total_discount_from_coin = 0;\r\n      this.escrowShopee?.order_income?.items.forEach(item => {\r\n        total_discount_from_voucher_seller += item.discount_from_voucher_seller;\r\n        total_discount_from_voucher_shopee += item.discount_from_voucher_shopee;\r\n        total_discount_from_coin += item.discount_from_coin;\r\n      });\r\n      this.bill['total_discount_from_voucher_seller'] = total_discount_from_voucher_seller;\r\n      this.bill['total_discount_from_voucher_shopee'] = total_discount_from_voucher_shopee;\r\n      this.bill['total_discount_from_coin'] = total_discount_from_coin;\r\n    }\r\n  }\r\n\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\"#order-status-shopee\") && document.querySelector(\".order-status-shopee-header\") && document.querySelector(\"#bill-info\") && document.querySelector(\"#buyer-info\") && document.querySelector(\".ant-table-pagination\")) {\r\n      this.heightScroll = document.querySelector(\"#order-status-shopee\").clientHeight -\r\n        - document.querySelector(\".order-status-shopee-header\").clientHeight - document.querySelector(\"#bill-info\").clientHeight - document.querySelector(\"#buyer-info\").clientHeight - 90 + \"px\";\r\n    }\r\n    if (document.getElementById(\"order-status-shopee\"))\r\n      this.widthScroll = document.getElementById(\"order-status-shopee\").clientWidth + \"px\"\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n  goBack() {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods'], {\r\n      state: { dataRestore: this.dataRestore }\r\n    })\r\n  }\r\n\r\n  gotoPrint() {\r\n    this.router.navigate([\"/sales/dashboard/manage/ecommerce/shopee/print\"], {\r\n      state: {\r\n        bill: this.bill, dataRestore:\r\n          this.dataRestore,\r\n        path: this.router.url,\r\n        infoShop: this.infoShop\r\n      }\r\n    })\r\n  }\r\n}\r\n","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\n \r\n\r\n@Component({\r\n  selector: 'app-detail',\r\n  templateUrl: './detail.component.html',\r\n  styleUrls: ['./detail.component.scss']\r\n})\r\nexport class DetailComponent {\r\n  \r\n}\r\n","<bill-type1-shopee-detail></bill-type1-shopee-detail>","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-edit',\r\n  templateUrl: './edit.component.html',\r\n  styleUrls: ['./edit.component.scss']\r\n})\r\nexport class EditComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<bill-type1-shopee-edit></bill-type1-shopee-edit>","import { DatePipe } from '@angular/common';\r\nimport { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhEcommerce, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { differenceInCalendarDays } from 'date-fns';\r\nimport { VhType } from 'src/app/sales/interface/vh-type';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhSaleShopeeInvoiceAdd, VhSaleShopeeInvoiceDetail, VhSaleShopeeInvoiceDetailCombo } from 'src/app/sales/components/bill-type/bill-type-1/shopee/shopee-interface';\r\n@Component({\r\n  selector: 'app-issue-delivery-goods',\r\n  templateUrl: './issue-delivery-goods.component.html',\r\n  styleUrls: ['./issue-delivery-goods.component.scss']\r\n})\r\nexport class IssueDeliveryGoodsComponent implements OnInit {\r\n  searchValue: any;\r\n  searchProductAppValue: any = '';\r\n  salesOrder: Array<any> = [];\r\n  salesSubOrder: Array<any> = [];\r\n  heightScroll: any;\r\n  public date: Date[] = [new Date(), new Date()];\r\n  load_status: boolean = false;\r\n  dataRestore: any = {};\r\n  bill_selected: any = {};\r\n  list_status_bill: Array<any> = [\r\n    { name: \"All\", value: \"all\" },\r\n    { name: \"Wait for confirmation\", value: \"UNPAID\", value2: 'TO_CONFIRM_RECEIVE' },\r\n    { name: \"Chờ lấy hàng\", value: \"READY_TO_SHIP\" },\r\n    { name: \"Shipping\", value: \"PROCESSED\" },\r\n    { name: \"Delivered\", value: \"SHIPPED\" },\r\n    { name: \"Hoàn tất\", value: \"COMPLETED\" },\r\n    { name: \"Cancellation\", value: \"CANCELLED\" },\r\n  ];\r\n  /**Giới hạn thời gian cho xem bill */\r\n  disabledDate = (current: Date): boolean => {\r\n    if (current.getTime() < this.minDate.getTime() - 24 * 60 * 60 * 1000) return true;\r\n    return false;\r\n  };\r\n  minDate: Date = new Date(Date.now() - 24 * 60 * 60 * 1000 * 30);\r\n  infoShop: any = {};\r\n  listProductOfBranch: Array<any> = []; // sp của phần mềm có liên kết với sp shopee\r\n  listProductApp: Array<any> = []; // sp trong phần mềm chứa shopee[]\r\n  listSubProductApp: Array<any> = []; //sp của app để search\r\n  listProductShopee: Array<any> = []; // sp của shopee\r\n  id_branch: string = this.vhQuerySales.getDefaultBranch()._id;\r\n  setHeight = { \"max-height\": \"500px\", \"height\": \"500px\", \"overflow-y\": \"hidden\" };\r\n  invoice: VhSaleShopeeInvoiceAdd = {\r\n    bill_type: 1,\r\n    cqt_status: 1,\r\n    payment_type: 2,\r\n    id_customer: '',\r\n    id_branch: '',\r\n    id_employee: '',\r\n    id_wallet: 'id_cash',\r\n    date: '',\r\n    total: 0,\r\n    payment: 0,\r\n    tax: 0,\r\n    discount: 0,\r\n    fee: 0,\r\n    note: '',\r\n    price_type: 0,\r\n    order_number_ecommerce: '',\r\n    ecommerce_fee_paid_by_seller:0,\r\n    id_shop: '',\r\n    tax_buyerDisplayName: '',\r\n    tax_buyerLegalName: '',\r\n    tax_buyerTaxCode: '',\r\n    tax_buyerAddressLine: '',\r\n    tax_buyerEmail: ''\r\n  };\r\n  invoiceDetail = [];\r\n  employee: any = {};\r\n  customer: any = {};\r\n  subTotal = 0;\r\n\r\n  constructor(\r\n    private router: Router,\r\n    public lang: LanguageService,\r\n    public vhComponent: VhComponent,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhQuerySales: VhQuerySales,\r\n    private cdRef: ChangeDetectorRef,\r\n    private datePipe: DatePipe,\r\n    private vhEcommerce: VhEcommerce,\r\n    private vhAuth: VhAuth,\r\n    private nzModalService: NzModalService,\r\n  ) {\r\n    this.date[0].setHours(0, 0, 0, 0);\r\n    this.date[1].setHours(23, 59, 59, 59);\r\n    this.dataRestore = this.router.getCurrentNavigation().extras.state?.dataRestore || {};\r\n  }\r\n  ngOnInit(): void {\r\n    this.initState();\r\n  }\r\n\r\n  initState() {\r\n    if (this.dataRestore.id_shop_selected) {\r\n      this.date = this.dataRestore.date;\r\n      this.searchValue = this.dataRestore.searchValue;\r\n      this.salesOrder = this.dataRestore.salesOrder;\r\n      this.salesSubOrder = this.salesOrder;\r\n      if (this.dataRestore['update']) {\r\n        this.dataRestore['update'] = false;\r\n        this.showReport();\r\n      }\r\n      else\r\n        this.load_status = true;\r\n    }\r\n    this.infoShop = this.vhEcommerce.getlocalShopListShopee()[0];\r\n    this.getMinDate();\r\n\r\n    this.listProductOfBranch = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden).filter(item => item[this.id_branch] && item[this.id_branch].shopees && item[this.id_branch].shopees.length >= 0);\r\n    let localProducts: Array<any> = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden)\r\n\r\n    this.listProductApp = localProducts.map(item => {\r\n      let unit = this.vhQuerySales.getUnit_byRatio(item.units, 1);\r\n      if (item[this.id_branch] && item[this.id_branch].shopees && item[this.id_branch].shopees.length) { //filter những sp shopee thuộc id shopee đã chọn\r\n        item[this.id_branch].product_shopees = [...item[this.id_branch].shopees.filter(prod => prod.id_shop == this.infoShop._id)];\r\n      }\r\n      return { ...item, ...unit };\r\n    });\r\n    this.listSubProductApp = [...this.listProductApp];\r\n\r\n    this.listProductShopee = this.clearProductShow(this.vhEcommerce.getlocalProductListShopee(this.infoShop['_id']).filter(item => item.item_status == 'NORMAL'), this.listProductApp);\r\n  }\r\n\r\n\r\n  /**\r\n   * Lấy ngày giới hạn được xem báo cáo\r\n  */\r\n  getMinDate() {\r\n    let date = new Date(Date.now() - 24 * 60 * 60 * 1000 * 100);\r\n    this.vhQuerySales.getValidityDate(date).then((validitydate: Date) => {\r\n      this.minDate = validitydate;\r\n      if ((this.minDate.getTime()) < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n        this.disabledDate = (current: Date): boolean => {\r\n          if (current.getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime() - 24 * 60 * 60 * 1000) return true;\r\n          return false;\r\n        };\r\n      }\r\n    });\r\n  }\r\n  /**Tìm kiếm hóa đơn */\r\n  search(value: string) {\r\n    let val: string = this.vhAlgorithm.changeAlias(value.trim().toLowerCase());\r\n    this.salesOrder = this.vhAlgorithm.searchList(val, [...this.salesSubOrder], ['order_sn']);\r\n  }\r\n\r\n  /**\r\n   * search tên sản phẩm trong app viethas\r\n   * @example this.search('Sản phẩm A')\r\n   */\r\n  searchProductApp(value: string) {\r\n    let val: string = this.vhAlgorithm.changeAlias(value.trim().toLowerCase());\r\n    this.listProductApp = this.vhAlgorithm.searchList(val, [...this.listSubProductApp],  ['name','barcode','item_code']);\r\n  }\r\n  goBack() {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/shopee/issue-invoice'], {\r\n      state: { dataRestore: this.dataRestore }\r\n    });\r\n  }\r\n  changeTime(event) {\r\n    if (event[1].getTime() - event[0].getTime() <= 1209600000) {\r\n    } else {\r\n      this.vhComponent.showToast(2000, this.lang.translate(\"Thời gian xem không quá 15 ngày\"), \"alert-toast\");\r\n      this.date = [event[0], new Date(event[0].getTime() + 1209600000)];\r\n    }\r\n  }\r\n  showReport() {\r\n    this.load_status = true;\r\n    this.salesOrder = [];\r\n    this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n      this.vhEcommerce.getSalesOrderListShopee(new Date(this.datePipe.transform(new Date(this.date[0].setHours(0, 0, 0)), \"yyyy-MM-dd HH:mm:ss\").toString()), new Date(this.datePipe.transform(new Date(this.date[1].setHours(23, 59, 59)), \"yyyy-MM-dd HH:mm:ss\").toString()), this.infoShop.access_token.toString(), this.infoShop._id.toString())\r\n        .then((result: any) => {\r\n          this.vhComponent.hideLoading(0);\r\n          result.forEach(item => {\r\n            if (item.verify_status_delivered_goods)\r\n              this.salesOrder.push({ ...item, create_at: new Date(item.create_time * 1000) });\r\n          });\r\n          this.salesSubOrder = [...this.salesOrder];\r\n        })\r\n        .catch(err => this.vhComponent.hideLoading(0));\r\n    });\r\n  }\r\n  changeShop(event) { }\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\"#shopee-issue-invoice\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".shopee-issue-invoice-header\") && document.querySelector(\".ant-table-pagination\")) {\r\n      this.heightScroll = document.querySelector(\"#shopee-issue-invoice\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".shopee-issue-invoice-header\").clientHeight - 90 + \"px\";\r\n    }\r\n\r\n    this.cdRef.detectChanges();\r\n  }\r\n  gotoCreateBill(bill: any) {\r\n    //tìm customer để loại trừ bug khách hàng bị xóa rồi\r\n    let customer: any = this.vhQuerySales.getlocalCustomer(this.infoShop.data?.id_customer);\r\n    if (customer) {\r\n      this.router.navigate(['/sales/dashboard/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/add'], {\r\n        state: { dataRestore: { ...this.dataRestore, searchValue: this.searchValue, id_shop_selected: this.infoShop._id, date: this.date, salesOrder: this.salesOrder }, billShopee: bill }\r\n      });\r\n    } else this.vhComponent.alertMessageDesktop('warning', this.lang.translate('Please update customer in settings'));\r\n  }\r\n  gotoDetail(bill: any) {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/detail'], {\r\n      state: { dataRestore: { ...this.dataRestore, searchValue: this.searchValue, id_shop_selected: this.infoShop._id, date: this.date, salesOrder: this.salesOrder }, id: bill.id_bill_delivered_goods, billShopee: bill }\r\n    });\r\n  }\r\n  gotoDetailShopee(bill) {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/shopee/issue-invoice/issue-delivery-goods/detail-shopee'],\r\n      {\r\n        state: {\r\n          bill: bill,\r\n          dataRestore: {\r\n            salesOrder: this.salesOrder, searchValue: this.searchValue,\r\n            id_shop_selected: this.infoShop._id, listProduct: this.dataRestore.listProduct,\r\n            date: this.date,\r\n            salesSubOrder: this.salesSubOrder,\r\n          }\r\n        }\r\n      });\r\n  }\r\n\r\n  findProductLinked(item) {\r\n    for (let productOfBranch of this.listProductOfBranch) {\r\n      const shopees = productOfBranch[this.id_branch]?.shopees || [];\r\n\r\n      const found = shopees.find(data => {\r\n        if (data.item_id !== item.item_id) return false;\r\n\r\n        if (data.model?.length && item.model_id !== 0) {\r\n          return data.model.some(model => model.model_id === item.model_id);\r\n        }\r\n\r\n        return data.model?.length ? false : true;\r\n      });\r\n\r\n      if (found) {\r\n        return productOfBranch;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Kiểm tra sản phẩm đã được lien kết hay chưa\r\n   *\r\n   */\r\n  isLinkedToProduct(item): boolean {\r\n    for (let productOfBranch of this.listProductOfBranch) {\r\n      let findProduct = productOfBranch[this.id_branch].shopees.find(data => data.item_id == item.item_id);\r\n      if (findProduct) {\r\n        if (findProduct.model && findProduct.model.length && item.model_id != 0) {\r\n          let indexModel = findProduct.model.findIndex(model => model.model_id == item.model_id);\r\n          if (indexModel >= 0) {\r\n            return true;\r\n          }\r\n        } else {\r\n          return true;\r\n        }\r\n      }\r\n    };\r\n    return false;\r\n  }\r\n\r\n  toggleSelectAll(checked: boolean) {\r\n    this.checkAll = checked;\r\n    this.listInvoiceSelected = []; // reset before adding\r\n\r\n    for (let bill of this.salesOrder) {\r\n      const canSelect = !bill.id_bill_delivered_goods && this.billIsLinkedToProduct(bill);\r\n\r\n      if (canSelect) {\r\n        this.selectedBills[bill.order_sn] = checked;\r\n\r\n        if (checked) {\r\n          this.listInvoiceSelected.push(bill);\r\n        }\r\n      } else {\r\n        // ensure unselect disabled ones\r\n        this.selectedBills[bill.order_sn] = false;\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  billIsLinkedToProduct(bill) {\r\n    return bill.item_list.every(item => this.isLinkedToProduct(item));\r\n  }\r\n\r\n\r\n  checkAll: boolean = false;\r\n  selectedBills: { [id: string]: boolean; } = {};\r\n  listInvoiceSelected = [];\r\n\r\n  checkBillToCreateInvoice(bool, bill) {\r\n    this.selectedBills[bill.order_sn] = bool;\r\n    if (bool) {\r\n      this.listInvoiceSelected.push(bill);\r\n    }\r\n    else {\r\n      this.listInvoiceSelected = this.listInvoiceSelected.filter(item => item.order_sn != bill.order_sn);\r\n    }\r\n\r\n    const allBillsCanSelect = this.salesOrder.filter(\r\n      b => !b.id_bill_delivered_goods && this.billIsLinkedToProduct(b)\r\n    );\r\n\r\n    this.checkAll = allBillsCanSelect.every(b => this.selectedBills[b.order_sn]);\r\n  }\r\n\r\n  visible_affiliate: boolean = false;\r\n  productShopeeSelected: any = null;\r\n\r\n  openModelSelectProductsShopee(productShopee) {\r\n    this.productShopeeSelected = productShopee;\r\n    this.visible_affiliate = true;\r\n  }\r\n\r\n  /**\r\n   * Tắt modal và clone mảng product ra một mảng mới để tránh nhớ lại product cũ bị checked\r\n   */\r\n  cancelAffiliate() {\r\n    this.visible_affiliate = false;\r\n  }\r\n\r\n  /**\r\n   * Liên kết sản phẩm từ shopee với sản phẩm tại cửa hàng.\r\n   * @param product Sản phẩm của cửa hàng\r\n   */\r\n  acceptAfiliate(product) {\r\n    const isZeroPriceCombo = product.type === VhType.COMBO && product.units[0].price === 0;\r\n    const confirmZeroPriceComboMessage = this.lang.translate(\"This product is a combo with a price of 0. Do you still want to link it with the product\", {platform : 'Shopee'}) + \"?\";\r\n    this.nzModalService.confirm({\r\n      nzTitle: '<i>' + (isZeroPriceCombo ? confirmZeroPriceComboMessage : this.lang.translate(\"Confirm\")) + '</i>',\r\n      nzIconType: \"info-circle\",\r\n      nzCancelText: this.lang.translate(\"Cancel\"),\r\n      nzOnOk: () => {\r\n        this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n          // Tìm sản phẩm shopee\r\n          const currentProductShopee = this.listProductShopee.find(item => item.item_id == this.productShopeeSelected.item_id);\r\n          const id_product_selected = product.id_subproduct ? product.id_subproduct : product['_id'];\r\n\r\n          if (!currentProductShopee) {\r\n            this.vhComponent.hideLoading().then(() => {\r\n              this.vhComponent.alertMessageDesktop('error', this.lang.translate(\"The product link failed\"));\r\n            });\r\n            return;\r\n          }\r\n\r\n          let productShopee = {\r\n            item_id: this.productShopeeSelected.item_id,\r\n            models: []\r\n          };\r\n\r\n          // Nếu sản phẩm shopee có model thì thêm vào mảng\r\n          if (currentProductShopee && currentProductShopee.has_model) {\r\n            const model = currentProductShopee.model.find(item => item.model_id == this.productShopeeSelected.model_id);\r\n            productShopee.models.push(model);\r\n          }\r\n\r\n          this.vhEcommerce.addMergeShopeesProduct_model(this.vhQuerySales.getlocalDetailProduct(id_product_selected), productShopee.item_id, productShopee.models, this.infoShop['_id'], this.id_branch).then((bool) => {\r\n            this.vhComponent.hideLoading().then(() => {\r\n              setTimeout(() => {\r\n                this.visible_affiliate = false;\r\n                this.listProductOfBranch = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden).filter(item => item[this.id_branch] && item[this.id_branch].shopees && item[this.id_branch].shopees.length >= 0);\r\n                this.vhComponent.alertMessageDesktop('success', this.lang.translate(\"Product linked successfully\"));\r\n              }, 300);\r\n            });\r\n          }).catch(err => {\r\n            console.error(err);\r\n            this.visible_affiliate = false;\r\n            this.vhComponent.alertMessageDesktop('error', this.lang.translate(\"The product link failed\"));\r\n            this.vhComponent.hideLoading(0);\r\n          });\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**Xóa những sp đã được liên kết rồi ra khỏi mảng của modal danh sách sp liên kết\r\n   * @example this.clearProductShow(listProductShopee, listProductApp)\r\n   */\r\n  clearProductShow(listProduct, listProductApp) {\r\n    for (let prodApp of listProductApp) {\r\n      if (prodApp[this.id_branch] && prodApp[this.id_branch].shopees && prodApp[this.id_branch].shopees.length) {\r\n        let arrayProdShopee = prodApp[this.id_branch].shopees;\r\n        for (let item of arrayProdShopee) {\r\n          let indexProd = listProduct.findIndex(prod => prod.item_id == item.item_id);\r\n          if (indexProd >= 0) {\r\n            if (listProduct[indexProd].model && item.model && item.model.length) {\r\n              for (let model of item.model) {\r\n                let index = listProduct[indexProd].model.findIndex(data => data.model_id == model?.model_id);\r\n                if (index >= 0) listProduct[indexProd].model.splice(index, 1);\r\n              }\r\n              if (!listProduct[indexProd].model.length) listProduct.splice(indexProd, 1);\r\n            } else listProduct.splice(indexProd, 1);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return listProduct;\r\n  }\r\n\r\n  payInvoice() {\r\n    this.vhComponent.alertConfirm(\r\n      `${this.lang.translate(\"Pay\")}?`,\r\n      \"\", \"\", \"OK\", this.lang.translate(\"Cancel\")\r\n    )\r\n      .then(() => {\r\n        this.vhComponent.showLoading(\"\", \"transparent-loading\").then(async () => {\r\n          const updatePromises = [];\r\n\r\n          for (let index = 0; index < this.listInvoiceSelected.length; index++) {\r\n            const billShopee = this.listInvoiceSelected[index];\r\n            await this.initBill(billShopee);\r\n\r\n            const promise = this.createOrUpdate(1).then((bill: any) => {\r\n              this.salesOrder.find(item => item.order_sn == billShopee['order_sn']).id_bill_delivered_goods = bill._id;\r\n              if (this.invoice.cqt_status !== 1) {\r\n                this.vhQuerySales.updateBill(bill._id, { cqt_status: this.invoice.cqt_status });\r\n              }\r\n              return this.vhEcommerce.updateSalesOrderShopee(this.infoShop._id, billShopee['order_sn'].toString(), { id_bill_delivered_goods: bill._id });\r\n            });\r\n\r\n            updatePromises.push(promise.catch(err => {\r\n              this.vhComponent.showToast(2000, err);\r\n              return null;\r\n            }));\r\n          }\r\n\r\n          // Wait for all promises to resolve (or reject caught above)\r\n          Promise.all(updatePromises).then(() => {\r\n            this.vhComponent.hideLoading(0).then(() => {\r\n              this.vhComponent.showToast(2000,\r\n                `${this.lang.translate(\"Issue invoice\")} ${this.lang.translate(\"Successfully\").toLocaleLowerCase()}`, \"success-toast\"\r\n              );\r\n            });\r\n          });\r\n        });\r\n      }, () => { });\r\n\r\n    // }\r\n    // else this.vhComponent.showToast(1500, this.languageService.translate('You do not have this rights'), \"alert-toast\")\r\n  }\r\n\r\n  createOrUpdate(bill_type: 1) {\r\n    return new Promise((resolve, reject) => {\r\n      this.vhQuerySales.createBill_Billdetail({ ...this.invoice }, this.getCreateUpdateInvoiceDetail()).then(res => resolve(res)).catch(err => reject(err));\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Thêm sản phẩm đã bán vào cart\r\n   * Sản phẩm này là sp đã bán trên sàn\r\n   */\r\n  addInvoiceDetail(item_list: Array<any>) {\r\n    let products: Array<any> = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden).filter(item => item[this.id_branch] && item[this.id_branch].shopees && item[this.id_branch].shopees.length >= 0);\r\n    for (let item of item_list) {\r\n      let findSuccess: boolean = false;\r\n      for (let productOfBranch of products) {\r\n        let findProduct = productOfBranch[this.id_branch].shopees.find(data => data.item_id == item.item_id);\r\n        if (findProduct) {\r\n\r\n          if (findProduct.model && findProduct.model.length && item.model_id != 0) {\r\n            let indexModel = findProduct.model.findIndex(model => model.model_id == item.model_id);\r\n            if (indexModel >= 0) {\r\n              this.addInvoiceDetailShopee(item.model_discounted_price, item.model_original_price, item.model_quantity_purchased, productOfBranch, true);\r\n              findSuccess = true;\r\n              break;\r\n            }\r\n          } else {\r\n            this.addInvoiceDetailShopee(item.model_discounted_price, item.model_original_price, item.model_quantity_purchased, productOfBranch, true);\r\n            findSuccess = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      if (!findSuccess) {\r\n        this.addInvoiceDetailShopee(item.model_discounted_price, item.model_original_price, item.model_quantity_purchased, { name: item.item_name }, false);\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   *\r\n   * @param price\r\n   * @param product\r\n   * @param exist\r\n   * @example addInvoiceDetailShopee(price_on_shopee, product, false)\r\n   */\r\n  addInvoiceDetailShopee(price, price_origin, quantity, product, exist) {\r\n    if (exist) {\r\n      const productToAdd = {\r\n        name: product.name,\r\n        id_product: product._id,\r\n        quantity: quantity,\r\n        ptype: product.type,\r\n        unit: product.unit,\r\n        ratio: 1,\r\n        units: product.units,\r\n        price: price,\r\n        price_origin: price_origin || 0,\r\n        id_subproduct: product.id_subproduct,\r\n        lots: product.lots,\r\n        id_lotproduct: product.id_lotproduct,\r\n        free: false, //nếu có trường này true thì được quyền chỉnh số lượng\r\n      }\r\n      if(product.type == VhType.COMBO) {\r\n        productToAdd['combos'] = product.combos;\r\n      }\r\n      this.invoiceDetail.unshift(productToAdd);\r\n    } else {\r\n      this.invoiceDetail.unshift({\r\n        id_product: null,\r\n        quantity: quantity,\r\n        price: price,\r\n        ptype: 1,\r\n        ratio: 1,\r\n        name: product.name\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n     * trả về danh sách bill_detail đã format theo đúng chuẩn các trường để lưu DB\r\n     * @returns array bill_detail\r\n     * @example let bill_details = getCreateUpdateInvoiceDetail()\r\n     */\r\n  getCreateUpdateInvoiceDetail(): VhSaleShopeeInvoiceDetail[] {\r\n    return this.invoiceDetail.map(item => {\r\n\r\n      let detail: VhSaleShopeeInvoiceDetail = {\r\n        id_product: item.id_product,\r\n        ptype: item.ptype,\r\n        price: item.price,\r\n        quantity: item.quantity,\r\n        ratio: item.ratio,\r\n        price_origin: item.price_origin,\r\n      };\r\n      if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct;\r\n      if (item.id_subproduct) detail['id_subproduct'] = item.id_subproduct;\r\n\r\n      if (item.ptype == 5) {\r\n        detail['combos'] = item.combos.map(combo => {\r\n          let product: VhSaleShopeeInvoiceDetailCombo = {\r\n            id_product: combo.id_product,\r\n            price: combo.price,\r\n            quantity: combo.quantity,\r\n            ptype: combo.ptype || combo.type,\r\n            ratio: combo.ratio ? combo.ratio : 1,\r\n          };\r\n          if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct;\r\n          if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct;\r\n          return product;\r\n        });\r\n      }\r\n      return detail;\r\n\r\n    }).filter(item => item);\r\n\r\n  }\r\n  pickerTime = new Date();\r\n\r\n  async initBill(billShopee) {\r\n    this.resetInvoice();\r\n    const escrowShopee: any = await this.vhEcommerce.getEscrowShopee(billShopee.order_sn, this.infoShop.access_token, this.infoShop._id)\r\n    console.log('escrowShopee', escrowShopee);\r\n    this.invoice.date = this.pickerTime.toISOString();\r\n    this.invoice.id_employee = this.vhAuth.getUser()._id;\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    this.invoice.id_branch = (this.vhQuerySales.getDefaultBranch()._id);\r\n    this.invoice.id_customer = (this.vhEcommerce.getlocalShopListShopee().find(item => item._id == this.infoShop._id).data.id_customer);\r\n    this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n    this.invoice.payment_type = (2); //set bill công nợ\r\n    this.addInvoiceDetail(billShopee.item_list);\r\n\r\n    this.invoice.discount = escrowShopee.order_income.voucher_from_seller || 0;\r\n    this.invoice.fee = escrowShopee.order_income.actual_shipping_fee - escrowShopee.order_income.shopee_shipping_rebate;\r\n    this.invoice.ecommerce_fee_paid_by_seller = escrowShopee.order_income.seller_transaction_fee + escrowShopee.order_income.shipping_seller_protection_fee_amount + escrowShopee.order_income.commission_fee;\r\n    this.invoice.order_number_ecommerce = (billShopee['order_sn'].toString());\r\n    this.invoice.id_shop = (this.infoShop._id);\r\n    this.invoice.note = (`${this.lang.translate(\"Order number\")} Shopee ${billShopee.order_sn}`);\r\n    this.invoice.tax_buyerDisplayName = this.invoice.tax_buyerDisplayName ? this.invoice.tax_buyerDisplayName : 'Người mua không lấy hóa đơn';\r\n    this.invoice.cqt_status = billShopee.cqt_status ? billShopee.cqt_status : 1;\r\n    this.setSubTotal();\r\n  }\r\n\r\n  /**\r\n   * tính và gán lại cộng tiền (subTotal) của đơn\r\n   * @example this.setSubTotal()\r\n   */\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      subTotal += (i.price ? i.price * i.quantity : 0);\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal();\r\n  }\r\n\r\n  /**\r\n   * tính và gán lại tổng tiền (total) của đơn\r\n   * @example this.setTotal()\r\n   */\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee > 0 ? this.subTotal - this.invoice.discount + this.invoice.fee : 0;\r\n  }\r\n\r\n  resetInvoice() {\r\n    this.invoice = {\r\n      bill_type: 1,\r\n      cqt_status: 1,\r\n      payment_type: 2,\r\n      id_customer: '',\r\n      id_branch: '',\r\n      id_employee: '',\r\n      ecommerce_fee_paid_by_seller: 0,\r\n      id_wallet: 'id_cash',\r\n      date: '',\r\n      total: 0,\r\n      payment: 0,\r\n      tax: 0,\r\n      discount: 0,\r\n      fee: 0,\r\n      note: '',\r\n      price_type: 0,\r\n      order_number_ecommerce: '',\r\n      id_shop: '',\r\n      tax_buyerDisplayName: '',\r\n      tax_buyerLegalName: '',\r\n      tax_buyerTaxCode: '',\r\n      tax_buyerAddressLine: '',\r\n      tax_buyerEmail: ''\r\n    };\r\n    this.invoiceDetail = [];\r\n  }\r\n  \r\n  \r\n  \r\n  /**\r\n   * Đếm số lượng bill đang check\r\n   */\r\n  get countSelectedBill(): number {\r\n    let count = 0;\r\n    for (let key in this.selectedBills) {\r\n      if (this.selectedBills[key]) {\r\n        count++;\r\n      }\r\n    }\r\n    return count;\r\n  }\r\n  \r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{'Back' | translate}}\r\n</div>\r\n<nz-layout id=\"shopee-issue-invoice\">\r\n    <div nz-row nzGutter=\"4\" class=\"shopee-issue-invoice-header\">\r\n        <div nz-col nzSpan=\"8\" class=\"title\">\r\n            <b>{{'Goods delivered'|translate}}</b> <br>\r\n            {{'Shop name' | translate}} : <b class=\"color-green\">{{infoShop.data?.name}}</b>\r\n        </div>\r\n\r\n        <div nz-col nzSpan=\"6\" class=\"title center-all-content\">\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input [(ngModel)]=\"searchValue\" (ngModelChange)=\"search($event)\" type=\"text\" nz-input\r\n                    placeholder=\"{{('Search for order code' | translate)}}\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <div nz-col nzSpan=\"6\">\r\n             <nz-range-picker nzFormat='dd/MM/yyyy'  [nzDisabledDate]=\"disabledDate\" [(ngModel)]=\"date\" (ngModelChange)=\"changeTime($event)\">\r\n            </nz-range-picker>\r\n        </div>\r\n        <div nz-col nzSpan=\"4\" class=\"right-all-content\">\r\n            <div style=\"display: flex; gap: 4px;\">\r\n                <button class=\"btn-view center-all-content\" nz-button nzType=\"default\" (click)=\"showReport()\">\r\n                    <ion-icon src=\"assets/icon/management/view.svg\"></ion-icon>\r\n                    {{'View' | translate}}\r\n                </button>\r\n                <button [disabled]=\"this.listInvoiceSelected.length == 0\" (click)=\"payInvoice()\" nz-button class=\"btn-green\">{{\"Create bulk invoices\" | translate}}</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"load_status else no_data\" nz-row nzGutter=\"16\" class=\"shopee-issue-invoice-body\">\r\n        <div nz-col nzSpan=\"24\">\r\n            <nz-table [nzPageSize]=\"20\" [nzPageSizeOptions]=\"[20, 30, 40, 50, 100, 200]\"\r\n                *ngIf=\"salesOrder.length > 0;else no_bill\" [nzScroll]=\"{y: heightScroll }\" #salesOrder_show\r\n                nzShowPagination nzShowSizeChanger [nzData]=\"salesOrder\">\r\n                <thead>\r\n                    <tr>\r\n                        <th style=\"text-align: center;\" nzWidth=\"8%\"><b>{{'No.' | translate}}</b></th>\r\n                        <th nzWidth=\"17%\"><b>{{'Date' | translate}}</b></th>\r\n                        <th nzWidth=\"20%\"><b>{{'Order number' | translate}}</b></th>\r\n                        <th nzWidth=\"20%\"><b>{{'Product' | translate}}</b></th>\r\n                        <th nzWidth=\"20%\"><b>{{\"Status on Shopee\" | translate}}</b></th>\r\n                        <th style=\"text-align: right;\" nzWidth=\"15%\"><b>{{\"Total\"| translate}}</b></th>\r\n                        <th nzAlign=\"center\" nzWidth=\"20%\"><b>{{\"Invoice\" | translate}}</b></th>\r\n                        <th nzAlign=\"center\" nzWidth=\"10%\">\r\n                            ({{countSelectedBill}})\r\n                            <b>{{\"Select\" | translate}}</b>\r\n                            <label style=\"margin-left: 8px;\" class=\"product-item-checkbox\" nz-checkbox [(ngModel)]=\"checkAll\" (ngModelChange)=\"toggleSelectAll($event)\"></label>\r\n                        </th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr (click)=\"gotoDetailShopee(bill)\" *ngFor=\"let bill of salesOrder_show.data;let i =index\"\r\n                        style=\"cursor: pointer;\">\r\n                        <td style=\"text-align: center;\">{{i+1}}</td>\r\n                        <td>\r\n                            {{bill.create_at | date : \"dd/MM/yyyy HH:mm\"}}</td>\r\n                        <td nzLeft> {{bill.order_sn}} <i\r\n                                (click)=\"$event.stopPropagation();vhComponent.copyValue(bill.order_sn)\" nz-icon\r\n                                nzType=\"copy\" nzTheme=\"outline\"></i>\r\n                        </td>\r\n\r\n                        <td><span\r\n                                style=\"font-size: 0.8rem;\"\r\n                                [style.color]=\"isLinkedToProduct(item) ? '' : 'var(--ion-color-vh-red)'\"\r\n                                *ngFor=\"let item of bill.item_list\">{{isLinkedToProduct(item) ? findProductLinked(item)?.name : item.item_name}}\r\n                                (SL :{{item.model_quantity_purchased}}) <i *ngIf=\"!isLinkedToProduct(item)\" (click)=\"$event.stopPropagation();openModelSelectProductsShopee(item)\" class=\"icon-link green\" nz-icon nzType=\"link\" nzTheme=\"outline\"></i>\r\n                                <br>\r\n                            </span>\r\n                        </td>\r\n                        <td>\r\n                            <span>{{bill.order_status | translate}}</span>\r\n                        </td>\r\n                        <td style=\"text-align: right;\">\r\n                            <b>{{vhAlgorithm.vhcurrencyunit(bill.total_amount)}}</b>\r\n                        </td>\r\n                        <td nzAlign=\"center\">\r\n                            <span (click)=\"$event.stopPropagation();gotoCreateBill(bill)\" class=\"invoice-create\"\r\n                                *ngIf=\"!bill.id_bill_delivered_goods\">\r\n                                <b>{{\"Create invoice\" |translate}}</b>\r\n                            </span>\r\n                            <span (click)=\"$event.stopPropagation();gotoDetail(bill)\" class=\"invoice-view\"\r\n                                *ngIf=\"bill.id_bill_delivered_goods\"><b>{{\"View invoice\" | translate}}</b></span>\r\n                        </td>\r\n                        <td nzAlign=\"center\">\r\n                            <label\r\n                                *ngIf=\"!bill.id_bill_delivered_goods ? billIsLinkedToProduct(bill) : false\"\r\n                                [ngModel]=\"selectedBills[bill.order_sn]\"\r\n                                (ngModelChange)=\"checkBillToCreateInvoice($event,bill)\"\r\n                                class=\"product-item-checkbox\" nz-checkbox>\r\n                            </label>\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </nz-table>\r\n\r\n        </div>\r\n    </div>\r\n    <ng-template #no_bill class=\"full-height\">\r\n        <div *ngIf=\"load_status\" nz-col nzSpan=\"24\" style=\"height: 60vh;\" class=\"center-all-content\">\r\n            <div>{{'No data'| translate}}</div>\r\n        </div>\r\n    </ng-template>\r\n    <ng-template #no_data>\r\n        <div nz-row class=\"no-affiliate\">\r\n            <div nz-col nzSpan=\"24\" class=\"text-center\">\r\n                <img src=\"assets/icon/management/ecommerce/no-data-orderstatus.svg\" alt=\"\">\r\n                <p>{{\"Please click the view button\"|translate}}\r\n                </p>\r\n            </div>\r\n        </div>\r\n    </ng-template>\r\n    <ng-template #updateForControl let-params>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"24\">\r\n                <span>{{\"Date\"| translate}}: </span>\r\n                <nz-date-picker nzFormat=\"dd/MM/yyyy\" style=\"margin-left:20px\" [(ngModel)]=\"bill_selected.date_control\">\r\n                </nz-date-picker>\r\n            </div>\r\n        </div>\r\n    </ng-template>\r\n</nz-layout>\r\n\r\n\r\n<!-- --------------modal chọn sản phẩm liên kết--------------- -->\r\n<app-modal-link-product-ecommerce\r\n    [title]=\"'Select Shopee linked products' | translate\"\r\n    [visible_affiliate]=\"visible_affiliate\"\r\n    [listProductApp]=\"listProductApp\"\r\n    [searchProductAppValue]=\"searchProductAppValue\"\r\n    (cancelAffiliate)=\"cancelAffiliate()\"\r\n    (searchProductApp)=\"searchProductApp($event)\"\r\n    (acceptAfiliate)=\"acceptAfiliate($event)\"\r\n></app-modal-link-product-ecommerce>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { IssueDeliveryGoodsComponent } from './issue-delivery-goods.component';\r\nimport { AddComponent } from './add/add.component';\r\nimport { DetailComponent } from './detail/detail.component';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { NgZorroAntModule } from 'src/app/ng-zorro-ant.module';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { DetailComponentShopee } from './detailShopee/detail.component';\r\nimport { SearchModule } from 'src/app/sales/components/search/search.module';\r\nimport { EditComponent } from './edit/edit.component';\r\nimport { BillType1ShopeeModule } from 'src/app/sales/components/bill-type/bill-type-1/shopee/bill-type1-shopee.module';\r\nimport { ModalLinkProductEcommerceModule } from 'src/app/sales/menu/manage/ecommerce/components/modal-link-product-ecommerce/modal-link-product-ecommerce.module';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: \"\",\r\n    component: IssueDeliveryGoodsComponent\r\n  },\r\n  {\r\n    path: \"add\",\r\n    component: AddComponent\r\n  },\r\n  {\r\n    path: \"edit\",\r\n    component: EditComponent\r\n  },\r\n  {\r\n    path: \"detail\",\r\n    component: DetailComponent\r\n  },\r\n  {\r\n    path: \"detail-shopee\",\r\n    component: DetailComponentShopee\r\n  }\r\n]\r\n\r\n@NgModule({\r\n  declarations: [IssueDeliveryGoodsComponent, AddComponent, DetailComponent, DetailComponentShopee, EditComponent],\r\n  imports: [\r\n    CommonModule,\r\n    RouterModule.forChild(routes),\r\n    NgZorroAntModule,\r\n    TranslateModule,\r\n    IonicModule,\r\n    FormsModule,\r\n    BillType1ShopeeModule,\r\n    ModalLinkProductEcommerceModule\r\n  ]\r\n})\r\nexport class IssueDeliveryGoodsModule { }\r\n"],"names":["SalesK57Col3Component","SalesK80Col3Component","SalesK80Col4Component","SalesA5Component","SalesA4Component","VhType","i0","ctx_r2","ctx_r6","AddComponent","constructor","router","vhComponent","languageService","vhQuerySales","vhAlgorithm","vhAuth","fncService","nzModalService","cdf","vhEcommerce","bill_type","cqt_status","payment_type","id_customer","id_branch","id_employee","id_wallet","date","total","payment","tax","discount","fee","note","price_type","order_number_ecommerce","ecommerce_fee_paid_by_seller","id_shop","tax_buyerDisplayName","tax_buyerLegalName","tax_buyerTaxCode","tax_buyerAddressLine","tax_buyerEmail","getCurrentNavigation","extras","state","dataRestore","billShopee","Date","getDefaultBranch","_id","getLocalAppSettingNameBranch","warning_lot_expried","initBill","infoShop","getlocalShopListShopee","find","item","id_shop_selected","escrowShopee","getEscrowShopee","order_sn","access_token","invoice","pickerTime","toISOString","getUser","employee","getlocalEmployee","data","customer","getlocalCustomer","addInvoiceDetail","item_list","setSubTotal","order_income","voucher_from_seller","actual_shipping_fee","shopee_shipping_rebate","seller_transaction_fee","shipping_seller_protection_fee_amount","commission_fee","toString","translate","invoiceDetail","id_product","validProdDetail","subTotal","i","price","quantity","setTotal","detectChanges","ngOnInit","eventKeypress","printer","getLocalPrintPage","checkPrinter","print_sizes","findIndex","e","print_size_default","enable","waitingStack","then","discount_price","vhnumeral","invoice_fee","ngOnDestroy","document","removeEventListener","event","window","closerBrower","keycode","keyCode","preventDefault","payInvoice","searchProductList","returnValue","addEventListener","goBack","alertConfirm","isExit","navigate","closeAndReceiveEmployee","setPickerTime","getTime","getStore","registrationdate","alertMessageDesktop","formatDate","getValidityDate","validitydate","editDiscount","getRawValue","parseFloat","getElementById","editFee","compareSubTotal","sub","reduce","prev","next","getCreateUpdateInvoiceDetail","map","detail","ptype","ratio","price_origin","id_lotproduct","id_subproduct","combos","combo","product","type","filter","print","save_enable","showLoading","createOrUpdate","bill","updateBill","update","updateSalesOrderShopee","id_bill_delivered_goods","hideLoading","showToast","toLocaleLowerCase","handlePrint","handle","catch","err","Promise","resolve","reject","createBill_Billdetail","Object","res","checkPrint","rejects","renderPrintPage","showModal","invoice_detail","modal","onWillDismiss","checkDeactivate","currentRoute","currentState","nextState","url","closeSearchProductList","manylot","openModalChooseLot","lots","length","tempDetail","show_modal_select_lots_combo","addInvoiceDetailExtraEcommerce","value","index","name","unit","units","id_category","free","subComboName","unshift","checkQuantityProduct","MIN_PRICE","oldQuantity","oldPrice","originalTotal","newQuantity","newPrice","openEditUnitPrice","isVisibleEditUnitPrice","unit_price","handleEditUnit","deleteGoods","removeInvoiceDetail","id","splice","products","getlocalDetailProducts","delete_hidden","shopees","findSuccess","productOfBranch","findProduct","item_id","model","model_id","indexModel","addInvoiceDetailShopee","model_discounted_price","model_original_price","model_quantity_purchased","item_name","exist","productToAdd","COMBO","getUnit","getUnit_byRatio","getLotNumber","lot","lot_number","searchLot","searchList","changeAlias","list_search_lot","show_modal_select_lots","changeLot","handleChooseLot","lot_select","date_exp","confirm","nzTitle","nzOnOk","nzOnCancel","handleCancelChooseLot","handleChooseLotCombo","onClose","isOpenModalTaxCustomer","onOkEditTax","customerTaxInfo","assign","selectors","decls","vars","consts","template","ctx","EditComponent","pmtype","checkMyPermission","updateBill_Billdetail","order_items","reason","freeShipMax","paymet_fee","order_item","item_price","voucher_seller","shipping_amount","toFixed","productApp","productShopee","findProd","skus","sku","SkuId","sku_id","shipping_fee_discount_seller","ctx_r9","ctx_r11","ctx_r3","ctx_r19","DetailComponentShopee","cdRef","sub_total","forEach","console","log","order_status","total_discount_from_voucher_seller","total_discount_from_voucher_shopee","total_discount_from_coin","_a","_b","items","discount_from_voucher_seller","discount_from_voucher_shopee","discount_from_coin","ngAfterViewChecked","querySelector","heightScroll","clientHeight","widthScroll","clientWidth","gotoPrint","path","$event","ctx_r35","_r3","IssueDeliveryGoodsComponent","lang","datePipe","value2","current","minDate","now","setHours","initState","searchValue","salesOrder","salesSubOrder","showReport","load_status","getMinDate","listProductOfBranch","localProducts","listProductApp","product_shopees","prod","listSubProductApp","listProductShopee","clearProductShow","getlocalProductListShopee","item_status","disabledDate","search","val","trim","toLowerCase","searchProductApp","changeTime","getSalesOrderListShopee","transform","result","verify_status_delivered_goods","push","create_at","create_time","changeShop","gotoCreateBill","gotoDetail","gotoDetailShopee","listProduct","findProductLinked","found","some","isLinkedToProduct","toggleSelectAll","checked","checkAll","listInvoiceSelected","canSelect","billIsLinkedToProduct","selectedBills","every","checkBillToCreateInvoice","bool","allBillsCanSelect","b","openModelSelectProductsShopee","productShopeeSelected","visible_affiliate","cancelAffiliate","acceptAfiliate","isZeroPriceCombo","confirmZeroPriceComboMessage","platform","nzIconType","nzCancelText","currentProductShopee","id_product_selected","models","has_model","addMergeShopeesProduct_model","getlocalDetailProduct","setTimeout","error","prodApp","arrayProdShopee","indexProd","updatePromises","promise","all","resetInvoice","countSelectedBill","count","key","_r5"],"sourceRoot":"webpack:///"}