{"version":3,"file":"src_app_sales_menu_manage_ecommerce_tiki_issue-invoice_issue-delivery-goods_issue-delivery-go-ca729e.js","mappings":"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","sources":["./src/app/sales/components/bill-type/bill-type-1/tiki/add/add.component.ts","./src/app/sales/components/bill-type/bill-type-1/tiki/add/add.component.html","./src/app/sales/components/bill-type/bill-type-1/tiki/bill-type1-tiki.module.ts","./src/app/sales/components/bill-type/bill-type-1/tiki/detail/detail.component.ts","./src/app/sales/components/bill-type/bill-type-1/tiki/detail/detail.component.html","./src/app/sales/components/bill-type/bill-type-1/tiki/edit/edit.component.ts","./src/app/sales/components/bill-type/bill-type-1/tiki/edit/edit.component.html","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/add/add.component.ts","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/add/add.component.html","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/detail-tiki/detail-tiki.component.ts","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/detail-tiki/detail-tiki.component.html","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/detail/detail.component.ts","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/detail/detail.component.html","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/edit/edit.component.ts","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/edit/edit.component.html","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/issue-delivery-goods.component.ts","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/issue-delivery-goods.component.html","./src/app/sales/menu/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/issue-delivery-goods.module.ts"],"sourcesContent":["import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { Observable } from 'rxjs';\r\nimport { SalesK57Col3Component } from 'src/app/sales/components/print/sales/sales-k57-col3/sales-k57-col3.component';\r\nimport { SalesK80Col3Component } from 'src/app/sales/components/print/sales/sales-k80-col3/sales-k80-col3.component';\r\nimport { SalesK80Col4Component } from 'src/app/sales/components/print/sales/sales-k80-col4/sales-k80-col4.component';\r\nimport { SalesA5Component } from 'src/app/sales/components/print/sales/sales-a5/sales-a5.component';\r\nimport { SalesA4Component } from 'src/app/sales/components/print/sales/sales-a4/sales-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhSaleTikiInvoiceAdd, VhSaleTikiInvoiceDetail, VhSaleTikiInvoiceDetailCombo } from '../tiki-interface';\r\nimport { VhType } from 'src/app/sales/interface/vh-type';\r\n\r\n@Component({\r\n  selector: 'bill-type1-tiki-add',\r\n  templateUrl: './add.component.html',\r\n  styleUrls: ['./add.component.scss']\r\n})\r\nexport class AddComponent implements OnInit {\r\n  invoice: VhSaleTikiInvoiceAdd = {\r\n    bill_type: 1,\r\n    cqt_status: 1,\r\n    payment_type: 2,\r\n    id_customer: '',\r\n    id_branch: '',\r\n    id_employee: '',\r\n    id_wallet: 'id_cash',\r\n    date: '',\r\n    total: 0,\r\n    payment: 0,\r\n    tax: 0,\r\n    discount: 0,\r\n    fee: 0,\r\n    note: '',\r\n    price_type: 0,\r\n    order_number_ecommerce: '',\r\n    id_shop: '',\r\n    tax_buyerDisplayName: '',\r\n    tax_buyerLegalName: '',\r\n    tax_buyerTaxCode: '',\r\n    tax_buyerAddressLine: '',\r\n    tax_buyerEmail: '',\r\n    ecommerce_fee_paid_by_seller: 0,\r\n  };\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore; //nhớ dữ liệu truyền từ trang trước\r\n  billTiki: any = this.router.getCurrentNavigation().extras.state.billTiki;\r\n  employee: any = {};\r\n  customer: any = {};\r\n  pickerTime = new Date();\r\n  checkPrinter: boolean = false;\r\n  closerBrower: any;\r\n  validProdDetail: boolean = true;//nếu biến này = false tức có sp tiki chưa được liên kết với app\r\n  id_branch: string = this.vhQuerySales.getDefaultBranch()._id;\r\n  invoiceDetail = [];\r\n  subTotal = 0;\r\n  taxValue = 0;\r\n  isOpenModalTaxCustomer = false;\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private languageService: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhAuth: VhAuth,\r\n    private cdRef: ChangeDetectorRef,\r\n    private fncService: FunctionService,\r\n    private nzModalService: NzModalService\r\n  ) {\r\n\r\n\r\n  }\r\n  /**Khởi tạo hóa đơn và merge sp của tiki vào billDetail */\r\n  initBill() {\r\n    this.invoice.date = this.pickerTime.toISOString();\r\n    this.invoice.id_employee = this.vhAuth.getUser()._id;\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    this.invoice.id_branch = (this.vhQuerySales.getDefaultBranch()._id);\r\n    this.invoice.id_customer = (this.vhQuerySales.getlocalShopListTiki().find(item => item._id == this.dataRestore.id_shop_selected).data.id_customer);\r\n    this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n    this.invoice.payment_type = (2); //set bill công nợ\r\n    /** Để cộng dồn tiền seller giảm giá phí ship trong từng bill detail shipping_fee_discountAmount */\r\n    let shipping_fee_discountAmount = 0;\r\n    for (let i = 0; i < this.billTiki['items'].length; i++) {\r\n      // Cộng dồn tiền seller giảm giá phí ship\r\n      shipping_fee_discountAmount += this.billTiki['items'][i].seller_income_detail.discount?.discount_shipping_fee?.seller_subsidy || 0;\r\n    }\r\n    this.invoice.discount = 0;\r\n    this.invoice.fee = this.billTiki.invoice.shipping_amount_after_discount + shipping_fee_discountAmount;\r\n    this.invoice.ecommerce_fee_paid_by_seller = Math.abs(this.billTiki.invoice?.total_seller_fee) - shipping_fee_discountAmount;\r\n    this.addInvoiceDetail(this.billTiki.items);\r\n    this.setSubTotal();\r\n    this.invoice.order_number_ecommerce = (this.billTiki['code'].toString());\r\n    this.invoice.id_shop = (this.dataRestore['id_shop_selected']);\r\n    this.invoice.note = (`${this.languageService.translate(\"Order number\")} Tiki ${this.billTiki['code']}`);\r\n    this.invoice.tax_buyerDisplayName = this.invoice.tax_buyerDisplayName ? this.invoice.tax_buyerDisplayName : 'Người mua không lấy hóa đơn';\r\n    this.invoice.cqt_status = this.billTiki.cqt_status ? this.billTiki.cqt_status : 1;\r\n  }\r\n  ngOnInit(): void {\r\n    this.eventKeypress();\r\n    this.initBill();\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales');\r\n    if (printer) this.checkPrinter = printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.discount_price = this.vhAlgorithm.vhnumeral(\".discount-price\");\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral(\".invoice-fee\");\r\n      // this.platform_price = this.vhAlgorithm.vhnumeral(\".platform-price\")\r\n    });\r\n  }\r\n  event: any; // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n    window.removeEventListener('beforeunload', this.closerBrower, false);\r\n  }\r\n  /**\r\n   * lắng nghe sk nhấn f1 f2 f3 f4 trên bàn phím\r\n   * @example\r\n   */\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113) event.preventDefault();\r\n      switch (keycode) {\r\n        case 112: this.payInvoice(false);\r\n          break;\r\n        case 113: {\r\n          if (this.checkPrinter) this.payInvoice(true);\r\n          break;\r\n        }\r\n        case 114: {\r\n          this.searchProductList = !this.searchProductList;\r\n          break;\r\n        }\r\n      }\r\n    };\r\n    //sự kiện f5, close tab...\r\n    this.closerBrower = (event: BeforeUnloadEvent) => {\r\n      (event || window.event).returnValue = 'Changes you made may not be saved';\r\n      return 'Changes you made may not be saved';\r\n    };\r\n    window.addEventListener('beforeunload', this.closerBrower);\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  /**\r\n   * trở về trang phát hành hóa đơn lazada\r\n   * @example this.goBack()\r\n   */\r\n  goBack() {\r\n    this.vhComponent.alertConfirm(`${this.languageService.translate(\"Confirm\")}`, \"\", `${this.languageService.translate(\"Are you sure to cancel the sales order\")}?`, \"OK\", this.languageService.translate('Cancel'))\r\n      .then(() => { this.isExit = true; this.router.navigate([\"/sales/dashboard/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods\"], { state: { dataRestore: this.dataRestore } }); }, () => { });\r\n  }\r\n  // -------set employee-------\r\n  /**\r\n   * nhận sk ouput từ component app-staff bắt sk thay đổi nv\r\n   * @param event : id_employee thay đổi\r\n   * @example this.closeAndReceiveEmployee('DNHWIUYGBDGUIWQYGD&W')\r\n   */\r\n  closeAndReceiveEmployee(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n    }\r\n  }\r\n  /**\r\n   * bắt sk thay đổi date của hóa đơn , gán lại giá trị date mới cho đơn\r\n   * @example this.setPickerTime('2023-06-12T08:02:27.697Z')\r\n   */\r\n  setPickerTime(event) {\r\n    if (event.getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 8000);\r\n      this.pickerTime = new Date(this.invoice.date);\r\n      this.invoice.date = (this.pickerTime.toISOString());\r\n    }\r\n    else\r\n      this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n\r\n        if (validitydate == null) this.invoice.date = (event);\r\n        else {\r\n          this.pickerTime = new Date(this.invoice.date);\r\n          this.invoice.date = (this.pickerTime.toISOString());\r\n          this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 8000);\r\n        }\r\n      });\r\n  }\r\n  discount_price: any;\r\n  /**\r\n   * bắt sk thay đổi giảm giá của hóa đơn , gán lại giá trị giảm giá mới cho đơn\r\n   * @example this.editDiscount()\r\n   */\r\n  editDiscount() {\r\n    if (this.discount_price.getRawValue() && this.discount_price.getRawValue() >= 0) {\r\n      this.invoice.discount = (parseFloat(this.discount_price.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"discount-price\")['value'] = this.invoice.discount;\r\n      this.discount_price = this.vhAlgorithm.vhnumeral('.discount-price');\r\n    }\r\n  }\r\n\r\n\r\n\r\n  // platform_price: any = 0; // phí nền tảng\r\n  // /**\r\n  //  * bắt sk thay đổi phí sàn của hóa đơn, gán lại giá trị phí sàn mới cho đơn\r\n  //  * @example this.editPlatformPrice()\r\n  //  */\r\n  // editPlatformPrice() {\r\n  //   if (this.platform_price.getRawValue() && this.platform_price.getRawValue() >= 0) {\r\n  //     this.invoice.ecommerce_fee_paid_by_seller = (parseFloat(this.platform_price.getRawValue()));\r\n  //   }\r\n  //   else {\r\n  //     document.getElementById('platform-price')['value'] = this.invoice.ecommerce_fee_paid_by_seller;\r\n  //     this.platform_price = this.vhAlgorithm.vhnumeral('.platform-price');\r\n  //   }\r\n  // }\r\n\r\n\r\n\r\n  invoice_fee: any;\r\n  /**\r\n  * bắt sk thay đổi phí của hóa đơn , gán lại giá trị phí mới cho đơn\r\n  * @example this.editFee()\r\n  */\r\n  editFee() {\r\n    if (this.invoice_fee.getRawValue() && this.invoice_fee.getRawValue() >= 0) {\r\n      this.invoice.fee = (parseFloat(this.invoice_fee.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"invoice-fee\")['value'] = this.invoice.fee;\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral('.invoice-fee');\r\n    }\r\n  }\r\n  /**\r\n   * so sánh subtotal trước khi tạo bill để chắc chắn có thay đổ bill_detail thì vẫn đúng số liệu\r\n   * @returns boolean\r\n   * @example let bool = this.compareSubTotal()\r\n   */\r\n  compareSubTotal() {\r\n    let sub = this.invoiceDetail.reduce((prev: number, next) => prev + next.quantity * next.price, 0);\r\n    if (sub == this.subTotal) return true;\r\n    return false;\r\n  }\r\n  save_enable = true;\r\n  /**\r\n   * bắt sk nhấn nút thanh toán hóa đơn\r\n   * @param print biến check in hay ko\r\n   * @example this.payInvoice('print')\r\n   */\r\n  payInvoice(print?) {\r\n    // if (this.vhAuth.checkMyPermission(\"sales_enable_payment\")) {\r\n    if (this.compareSubTotal()) {\r\n      this.vhComponent.alertConfirm(\r\n        !print ? `${this.languageService.translate(\"Pay\")}?` : `${this.languageService.translate(\"Pay & Print\")}?`,\r\n        \"\", \"\", \"OK\", this.languageService.translate(\"Cancel\")\r\n      )\r\n        .then(() => {\r\n          if (this.save_enable) {\r\n            this.save_enable = false;\r\n            this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n              this.createOrUpdate(1).then((bill: any) => {\r\n                this.save_enable = true;\r\n                if (this.invoice.cqt_status !== 1) {\r\n                  this.vhQuerySales.updateBill(bill._id, { cqt_status: this.invoice.cqt_status });\r\n                }\r\n                let update = async () => await\r\n                  this.vhQuerySales.updateSalesOrderTiki(this.dataRestore['id_shop_selected'], this.billTiki['code'], { id_bill_delivered_goods: bill._id });\r\n                update();\r\n                this.vhComponent.hideLoading(0).then(() => {\r\n                  this.vhComponent.showToast(2000,\r\n                    `${this.languageService.translate(\"Issue invoice\")} ${this.languageService.translate(\"Successfully\").toLocaleLowerCase()}`, \"success-toast\"\r\n                  );\r\n                  if (print) this.handlePrint();\r\n                  else this.handle(true);\r\n                });\r\n              });\r\n            }).catch(err => { this.vhComponent.hideLoading(0); this.vhComponent.showToast(2000, err); });\r\n          }\r\n        }, () => { });\r\n    } else this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"The total price of the product is not equal to the subtotal\"));\r\n\r\n    // }\r\n    // else this.vhComponent.showToast(1500, this.languageService.translate('You do not have this rights'), \"alert-toast\")\r\n  }\r\n  /**\r\n   * tạo bill lên DB\r\n   * @returns Promise<any>\r\n   * @example  this.createOrUpdate()\r\n   * .then((bill: any) => {\r\n   *\r\n   * })\r\n   */\r\n  createOrUpdate(bill_type: 1) {\r\n    return new Promise((resolve, reject) => {\r\n      return this.vhQuerySales.createBill_Billdetail({ ...this.invoice }, this.getCreateUpdateInvoiceDetail()).then(res => resolve(res)).catch(err => reject(err));\r\n    });\r\n  }\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales');\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)]);\r\n      else rejects(\"No\");\r\n    });\r\n  }\r\n  /**\r\n   * trả về danh sách bill_detail đã format theo đúng chuẩn các trường để lưu DB\r\n   * @returns array bill_detail\r\n   * @example let bill_details = getCreateUpdateInvoiceDetail()\r\n   */\r\n  getCreateUpdateInvoiceDetail(): VhSaleTikiInvoiceDetail[] {\r\n    return this.invoiceDetail.map(item => {\r\n\r\n      let detail: VhSaleTikiInvoiceDetail = {\r\n        id_product: item.id_product,\r\n        ptype: item.ptype,\r\n        price: item.price,\r\n        quantity: item.quantity,\r\n        ratio: item.ratio,\r\n        price_origin: item.price_origin,\r\n      };\r\n      if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct;\r\n      if (item.id_subproduct) detail['id_subproduct'] = item.id_subproduct;\r\n\r\n      if (item.ptype == 5) {\r\n        detail['combos'] = item.combos.map(combo => {\r\n          let product: VhSaleTikiInvoiceDetailCombo = {\r\n            id_product: combo.id_product,\r\n            price: combo.price,\r\n            quantity: combo.quantity,\r\n            ptype: combo.ptype || combo.type,\r\n            ratio: combo.ratio ? combo.ratio : 1,\r\n          };\r\n          if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct;\r\n          if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct;\r\n          return product;\r\n        });\r\n      }\r\n      return detail;\r\n\r\n    }).filter(item => item);\r\n\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return SalesK57Col3Component;\r\n      case 'print_size_k80_3c': return SalesK80Col3Component;\r\n      case 'print_size_k80_4c': return SalesK80Col4Component;\r\n      case 'print_size_a5': return SalesA5Component;\r\n      case 'print_size_a4': return SalesA4Component;\r\n      default: return SalesA4Component;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * trờ về trang phát hành hóa đơn sau khi đã thanh toán xong\r\n   * @example this.handle(true)\r\n   */\r\n  handle(update?: boolean) {\r\n    this.isExit = true;\r\n    if (update) this.dataRestore['update'] = true;\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods'], { state: { dataRestore: this.dataRestore } });\r\n  }\r\n  /**\r\n   * kiểm tra dữ liệu thông tin máy in và mở component in\r\n   * @example this.handlePrint()\r\n   */\r\n  handlePrint() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice: this.invoice, invoice_detail: this.invoiceDetail }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.handle(true));\r\n        });\r\n    }, (err) => this.handle(true));\r\n  }\r\n  // ------thoát trang-----\r\n  isExit: boolean = false;\r\n  checkDeactivate(currentRoute: ActivatedRouteSnapshot, currentState: RouterStateSnapshot, nextState?: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    return nextState.url == '/login' ? true : (this.isExit ? this.isExit : this.vhComponent.alertConfirm(this.languageService.translate(\"Confirm\"), \"\", this.languageService.translate(\"Are you sure to cancel the sales order\"), \"OK\", (this.languageService.translate(\"Cancel\"))).then(() => { return true; }).catch(() => { return false; }));\r\n  }\r\n\r\n  searchProductList: boolean = false;\r\n  /**Phần thêm sản phẩm bổ sung\r\n  * Note : không tính tiền sản phẩm này\r\n  * @param data sản phẩm được chọn\r\n  * @example this.closeSearchProductList(data_product)\r\n  */\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      if (data.manylot && !data.id_lotproduct) this.openModalChooseLot(data);\r\n      else\r\n        if (data.combos && data.combos.filter(e => e.lots && !e.id_lotproduct).length) {\r\n          this.tempDetail = data;\r\n          this.show_modal_select_lots_combo = true;\r\n        }\r\n        else\r\n          this.addInvoiceDetailExtraEcommerce(data);\r\n\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n  /**\r\n   * thêm sp vô mảng invoice_detail\r\n   * @param value\r\n   * @example  this.addInvoiceDetailExtraEcommerce(data_product);\r\n   */\r\n  addInvoiceDetailExtraEcommerce(value: any) {\r\n\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == value['_id'] && detail['free']);\r\n    if (index != -1) {\r\n      if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1;\r\n    } else {\r\n      let detail: any = {\r\n        name: value.name,\r\n        id_product: value._id,\r\n        quantity: 1,\r\n        ptype: value.type,\r\n        unit: value.unit,\r\n        units: value.units,\r\n        ratio: value.ratio,\r\n        price: 0,\r\n        price_origin: value.price,\r\n        id_category: value.id_category,\r\n        free: true, //nếu có trường này thì được quyền chỉnh số lượng\r\n        id_subproduct: value.id_subproduct,\r\n        lots: value.lots,\r\n        id_lotproduct: value.id_lotproduct,\r\n      };\r\n\r\n      if (value.type == 5) {\r\n        detail['subComboName'] = value.subComboName;\r\n        detail['combos'] = [...value.combos.map(item => {\r\n          let product: any = {\r\n            id_product: item.id_product, name: item.name, ptype: item.type,\r\n            price: 0, quantity: item.quantity, id_subproduct: item.id_subproduct,\r\n            lots: item.lots,\r\n            id_lotproduct: item.id_lotproduct, units: item.units, ratio: item.ratio,\r\n            free: true//nếu có trường này thì được quyền chỉnh số lượng\r\n          };\r\n          return product;\r\n        })];\r\n      }\r\n\r\n      this.invoiceDetail.unshift(detail);\r\n    }\r\n\r\n  }\r\n  /**\r\n   * bắt sk thay đổi quantity của bill_detail\r\n   * @param product bill-detail được chọn\r\n   * @param event số lượng thay đổi\r\n   * @example this.checkQuantityProduct(product, 1)\r\n   */\r\n  checkQuantityProduct(product: VhSaleTikiInvoiceDetail, event) {\r\n    const MIN_PRICE = 1;\r\n\r\n    const oldQuantity = product.quantity;\r\n    const oldPrice = product.price;\r\n    const originalTotal = oldQuantity * oldPrice;\r\n\r\n    const newQuantity = event || 1;\r\n    const newPrice = originalTotal / newQuantity;\r\n\r\n    if (newPrice < MIN_PRICE) {\r\n      return;\r\n    }\r\n\r\n    product.quantity = newQuantity;\r\n    product.price = newPrice;\r\n\r\n    this.setSubTotal();\r\n  }\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhSaleTikiInvoiceDetail;\r\n  /**\r\n   * mở modal chỉnh sửa giá bán của bill_detail\r\n   * @param detail\r\n   * @example this.openEditUnitPrice(bill_detail)\r\n   */\r\n  openEditUnitPrice(detail: VhSaleTikiInvoiceDetail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n  /**\r\n   * bắt sk nhấn nút ok của modal chỉnh sửa giá bán\r\n   * @example this.handleEditUnit()\r\n   */\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      this.isVisibleEditUnitPrice = false;\r\n\r\n      this.setSubTotal();\r\n    } else { this.vhComponent.showToast(2000, this.languageService.translate(\"Invalid data, please check again\"), \"alert-toast\"); }\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút xóa bill-detail\r\n   * @param detail\r\n   * @example this.deleteGoods(bill-detail)\r\n   */\r\n  deleteGoods(detail: VhSaleTikiInvoiceDetail) {\r\n    this.vhComponent.alertConfirm(\"\", \"\", `${this.languageService.translate(\"Delete\")} ${detail.name}?`, \"OK\", this.languageService.translate(\"Cancel\"))\r\n      .then(() => this.removeInvoiceDetail(detail.id_product), () => { });\r\n  }\r\n\r\n  /**\r\n   * xóa bill-detail trong mảng local invoice_detail\r\n   * @param id\r\n   * @example this.removeInvoiceDetail(bill_detail.id_product)\r\n   */\r\n  removeInvoiceDetail(id: string) {\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == id);\r\n    if (index != -1) {\r\n      this.invoiceDetail.splice(index, 1);\r\n      this.setSubTotal();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * tính và gán lại cộng tiền (subTotal) của đơn\r\n   * @example this.setSubTotal()\r\n   */\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      subTotal += (i.price ? i.price * i.quantity : 0);\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal();\r\n  }\r\n\r\n  /**\r\n   * tính và gán lại tổng tiền (total) của đơn\r\n   * @example this.setTotal()\r\n   */\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee > 0 ? this.subTotal - this.invoice.discount + this.invoice.fee : 0;\r\n  }\r\n  /**\r\n   * Thêm sản phẩm đã bán vào cart\r\n   */\r\n  addInvoiceDetail(items: Array<any>) {\r\n    let products: Array<any> = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden).filter(item => item[this.id_branch] && item[this.id_branch].tikis && item[this.id_branch].tikis.length >= 0);\r\n    for (let item of items) {\r\n      let findSuccess: boolean = false;\r\n      for (let productOfBranch of products) {\r\n        let findProduct = productOfBranch[this.id_branch].tikis.find(data => data.product_id == item.product.id);\r\n        if (findProduct) {\r\n          findSuccess = true;\r\n          this.addInvoiceDetailTiki(item.invoice.row_total, item.price, item.qty, productOfBranch, true);\r\n          break;\r\n        }\r\n      }\r\n      if (!findSuccess) {\r\n        this.addInvoiceDetailTiki(item.invoice.row_total, item.price, item.qty, { name: item.product.name }, false);\r\n        this.validProdDetail = false;\r\n      }\r\n    }\r\n  }\r\n  addInvoiceDetailTiki(price, price_origin, quantity, product, exist) {\r\n    if (exist) {\r\n      const productToAdd = {\r\n        name: product.name,\r\n        id_product: product._id,\r\n        quantity: quantity,\r\n        ptype: product.type,\r\n        unit: product.unit,\r\n        price: price,\r\n        ratio: 1,\r\n        units: product.units,\r\n        price_origin: price_origin || null,\r\n        id_subproduct: product.id_subproduct,\r\n        lots: product.lots,\r\n        id_lotproduct: product.id_lotproduct,\r\n        free: false //nếu có trường này true thì được quyền chỉnh số lượng\r\n      }\r\n      if(product.type == VhType.COMBO) {\r\n        productToAdd['combos'] = product.combos;\r\n      }\r\n      this.invoiceDetail.unshift(productToAdd);\r\n    } else {\r\n      this.invoiceDetail.unshift({\r\n        id_product: null,\r\n        quantity: quantity,\r\n        price: price,\r\n        ptype: 1,\r\n        ratio: 1,\r\n        name: product.name\r\n      });\r\n    }\r\n  }\r\n\r\n  warning_lot_expried: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').warning_lot_expried;\r\n  /**\r\n  * trả về tên unit của sp\r\n  * @param units mảng units của sp\r\n  * @param ratio ratio được chọn\r\n  * @returns string\r\n  * @example let unit_name = this.getUnit([], 1)\r\n  */\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit;\r\n  }\r\n\r\n  show_modal_select_lots = false;\r\n  list_search_lot = [];\r\n\r\n  /**\r\n   * trả về số lô của sp\r\n   * @param lots mảng lots của sp\r\n   * @param _id id của lô đã chọn\r\n   * @returns string\r\n   * @example let lot_name = this.getLotNumber([], 'SQOIUGDHBUWYGBDUEYTFTQ')\r\n   */\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id);\r\n    return lot.lot_number;\r\n  }\r\n  /**\r\n   * tìm kiếm lô theo tên lô\r\n   * @param value\r\n   * @example this.searchLot('')\r\n   */\r\n  searchLot(value) {\r\n    this.tempDetail.lots = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.list_search_lot, ['lot_number']);\r\n  }\r\n  /**\r\n   * mở modal chọn lô sp\r\n   * @param data bill-detail được chọn\r\n   * @example this.openModalChooseLot(data)\r\n   */\r\n  openModalChooseLot(data) {\r\n    this.tempDetail = data;\r\n    this.list_search_lot = this.tempDetail.lots;\r\n    if (!this.list_search_lot.length) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Sản phẩm này không có lô khả dụng để bán!\"));\r\n    else this.show_modal_select_lots = true;\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi id_lotnumber của bill-detail\r\n   * @param e id_lotnumber thay đổi\r\n   * @example this.changeLot('DNIUHWIDCHBIQOHSDOIHW')\r\n   */\r\n  changeLot(e) {\r\n    this.tempDetail.lot_number = this.tempDetail.lots.find(item => item._id == e).lot_number;\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút ok của modal chọn lô sp\r\n   * @example this.handleChooseLot()\r\n   */\r\n  handleChooseLot() {\r\n\r\n    if (this.warning_lot_expried) {\r\n      let lot_select = this.list_search_lot.find(e => e._id == this.tempDetail.id_lotproduct);\r\n\r\n\r\n\r\n      if (new Date().getTime() >= new Date(lot_select.date_exp).getTime()) {\r\n        this.nzModalService.confirm({\r\n          nzTitle: this.languageService.translate(\"Lô này đã hết hạn! Tiếp tục bán sản phẩm này?\"),\r\n          nzOnOk: () => {\r\n            this.show_modal_select_lots = false;\r\n            this.tempDetail.lots = this.list_search_lot;\r\n            if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n          },\r\n          nzOnCancel: () => {\r\n            // this.show_modal_select_lots = false;\r\n            // this.tempDetail.lots = this.list_search_lot;\r\n          }\r\n\r\n        });\r\n      }\r\n      else {\r\n        this.show_modal_select_lots = false;\r\n        this.tempDetail.lots = this.list_search_lot;\r\n        if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n      }\r\n    }\r\n    else {\r\n      this.show_modal_select_lots = false;\r\n      this.tempDetail.lots = this.list_search_lot;\r\n      if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút hủy modal chọn lô sp\r\n   * @example this.handleCancelChooseLot()\r\n   */\r\n  handleCancelChooseLot() {\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot;\r\n  }\r\n\r\n  show_modal_select_lots_combo = false;\r\n  /** bắt sk nhấn nút ok modal chọn lô sp là combo\r\n * @example this.handleChooseLotCombo()\r\n */\r\n  handleChooseLotCombo() {\r\n    if (this.tempDetail.combos.filter(item => item.lots && !item.id_lotproduct).length)\r\n      this.vhComponent.alertMessageDesktop(\"warning\", this.languageService.translate(\"Vui lòng chọn lô cho sản phẩm thuộc combo này\"));\r\n    else {\r\n      this.show_modal_select_lots_combo = false;\r\n      this.closeSearchProductList(this.tempDetail);\r\n    }\r\n  }\r\n\r\n  onClose(event) {\r\n    this.isOpenModalTaxCustomer = false;\r\n  }\r\n\r\n  /**\r\n   * Khi ok trong modal chỉnh sửa customer tax\r\n   * @param customerTaxInfo\r\n   */\r\n  onOkEditTax(customerTaxInfo) {\r\n    this.isOpenModalTaxCustomer = false;\r\n    Object.assign(this.invoice, customerTaxInfo);\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n\r\n<nz-layout>\r\n    <div class=\"sales hide-best-selling\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{\"Order number\" | translate}}: <a target=\"_blank\"\r\n                            href=\"https://sellercenter.tiki.vn/new#/order/list?filter_date_by=allDays&keyword={{billTiki.code}}&limit=20&order_status_tab=all&page=1&search_type=code&seller_id=5346\">{{billTiki.code}}</a></b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n                    <div>\r\n                        <button style=\"width: 97%;\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                            (click)=\"searchProductList =true\">\r\n                            <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                            {{'Search (F4)' | translate}}</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\" *ngFor=\"let item of invoiceDetail\">\r\n                    <div nz-row>\r\n                        <div (click)=\"deleteGoods(item)\" nz-col nzSpan=\"1\">\r\n                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"8\">\r\n                            <p class=\"invoiceDetail-item-name\">\r\n                                <span class=\"invoiceDetail-item-name-linked\"\r\n                                    *ngIf=\"item.id_product\">{{item.name}}</span>\r\n                                    <ng-container *ngIf=\"item.lots\">\r\n                                        <span *ngIf=\"item.id_lotproduct\" style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(item)\">{{getLotNumber(item.lots, item.id_lotproduct)}}</span>\r\n                                            <span *ngIf=\"!item.id_lotproduct\" style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(item)\">{{'Select lot' | translate}}</span>\r\n                                    </ng-container>\r\n                                    <span *ngFor=\"let combo of item.combos;index as i\"\r\n                                    style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                    {{ i == item.combos.length-1 ? combo.quantity + 'x ' +\r\n                                    combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ' :\r\n                                    combo.quantity + 'x ' + combo.name + ' (' +\r\n                                    getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                    <ng-container *ngIf=\"combo.id_lotproduct\">\r\n                                        <span style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(combo)\">{{getLotNumber(combo.lots, combo.id_lotproduct)}}</span>\r\n                                    </ng-container>\r\n                                </span>\r\n                                <span *ngIf=\"!item.id_product\">{{item.name}}\r\n                                    <span class=\"invoiceDetail-item-name-notlinked\">({{\"The products have not been linked\"\r\n                                        | translate}})</span></span>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"5\" style=\"text-align: right;\">\r\n                            <nz-input-number (ngModelChange)=\"checkQuantityProduct(item,$event)\"\r\n                                [ngModel]=\"item.quantity\">\r\n                            </nz-input-number>\r\n                        </div>\r\n                        <!-- <div (click)=\"openEditUnitPrice(item)\" class=\"invoiceDetail-item-price text-end\" nz-col -->\r\n                        <div class=\"invoiceDetail-item-price text-end\" nz-col\r\n                            nzSpan=\"5\">\r\n                            <p class=\"max-width-two-line\" style=\"border-bottom: 1px var(--ion-color-vh-gray) solid;\r\n              margin-left: 16px;\">\r\n                                <span>{{vhAlgorithm.vhcurrencyunit(item.price)}}</span>\r\n                                <del style=\"margin-left:5px;font-size: 0.8rem;\">\r\n                                    {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin) :\r\n                                    ''}}\r\n                                </del>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"5\" style=\"text-align: right;\">\r\n                            <p class=\"max-width-two-line\">\r\n                                <b>{{vhAlgorithm.vhcurrencyunit(item.price*item.quantity)}}</b>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Salesman' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_employee\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveEmployee($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Sales date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\" class=\"sales-bills-customer-info\" nz-row>\r\n                    <b style=\"width: 100%;margin-bottom: 12px;\">{{'Customer information' | translate}}</b>\r\n                    <div class=\"sales-bills-customer-info-name\">\r\n                        {{customer.name}}\r\n                    </div>\r\n                    <div class=\"sales-bills-customer-info-phone\">\r\n                        {{customer.phone}}\r\n                    </div>\r\n                </div>\r\n                <div style=\"margin-top: 12px;\" nz-col nzSpan=\"24\" class=\"sales-bills-customer-info\" nz-row>\r\n                    <span (click)=\"isOpenModalTaxCustomer = true\" style=\"width: 100%;margin-bottom: 12px; color: var(--ion-color-vh-green); cursor: pointer;\">\r\n                        <b>{{'Invoice information' | translate}}</b>\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div>{{'SubTotal' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Platform fee' | translate}}<i\r\n                            style=\"font-size: 0.9rem;color: var(--ion-color-vh-red);;margin-left: 4px;\"\r\n                            nzTooltipTitle=\"{{'Vui lòng kiểm tra phí sàn chính xác trước khi phát hành hóa đơn'}}\"\r\n                            nzTooltipPlacement=\"top\" nz-tooltip nz-icon nzType=\"exclamation-circle\"\r\n                            nzTheme=\"outline\"></i></div>\r\n                    <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                        class=\"nz-no-border discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\" nz-input />\r\n                </div>\r\n                <!-- <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Platform fee' | translate}}<i\r\n                            style=\"font-size: 0.9rem;color: var(--ion-color-vh-red);;margin-left: 4px;\"\r\n                            nzTooltipTitle=\"{{'Vui lòng kiểm tra phí sàn chính xác trước khi phát hành hóa đơn'}}\"\r\n                            nzTooltipPlacement=\"top\" nz-tooltip nz-icon nzType=\"exclamation-circle\"\r\n                            nzTheme=\"outline\"></i></div>\r\n                    <input (blur)=\"editPlatformPrice()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.ecommerce_fee_paid_by_seller)\"\r\n                        class=\"nz-no-border platform-price\" type=\"text\" maxlength=\"15\" id=\"platform-price\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Discount value' | translate}}</div>\r\n                    <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                        class=\"nz-no-border discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\" nz-input />\r\n                </div> -->\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Fee' | translate}}</div>\r\n                    <input (blur)=\"editFee()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.fee)\"\r\n                        class=\"nz-no-border invoice-fee\" type=\"text\" maxlength=\"15\" id=\"invoice-fee\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Total' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.total)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <div><b>{{'Pay' | translate}}</b></div>\r\n                    <div> <b>{{vhAlgorithm.vhcurrencyunit(invoice.payment)}}</b></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Rest' | translate}}</div>\r\n                    <div><b> {{vhAlgorithm.vhcurrencyunit_symbol(invoice.total - invoice.payment)}}</b></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\">\r\n                    <textarea class=\"nz-hover-border\" [(ngModel)]=\"invoice.note\" nz-input\r\n                        placeholder=\"{{'Enter note...' | translate}}\"\r\n                        [nzAutosize]=\"{ minRows: 2, maxRows: 4 }\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!validProdDetail || !checkPrinter\" (click)=\"payInvoice(true)\" nz-button\r\n                    class=\"order-and-print\">\r\n                    {{\"Save & Print\"|translate}} (F2)\r\n                </button>\r\n                <button [disabled]=\"!validProdDetail\" (click)=\"payInvoice(false)\" nz-button class=\"order\">\r\n                    {{\"Save\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n<!-- search sp -->\r\n<!-- -----nz-drawer list-product-------- -->\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\" [default_price_type]=\"1\">\r\n</app-search-product>\r\n\r\n\r\n<!--Modal edit unit price-->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Edit unit price' | translate}}\" (nzOnCancel)=\"isVisibleEditUnitPrice = false\"\r\n    (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Unit price' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\" [value]=\"tempDetail.price\" nz-input\r\n                    placeholder=\"{{'Enter unit price' | translate}}\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"isVisibleEditUnitPrice = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n\r\n<!-- modal chọn lô/HSD -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice2\" [(nzVisible)]=\"show_modal_select_lots\"\r\n    nzTitle=\"{{'Select lot number' | translate}}\" (nzOnCancel)=\"handleCancelChooseLot()\" (nzOnOk)=\"handleChooseLot()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input type=\"text\" nz-input placeholder=\"{{'Find lot number' | translate}}\" #searchValue\r\n                    (keyup)=\"searchLot(searchValue.value )\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <nz-radio-group [(ngModel)]=\"tempDetail.id_lotproduct\" (ngModelChange)=\"changeLot($event)\" style=\"width:100%;\">\r\n            <div nz-row *ngFor=\"let item of tempDetail.lots\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <label class=\"radio-purchase\" nz-radio [nzValue]=\"item._id\" style=\"width:100%;\">\r\n                        <div nz-row>\r\n                            <div nz-col nzSpan=\"8\">\r\n                                {{item.lot_number}}\r\n                            </div>\r\n\r\n                            <div nz-col nzSpan=\"8\">\r\n                                NSX: {{item.date_mfg | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                            <div nz-col nzSpan=\"8\">\r\n                                HSD: {{item.date_exp | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                        </div>\r\n\r\n                    </label>\r\n                </div>\r\n\r\n            </div>\r\n        </nz-radio-group>\r\n        <div *ngIf=\"!tempDetail.lots.length\" style=\"text-align: center;\">{{'No data' | translate}}</div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice2>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelChooseLot()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\" [disabled]=\"!tempDetail.id_lotproduct\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLot()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!-- modal chọn lô/HSD cho combo-->\r\n<nz-modal  nzWidth=\"70vw\"  *ngIf=\"show_modal_select_lots_combo\" [nzFooter]=\"modalFooterEditUnitPrice3\"\r\n    [(nzVisible)]=\"show_modal_select_lots_combo\"\r\n    nzTitle=\"{{'Select lot number for products in combo' | translate}}: {{tempDetail.name}}\"\r\n    (nzOnCancel)=\"show_modal_select_lots_combo = false\" (nzOnOk)=\"handleChooseLotCombo()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"tempDetail.combos\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{{\"Product name\" | translate}}</th>\r\n                    <th>{{'Lot number' | translate}}</th>\r\n                    <th>{{'Unit' | translate}}</th>\r\n                    <th>{{'Quantity' | translate}}</th>\r\n                    <th>{{'Unit price' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let data of basicTable.data\">\r\n                    <ng-container *ngIf=\"data.lots\">\r\n\r\n                        <tr>\r\n                            <td>{{ data.name }}</td>\r\n                            <td>\r\n                                <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                    [(ngModel)]=\"data.id_lotproduct\">\r\n                                    <nz-option *ngFor=\"let element of data.lots\"  nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp | date: 'dd/MM/yyyy'}}\"\r\n                                        [nzValue]=\"element._id\"></nz-option>\r\n                                </nz-select>\r\n                            </td>\r\n                            <td>{{getUnit(data.units, data.ratio)}}</td>\r\n                            <td>{{ data.quantity }}</td>\r\n                            <td>\r\n                                {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n\r\n                            </td>\r\n                        </tr>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice3>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"show_modal_select_lots_combo = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLotCombo()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<app-modal-customer-tax [isOpenModal]=\"isOpenModalTaxCustomer\" [invoice]=\"invoice\"\r\n    (onClose)=\"onClose($event)\" (onOk)=\"onOkEditTax($event)\"></app-modal-customer-tax>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { AddComponent } from './add/add.component';\r\nimport { DetailComponent } from './detail/detail.component';\r\nimport { EditComponent } from './edit/edit.component';\r\nimport { ComponentsModule } from 'src/app/sales/sale-desktop/components/components.module';\r\nimport { NgZorroAntModule } from 'src/app/ng-zorro-ant.module';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { SearchModule } from 'src/app/sales/components/search/search.module';\r\nimport { ModalCustomerTaxModule } from '../components/modal-customer-tax/modal-customer-tax.module';\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddComponent,\r\n    DetailComponent,\r\n    EditComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    ComponentsModule,\r\n    NgZorroAntModule,\r\n    TranslateModule,\r\n    FormsModule,\r\n    SearchModule,\r\n    ModalCustomerTaxModule,\r\n  ],\r\n  exports: [\r\n    AddComponent,\r\n    DetailComponent,\r\n    EditComponent\r\n  ],\r\n})\r\nexport class BillType1TikiModule { }\r\n","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { SalesK57Col3Component } from 'src/app/sales/components/print/sales/sales-k57-col3/sales-k57-col3.component';\r\nimport { SalesK80Col3Component } from 'src/app/sales/components/print/sales/sales-k80-col3/sales-k80-col3.component';\r\nimport { SalesK80Col4Component } from 'src/app/sales/components/print/sales/sales-k80-col4/sales-k80-col4.component';\r\nimport { SalesA5Component } from 'src/app/sales/components/print/sales/sales-a5/sales-a5.component';\r\nimport { SalesA4Component } from 'src/app/sales/components/print/sales/sales-a4/sales-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { VhSaleTikiInvoiceEdit, VhSaleTikiInvoiceDetail } from '../tiki-interface';\r\n@Component({\r\n  selector: 'bill-type1-tiki-detail',\r\n  templateUrl: './detail.component.html',\r\n  styleUrls: ['./detail.component.scss']\r\n})\r\nexport class DetailComponent   {\r\n  tableHeight: string;\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore\r\n  billTiki: any = this.router.getCurrentNavigation().extras.state.billTiki\r\n  public invoiceInfo: any;\r\n  public invoice: VhSaleTikiInvoiceEdit = null;\r\n  invoice_detail : VhSaleTikiInvoiceDetail[]\r\n  subTotal = 0;\r\n  constructor(\r\n    private router: Router,\r\n    private vhQuerySales: VhQuerySales,\r\n    private lang: LanguageService,\r\n    private vhAuth: VhAuth,\r\n    private vhComponent: VhComponent,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private cdRef: ChangeDetectorRef,\r\n    private fncService:FunctionService\r\n  ) {\r\n    this.getDataInvoice(this.router.getCurrentNavigation().extras.state.id)\r\n\r\n     \r\n  }\r\n\r\n  /**\r\n   * gán bill và bill-detail get được vào biến và get các thông tin của nv, khách hàng, phương thức thanh toán\r\n   * @example this.init(bill, bill-deails)\r\n   */\r\n  init(invoice: VhSaleTikiInvoiceEdit = null, invoiceDetail: VhSaleTikiInvoiceDetail[] = null) {\r\n    this.invoice = invoice\r\n    this.invoice_detail = invoiceDetail\r\n    if (invoice && invoiceDetail) {\r\n      this.invoiceInfo = {\r\n        employee: this.vhAuth.getlocalEmployee(this.invoice.id_employee),\r\n        partner: this.vhQuerySales.getlocalCustomer(this.invoice.id_customer),\r\n        paymentName: this.setPaymentName(this.invoice.payment_type)\r\n      } \r\n    } else this.invoiceInfo = { employee: {}, partner: {}, paymentName: '' }\r\n    this.setSubTotal()\r\n  }\r\n\r\n  /**\r\n   * get dữ liệu bill từ DB\r\n   * @param id : nhận từ state truyền qua\r\n   * @example this.getDataInvoice('DHIWHNXDIWODUHIWDHOWID')\r\n   */\r\n  private getDataInvoice(id) {\r\n    this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n      Promise.all([\r\n        this.vhQuerySales.getBill(id),\r\n        this.vhQuerySales.getBill_details_byId_bill(id)\r\n      ]).then(([invoice, invoiceDetail]: any) => {\r\n        if (!invoiceDetail.length)\r\n          this.init(invoice, [])\r\n        else {\r\n          invoiceDetail = this.vhAlgorithm.sortVietnamesebyASC(invoiceDetail, 'name');\r\n          this.init(invoice, invoiceDetail)\r\n        }\r\n        this.vhComponent.hideLoading(0)\r\n      })\r\n    })\r\n  }\r\n  /**\r\n   * tính cộng tiền hóa đơn\r\n   * @example this.setSubTotal()\r\n   */\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoice_detail) {\r\n      subTotal +=  (i.price ? i.price * i.quantity : 0)\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal();\r\n  }\r\n  /**\r\n   * tính tổng tiền hóa đơn\r\n   * @example this.setTotal()\r\n   */\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee > 0 ? this.subTotal - this.invoice.discount + this.invoice.fee : 0\r\n   \r\n  } \r\n  /**\r\n   * trả về tên phương thức thanh toán\r\n   * @param type \r\n   * @returns string\r\n   * @example this.setPaymentName(1)\r\n   */\r\n  public setPaymentName(type: 1 | 2 | 3) {\r\n    switch (type) {\r\n      case 1: return this.lang.translate(\"Cash\")\r\n      case 2: return this.lang.translate(\"Debit\")\r\n      case 3: return this.vhQuerySales.getlocalWallet(this.invoice.id_wallet).name\r\n    }\r\n  }\r\n  /**\r\n   * trả về tên unit của sản phẩm theo ratio truyền vào\r\n   * @param units \r\n   * @param ratio \r\n   * @returns string\r\n   * @example let unit_name = this.getUnit([object], 1)\r\n   */\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units,ratio).unit\r\n  }\r\n\r\n\r\n  /**\r\n   * trả về chuỗi thông tin lô theo id lô truyền vào\r\n   * @param lots \r\n   * @param _id \r\n   * @returns string\r\n   * @example let lot = this.getLotNumber([], 'DNIWUHNDKLJWHDIWUOH')\r\n   */\r\n  getLotNumber(lots, _id){\r\n    let lot = lots.find(item => item._id == _id)\r\n    return lot.lot_number + '\\n' + this.fncService.formatDate(lot.date_mfg) + ' - ' +  this.fncService.formatDate(lot.date_exp)\r\n  } \r\n  /**\r\n   * trả về chuỗi thông tin địa chỉ của customer\r\n   * @param partner \r\n   * @returns string\r\n   * @example let addr = this.renderAddress(customer_info)\r\n   */\r\n  public renderAddress(partner) {\r\n    return (partner.address ? partner.address : '') +\r\n      (partner.district ? ', ' + partner.district : '') +\r\n      (partner.province ? ', ' + partner.province : '') +\r\n      (partner.country ? ', ' + partner.country : '')\r\n  }\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales')\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)])\r\n      else rejects(\"No\")\r\n    })\r\n  }\r\n\r\n  /**\r\n   * kiểm tra thông tin dữ liệu trang in và mở component in\r\n   * @example this.printInvoice()\r\n   */\r\n  printInvoice() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer , invoice: this.invoice, invoice_detail: this.invoice_detail }, false, false, `modal-print-${printer['_id']}`)\r\n    }, (err) => {\r\n      let name :any= 'Sales'\r\n      this.vhComponent.alertMessage(this.lang.translate(\"Function\"), \"\", this.lang.translate(\"Please turn on the printer function\"), \"OK\")\r\n        .then(() => this.router.navigate(['/sales/dashboard/manage/printer','page_desktop_sales'],{state : name}))\r\n    })\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return SalesK57Col3Component\r\n      case 'print_size_k80_3c': return SalesK80Col3Component\r\n      case 'print_size_k80_4c': return SalesK80Col4Component\r\n      case 'print_size_a5': return SalesA5Component\r\n      case 'print_size_a4': return SalesA4Component\r\n      default: return SalesA4Component\r\n    }\r\n  }\r\n  /**\r\n   * trở về trang phát hành hóa đơn tiki\r\n   * @example this.goBack()\r\n   */\r\n  goBack() {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods'], { state: { dataRestore: this.dataRestore } });\r\n  }\r\n  ngAfterViewChecked() {\r\n    if (document.getElementById('sales-invoice-detail-today') && document.querySelector(\".sales-cart-header\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".ant-table-pagination\")) {\r\n      this.tableHeight = document.getElementById('sales-invoice-detail-today').clientHeight - document.querySelector(\".sales-cart-header\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".ant-table-pagination\").clientHeight - 40 + \"px\";\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n  /**\r\n   * router trang cập nhật phát hành hóa đơn tiki\r\n   * @example this.goToCart()\r\n   */\r\n  public goToCart() {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/edit'], { state: { dataRestore: this.dataRestore, invoiceDetail: this.invoice_detail, invoice: this.invoice, billTiki: this.billTiki } })\r\n  }\r\n\r\n\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n<nz-layout id=\"sales-invoice-detail-today\" *ngIf=\"invoice\">\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{'Issue invoice' | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n                    <div>\r\n                        <button (click)=\"goToCart()\" class=\"btn-data nz-hover-border center-all-content\" nz-button\r\n                            nzType=\"default\">\r\n                            <span nz-icon nzType=\"edit\" nzTheme=\"outline\"></span>\r\n                            {{'Edit' | translate}}\r\n                        </button>\r\n                    </div>\r\n                    <div style=\"margin-left:4px\">\r\n                        <button (click)=\"printInvoice()\" class=\"btn-data nz-hover-border center-all-content\" nz-button\r\n                            nzType=\"default\">\r\n                            <span nz-icon nzType=\"printer\" nzTheme=\"outline\"></span>\r\n                            {{'Print' | translate}}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\">\r\n                    <nz-table [nzScroll]=\"{ y: tableHeight }\" [nzData]=\"invoice_detail || []\" #rowSelectionTable\r\n                        nzShowSizeChanger nzNoResult=\"{{'No data' | translate}}\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th nzWidth=\"35%\"><b>{{'Product name' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='center'><b>{{'Unit' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='center'><b>{{'Quantity' | translate}}</b></th>\r\n                                <th nzWidth=\"15%\" nzAlign='right'><b>{{'Unit price' | translate}}</b></th>\r\n                                <th nzWidth=\"20%\" nzAlign='right'><b>{{'Total' | translate}}</b></th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr *ngFor=\"let item of rowSelectionTable.data\" style=\"cursor: pointer;\">\r\n                                <td>{{item.name}} <br>\r\n                                    <ng-container *ngIf=\"item.lots\">\r\n                                        <pre>{{getLotNumber(item.lots, item.id_lotproduct)}}</pre>\r\n                                    </ng-container>\r\n                                    <ng-container *ngIf=\"item.ptype == 5\">\r\n                                        <span class=\"sub-name\" *ngFor=\"let combo of item.combos\">{{combo.quantity}}x\r\n                                            {{combo.name}}\r\n                                            ({{getUnit(combo.units,combo.ratio)}}), </span><br>\r\n                                    </ng-container>\r\n                                </td>\r\n                                <td nzAlign='center'>\r\n                                    {{getUnit(item.units, item.ratio)}}\r\n                                </td>\r\n                                <td nzAlign='center'>{{item.quantity}}</td>\r\n                                <td nzAlign='right'>{{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n                                    <del style=\"font-size: 0.7rem;\">\r\n                                        {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin)\r\n                                        : ''}}\r\n                                    </del>\r\n                                </td>\r\n                                <td nzAlign='right'><b>{{vhAlgorithm.vhcurrencyunit(item.quantity * item.price)}}</b>\r\n                                </td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </nz-table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills not-continue-sell\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div>\r\n                    <b>{{'Invoice code' | translate}}</b>\r\n                    <div> {{invoice.bill_code}}</div>\r\n                </div>\r\n                <div>\r\n                    <b>{{'Salesman' | translate}}</b>\r\n                    <div>{{invoiceInfo.employee.name}}</div>\r\n                </div>\r\n                <div>\r\n                    <b>{{'Sales date' | translate}}</b>\r\n                    <div>{{invoice.date | date: 'dd/MM/yyyy HH:mm'}}</div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\" nz-row>\r\n                <b>{{'Customer information' | translate}}</b>\r\n                <div *ngIf=\"invoiceInfo.partner._id == 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{invoiceInfo.partner.name | translate}}\r\n                </div>\r\n                <div *ngIf=\"invoiceInfo.partner._id != 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{invoiceInfo.partner.name | translate}} - {{invoiceInfo.partner.phone}}\r\n                </div>\r\n                <div *ngIf=\"invoiceInfo.partner._id != 'id_retail'\" nz-col nzSpan=\"24\">\r\n                    {{renderAddress(invoiceInfo.partner)}}\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <span>{{'SubTotal' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n                <!-- <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Platform fee' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.ecommerce_fee_paid_by_seller)}}</div>\r\n                </div> -->\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Discount' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.discount)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Fee' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.fee)}}</div>\r\n                </div>\r\n                <!-- <div class=\"sales-bills-content-tax\" nz-col nzSpan=\"24\">\r\n            <span>{{'Tax' | translate}}</span>\r\n            <div>{{vhAlgorithm.vhpercent(invoice.getTax()/100)}}</div>\r\n            <div>\r\n              {{vhAlgorithm.vhcurrencyunit(invoice.getTaxValue())}}</div>\r\n          </div> -->\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Total' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.total)}}</div>\r\n\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Pay' | translate}}</span>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit_symbol(invoice.payment)}}</div>\r\n\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Rest' | translate}}</span>\r\n                    <div style=\"color: var(--ion-color-vh-red);\">{{vhAlgorithm.vhcurrencyunit_symbol(invoice.total -\r\n                        invoice.payment)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-payment_type\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Payment method' | translate}}</span>\r\n                    <div>{{setPaymentName(this.invoice.payment_type)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\">\r\n                    <span>{{'Note' | translate}}</span>\r\n                    <div>{{invoice.note}}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>","\r\nimport { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { Observable } from 'rxjs';\r\nimport { SalesK57Col3Component } from 'src/app/sales/components/print/sales/sales-k57-col3/sales-k57-col3.component';\r\nimport { SalesK80Col3Component } from 'src/app/sales/components/print/sales/sales-k80-col3/sales-k80-col3.component';\r\nimport { SalesK80Col4Component } from 'src/app/sales/components/print/sales/sales-k80-col4/sales-k80-col4.component';\r\nimport { SalesA5Component } from 'src/app/sales/components/print/sales/sales-a5/sales-a5.component';\r\nimport { SalesA4Component } from 'src/app/sales/components/print/sales/sales-a4/sales-a4.component';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhSaleTikiInvoiceEdit, VhSaleTikiInvoiceDetail, VhSaleTikiInvoiceDetailCombo } from '../tiki-interface';\r\nimport { VhType } from 'src/app/sales/interface/vh-type';\r\n\r\n@Component({\r\n  selector: 'bill-type1-tiki-edit',\r\n  templateUrl: './edit.component.html',\r\n  styleUrls: ['./edit.component.scss']\r\n})\r\nexport class EditComponent implements OnInit {\r\n  invoice: VhSaleTikiInvoiceEdit = this.router.getCurrentNavigation().extras.state.invoice;\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state.dataRestore; //nhớ dữ liệu truyền từ trang trước\r\n  billTiki: any = this.router.getCurrentNavigation().extras.state.billTiki;\r\n  employee: any = {};\r\n  customer: any = {};\r\n  pickerTime = new Date();\r\n  checkPrinter: boolean = false;\r\n  closerBrower: any;\r\n  validProdDetail: boolean = true;//nếu biến này = false tức có sp tiki chưa được liên kết với app\r\n  id_branch: string = this.vhQuerySales.getDefaultBranch()._id;\r\n  invoiceDetail = this.router.getCurrentNavigation().extras.state.invoiceDetail;\r\n  subTotal = 0;\r\n  taxValue = 0;\r\n  isOpenModalTaxCustomer = false;\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private languageService: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhAuth: VhAuth,\r\n    private fncService: FunctionService,\r\n    private nzModalService: NzModalService,\r\n    private cdf: ChangeDetectorRef\r\n  ) {\r\n\r\n  }\r\n  /**Khởi tạo hóa đơn và merge sp của tiki vào billDetail */\r\n  initBill() {\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n    this.setSubTotal();\r\n    this.pickerTime = new Date(this.invoice.date);\r\n  }\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      subTotal += (i.price ? i.price * i.quantity : 0);\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal();\r\n  }\r\n\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee > 0 ? this.subTotal - this.invoice.discount + this.invoice.fee : 0;\r\n    this.cdf.detectChanges();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n\r\n\r\n    this.initBill();\r\n    this.eventKeypress();\r\n    let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales');\r\n    if (printer) this.checkPrinter = printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.discount_price = this.vhAlgorithm.vhnumeral(\".discount-price\");\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral(\".invoice-fee\");\r\n      // this.platform_price = this.vhAlgorithm.vhnumeral(\".platform-price\")\r\n    });\r\n  }\r\n  event: any; // biến lắng nghe\r\n  ngOnDestroy() {\r\n    document.removeEventListener('keydown', this.event, false);\r\n    window.removeEventListener('beforeunload', this.closerBrower, false);\r\n  }\r\n  eventKeypress() {\r\n    this.event = (event: any) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 112 || keycode === 113) event.preventDefault();\r\n      switch (keycode) {\r\n        case 112: this.payInvoice(false);\r\n          break;\r\n        case 113: {\r\n          if (this.checkPrinter) this.payInvoice(true);\r\n          break;\r\n        }\r\n        case 114: {\r\n          this.searchProductList = !this.searchProductList;\r\n          break;\r\n        }\r\n      }\r\n    };\r\n    //sự kiện f5, close tab...\r\n    this.closerBrower = (event: BeforeUnloadEvent) => {\r\n      (event || window.event).returnValue = 'Changes you made may not be saved';\r\n      return 'Changes you made may not be saved';\r\n    };\r\n    window.addEventListener('beforeunload', this.closerBrower);\r\n    document.addEventListener('keydown', this.event, false);\r\n  }\r\n  goBack() {\r\n    this.vhComponent.alertConfirm(`${this.languageService.translate(\"Confirm\")}`, \"\", `${this.languageService.translate(\"Are you sure to cancel the sales order\")}?`, \"OK\", this.languageService.translate('Cancel'))\r\n      .then(() => { this.isExit = true; this.router.navigate([\"/sales/dashboard/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods\"], { state: { dataRestore: this.dataRestore } }); }, () => { });\r\n  }\r\n  // -------set employee-------\r\n  closeAndReceiveEmployee(event) {\r\n    if (event) {\r\n      this.invoice.id_employee = (event);\r\n    }\r\n  }\r\n  setPickerTime(event) {\r\n    if (event.getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n      this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the registration date (\")} ${this.fncService.formatDate(this.vhAuth.getStore().registrationdate)} ${\")\"}`, 8000);\r\n      this.pickerTime = new Date(this.invoice.date);\r\n      this.invoice.date = (this.pickerTime.toISOString());\r\n    }\r\n    else\r\n      this.vhQuerySales.getValidityDate(new Date(event)).then((validitydate: any) => {\r\n\r\n        if (validitydate == null) this.invoice.date = (event);\r\n        else {\r\n          this.pickerTime = new Date(this.invoice.date);\r\n          this.invoice.date = (this.pickerTime.toISOString());\r\n          this.vhComponent.alertMessageDesktop(\"warning\", `${this.languageService.translate(\"You can only create or edit the invoice from the date\")} ${this.fncService.formatDate(validitydate)}`, 8000);\r\n        }\r\n      });\r\n  }\r\n  discount_price: any;\r\n  editDiscount() {\r\n    if (this.discount_price.getRawValue() && this.discount_price.getRawValue() >= 0) {\r\n      this.invoice.discount = (parseFloat(this.discount_price.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"discount-price\")['value'] = this.invoice.discount;\r\n      this.discount_price = this.vhAlgorithm.vhnumeral('.discount-price');\r\n    }\r\n    this.setTotal();\r\n  }\r\n\r\n\r\n\r\n  // platform_price: any = 0; // phí nền tảng\r\n  // /**\r\n  //  * bắt sk thay đổi phí sàn của hóa đơn, gán lại giá trị phí sàn mới cho đơn\r\n  //  * @example this.editPlatformPrice()\r\n  //  */\r\n  // editPlatformPrice() {\r\n  //   if (this.platform_price.getRawValue() && this.platform_price.getRawValue() >= 0) {\r\n  //     this.invoice.ecommerce_fee_paid_by_seller = (parseFloat(this.platform_price.getRawValue()));\r\n  //   }\r\n  //   else {\r\n  //     document.getElementById('platform-price')['value'] = this.invoice.ecommerce_fee_paid_by_seller;\r\n  //     this.platform_price = this.vhAlgorithm.vhnumeral('.platform-price');\r\n  //   }\r\n  // }\r\n\r\n\r\n\r\n  invoice_fee: any;\r\n  editFee() {\r\n    if (this.invoice_fee.getRawValue() && this.invoice_fee.getRawValue() >= 0) {\r\n      this.invoice.fee = (parseFloat(this.invoice_fee.getRawValue()));\r\n    } else {\r\n      document.getElementById(\"invoice-fee\")['value'] = this.invoice.fee;\r\n      this.invoice_fee = this.vhAlgorithm.vhnumeral('.invoice-fee');\r\n    }\r\n    this.setTotal();\r\n  }\r\n\r\n  compareSubTotal() {\r\n    let sub = this.invoiceDetail.reduce((prev: number, next) => prev + next.quantity * next.price, 0);\r\n    if (sub == this.subTotal) return true;\r\n    return false;\r\n  }\r\n\r\n  getCreateUpdateInvoiceDetail(): VhSaleTikiInvoiceDetail[] {\r\n    return this.invoiceDetail.map(item => {\r\n      if (!item.pmtype) {\r\n        let detail: VhSaleTikiInvoiceDetail = {\r\n          id_product: item.id_product,\r\n          ptype: item.ptype,\r\n          price: item.price,\r\n          quantity: item.quantity,\r\n          ratio: item.ratio,\r\n          price_origin: item.price_origin,\r\n        };\r\n        if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct;\r\n        if (item.id_subproduct) detail['id_subproduct'] = item.id_subproduct;\r\n\r\n        if (item.ptype == 5) {\r\n          detail['combos'] = item.combos.map(combo => {\r\n            let product: VhSaleTikiInvoiceDetailCombo = {\r\n              id_product: combo.id_product,\r\n              price: combo.price,\r\n              quantity: combo.quantity,\r\n              ptype: combo.ptype || combo.type,\r\n              ratio: combo.ratio ? combo.ratio : 1,\r\n            };\r\n            if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct;\r\n            if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct;\r\n            return product;\r\n          });\r\n        }\r\n        return detail;\r\n      }\r\n    }).filter(item => item);\r\n\r\n  }\r\n  payInvoice(print?) {\r\n\r\n\r\n\r\n    if (this.vhAuth.checkMyPermission(\"sales_enable_payment\")) {\r\n      if (this.compareSubTotal()) {\r\n        this.vhComponent.alertConfirm(\r\n          !print ? `${this.languageService.translate(\"Pay\")}?` : `${this.languageService.translate(\"Pay & Print\")}?`,\r\n          \"\", \"\", \"OK\", this.languageService.translate(\"Cancel\")\r\n        )\r\n          .then(() => {\r\n            this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n              this.createOrUpdate(1).then((bill: any) => {\r\n                this.vhComponent.hideLoading(0).then(() => {\r\n                  this.vhComponent.showToast(2000,\r\n                    `${this.languageService.translate(\"Issue invoice\")} ${this.languageService.translate(\"Successfully\").toLocaleLowerCase()}`, \"success-toast\"\r\n                  );\r\n                  if (print) this.handlePrint();\r\n                  else this.handle(true);\r\n                });\r\n              }).catch(err => { this.vhComponent.hideLoading(0); this.vhComponent.showToast(2000, err); });\r\n            });\r\n          }, () => { });\r\n      } else this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"The total price of the product is not equal to the subtotal\"));\r\n\r\n    }\r\n    else this.vhComponent.showToast(1500, this.languageService.translate('You do not have this rights'), \"alert-toast\");\r\n  }\r\n\r\n  createOrUpdate(bill_type: 1) {\r\n    return new Promise((resolve, reject) => {\r\n      this.vhQuerySales.updateBill_Billdetail(this.invoice._id, this.invoice, this.getCreateUpdateInvoiceDetail()).then(res => resolve(res)).catch(err => reject(err));\r\n    });\r\n  }\r\n  /**\r\n  * lấy thông tin dữ liệu trang in\r\n  * @returns Promise<any>\r\n  * @example this.checkPrint()\r\n  */\r\n  checkPrint() {\r\n    return new Promise((resolve, rejects) => {\r\n      let printer = this.vhQuerySales.getLocalPrintPage('page_desktop_sales');\r\n      if (printer && printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)].enable) resolve(printer.print_sizes[printer.print_sizes.findIndex(e => e._id == printer.print_size_default)]);\r\n      else rejects(\"No\");\r\n    });\r\n  }\r\n\r\n  /**\r\n   * trả về component của trang in tương ứng\r\n   * @example this.renderPrintPage('print_size_a4')\r\n   * @returns component\r\n   */\r\n  private renderPrintPage(type: 'print_size_a4' | 'print_size_a5' | 'print_size_k80_4c' | 'print_size_k80_3c' | 'print_size_k57_3c') {\r\n    switch (type) {\r\n      case 'print_size_k57_3c': return SalesK57Col3Component;\r\n      case 'print_size_k80_3c': return SalesK80Col3Component;\r\n      case 'print_size_k80_4c': return SalesK80Col4Component;\r\n      case 'print_size_a5': return SalesA5Component;\r\n      case 'print_size_a4': return SalesA4Component;\r\n      default: return SalesA4Component;\r\n    }\r\n  }\r\n\r\n  handle(update?: boolean) {\r\n    this.isExit = true;\r\n    if (update) this.dataRestore['update'] = true;\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods'], { state: { dataRestore: this.dataRestore } });\r\n  }\r\n  handlePrint() {\r\n    this.checkPrint().then((printer) => {\r\n      if (printer)\r\n        this.vhComponent.showModal(this.renderPrintPage(printer['_id']), { printer: printer, invoice: this.invoice, invoice_detail: this.invoiceDetail }, false, false, `modal-print-${printer['_id']}`).then((modal) => {\r\n          modal.onWillDismiss().then(() => this.handle(true));\r\n        });\r\n    }, (err) => this.handle(true));\r\n  }\r\n  // ------thoát trang-----\r\n  isExit: boolean = false;\r\n  checkDeactivate(currentRoute: ActivatedRouteSnapshot, currentState: RouterStateSnapshot, nextState?: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    return nextState.url == '/login' ? true : (this.isExit ? this.isExit : this.vhComponent.alertConfirm(this.languageService.translate(\"Confirm\"), \"\", this.languageService.translate(\"Are you sure to cancel the sales order\"), \"OK\", (this.languageService.translate(\"Cancel\"))).then(() => { return true; }).catch(() => { return false; }));\r\n  }\r\n  /**Phần thêm sản phẩm bổ sung\r\n   * Note : không tính tiền sản phẩm này\r\n   */\r\n  searchProductList: boolean = false;\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      if (data.manylot && !data.id_lotproduct) this.openModalChooseLot(data);\r\n      else\r\n        if (data.combos && data.combos.filter(e => e.lots && !e.id_lotproduct).length) {\r\n          this.tempDetail = data;\r\n          this.show_modal_select_lots_combo = true;\r\n        }\r\n        else\r\n          this.addInvoiceDetailExtraEcommerce(data);\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n\r\n  addInvoiceDetailExtraEcommerce(value: any) {\r\n\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == value['_id'] && detail['free']);\r\n    if (index != -1) {\r\n      if (this.invoiceDetail[index]['quantity'] < 9999999999) this.invoiceDetail[index]['quantity'] += 1;\r\n    } else {\r\n      let detail: any = {\r\n        name: value.name,\r\n        id_product: value._id,\r\n        quantity: 1,\r\n        ptype: value.type,\r\n        unit: value.unit,\r\n        units: value.units,\r\n        ratio: value.ratio,\r\n        price: 0,\r\n        price_origin: value.price,\r\n        id_category: value.id_category,\r\n        free: true, //nếu có trường này thì được quyền chỉnh số lượng\r\n        id_subproduct: value.id_subproduct,\r\n        lots: value.lots,\r\n        id_lotproduct: value.id_lotproduct,\r\n      };\r\n\r\n      if (value.type == 5) {\r\n        detail['subComboName'] = value.subComboName;\r\n        detail['combos'] = [...value.combos.map(item => {\r\n          let product: any = {\r\n            id_product: item.id_product, name: item.name, ptype: item.type,\r\n            price: 0, quantity: item.quantity, id_subproduct: item.id_subproduct,\r\n            lots: item.lots,\r\n            id_lotproduct: item.id_lotproduct, units: item.units, ratio: item.ratio,\r\n            free: true//nếu có trường này thì được quyền chỉnh số lượng\r\n          };\r\n          return product;\r\n        })];\r\n      }\r\n\r\n      this.invoiceDetail.unshift(detail);\r\n    }\r\n\r\n  }\r\n\r\n  checkQuantityProduct(product: VhSaleTikiInvoiceDetail, event) {\r\n    const MIN_PRICE = 1;\r\n\r\n    const oldQuantity = product.quantity;\r\n    const oldPrice = product.price;\r\n    const originalTotal = oldQuantity * oldPrice;\r\n\r\n    const newQuantity = event || 1;\r\n    const newPrice = originalTotal / newQuantity;\r\n\r\n    if (newPrice < MIN_PRICE) {\r\n      return;\r\n    }\r\n\r\n    product.quantity = newQuantity;\r\n    product.price = newPrice;\r\n\r\n    this.setSubTotal();\r\n    this.cdf.detectChanges();\r\n  }\r\n  /**\r\n   * bắt sk thay đổi đơn vị của bill_detail\r\n   * @param ev  ratio được chọn\r\n   * @param item\r\n   * @example  this.changeUnit(24, bill_detail_selected)\r\n   */\r\n  changeUnit(ev, item) {\r\n\r\n    let unit = this.vhQuerySales.getUnit_byRatio(item.units, ev);\r\n    if (unit) {\r\n      item.unit = unit.unit;\r\n\r\n      item.ratio = parseFloat(unit.ratio);\r\n\r\n    }\r\n\r\n  }\r\n  // -------modal edit unit price-------\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  unit_price: any;\r\n  tempDetail: VhSaleTikiInvoiceDetail;\r\n  openEditUnitPrice(detail: VhSaleTikiInvoiceDetail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.unit_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n  handleEditUnit() {\r\n    if (this.unit_price.getRawValue() != '' && this.unit_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.unit_price.getRawValue());\r\n      this.isVisibleEditUnitPrice = false;\r\n      this.setSubTotal();\r\n    } else { this.vhComponent.showToast(2000, this.languageService.translate(\"Invalid data, please check again\"), \"alert-toast\"); }\r\n  }\r\n  deleteGoods(detail: VhSaleTikiInvoiceDetail) {\r\n    this.vhComponent.alertConfirm(\"\", \"\", `${this.languageService.translate(\"Delete\")} ${detail.name}?`, \"OK\", this.languageService.translate(\"Cancel\"))\r\n      .then(() => this.removeInvoiceDetail(detail.id_product), () => { });\r\n  }\r\n\r\n  removeInvoiceDetail(id: string) {\r\n    let index = this.invoiceDetail.findIndex(detail => detail['id_product'] == id);\r\n    if (index != -1) {\r\n      this.invoiceDetail.splice(index, 1);\r\n      this.setSubTotal();\r\n    }\r\n  }\r\n  /**\r\n  * Thêm sản phẩm đã bán vào cart\r\n  */\r\n  addInvoiceDetail(order_items: Array<any>) {\r\n    let products: Array<any> = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden).filter(item => item[this.id_branch] && item[this.id_branch].tikis && item[this.id_branch].tikis.length >= 0);\r\n    for (let item of order_items) {\r\n      let findSuccess: boolean = false;\r\n      for (let productOfBranch of products) {\r\n        let findProduct = productOfBranch[this.id_branch].tikis.find(data => data.product_id == item.product.id);\r\n        if (findProduct) {\r\n          findSuccess = true;\r\n          this.addInvoiceDetailTiki(item.price, item.qty, productOfBranch, true);\r\n          break;\r\n        }\r\n      }\r\n      if (!findSuccess) {\r\n        this.addInvoiceDetailTiki(item.price, item.qty, { name: item.product.name }, false);\r\n        this.validProdDetail = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  addInvoiceDetailTiki(price, quantity, product, exist) {\r\n    if (exist) {\r\n      const productToAdd = {\r\n        name: product.name,\r\n        id_product: product._id,\r\n        quantity: quantity,\r\n        ptype: product.type,\r\n        unit: product.unit,\r\n        price: price,\r\n        ratio: 1,\r\n        units: product.units,\r\n        price_origin: product.price_origin || null,\r\n        id_subproduct: product.id_subproduct,\r\n        lots: product.lots,\r\n        id_lotproduct: product.id_lotproduct,\r\n        free: false //nếu có trường này true thì được quyền chỉnh số lượng\r\n      }\r\n      if(product.type == VhType.COMBO) {\r\n        productToAdd['combos'] = product.combos;\r\n      }\r\n      this.invoiceDetail.unshift(productToAdd);\r\n    } else {\r\n      this.invoiceDetail.unshift({\r\n        id_product: null,\r\n        quantity: quantity,\r\n        price: price,\r\n        ptype: 1,\r\n\r\n        ratio: 1,\r\n        name: product.name\r\n      });\r\n    }\r\n  }\r\n\r\n  warning_lot_expried: boolean = this.vhQuerySales.getLocalAppSettingNameBranch('permission_branch').warning_lot_expried;\r\n  getUnit(units: any[], ratio) {\r\n    return this.vhQuerySales.getUnit_byRatio(units, ratio).unit;\r\n  }\r\n\r\n  show_modal_select_lots = false;\r\n  list_search_lot = [];\r\n\r\n  getLotNumber(lots, _id) {\r\n    let lot = lots.find(item => item._id == _id);\r\n    return lot.lot_number;\r\n  }\r\n  searchLot(value) {\r\n    this.tempDetail.lots = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.list_search_lot, ['lot_number']);\r\n  }\r\n  openModalChooseLot(data) {\r\n    this.tempDetail = data;\r\n    this.list_search_lot = this.tempDetail.lots;\r\n    if (!this.list_search_lot.length) this.vhComponent.alertMessageDesktop(\"error\", this.languageService.translate(\"Sản phẩm này không có lô khả dụng để bán!\"));\r\n    else this.show_modal_select_lots = true;\r\n  }\r\n\r\n  changeLot(e) {\r\n    this.tempDetail.lot_number = this.tempDetail.lots.find(item => item._id == e).lot_number;\r\n  }\r\n\r\n  handleChooseLot() {\r\n    if (this.warning_lot_expried) {\r\n      let lot_select = this.list_search_lot.find(e => e._id == this.tempDetail.id_lotproduct);\r\n      if (new Date().getTime() >= new Date(lot_select.date_exp).getTime()) {\r\n        this.nzModalService.confirm({\r\n          nzTitle: this.languageService.translate(\"Lô này đã hết hạn! Tiếp tục bán sản phẩm này?\"),\r\n          nzOnOk: () => {\r\n            this.show_modal_select_lots = false;\r\n            this.tempDetail.lots = this.list_search_lot;\r\n            if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n          },\r\n          nzOnCancel: () => {\r\n            // this.show_modal_select_lots = false;\r\n            // this.tempDetail.lots = this.list_search_lot;\r\n          }\r\n\r\n        });\r\n      }\r\n      else {\r\n        this.show_modal_select_lots = false;\r\n        this.tempDetail.lots = this.list_search_lot;\r\n        if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n      }\r\n    }\r\n    else {\r\n      this.show_modal_select_lots = false;\r\n      this.tempDetail.lots = this.list_search_lot;\r\n      if (!this.tempDetail.id_product) this.closeSearchProductList(this.tempDetail);\r\n    }\r\n  }\r\n\r\n  handleCancelChooseLot() {\r\n    this.show_modal_select_lots = false;\r\n    this.tempDetail.lots = this.list_search_lot;\r\n  }\r\n\r\n  show_modal_select_lots_combo = false;\r\n  handleChooseLotCombo() {\r\n    if (this.tempDetail.combos.filter(item => item.lots && !item.id_lotproduct).length)\r\n      this.vhComponent.alertMessageDesktop(\"warning\", this.languageService.translate(\"Vui lòng chọn lô cho sản phẩm thuộc combo này\"));\r\n    else {\r\n      this.show_modal_select_lots_combo = false;\r\n      this.closeSearchProductList(this.tempDetail);\r\n    }\r\n  }\r\n\r\n  onClose(event) {\r\n    this.isOpenModalTaxCustomer = false;\r\n  }\r\n\r\n  /**\r\n   * Khi ok trong modal chỉnh sửa customer tax\r\n   * @param customerTaxInfo\r\n   */\r\n  onOkEditTax(customerTaxInfo) {\r\n    this.isOpenModalTaxCustomer = false;\r\n    Object.assign(this.invoice, customerTaxInfo);\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n\r\n<nz-layout>\r\n    <div class=\"sales hide-best-selling\">\r\n        <div class=\"sales-cart\">\r\n            <div class=\"sales-cart-header\" nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"12\" class=\"title\">\r\n                    <b>{{\"Order number\" | translate}}: <a target=\"_blank\"\r\n                        href=\"https://sellercenter.tiki.vn/new#/order/list?filter_date_by=allDays&keyword={{billTiki.code}}&limit=20&order_status_tab=all&page=1&search_type=code&seller_id=5346\">{{billTiki.code}}</a></b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"right-all-content\">\r\n                    <div>\r\n                        <button style=\"width: 97%;\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\"\r\n                            (click)=\"searchProductList =true\">\r\n                            <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                            {{'Search (F4)' | translate}}</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n                <div class=\"invoiceDetail-item\" *ngFor=\"let item of invoiceDetail\">\r\n                    <div nz-row>\r\n                        <div (click)=\"deleteGoods(item)\" nz-col nzSpan=\"1\">\r\n                            <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                                style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"8\">\r\n                            <p class=\"invoiceDetail-item-name\">\r\n                                <span class=\"invoiceDetail-item-name-linked\"\r\n                                    *ngIf=\"item.id_product\">{{item.name}}</span>\r\n                                    <ng-container *ngIf=\"item.lots\">\r\n                                        <span *ngIf=\"item.id_lotproduct\" style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(item)\">{{getLotNumber(item.lots, item.id_lotproduct)}}</span>\r\n                                            <span *ngIf=\"!item.id_lotproduct\" style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(item)\">{{'Select lot' | translate}}</span>\r\n                                    </ng-container>\r\n                                    <span *ngFor=\"let combo of item.combos;index as i\"\r\n                                    style=\"font-size: 0.75rem; color: var(--ion-color-vh-black); font-weight: normal;\">\r\n                                    {{ i == item.combos.length-1 ? combo.quantity + 'x ' +\r\n                                    combo.name + ' (' + getUnit(combo.units,combo.ratio)+ ') ' :\r\n                                    combo.quantity + 'x ' + combo.name + ' (' +\r\n                                    getUnit(combo.units,combo.ratio)+ ') '+\" ,\"}}\r\n                                    <ng-container *ngIf=\"combo.id_lotproduct\">\r\n                                        <span style=\"color:var(--ion-color-vh-green);cursor: pointer;\"\r\n                                            (click)=\"openModalChooseLot(combo)\">{{getLotNumber(combo.lots, combo.id_lotproduct)}}</span>\r\n                                    </ng-container>\r\n                                </span>\r\n                                <span *ngIf=\"!item.id_product\">{{item.name}}\r\n                                    <span class=\"invoiceDetail-item-name-notlinked\">({{\"The products have not been linked\" | translate}})</span></span>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"5\" style=\"text-align: right;\">\r\n                            <nz-input-number (ngModelChange)=\"checkQuantityProduct(item,$event)\"\r\n                                [ngModel]=\"item.quantity\" [nzMin]=\"0.1\">\r\n                            </nz-input-number>\r\n                        </div>\r\n                        <!-- <div (click)=\"openEditUnitPrice(item)\" class=\"invoiceDetail-item-price text-end\" nz-col -->\r\n                        <div class=\"invoiceDetail-item-price text-end\" nz-col\r\n                            nzSpan=\"5\">\r\n                            <p class=\"max-width-two-line\" style=\"border-bottom: 1px var(--ion-color-vh-gray) solid;\r\n              margin-left: 16px;\">\r\n                                <span>{{vhAlgorithm.vhcurrencyunit(item.price)}}</span>\r\n                                <del style=\"margin-left:5px;font-size: 0.8rem;\">\r\n                                    {{item.price_origin > item.price ? vhAlgorithm.vhcurrencyunit(item.price_origin) :\r\n                                    ''}}\r\n                                </del>\r\n                            </p>\r\n                        </div>\r\n                        <div nz-col nzSpan=\"5\" style=\"text-align: right;\">\r\n                            <p class=\"max-width-two-line\">\r\n                                <b>{{vhAlgorithm.vhcurrencyunit(item.price*item.quantity)}}</b>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-staff hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div class=\"sales-bills-staff-name\">\r\n                        <b>{{'Salesman' | translate}}</b>\r\n                        <app-staff [id_employee]=\"invoice.id_employee\"\r\n                            (closeAndReceiveEmployee)=\"closeAndReceiveEmployee($event)\"></app-staff>\r\n                    </div>\r\n                    <div class=\"sales-bills-staff-time\" nz-col nzSpan=\"24\">\r\n                        <b>{{'Sales date' | translate}}</b>\r\n                        <nz-date-picker [(ngModel)]=\"pickerTime\" (ngModelChange)=\"setPickerTime($event)\" nzBorderless\r\n                            nzShowTime style=\"text-align-last: right;\" nzFormat=\"dd/MM/yyyy HH:mm:ss\"></nz-date-picker>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-customer hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\" class=\"sales-bills-customer-info\" nz-row>\r\n                    <b style=\"width: 100%;margin-bottom: 12px;\">{{'Customer information' | translate}}</b>\r\n                    <div class=\"sales-bills-customer-info-name\">\r\n                        {{customer.name}}\r\n                    </div>\r\n                    <div class=\"sales-bills-customer-info-phone\">\r\n                        {{customer.phone}}\r\n                    </div>\r\n                </div>\r\n                <div style=\"margin-top: 12px;\" nz-col nzSpan=\"24\" class=\"sales-bills-customer-info\" nz-row>\r\n                    <span (click)=\"isOpenModalTaxCustomer = true\" style=\"width: 100%;margin-bottom: 12px; color: var(--ion-color-vh-green); cursor: pointer;\">\r\n                        <b>{{'Invoice information' | translate}}</b>\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div class=\"sales-bills-content hideScrollbar\" nz-row>\r\n                <b>{{'Payment information' | translate}}</b>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <div>{{'SubTotal' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(subTotal)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Platform fee' | translate}}<i\r\n                            style=\"font-size: 0.9rem;color: var(--ion-color-vh-red);;margin-left: 4px;\"\r\n                            nzTooltipTitle=\"{{'Vui lòng kiểm tra phí sàn chính xác trước khi phát hành hóa đơn'}}\"\r\n                            nzTooltipPlacement=\"top\" nz-tooltip nz-icon nzType=\"exclamation-circle\"\r\n                            nzTheme=\"outline\"></i></div>\r\n                    <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                        class=\"nz-no-border discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\" nz-input />\r\n                </div>\r\n                <!-- <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Platform fee' | translate}}<i\r\n                            style=\"font-size: 0.9rem;color: var(--ion-color-vh-red);;margin-left: 4px;\"\r\n                            nzTooltipTitle=\"{{'Vui lòng kiểm tra phí sàn chính xác trước khi phát hành hóa đơn'}}\"\r\n                            nzTooltipPlacement=\"top\" nz-tooltip nz-icon nzType=\"exclamation-circle\"\r\n                            nzTheme=\"outline\"></i></div>\r\n                    <input (blur)=\"editPlatformPrice()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.ecommerce_fee_paid_by_seller)\"\r\n                        class=\"nz-no-border platform-price\" type=\"text\" maxlength=\"15\" id=\"platform-price\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-discount\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Discount value' | translate}}</div>\r\n                    <input (blur)=\"editDiscount()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.discount)\"\r\n                        class=\"nz-no-border discount-price\" type=\"text\" maxlength=\"15\" id=\"discount-price\" nz-input />\r\n                </div> -->\r\n                <div class=\"sales-bills-content-fee\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Fee' | translate}}</div>\r\n                    <input (blur)=\"editFee()\" [value]=\"vhAlgorithm.vhcurrencyunit(invoice.fee)\"\r\n                        class=\"nz-no-border invoice-fee\" type=\"text\" maxlength=\"15\" id=\"invoice-fee\" nz-input />\r\n                </div>\r\n                <div class=\"sales-bills-content-total\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Total' | translate}}</div>\r\n                    <div>{{vhAlgorithm.vhcurrencyunit(invoice.total)}}</div>\r\n                </div>\r\n                <div class=\"sales-bills-content-pay\" nz-col nzSpan=\"24\">\r\n                    <div><b>{{'Pay' | translate}}</b></div>\r\n                    <div> <b>{{vhAlgorithm.vhcurrencyunit(invoice.payment)}}</b></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-rest\" nz-col nzSpan=\"24\">\r\n                    <div>{{'Rest' | translate}}</div>\r\n                    <div><b> {{vhAlgorithm.vhcurrencyunit_symbol(invoice.total - invoice.payment)}}</b></div>\r\n                </div>\r\n                <div class=\"sales-bills-content-note\" nz-col nzSpan=\"24\">\r\n                    <textarea class=\"nz-hover-border\" [(ngModel)]=\"invoice.note\" nz-input\r\n                        placeholder=\"{{'Enter note...' | translate}}\"\r\n                        [nzAutosize]=\"{ minRows: 2, maxRows: 4 }\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div nz-row class=\"sales-bills-button\">\r\n                <button [disabled]=\"!validProdDetail || !checkPrinter\" (click)=\"payInvoice(true)\" nz-button\r\n                    class=\"order-and-print\">\r\n                    {{\"Save & Print\"|translate}} (F2)\r\n                </button>\r\n                <button [disabled]=\"!validProdDetail\" (click)=\"payInvoice(false)\" nz-button class=\"order\">\r\n                    {{\"Save\"|translate}} (F1)</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>\r\n<!-- search sp -->\r\n<!-- -----nz-drawer list-product-------- -->\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\" [default_price_type]=\"1\">\r\n</app-search-product>\r\n\r\n\r\n<!--Modal edit unit price-->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Edit unit price' | translate}}\" (nzOnCancel)=\"isVisibleEditUnitPrice = false\"\r\n    (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Unit price' | translate}}</div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\" [value]=\"tempDetail.price\" nz-input\r\n                    placeholder=\"{{'Enter unit price' | translate}}\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"isVisibleEditUnitPrice = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- modal chọn lô/HSD -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice2\" [(nzVisible)]=\"show_modal_select_lots\"\r\n    nzTitle=\"{{'Select lot number' | translate}}\" (nzOnCancel)=\"handleCancelChooseLot()\" (nzOnOk)=\"handleChooseLot()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input type=\"text\" nz-input placeholder=\"{{'Find lot number' | translate}}\" #searchValue\r\n                    (keyup)=\"searchLot(searchValue.value )\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <nz-radio-group [(ngModel)]=\"tempDetail.id_lotproduct\" (ngModelChange)=\"changeLot($event)\" style=\"width:100%;\">\r\n            <div nz-row *ngFor=\"let item of tempDetail.lots\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <label class=\"radio-purchase\" nz-radio [nzValue]=\"item._id\" style=\"width:100%;\">\r\n                        <div nz-row>\r\n                            <div nz-col nzSpan=\"8\">\r\n                                {{item.lot_number}}\r\n                            </div>\r\n\r\n                            <div nz-col nzSpan=\"8\">\r\n                                NSX: {{item.date_mfg | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                            <div nz-col nzSpan=\"8\">\r\n                                HSD: {{item.date_exp | date : 'dd/MM/yyyy'}}\r\n                            </div>\r\n                        </div>\r\n\r\n                    </label>\r\n                </div>\r\n\r\n            </div>\r\n        </nz-radio-group>\r\n        <div *ngIf=\"!tempDetail.lots.length\" style=\"text-align: center;\">{{'No data' | translate}}</div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice2>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelChooseLot()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\" [disabled]=\"!tempDetail.id_lotproduct\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLot()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!-- modal chọn lô/HSD cho combo-->\r\n<nz-modal  nzWidth=\"70vw\"  *ngIf=\"show_modal_select_lots_combo\" [nzFooter]=\"modalFooterEditUnitPrice3\"\r\n    [(nzVisible)]=\"show_modal_select_lots_combo\"\r\n    nzTitle=\"{{'Select lot number for products in combo' | translate}}: {{tempDetail.name}}\"\r\n    (nzOnCancel)=\"show_modal_select_lots_combo = false\" (nzOnOk)=\"handleChooseLotCombo()\">\r\n    <ng-container *nzModalContent>\r\n        <nz-table #basicTable [nzData]=\"tempDetail.combos\" [nzShowPagination]=\"false\" [nzScroll]=\"{ y: '400px' }\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{{\"Product name\" | translate}}</th>\r\n                    <th>{{'Lot number' | translate}}</th>\r\n                    <th>{{'Unit' | translate}}</th>\r\n                    <th>{{'Quantity' | translate}}</th>\r\n                    <th>{{'Unit price' | translate}}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <ng-container *ngFor=\"let data of basicTable.data\">\r\n                    <ng-container *ngIf=\"data.lots\">\r\n\r\n                        <tr>\r\n                            <td>{{ data.name }}</td>\r\n                            <td>\r\n                                <nz-select nzShowSearch nzPlaceHolder=\"{{'Select product batch' | translate}}\"\r\n                                    [(ngModel)]=\"data.id_lotproduct\">\r\n                                    <nz-option *ngFor=\"let element of data.lots\"  nzLabel=\"{{element.lot_number}} - HSD: {{element.date_exp | date: 'dd/MM/yyyy'}}\"\r\n                                        [nzValue]=\"element._id\"></nz-option>\r\n                                </nz-select>\r\n                            </td>\r\n                            <td>{{getUnit(data.units, data.ratio)}}</td>\r\n                            <td>{{ data.quantity }}</td>\r\n                            <td>\r\n                                {{vhAlgorithm.vhcurrencyunit(data.price) }}\r\n\r\n                            </td>\r\n                        </tr>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </tbody>\r\n        </nz-table>\r\n\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice3>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"show_modal_select_lots_combo = false\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleChooseLotCombo()\">{{\"Ok\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<app-modal-customer-tax [isOpenModal]=\"isOpenModalTaxCustomer\" [invoice]=\"invoice\"\r\n    (onClose)=\"onClose($event)\" (onOk)=\"onOkEditTax($event)\"></app-modal-customer-tax>\r\n","import { Component } from '@angular/core';\r\n@Component({\r\n  selector: 'app-add',\r\n  templateUrl: './add.component.html',\r\n  styleUrls: ['./add.component.scss']\r\n})\r\nexport class AddComponent  {\r\n\r\n  constructor(){\r\n\r\n  }\r\n}","<bill-type1-tiki-add></bill-type1-tiki-add>","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\n\r\n@Component({\r\n  selector: 'app-detail-tiki',\r\n  templateUrl: './detail-tiki.component.html',\r\n  styleUrls: ['./detail-tiki.component.scss']\r\n})\r\nexport class DetailTikiComponent implements OnInit {\r\n\r\n  bill: any;\r\n  dataRestore: any;\r\n  heightScroll: any;\r\n  widthScroll: any;\r\n  tong_gia_tri_don: number = 0;\r\n  tong_tiki_giam_gia: number = 0;\r\n  tong_giam_gia_nha_ban: number = 0;\r\n  tong_phi_tra_tiki: number = 0;\r\n  constructor(\r\n    private router: Router,\r\n    private vhQuerySales: VhQuerySales,\r\n    public vhComponent: VhComponent,\r\n    private cdRef: ChangeDetectorRef,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    public functionService: FunctionService\r\n  ) {\r\n    this.bill = this.router.getCurrentNavigation().extras.state.bill;\r\n    this.dataRestore = this.router.getCurrentNavigation().extras.state.dataRestore;\r\n    this.bill.order_date_time_stamp = new Date((this.bill.order_date_time_stamp - 7 * 60 * 60) * 1000)\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    for (let item of this.bill.items) {\r\n      item.tiki_fee = this.getTikiFee(item.seller_income_detail.seller_fees);\r\n      this.tong_gia_tri_don += item.seller_income_detail.item_qty * item.seller_income_detail.item_price + item.seller_income_detail.shipping_fee;\r\n      this.tong_tiki_giam_gia += item.seller_income_detail.discount.discount_shipping_fee.tiki_subsidy;\r\n      this.tong_giam_gia_nha_ban += item.seller_income_detail.discount.discount_shipping_fee.seller_subsidy;\r\n      this.tong_phi_tra_tiki += item.tiki_fee\r\n    }\r\n  }\r\n\r\n  getTikiFee(arr) {\r\n    let total = 0;\r\n    for (let i in arr) {\r\n      total += arr[i].final_amount\r\n    }\r\n    return total\r\n  }\r\n\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\"#order-status-sendo\") && document.querySelector(\".order-status-sendo-header\") && document.querySelector(\"#bill-info\") && document.querySelector(\"#buyer-info\") && document.querySelector(\".ant-table-pagination\")) {\r\n      this.heightScroll = document.querySelector(\"#order-status-sendo\").clientHeight -\r\n        - document.querySelector(\".order-status-sendo-header\").clientHeight - document.querySelector(\"#bill-info\").clientHeight - document.querySelector(\"#buyer-info\").clientHeight - 90 + \"px\";\r\n    }\r\n    if (document.getElementById(\"order-status-sendo\"))\r\n      this.widthScroll = document.getElementById(\"order-status-sendo\").clientWidth + \"px\"\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n  goBack() {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods'], {\r\n      state: { dataRestore: this.dataRestore }\r\n    })\r\n  }\r\n\r\n  gotoPrint() {\r\n    this.router.navigate([\"/sales/dashboard/manage/ecommerce/tiki/print\"], { state: { bill: this.bill, dataRestore: this.dataRestore, path: this.router.url, info_Shop: this.vhQuerySales.getlocalShopListTiki()[this.vhQuerySales.getlocalShopListTiki().findIndex(item => item._id == this.dataRestore.id_shop_selected)] } })\r\n  }\r\n\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{'Back' | translate}}\r\n</div>\r\n<nz-layout id=\"order-status-sendo\" *ngIf=\"bill\">\r\n    <div nz-row class=\"order-status-sendo-header\">\r\n        <div nz-col nzSpan=\"18\" class=\"title\">\r\n            <b>{{'Order code'|translate}}: <span style=\"color: #ee2624;\" (click)=\"vhComponent.copyValue(bill.code)\">\r\n                    #{{bill.code}} <i nz-icon nzType=\"copy\" nzTheme=\"outline\"></i></span></b>\r\n            - <span>{{bill.main_substate_text}}</span>\r\n        </div>\r\n        <div nz-col nzSpan=\"6\" class=\"right-all-content\">\r\n            <button style=\"width: 8vw;\" [disabled]=\"!bill.tracking_number\" class=\" center-all-content\" nz-button\r\n                nzType=\"default\" (click)=\"gotoPrint()\">\r\n                <i nz-icon nzType=\"printer\" nzTheme=\"outline\"></i>\r\n                {{'Print' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div nz-row id=\"bill-info\">\r\n        <div nz-col nzSpan=\"24\">\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Order day' | translate}} : <b> {{bill.created_at | date : \"dd/MM/yyyy HH:mm\"}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Payment method' | translate}} : <b> <span>{{bill.payment.description}}</span></b>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <nz-divider></nz-divider>\r\n    <div nz-row class=\"order-status-sendo-header\">\r\n        <div nz-col nzSpan=\"24\" class=\"title\">\r\n            <b>{{'Product list'|translate}}</b>\r\n        </div>\r\n    </div>\r\n    <!-- Danh sách sản phẩm -->\r\n    <nz-table *ngIf=\"bill.items.length > 0\" #salesOrder_show nzShowPagination nzShowSizeChanger [nzData]=\"bill.items\"\r\n        [nzPageSize]=\"20\" [nzPageSizeOptions]=\"[20, 30, 40, 50, 100, 200]\">\r\n        <thead>\r\n            <tr>\r\n                <th nzLeft nzWidth=\"12%\"><b>{{'Image' | translate}}</b></th>\r\n                <th nzLeft nzWidth=\"23%\"><b>{{'Product information' | translate}}</b></th>\r\n                <th nzWidth=\"13%\"><b>{{'Order value' | translate}}</b></th>\r\n                <th nzWidth=\"13%\"><b>{{'Tiki discount' | translate}}</b></th>\r\n                <th nzWidth=\"13%\"><b>{{'Seller discount' | translate}}</b></th>\r\n                <th nzWidth=\"13%\"><b>{{'Tiki fee' | translate}}</b></th>\r\n                <th nzWidth=\"13%\"><b>{{'Revenue' | translate}}</b></th>\r\n                <!-- <th nzWidth=\"8%\"><b>{{'In stock' | translate}}</b></th> -->\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            <tr *ngFor=\"let data of salesOrder_show.data\">\r\n                <td nzLeft>\r\n                    <img src=\"{{data.product.thumbnail}}\" alt=\"\">\r\n                </td>\r\n                <td nzLeft>\r\n                    <b style=\"position: absolute;top: 16px;right: 0;\">x{{data.qty}}</b>\r\n                    <b (click)=\"vhComponent.copyValue(data.product.name)\"> {{data.product.name}}</b> <br>\r\n                    <span *ngIf=\"data.product.seller_product_code\">{{'Mã sản phẩm'}}</span>: <b>\r\n                        {{data.product.seller_product_code}}</b> <i\r\n                        (click)=\"vhComponent.copyValue(data.product.seller_product_code)\" nz-icon nzType=\"copy\"\r\n                        *ngIf=\"data.product.seller_product_code\" nzTheme=\"outline\"></i> <br>\r\n                    <span>{{'SKU'}}</span>:<b> {{data.product.sku}}</b> <i\r\n                        (click)=\"vhComponent.copyValue(data.product.sku)\" nz-icon nzType=\"copy\" nzTheme=\"outline\"></i>\r\n                    <br>\r\n                    <span>{{'Price' | translate}}</span>:<b> {{vhAlgorithm.vhcurrencyunit(data.price)}}</b>\r\n\r\n                </td>\r\n                <td>{{vhAlgorithm.vhcurrencyunit(data.seller_income_detail.item_price +\r\n                    data.seller_income_detail.shipping_fee)}}</td>\r\n                <td>{{vhAlgorithm.vhcurrencyunit(data.seller_income_detail.discount.discount_shipping_fee.tiki_subsidy)}}\r\n                </td>\r\n                <td>-{{vhAlgorithm.vhcurrencyunit(data.seller_income_detail.discount.discount_shipping_fee.seller_subsidy)}}\r\n                </td>\r\n                <td>{{vhAlgorithm.vhcurrencyunit(data.tiki_fee)}}</td>\r\n                <td>{{vhAlgorithm.vhcurrencyunit(data.invoice.seller_income)}}</td>\r\n                <!-- <td nzWidth=\"8%\">\r\n                </td> -->\r\n            </tr>\r\n            <tr style=\"background-color: #e6f7ff;\">\r\n                <td colSpan=\"2\">\r\n                    <b> {{'Total' | translate}}</b>\r\n                </td>\r\n                <td>\r\n                    <b>{{vhAlgorithm.vhcurrencyunit(tong_gia_tri_don)}}</b>\r\n                </td>\r\n                <td>\r\n                    <b>{{vhAlgorithm.vhcurrencyunit(tong_tiki_giam_gia)}}</b>\r\n                </td>\r\n                <td>\r\n                    <b>-{{vhAlgorithm.vhcurrencyunit(tong_giam_gia_nha_ban)}}</b>\r\n                </td>\r\n                <td>\r\n                    <b>{{vhAlgorithm.vhcurrencyunit(tong_phi_tra_tiki)}}</b>\r\n                </td>\r\n                <td>\r\n                    <b>{{vhAlgorithm.vhcurrencyunit(bill.invoice.total_seller_income)}}</b>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </nz-table>\r\n    <!-- Thông tin người mua -->\r\n    <div nz-row class=\"order-status-sendo-header\">\r\n        <div nz-col nzSpan=\"12\" class=\"title\">\r\n            <b>{{'Payment information' | translate}}</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"12\" class=\"title\">\r\n            <b>{{'Customer information' | translate}}</b>\r\n        </div>\r\n    </div>\r\n    <div nz-row id=\"buyer-info\">\r\n        <div nz-col nzSpan=\"12\" style=\"padding-right: 16px;\">\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Payment_method' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    <b>{{bill.payment.description}} ({{bill.payment.method}})</b>\r\n                </div>\r\n            </div>\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Customer payment' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    <b>{{vhAlgorithm.vhcurrencyunit(bill.invoice.subtotal)}}</b>\r\n                </div>\r\n            </div>\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Statement value (estimated)' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    <b>{{vhAlgorithm.vhcurrencyunit(bill.invoice.total_seller_income)}}</b>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div nz-col nzSpan=\"12\">\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Full_name' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    <b>{{bill.billing_address.full_name}}</b>\r\n                </div>\r\n            </div>\r\n            <div nz-row>\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Delivery address' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    <b>{{bill.billing_address.street}} , {{bill.billing_address.ward}},\r\n                        {{bill.billing_address.district}}, {{bill.billing_address.region}}</b>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div nz-row class=\"order-status-sendo-header\" style=\"margin-top: 16px;\">\r\n        <div nz-col nzSpan=\"12\" class=\"title\">\r\n            <b>{{'Shipping information' | translate}}</b>\r\n        </div>\r\n    </div>\r\n    <div nz-row>\r\n        <div nz-col nzSpan=\"12\">\r\n            <div nz-row style=\"padding-right: 16px;\">\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Shipping package' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    <b> {{bill.shipping.plan.name}}</b> <br>\r\n                    <span style=\"color: gray;\">\r\n                        {{bill.shipping.plan.description}}\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div nz-row style=\"padding-right: 16px;\">\r\n                <div nz-col nzSpan=\"12\">\r\n                    {{'Allowed to view goods' | translate}}:\r\n                </div>\r\n                <div nz-col nzSpan=\"12\" class=\"text-end\">\r\n                    <b>{{'Cho phép xem hàng'}} </b>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-detail',\r\n  templateUrl: './detail.component.html',\r\n  styleUrls: ['./detail.component.scss']\r\n})\r\nexport class DetailComponent { \r\n  constructor(){\r\n\r\n  }\r\n}\r\n","<bill-type1-tiki-detail></bill-type1-tiki-detail>","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-edit',\r\n  templateUrl: './edit.component.html',\r\n  styleUrls: ['./edit.component.scss']\r\n})\r\nexport class EditComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<bill-type1-tiki-edit></bill-type1-tiki-edit>","import { DatePipe } from '@angular/common';\r\nimport { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales, VhAuth } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhSaleTikiInvoiceAdd, VhSaleTikiInvoiceDetail, VhSaleTikiInvoiceDetailCombo } from 'src/app/sales/components/bill-type/bill-type-1/tiki/tiki-interface';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { VhType } from 'src/app/sales/interface/vh-type';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-issue-delivery-goods',\r\n  templateUrl: './issue-delivery-goods.component.html',\r\n  styleUrls: ['./issue-delivery-goods.component.scss']\r\n})\r\nexport class IssueDeliveryGoodsComponent implements OnInit {\r\n  searchValue: any;\r\n  salesOrder: Array<any> = [];\r\n  salesSubOrder: Array<any> = [];\r\n  heightScroll: any;\r\n  public date: Date[] = [new Date(), new Date()];\r\n  load_status: boolean = false;\r\n  dataRestore: any = {};\r\n  bill_selected: any = {};\r\n  /**Giới hạn thời gian cho xem bill */\r\n  disabledDate = (current: Date): boolean => {\r\n    if (current.getTime() < this.minDate.getTime() - 24 * 60 * 60 * 1000) return true;\r\n    return false;\r\n  };\r\n  minDate: Date = new Date(Date.now() - 24 * 60 * 60 * 1000 * 30);\r\n  infoShop: any = {};\r\n  listProductOfBranch: Array<any> = []; // sp của phần mềm có liên kết với tiki\r\n  listProductApp: Array<any> = []; //sp của phần mềm\r\n  listSubProductApp: Array<any> = []; //sp của app chứa tiki[]\r\n  id_branch: string = this.vhQuerySales.getDefaultBranch()._id;\r\n  setHeight = { \"max-height\": \"500px\", \"height\": \"500px\", \"overflow-y\": \"hidden\" };\r\n  arrayHidden: Array<any> = []; //mảng này chứa id của những sp đang tạm ẩn\r\n  searchProductAppValue: any = '';\r\n  invoice: VhSaleTikiInvoiceAdd = {\r\n    bill_type: 1,\r\n    cqt_status: 1,\r\n    payment_type: 2,\r\n    id_customer: '',\r\n    id_branch: '',\r\n    id_employee: '',\r\n    id_wallet: 'id_cash',\r\n    date: '',\r\n    total: 0,\r\n    payment: 0,\r\n    tax: 0,\r\n    discount: 0,\r\n    fee: 0,\r\n    note: '',\r\n    price_type: 0,\r\n    order_number_ecommerce: '',\r\n    id_shop: '',\r\n    tax_buyerDisplayName: '',\r\n    tax_buyerLegalName: '',\r\n    tax_buyerTaxCode: '',\r\n    tax_buyerAddressLine: '',\r\n    tax_buyerEmail: '',\r\n    ecommerce_fee_paid_by_seller: 0,\r\n  };\r\n  invoiceDetail = [];\r\n  employee: any = {};\r\n  customer: any = {};\r\n  subTotal = 0;\r\n  constructor(\r\n    private router: Router,\r\n    public lang: LanguageService,\r\n    public vhComponent: VhComponent,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhQuerySales: VhQuerySales,\r\n    private cdRef: ChangeDetectorRef,\r\n    private datePipe: DatePipe,\r\n    private nzModalService: NzModalService,\r\n    private vhAuth: VhAuth\r\n  ) {\r\n    this.date[0].setHours(0, 0, 0, 0);\r\n    this.date[1].setHours(23, 59, 59, 59);\r\n    this.dataRestore = this.router.getCurrentNavigation().extras.state?.dataRestore || {};\r\n  }\r\n  ngOnInit(): void {\r\n    this.initState();\r\n  }\r\n  initState() {\r\n    if (this.dataRestore.id_shop_selected) {\r\n      this.date = this.dataRestore.date;\r\n      this.searchValue = this.dataRestore.searchValue;\r\n      this.salesOrder = this.dataRestore.salesOrder;\r\n      this.salesSubOrder = this.salesOrder;\r\n      if (this.dataRestore['update']) {\r\n        this.dataRestore['update'] = false;\r\n        this.showReport();\r\n      }\r\n      else\r\n        this.load_status = true;\r\n    }\r\n    this.infoShop = this.vhQuerySales.getlocalShopListTiki()[0];\r\n    this.getMinDate();\r\n\r\n    this.listProductOfBranch = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden).filter(item => item[this.id_branch] && item[this.id_branch].tikis && item[this.id_branch].tikis.length >= 0);\r\n\r\n    let localProducts: Array<any> = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden);\r\n    this.listProductApp = localProducts.map(item => {\r\n      if (item[this.id_branch] && item[this.id_branch].tikis && item[this.id_branch].tikis.length) { //filter những sp tiki thuộc id tiki đã chọn\r\n        item[this.id_branch].tikis = [...item[this.id_branch].tikis.filter(prod => prod.id_shop == this.infoShop._id)];\r\n      }\r\n      return { ...item, ...this.vhQuerySales.getUnit_byRatio(item.units, 1) };\r\n    });\r\n\r\n    this.listSubProductApp = [...this.listProductApp];\r\n  }\r\n  /**\r\n   * Lấy ngày giới hạn được xem báo cáo\r\n  */\r\n  getMinDate() {\r\n    let date = new Date(Date.now() - 24 * 60 * 60 * 1000 * 100);\r\n    this.vhQuerySales.getValidityDate(date).then((validitydate: Date) => {\r\n      this.minDate = validitydate;\r\n      if ((this.minDate.getTime()) < new Date(this.vhAuth.getStore().registrationdate).getTime()) {\r\n        this.disabledDate = (current: Date): boolean => {\r\n          if (current.getTime() < new Date(this.vhAuth.getStore().registrationdate).getTime() - 24 * 60 * 60 * 1000) return true;\r\n          return false;\r\n        };\r\n      }\r\n    });\r\n  }\r\n  /**Tìm kiếm hóa đơn */\r\n  search(value: string) {\r\n    let val: string = this.vhAlgorithm.changeAlias(value.trim().toLowerCase());\r\n    this.salesOrder = this.vhAlgorithm.searchList(val, [...this.salesSubOrder], ['code']);\r\n  }\r\n  /**\r\n   * search tên sản phẩm trong app viethas\r\n   * @example this.search('Sản phẩm A')\r\n   */\r\n  searchProductApp(value: string) {\r\n    let val: string = this.vhAlgorithm.changeAlias(value.trim().toLowerCase());\r\n    this.listProductApp = this.vhAlgorithm.searchList(val, [...this.listSubProductApp],  ['name','barcode','item_code']);\r\n  }\r\n  goBack() {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/tiki/issue-invoice'], {\r\n      state: { dataRestore: this.dataRestore }\r\n    });\r\n  }\r\n  changeTime(event) {\r\n    if (event[1].getTime() - event[0].getTime() <= 2678400000) {\r\n    } else {\r\n      this.vhComponent.showToast(2000, this.lang.translate(\"The time to view no more than 30 days\"), \"alert-toast\");\r\n      this.date = [event[0], event[0].getTime() + 2678400000];\r\n    }\r\n  }\r\n  showReport() {\r\n    this.load_status = true;\r\n    this.salesOrder = [];\r\n    this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n      this.vhQuerySales.getSalesOrderListTiki(this.datePipe.transform(new Date(this.date[0].setHours(0, 0, 0)), \"yyyy-MM-dd HH:mm:ss\").toString(), this.datePipe.transform(new Date(this.date[1].setHours(23, 59, 59)), \"yyyy-MM-dd HH:mm:ss\").toString(), this.infoShop.access_token, this.infoShop._id)\r\n        .then((result: Array<any>) => {\r\n          this.vhComponent.hideLoading(0);\r\n          result.forEach(item => {\r\n            if (item.verify_status_delivered_goods) this.salesOrder.push(item);\r\n          });\r\n          this.salesSubOrder = [...this.salesOrder];\r\n\r\n          console.log(this.salesOrder);\r\n        })\r\n        .catch(err => this.vhComponent.hideLoading(0));\r\n    });\r\n  }\r\n  changeShop(event) { }\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\"#tiki-issue-invoice\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".tiki-issue-invoice-header\") && document.querySelector(\".ant-table-pagination\")) {\r\n      this.heightScroll = document.querySelector(\"#tiki-issue-invoice\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".tiki-issue-invoice-header\").clientHeight - 90 + \"px\";\r\n    }\r\n\r\n    this.cdRef.detectChanges();\r\n  }\r\n  gotoCreateBill(bill: any) {\r\n    //tìm customer để loại trừ bug khách hàng bị xóa rồi\r\n    let customer: any = this.vhQuerySales.getlocalCustomer(this.infoShop.data?.id_customer);\r\n    if (customer) {\r\n      this.router.navigate(['/sales/dashboard/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/add'], {\r\n        state: { dataRestore: { ...this.dataRestore, searchValue: this.searchValue, id_shop_selected: this.infoShop._id, date: this.date, salesOrder: this.salesOrder }, billTiki: bill }\r\n      });\r\n    } else this.vhComponent.alertMessageDesktop('warning', this.lang.translate('Please update customer in settings'));\r\n  }\r\n  gotoDetail(bill: any) {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/detail'], {\r\n      state: { dataRestore: { ...this.dataRestore, searchValue: this.searchValue, id_shop_selected: this.infoShop._id, date: this.date, salesOrder: this.salesOrder }, id: bill.id_bill_delivered_goods, billTiki: bill }\r\n    });\r\n  }\r\n  gotoDetailTiki(bill) {\r\n    this.router.navigate(['/sales/dashboard/manage/ecommerce/tiki/issue-invoice/issue-delivery-goods/detail-tiki'],\r\n      {\r\n        state: {\r\n          bill: bill,\r\n          dataRestore: {\r\n            salesOrder: this.salesOrder, searchValue: this.searchValue,\r\n            id_shop_selected: this.infoShop._id, listProduct: this.dataRestore.listProduct,\r\n            date: this.date,\r\n            salesSubOrder: this.salesSubOrder,\r\n          }\r\n        }\r\n      });\r\n  }\r\n\r\n  findProductLinked(item) {\r\n    for (let productOfBranch of this.listProductOfBranch) {\r\n      let findProduct = productOfBranch[this.id_branch].tikis.find(data => data.product_id == item.product.id);\r\n      if (findProduct) {\r\n        return productOfBranch;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Kiểm tra sản phẩm đã được lien kết hay chưa\r\n   *\r\n   */\r\n  isLinkedToProduct(item): boolean {\r\n    for (let productOfBranch of this.listProductOfBranch) {\r\n      let findProduct = productOfBranch[this.id_branch].tikis.find(data => data.product_id == item.product.id);\r\n      if (findProduct) {\r\n        return true;\r\n      }\r\n\r\n    };\r\n    return false;\r\n  }\r\n\r\n  visible_affiliate: boolean = false; // hiển thị modal chọn sản phẩm phần mềm liên kết\r\n  productTikiSelected: any = null; // sản phẩm tiki được chọn để lien kết\r\n\r\n\r\n  openModelSelectProductsTiki(productTiki) {\r\n    this.productTikiSelected = productTiki;\r\n    this.visible_affiliate = true;\r\n  }\r\n\r\n\r\n  /**\r\n   * Tắt modal và clone mảng product ra một mảng mới để tránh nhớ lại product cũ bị checked\r\n   */\r\n  cancelAffiliate() {\r\n    this.visible_affiliate = false;\r\n  }\r\n\r\n\r\n  /**\r\n    * Liên kết sản phẩm từ tiki với sản phẩm tại cửa hàng.\r\n    * @param product Sản phẩm của cửa hàng\r\n    */\r\n  acceptAfiliate(product) {\r\n    const isZeroPriceCombo = product.type === VhType.COMBO && product.units[0].price === 0;\r\n    const confirmZeroPriceComboMessage = this.lang.translate(\"This product is a combo with a price of 0. Do you still want to link it with the product\", { platform: 'Tiki' }) + \"?\";\r\n\r\n    this.nzModalService.confirm({\r\n      nzTitle: '<i>' + (isZeroPriceCombo ? confirmZeroPriceComboMessage : this.lang.translate(\"Confirm\")) + '</i>',\r\n      nzIconType: \"info-circle\",\r\n      nzCancelText: this.lang.translate(\"Cancel\"),\r\n      nzOnOk: () => {\r\n        this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n          const id_product_selected = product.id_subproduct ? product.id_subproduct : product['_id'];\r\n          this.vhQuerySales.addMergeTikiProduct(id_product_selected, [this.productTikiSelected.product.id], this.infoShop['_id']).then((bool) => {\r\n            this.vhComponent.hideLoading().then(() => {\r\n              setTimeout(() => {\r\n                this.visible_affiliate = false;\r\n                this.listProductOfBranch = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden).filter(item => item[this.id_branch] && item[this.id_branch].tikis && item[this.id_branch].tikis.length >= 0);\r\n                this.vhComponent.alertMessageDesktop('success', this.lang.translate(\"Product linked successfully\"));\r\n              }, 300);\r\n            });\r\n          }).catch(err => {\r\n            console.error(err);\r\n            this.visible_affiliate = false;\r\n            this.vhComponent.alertMessageDesktop('error', this.lang.translate(\"The product link failed\"));\r\n            this.vhComponent.hideLoading(0);\r\n          });\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**Xóa những sp đã được liên kết rồi ra khỏi mảng của modal danh sách sp liên kết\r\n   * @param listProduct : danh sách sp đã lk với sàn\r\n   * @param listProductApp : toàn bộ danh sách sp của app\r\n   * @example let daa =  this.clearProductShow([], [])\r\n   *\r\n  */\r\n  clearProductShow(listProduct, listProductApp) {\r\n    for (let prodApp of listProductApp) {\r\n      if (prodApp[this.id_branch] && prodApp[this.id_branch].tikis && prodApp[this.id_branch].tikis.length) {\r\n        for (let item of prodApp[this.id_branch].tikis) {\r\n          let indexProd = listProduct.findIndex(prod => prod.product_id == item.product_id);\r\n          if (indexProd >= 0)\r\n            listProduct.splice(indexProd, 1);\r\n        }\r\n      }\r\n    }\r\n    return listProduct;\r\n  }\r\n\r\n  /* ----------- THANH TOÁN HÓA ĐƠN HÀNG LOẠT ------ */\r\n\r\n\r\n  checkAll: boolean = false;\r\n  selectedBills: { [id: string]: boolean; } = {};\r\n  listInvoiceSelected = [];\r\n\r\n  toggleSelectAll(checked: boolean) {\r\n    this.checkAll = checked;\r\n    this.listInvoiceSelected = []; // reset before adding\r\n\r\n    for (let bill of this.salesOrder) {\r\n      const canSelect = !bill.id_bill_delivered_goods && this.billIsLinkedToProduct(bill);\r\n\r\n      if (canSelect) {\r\n        this.selectedBills[bill.code] = checked;\r\n\r\n        if (checked) {\r\n          this.listInvoiceSelected.push(bill);\r\n        }\r\n      } else {\r\n        // ensure unselect disabled ones\r\n        this.selectedBills[bill.code] = false;\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  billIsLinkedToProduct(bill) {\r\n    return bill.items.every(item => this.isLinkedToProduct(item));\r\n  }\r\n\r\n  checkBillToCreateInvoice(bool, bill) {\r\n    this.selectedBills[bill.code] = bool;\r\n    if (bool) {\r\n      this.listInvoiceSelected.push(bill);\r\n    }\r\n    else {\r\n      this.listInvoiceSelected = this.listInvoiceSelected.filter(item => item.code != bill.code);\r\n    }\r\n\r\n    const allBillsCanSelect = this.salesOrder.filter(\r\n      b => !b.id_bill_delivered_goods && this.billIsLinkedToProduct(b)\r\n    );\r\n\r\n    this.checkAll = allBillsCanSelect.every(b => this.selectedBills[b.code]);\r\n  }\r\n\r\n  payInvoice() {\r\n    this.vhComponent.alertConfirm(\r\n      `${this.lang.translate(\"Pay\")}?`,\r\n      \"\", \"\", \"OK\", this.lang.translate(\"Cancel\")\r\n    )\r\n      .then(() => {\r\n        this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n          const updatePromises = [];\r\n\r\n          for (let index = 0; index < this.listInvoiceSelected.length; index++) {\r\n            const billTiki = this.listInvoiceSelected[index];\r\n            this.initBill(billTiki);\r\n\r\n\r\n            const promise = this.createOrUpdate(1).then((bill: any) => {\r\n              this.salesOrder.find(item => item.code == billTiki['code']).id_bill_delivered_goods = bill._id;\r\n              if (this.invoice.cqt_status !== 1) {\r\n                this.vhQuerySales.updateBill(bill._id, { cqt_status: this.invoice.cqt_status });\r\n              }\r\n              return this.vhQuerySales.updateSalesOrderTiki(this.infoShop._id, billTiki['code'], { id_bill_delivered_goods: bill._id });\r\n            });\r\n\r\n            updatePromises.push(promise.catch(err => {\r\n              this.vhComponent.showToast(2000, err);\r\n              return null;\r\n            }));\r\n          }\r\n\r\n          // Wait for all promises to resolve (or reject caught above)\r\n          Promise.all(updatePromises).then(() => {\r\n            this.vhComponent.hideLoading(0).then(() => {\r\n              this.vhComponent.showToast(2000,\r\n                `${this.lang.translate(\"Issue invoice\")} ${this.lang.translate(\"Successfully\").toLocaleLowerCase()}`, \"success-toast\"\r\n              );\r\n            });\r\n          });\r\n        });\r\n      }, () => { });\r\n\r\n    // }\r\n    // else this.vhComponent.showToast(1500, this.languageService.translate('You do not have this rights'), \"alert-toast\")\r\n  }\r\n\r\n  createOrUpdate(bill_type: 1) {\r\n    return new Promise((resolve, reject) => {\r\n      this.vhQuerySales.createBill_Billdetail({ ...this.invoice }, this.getCreateUpdateInvoiceDetail()).then(res => resolve(res)).catch(err => reject(err));\r\n    });\r\n  }\r\n\r\n  /**\r\n  * Thêm sản phẩm đã bán vào cart\r\n  */\r\n  addInvoiceDetail(items: Array<any>) {\r\n    let products: Array<any> = this.vhQuerySales.getlocalDetailProducts(35).filter(e => !e.delete_hidden).filter(item => item[this.id_branch] && item[this.id_branch].tikis && item[this.id_branch].tikis.length >= 0);\r\n    for (let item of items) {\r\n      let findSuccess: boolean = false;\r\n      for (let productOfBranch of products) {\r\n        let findProduct = productOfBranch[this.id_branch].tikis.find(data => data.product_id == item.product.id);\r\n        if (findProduct) {\r\n          findSuccess = true;\r\n          this.addInvoiceDetailTiki(item.invoice.row_total, item.price, item.qty, productOfBranch, true);\r\n          break;\r\n        }\r\n      }\r\n      if (!findSuccess) {\r\n        this.addInvoiceDetailTiki(item.invoice.row_total, item.price, item.qty, { name: item.product.name }, false);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param price\r\n   * @param product\r\n   * @param exist\r\n   */\r\n  addInvoiceDetailTiki(price, price_origin, quantity, product, exist) {\r\n    if (exist) {\r\n      const productToAdd = {\r\n        name: product.name,\r\n        id_product: product._id,\r\n        quantity: quantity,\r\n        ptype: product.type,\r\n        unit: product.unit,\r\n        price: price,\r\n        ratio: 1,\r\n        units: product.units,\r\n        price_origin: price_origin || null,\r\n        id_subproduct: product.id_subproduct,\r\n        lots: product.lots,\r\n        id_lotproduct: product.id_lotproduct,\r\n        free: false //nếu có trường này true thì được quyền chỉnh số lượng\r\n      }\r\n      if(product.type == VhType.COMBO) {\r\n        productToAdd['combos'] = product.combos;\r\n      }\r\n      this.invoiceDetail.unshift(productToAdd);\r\n    } else {\r\n      this.invoiceDetail.unshift({\r\n        id_product: null,\r\n        quantity: quantity,\r\n        price: price,\r\n        ptype: 1,\r\n        ratio: 1,\r\n        name: product.name\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n     * trả về danh sách bill_detail đã format theo đúng chuẩn các trường để lưu DB\r\n     * @returns array bill_detail\r\n     * @example let bill_details = getCreateUpdateInvoiceDetail()\r\n     */\r\n  getCreateUpdateInvoiceDetail(): VhSaleTikiInvoiceDetail[] {\r\n    return this.invoiceDetail.map(item => {\r\n\r\n      let detail: VhSaleTikiInvoiceDetail = {\r\n        id_product: item.id_product,\r\n        ptype: item.ptype,\r\n        price: item.price,\r\n        quantity: item.quantity,\r\n        ratio: item.ratio,\r\n        price_origin: item.price_origin,\r\n      };\r\n      if (item.id_lotproduct) detail['id_lotproduct'] = item.id_lotproduct;\r\n      if (item.id_subproduct) detail['id_subproduct'] = item.id_subproduct;\r\n\r\n      if (item.ptype == 5) {\r\n        detail['combos'] = item.combos.map(combo => {\r\n          let product: VhSaleTikiInvoiceDetailCombo = {\r\n            id_product: combo.id_product,\r\n            price: combo.price,\r\n            quantity: combo.quantity,\r\n            ptype: combo.ptype || combo.type,\r\n            ratio: combo.ratio ? combo.ratio : 1,\r\n          };\r\n          if (combo.id_lotproduct) product['id_lotproduct'] = combo.id_lotproduct;\r\n          if (combo.id_subproduct) product['id_subproduct'] = combo.id_subproduct;\r\n          return product;\r\n        });\r\n      }\r\n      return detail;\r\n\r\n    }).filter(item => item);\r\n\r\n  }\r\n  pickerTime = new Date();\r\n\r\n  initBill(billTiki) {\r\n    this.resetInvoice();\r\n\r\n    this.invoice.date = this.pickerTime.toISOString();\r\n    this.invoice.id_employee = this.vhAuth.getUser()._id;\r\n    this.employee = this.vhAuth.getlocalEmployee(this.invoice.id_employee);\r\n    this.invoice.id_branch = (this.vhQuerySales.getDefaultBranch()._id);\r\n    this.invoice.id_customer = (this.vhQuerySales.getlocalShopListTiki().find(item => item._id == this.infoShop._id).data.id_customer);\r\n    this.customer = this.vhQuerySales.getlocalCustomer(this.invoice.id_customer);\r\n    this.invoice.payment_type = (2); //set bill công nợ\r\n    this.invoice.fee = billTiki.invoice.shipping_amount_after_discount;\r\n    /** Để cộng dồn tiền seller giảm giá phí ship trong từng bill detail shipping_fee_discountAmount */\r\n    let shipping_fee_discountAmount = 0;\r\n    for (let i = 0; i < billTiki['items'].length; i++) {\r\n      // cộng dồn phần giảm giá từ seller\r\n      this.invoice.discount += billTiki['items'][i].invoice?.is_seller_discount_coupon ? billTiki['items'][i]?.seller_income_detail?.discount?.discount_coupon?.seller_discount : 0;\r\n      // Cộng dồn tiền seller giảm giá phí ship\r\n      shipping_fee_discountAmount += billTiki['items'][i].seller_income_detail.discount?.discount_shipping_fee?.seller_subsidy || 0;\r\n    }\r\n    this.invoice.ecommerce_fee_paid_by_seller = Math.abs(billTiki.invoice?.total_seller_fee) - shipping_fee_discountAmount;\r\n    this.addInvoiceDetail(billTiki.items);\r\n    this.setSubTotal();\r\n    this.invoice.order_number_ecommerce = (billTiki['code'].toString());\r\n    this.invoice.id_shop = (this.infoShop._id);\r\n    this.invoice.note = (`${this.lang.translate(\"Order number\")} Tiki ${billTiki['code']}`);\r\n    this.invoice.tax_buyerDisplayName = this.invoice.tax_buyerDisplayName ? this.invoice.tax_buyerDisplayName : 'Người mua không lấy hóa đơn';\r\n    this.invoice.cqt_status = billTiki.cqt_status ? billTiki.cqt_status : 1;\r\n  }\r\n\r\n  /**\r\n   * tính và gán lại cộng tiền (subTotal) của đơn\r\n   * @example this.setSubTotal()\r\n   */\r\n  setSubTotal() {\r\n    let subTotal = 0;\r\n    for (let i of this.invoiceDetail) {\r\n      subTotal += (i.price ? i.price * i.quantity : 0);\r\n    }\r\n    this.subTotal = subTotal;\r\n    this.setTotal();\r\n  }\r\n\r\n  /**\r\n   * tính và gán lại tổng tiền (total) của đơn\r\n   * @example this.setTotal()\r\n   */\r\n  setTotal() {\r\n    this.invoice.total = this.subTotal - this.invoice.discount + this.invoice.fee > 0 ? this.subTotal - this.invoice.discount + this.invoice.fee : 0;\r\n  }\r\n\r\n  resetInvoice() {\r\n    this.invoice = {\r\n      bill_type: 1,\r\n      cqt_status: 1,\r\n      payment_type: 2,\r\n      id_customer: '',\r\n      id_branch: '',\r\n      id_employee: '',\r\n      id_wallet: 'id_cash',\r\n      date: '',\r\n      total: 0,\r\n      payment: 0,\r\n      tax: 0,\r\n      discount: 0,\r\n      fee: 0,\r\n      note: '',\r\n      price_type: 0,\r\n      order_number_ecommerce: '',\r\n      id_shop: '',\r\n      tax_buyerDisplayName: '',\r\n      tax_buyerLegalName: '',\r\n      tax_buyerTaxCode: '',\r\n      tax_buyerAddressLine: '',\r\n      tax_buyerEmail: '',\r\n      ecommerce_fee_paid_by_seller: 0,\r\n    };\r\n    this.invoiceDetail = [];\r\n  }\r\n  \r\n  \r\n  \r\n  /**\r\n   * Đếm số lượng bill đang check\r\n   */\r\n  get countSelectedBill(): number {\r\n    let count = 0;\r\n    for (let key in this.selectedBills) {\r\n      if (this.selectedBills[key]) {\r\n        count++;\r\n      }\r\n    }\r\n    return count;\r\n  }\r\n  \r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{'Back' | translate}}\r\n</div>\r\n<nz-layout id=\"tiki-issue-invoice\">\r\n    <div nz-row nzGutter=\"4\" class=\"tiki-issue-invoice-header\">\r\n        <div nz-col nzSpan=\"4\" class=\"title\">\r\n            <b>{{'Goods delivered'|translate}}</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"5\">\r\n            {{'Shop name' | translate}} : <b class=\"color-green\">{{infoShop.data?.name}}</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"6\" class=\"title center-all-content\">\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\">\r\n                <input [(ngModel)]=\"searchValue\" (ngModelChange)=\"search($event)\" type=\"text\" nz-input\r\n                    placeholder=\"{{('Search for order code' | translate)}}\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n        </div>\r\n        <div nz-col nzSpan=\"6\">\r\n             <nz-range-picker nzFormat='dd/MM/yyyy'  [nzDisabledDate]=\"disabledDate\" [(ngModel)]=\"date\" (ngModelChange)=\"changeTime($event)\">\r\n            </nz-range-picker>\r\n        </div>\r\n        <div nz-col nzSpan=\"3\" class=\"right-all-content\">\r\n            <div style=\"display: flex; gap: 4px;\">\r\n                <button class=\"btn-view center-all-content\" nz-button nzType=\"default\" (click)=\"showReport()\">\r\n                    <ion-icon src=\"assets/icon/management/view.svg\"></ion-icon>\r\n                    {{'View' | translate}}\r\n                </button>\r\n                <button [disabled]=\"this.listInvoiceSelected.length == 0\" (click)=\"payInvoice()\" nz-button class=\"btn-green\">{{\"Create bulk invoices\" | translate}}</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"load_status else no_data\" nz-row nzGutter=\"16\" class=\"tiki-issue-invoice-body\">\r\n        <div nz-col nzSpan=\"24\">\r\n            <nz-table [nzPageSize]=\"20\" [nzPageSizeOptions]=\"[20, 30, 40, 50, 100, 200]\"\r\n                *ngIf=\"salesOrder.length > 0;else no_bill\" [nzScroll]=\"{y: heightScroll }\" #salesOrder_show\r\n                nzShowPagination nzShowSizeChanger [nzData]=\"salesOrder\">\r\n                <thead>\r\n                    <tr>\r\n                        <th style=\"text-align: center;\" nzWidth=\"8%\"><b>{{'No.' | translate}}</b></th>\r\n                        <th nzWidth=\"17%\"><b>{{'Date' | translate}}</b></th>\r\n                        <th nzWidth=\"20%\"><b>{{'Order number' | translate}}</b></th>\r\n                        <th nzWidth=\"20%\"><b>{{'Product' | translate}}</b></th>\r\n                        <th nzWidth=\"20%\"><b>{{\"Status on Tiki\" | translate}}</b></th>\r\n                        <th style=\"text-align: right;\" nzWidth=\"15%\"><b>{{\"Total\"| translate}}</b></th>\r\n                        <th nzAlign=\"center\" nzWidth=\"20%\"><b>{{\"Invoice\" | translate}}</b></th>\r\n                        <th nzAlign=\"center\" nzWidth=\"10%\">\r\n                            ({{countSelectedBill}})\r\n                            <b>{{\"Select\" | translate}}</b>\r\n                            <label style=\"margin-left: 8px;\" class=\"product-item-checkbox\" nz-checkbox [(ngModel)]=\"checkAll\" (ngModelChange)=\"toggleSelectAll($event)\"></label>\r\n                        </th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr (click)=\"gotoDetailTiki(bill)\" *ngFor=\"let bill of salesOrder_show.data;let i =index\"\r\n                        style=\"cursor: pointer;\">\r\n                        <td style=\"text-align: center;\">{{i+1}}</td>\r\n                        <td>\r\n                            {{bill.created_at | date : \"dd/MM/yyyy HH:mm\"}}</td>\r\n                        <td nzLeft> {{bill.code}} <i (click)=\"$event.stopPropagation();vhComponent.copyValue(bill.code)\"\r\n                                nz-icon nzType=\"copy\" nzTheme=\"outline\"></i>\r\n                        </td>\r\n                        <td>\r\n                            <span\r\n                                [style.color]=\"isLinkedToProduct(item) ? '' : 'var(--ion-color-vh-red)'\"\r\n                                style=\"font-size: 0.8rem;\"\r\n                                *ngFor=\"let item of bill.items\"\r\n                            >\r\n                                {{isLinkedToProduct(item) ? findProductLinked(item).name : item.product.name}} (SL: {{item.qty}}) <i *ngIf=\"!isLinkedToProduct(item)\" (click)=\"$event.stopPropagation();openModelSelectProductsTiki(item)\" class=\"icon-link green\" nz-icon nzType=\"link\" nzTheme=\"outline\"></i>\r\n                                <br>\r\n                            </span>\r\n                        </td>\r\n                        <td>\r\n                            <ng-container *ngIf=\"bill.main_substate_text; else elseTemplate\">\r\n                                <span>{{bill.main_substate_text | translate}}</span>\r\n                            </ng-container>\r\n                            <ng-template #elseTemplate>\r\n                                <span>{{bill.main_state_text | translate}}</span>\r\n                            </ng-template>\r\n                        </td>\r\n                        <td style=\"text-align: right;\">\r\n                            <b>{{vhAlgorithm.vhcurrencyunit(bill.invoice.total_seller_income)}}</b>\r\n                        </td>\r\n                        <td nzAlign=\"center\">\r\n                            <span (click)=\"$event.stopPropagation();gotoCreateBill(bill)\" class=\"invoice-create\"\r\n                                *ngIf=\"!bill.id_bill_delivered_goods\">\r\n                                <b>{{\"Create invoice\" |translate}}</b>\r\n                            </span>\r\n                            <span (click)=\"$event.stopPropagation();gotoDetail(bill)\" class=\"invoice-view\"\r\n                                *ngIf=\"bill.id_bill_delivered_goods\"><b>{{\"View invoice\" | translate}}</b></span>\r\n                        </td>\r\n                        <td nzAlign=\"center\">\r\n                            <label\r\n                                *ngIf=\"!bill.id_bill_delivered_goods ? billIsLinkedToProduct(bill) : false\"\r\n                                [ngModel]=\"selectedBills[bill.code]\"\r\n                                (ngModelChange)=\"checkBillToCreateInvoice($event,bill)\"\r\n                                class=\"product-item-checkbox\" nz-checkbox>\r\n                            </label>\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </nz-table>\r\n\r\n        </div>\r\n    </div>\r\n    <ng-template #no_bill class=\"full-height\">\r\n        <div *ngIf=\"load_status\" nz-col nzSpan=\"24\" style=\"height: 60vh;\" class=\"center-all-content\">\r\n            <div>{{'No data'| translate}}</div>\r\n        </div>\r\n    </ng-template>\r\n    <ng-template #no_data>\r\n        <div nz-row class=\"no-affiliate\">\r\n            <div nz-col nzSpan=\"24\" class=\"text-center\">\r\n                <img src=\"assets/icon/management/ecommerce/no-data-orderstatus.svg\" alt=\"\">\r\n                <p>{{\"Please click the view button\"|translate}}\r\n                </p>\r\n            </div>\r\n        </div>\r\n    </ng-template>\r\n    <ng-template #updateForControl let-params>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"24\">\r\n                <span>{{\"Date\"| translate}}: </span>\r\n                <nz-date-picker nzFormat=\"dd/MM/yyyy\" style=\"margin-left:20px\" [(ngModel)]=\"bill_selected.date_control\">\r\n                </nz-date-picker>\r\n            </div>\r\n        </div>\r\n    </ng-template>\r\n</nz-layout>\r\n\r\n\r\n<!-- --------------modal chọn sản phẩm liên kết--------------- -->\r\n<app-modal-link-product-ecommerce\r\n    [title]=\"'Select Tiki linked products' | translate\"\r\n    [visible_affiliate]=\"visible_affiliate\"\r\n    [listProductApp]=\"listProductApp\"\r\n    [searchProductAppValue]=\"searchProductAppValue\"\r\n    (cancelAffiliate)=\"cancelAffiliate()\"\r\n    (searchProductApp)=\"searchProductApp($event)\"\r\n    (acceptAfiliate)=\"acceptAfiliate($event)\"\r\n></app-modal-link-product-ecommerce>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { IssueDeliveryGoodsComponent } from './issue-delivery-goods.component';\r\nimport { AddComponent } from './add/add.component';\r\nimport { DetailComponent } from './detail/detail.component';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { NgZorroAntModule } from 'src/app/ng-zorro-ant.module';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { DetailTikiComponent } from './detail-tiki/detail-tiki.component';\r\nimport { BillType1TikiModule } from 'src/app/sales/components/bill-type/bill-type-1/tiki/bill-type1-tiki.module';\r\nimport { ModalLinkProductEcommerceModule } from 'src/app/sales/menu/manage/ecommerce/components/modal-link-product-ecommerce/modal-link-product-ecommerce.module';\r\nimport { EditComponent } from './edit/edit.component';\r\nconst routes: Routes = [\r\n  {\r\n    path: \"\",\r\n    component: IssueDeliveryGoodsComponent\r\n  },\r\n  {\r\n    path: \"add\",\r\n    component: AddComponent\r\n  },\r\n  {\r\n    path: \"edit\",\r\n    component: EditComponent\r\n  },\r\n  {\r\n    path: \"detail\",\r\n    component: DetailComponent\r\n  },\r\n  {\r\n    path: \"detail-tiki\",\r\n    component: DetailTikiComponent\r\n  },\r\n]\r\n\r\n@NgModule({\r\n  declarations: [IssueDeliveryGoodsComponent, AddComponent, DetailComponent, DetailTikiComponent, EditComponent],\r\n  imports: [\r\n    CommonModule,\r\n    RouterModule.forChild(routes),\r\n    NgZorroAntModule,\r\n    TranslateModule,\r\n    IonicModule,\r\n    FormsModule,\r\n    BillType1TikiModule,\r\n    ModalLinkProductEcommerceModule\r\n  ]\r\n})\r\nexport class IssueDeliveryGoodsModule { }\r\n"],"names":["SalesK57Col3Component","SalesK80Col3Component","SalesK80Col4Component","SalesA5Component","SalesA4Component","VhType","i0","ctx_r2","ctx_r6","AddComponent","constructor","router","vhComponent","languageService","vhQuerySales","vhAlgorithm","vhAuth","cdRef","fncService","nzModalService","bill_type","cqt_status","payment_type","id_customer","id_branch","id_employee","id_wallet","date","total","payment","tax","discount","fee","note","price_type","order_number_ecommerce","id_shop","tax_buyerDisplayName","tax_buyerLegalName","tax_buyerTaxCode","tax_buyerAddressLine","tax_buyerEmail","ecommerce_fee_paid_by_seller","getCurrentNavigation","extras","state","dataRestore","billTiki","Date","getDefaultBranch","_id","getLocalAppSettingNameBranch","warning_lot_expried","initBill","invoice","pickerTime","toISOString","getUser","employee","getlocalEmployee","getlocalShopListTiki","find","item","id_shop_selected","data","customer","getlocalCustomer","shipping_fee_discountAmount","i","length","seller_income_detail","_a","discount_shipping_fee","_b","seller_subsidy","shipping_amount_after_discount","Math","abs","_c","total_seller_fee","addInvoiceDetail","items","setSubTotal","toString","translate","ngOnInit","eventKeypress","printer","getLocalPrintPage","checkPrinter","print_sizes","findIndex","e","print_size_default","enable","waitingStack","then","discount_price","vhnumeral","invoice_fee","ngOnDestroy","document","removeEventListener","event","window","closerBrower","keycode","keyCode","preventDefault","payInvoice","searchProductList","returnValue","addEventListener","goBack","alertConfirm","isExit","navigate","closeAndReceiveEmployee","setPickerTime","getTime","getStore","registrationdate","alertMessageDesktop","formatDate","getValidityDate","validitydate","editDiscount","getRawValue","parseFloat","getElementById","editFee","compareSubTotal","sub","invoiceDetail","reduce","prev","next","quantity","price","subTotal","print","save_enable","showLoading","createOrUpdate","bill","updateBill","update","updateSalesOrderTiki","id_bill_delivered_goods","hideLoading","showToast","toLocaleLowerCase","handlePrint","handle","catch","err","Promise","resolve","reject","createBill_Billdetail","Object","getCreateUpdateInvoiceDetail","res","checkPrint","rejects","map","detail","id_product","ptype","ratio","price_origin","id_lotproduct","id_subproduct","combos","combo","product","type","filter","renderPrintPage","showModal","invoice_detail","modal","onWillDismiss","checkDeactivate","currentRoute","currentState","nextState","url","closeSearchProductList","manylot","openModalChooseLot","lots","tempDetail","show_modal_select_lots_combo","addInvoiceDetailExtraEcommerce","value","index","name","unit","units","id_category","free","subComboName","unshift","checkQuantityProduct","MIN_PRICE","oldQuantity","oldPrice","originalTotal","newQuantity","newPrice","openEditUnitPrice","isVisibleEditUnitPrice","unit_price","handleEditUnit","deleteGoods","removeInvoiceDetail","id","splice","setTotal","products","getlocalDetailProducts","delete_hidden","tikis","findSuccess","productOfBranch","findProduct","product_id","addInvoiceDetailTiki","row_total","qty","validProdDetail","exist","productToAdd","COMBO","getUnit","getUnit_byRatio","getLotNumber","lot","lot_number","searchLot","searchList","changeAlias","list_search_lot","show_modal_select_lots","changeLot","handleChooseLot","lot_select","date_exp","confirm","nzTitle","nzOnOk","nzOnCancel","handleCancelChooseLot","handleChooseLotCombo","onClose","isOpenModalTaxCustomer","onOkEditTax","customerTaxInfo","assign","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"webpack:///"}