{"version":3,"file":"src_app_sales_menu_manage_invoices_e-invoice_e-invoice_module_ts.js","mappings":"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","sources":["./src/app/sales/menu/manage/invoices/e-invoice/e-invoice.component.ts","./src/app/sales/menu/manage/invoices/e-invoice/e-invoice.component.html","./src/app/sales/menu/manage/invoices/e-invoice/e-invoice.module.ts","./src/app/sales/menu/manage/invoices/e-invoice/edit-customer-tax/edit-customer-tax.component.ts","./src/app/sales/menu/manage/invoices/e-invoice/edit-customer-tax/edit-customer-tax.component.html","./src/app/sales/menu/manage/invoices/e-invoice/quick-send-to-cqt/quick-send-to-cqt.component.html","./src/app/sales/menu/manage/invoices/e-invoice/quick-send-to-cqt/quick-send-to-cqt.component.ts"],"sourcesContent":["import { DatePipe } from '@angular/common';\r\nimport { ChangeDetectorRef, Component } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhAuth, VhEinvoice, VhQuerySales, } from 'ionic-vhframeworks';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { BillService } from 'src/app/sales/services/bill.service';\r\nimport { FunctionService } from 'src/app/sales/services/function.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\nimport { PrintService } from 'src/app/sales/services/print.service';\r\n\r\n@Component({\r\n  selector: 'app-e-invoice',\r\n  templateUrl: './e-invoice.component.html',\r\n  styleUrls: ['./e-invoice.component.scss']\r\n})\r\nexport class EInvoiceComponent {\r\n  public date: Date[] = [new Date(), new Date()];\r\n  public searchValue: string = ''\r\n  public invoiceShow: any[] = []\r\n  private invoiceSegment: any[] = []\r\n  private invoiceFilter: any[] = []\r\n  public invoices: any[];\r\n  stateObj = {\r\n    /** Từ khoá tìm kiếm */\r\n    keySearch: '',\r\n    /** id của danh mục được chọn */\r\n    selectedValue: '1',\r\n    /** Tab được chọn */\r\n    tab: 0,\r\n    nzPageIndex: 1\r\n  }\r\n  tableHeight: string;\r\n  status: any;\r\n  totalValInvoice: number = 0;\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state\r\n  customers = this.vhQuerySales.getlocalCustomers().filter(item => item.type != 3);\r\n  infoBranch = this.vhQuerySales.getlocalBranch(this.vhQuerySales.getDefaultBranch()._id);\r\n\r\n\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    public vhAuth: VhAuth,\r\n    private cdRef: ChangeDetectorRef,\r\n    private datePipe: DatePipe,\r\n    private fncService: FunctionService,\r\n    private vhEinvoice: VhEinvoice,\r\n    private billService: BillService,\r\n    public printService: PrintService,\r\n  ) {\r\n    this.date[0].setHours(0, 0, 0, 0)\r\n    this.date[1].setHours(23, 59, 59, 59)\r\n  }\r\n\r\n  \r\n\r\n  ngAfterContentInit(): void {\r\n\r\n    if (this.dataRestore) {\r\n\r\n      this.searchValue = this.dataRestore.searchValue\r\n      this.filterType = this.dataRestore.filterType\r\n\r\n\r\n      this.date = [this.dataRestore.startTime, this.dataRestore.endTime];\r\n      this.selectedIndex = this.dataRestore.selectedIndex\r\n\r\n      this.invoices = this.dataRestore.invoice\r\n      this.segmentChanged(this.selectedIndex);\r\n      if (this.dataRestore.reload) this.getInvoices()\r\n    }\r\n    else { this.filterType = 'all'; }\r\n  }\r\n\r\n  /**\r\n   * get danh sách hóa đơn bán hàng từ DB\r\n   * @example this.getInvoiceToday(1)\r\n   */\r\n  getInvoices() {\r\n    // if (this.vhAuth.checkMyPermission(\"sell_enable_view_bill\")) {\r\n    this.vhComponent.showLoading(\"\", \"transparent-loading\", null, 0, false).then(() => {\r\n      this.vhQuerySales.getBills_byFields(\r\n        {\r\n          date: { $gte: new Date(this.date[0].setHours(0, 0, 0)), $lte: new Date(this.date[1].setHours(23, 59, 59, 59)) },\r\n          bill_type: { $in: [1] },\r\n          id_branch: { $eq: this.vhQuerySales.getDefaultBranch()._id },\r\n          id_shop: { $eq: 'local' }\r\n        }, {})\r\n        .then((invoice: any[]) => {\r\n          console.log(invoice);\r\n          this.invoices = invoice.map(item => {\r\n            return {\r\n              ...item,\r\n              partner_name: this.renderPartner(item.id_customer),\r\n              payment_name: this.renderPayment(item.payment_type, item.id_wallet),\r\n              status: this.renderStatus(item.cqt_status),\r\n              debt_value: this.getDebtValue(item.total, item.tax, item.payment),\r\n              sum_price: item.total * (1 + item.tax / 100)\r\n            }\r\n          })\r\n\r\n          this.segmentChanged(this.selectedIndex);\r\n          this.status = \"Not found\"\r\n          this.vhComponent.hideLoading(0);\r\n        }, err => {\r\n          console.error(err);\r\n          this.vhComponent.hideLoading(0);\r\n        }).catch(err => this.vhComponent.hideLoading(0))\r\n    })\r\n    // }\r\n    // else this.vhComponent.showToast(1500, this.lang.translate('You do not have this rights'), \"alert-toast\")\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * trả về công nợ của hóa đơn\r\n   * @example let debt = this.getDebtValue(100000,0,0)\r\n   */\r\n  getDebtValue(total, tax, payment) {\r\n    return (parseFloat(parseFloat((total * (1 + tax / 100)).toString()).toFixed(0)) - payment)\r\n  }\r\n\r\n  /**\r\n   * trả về tên loại trạng thái bill\r\n   * @param bill_type \r\n   * @returns string\r\n   * @example let bill_name = this.renderStatus(2)\r\n   */\r\n  renderStatus(cqt_status) {\r\n    switch (cqt_status) {\r\n      case 1: return this.lang.translate('Not sent to CQT')\r\n      case 2: return this.lang.translate('Waiting for signature')\r\n      case 3: return this.lang.translate('Sent to CQT')\r\n      default: return this.lang.translate('Not sent to CQT')\r\n    }\r\n  }\r\n  /**\r\n   * trả về tên kh của bill\r\n   * @param id_partner \r\n   * @returns string\r\n   * @example let customer_name = this.renderPartner('DNIKWUJHNBDUYWGU') \r\n   */\r\n  renderPartner(id_partner: string) {\r\n    let customer: any = this.vhQuerySales.getlocalCustomer(id_partner)\r\n    return customer ? this.lang.translate(customer.name) : this.lang.translate(\"Not found\")\r\n  }\r\n  /**\r\n   * router qua trang chi tiết bill\r\n   * @example this.goToDetail('DMNWIDHNBIUWHGDUWY')\r\n   */\r\n  goToDetail(data) {\r\n    let dataRestore = { searchValue: this.searchValue, filterType: this.filterType, startTime: this.date[0], endTime: this.date[1], selectedIndex: this.selectedIndex, invoice: this.invoices }\r\n    if (data.bill_type == 3) this.router.navigate([\"/sales/dashboard/manage/invoice/sales-return-invoice/detail-customer-return\"], { state: { id: data._id, dataRestore } })\r\n    if (data.bill_type == 1) this.router.navigate([\"/sales/dashboard/manage/invoice/sales-return-invoice/detail-sales\"], { state: { id: data._id, dataRestore } })\r\n  }\r\n  public filterType = 'all';\r\n\r\n  /**\r\n   * lọc hóa đơn theo loại hóa đơn\r\n   * @example this.sortFilter(1)\r\n   */\r\n  sortFilter(filterType) {\r\n    if (filterType == 'all') {\r\n      this.invoiceFilter = this.invoiceSegment\r\n    }\r\n    else {\r\n      this.invoiceFilter = this.invoiceSegment.filter(item => item.id_customer == filterType)\r\n    }\r\n    this.searchBill(this.searchValue)\r\n  }\r\n  /**\r\n   * lọc bill theo ['bill_code', 'partner_name', 'payment_name', 'status']\r\n   * @example this.searchBill('')\r\n   */\r\n  searchBill(value: string) {\r\n    if (value.length) {\r\n      let val: string = this.vhAlgorithm.changeAlias(value.trim().toLowerCase())\r\n      this.invoiceShow = this.vhAlgorithm.searchList(val, this.invoiceFilter, ['bill_code', 'partner_name', 'payment_name', 'status'])\r\n    } else this.invoiceShow = [...this.invoiceFilter]\r\n\r\n    this.totalValInvoice = this.getTotal()\r\n\r\n  }\r\n  /**\r\n   * trả về tổng daonh số của tất cả hóa đơn đang hiển thị\r\n   * @returns \r\n   */\r\n  getTotal() {\r\n    return this.invoiceShow.reduce((prev: number, next) => prev + next.total * (1 + next.tax / 100), 0);\r\n  }\r\n\r\n\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\"#sales-return-invoice\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".invoice-header\")) {\r\n      this.tableHeight = document.querySelector(\"#sales-return-invoice\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".invoice-header\").clientHeight - 90 + \"px\";\r\n      if (document.querySelector(\".ant-table-pagination\")) {\r\n        this.tableHeight = document.querySelector(\"#sales-return-invoice\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n          - document.querySelector(\".invoice-header\").clientHeight - document.querySelector(\".ant-table-pagination\").clientHeight - 90 + \"px\";\r\n      }\r\n    }\r\n\r\n    this.cdRef.detectChanges();\r\n  }\r\n  /**\r\n   * trả về tên phương thức thanh toán của đơn\r\n   * @example let payment_name= this.renderPayment(1)\r\n   */\r\n  renderPayment(payment_type: 1 | 2 | 3, id_wallet: string = null) {\r\n    switch (payment_type) {\r\n      case 1: return this.lang.translate('Cash')\r\n      case 2: return this.lang.translate('Debit')\r\n      case 3: return this.vhQuerySales.getlocalWallet(id_wallet).name\r\n    }\r\n  }\r\n  goBack() {\r\n    this.router.navigate([\"/sales/dashboard/manage/invoice\"])\r\n  }\r\n  selectedIndex: number = 0;\r\n  mess_result = ''\r\n  /**\r\n   * bắt sk thay đổi tab loại hóa đơn\r\n   * @param value \r\n   */\r\n  segmentChanged(value) {\r\n    this.selectedIndex = value\r\n    if (this.invoices) {\r\n      switch (value) {\r\n        case 0: {\r\n          if (this.vhAuth.checkMyPermission(\"sell_enable_view_bill\")) { this.invoiceSegment = this.invoices; this.mess_result = 'Not invoice yet'; }\r\n          else { this.invoiceSegment = []; this.mess_result = 'You do not have this rights'; }\r\n          break;\r\n        }\r\n        case 2:\r\n        case 3:\r\n        case 1: {\r\n          if (this.vhAuth.checkMyPermission(\"sell_enable_view_bill\")) { this.invoiceSegment = this.invoices.filter(item => item.cqt_status == value); this.mess_result = 'Not invoice yet'; }\r\n          else { this.invoiceSegment = []; this.mess_result = 'You do not have this rights'; }\r\n          break;\r\n        }\r\n        // case 2: this.invoiceSegment = this.invoices.filter(item => item.bill_type == 5); break;\r\n        // case 2: \r\n        // this.invoiceSegment = this.invoices.filter(item => item.bill_type == 4); break;\r\n        // case 3: this.invoiceSegment = this.invoices.filter(item => item.bill_type == 23); break;\r\n      }\r\n      this.sortFilter(this.filterType);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi thời gian xem hóa đơn\r\n   * @param event array<date>\r\n   * @example this.changeTime([2023-06-23T07:12:35.157Z,2023-06-23T07:12:35.157Z])\r\n   */\r\n  changeTime(event) {\r\n    if (new Date(event[1].setHours(0, 0, 0, 0)).getTime() - new Date(event[0].setHours(0, 0, 0, 0)).getTime() <= this.fncService.checkDateReport() * 86000000) {\r\n      //this.getTransferList();\r\n    } else {\r\n      this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"The time limit to view is\") + \" \" + this.fncService.checkDateReport() + \" \" + this.lang.translate(\"days\"))\r\n      this.date = [new Date(event[0]), new Date(event[0].getTime() + this.fncService.checkDateReport() * 86000000)]\r\n    }\r\n  }\r\n\r\n  /**\r\n   * lưu mã đơn vào RAM\r\n   * @example this.copyBillCode('230623A001')\r\n   */\r\n  copyBillCode(billCode) {\r\n    this.vhComponent.copyValue(billCode)\r\n  }\r\n  /**\r\n   * format lại định dạng hiển thị ngày tháng để tải về file excel\r\n   * @param date \r\n   * @param type \r\n   * @returns string\r\n   * @example let date = this.format_date(2023-06-23T07:12:35.157Z, 'dd/MM/yyyy')\r\n   */\r\n  format_date(date, type) {\r\n    return this.datePipe.transform(date, type)\r\n  }\r\n  /**\r\n   * trả về tên loại bill để tạo tên file excel\r\n   * @param selectedIndex \r\n   * @returns string\r\n   * @example let bill_name = this.renderNameExcel(0)\r\n   */\r\n  renderNameExcel(selectedIndex) {\r\n    switch (selectedIndex) {\r\n      case 0: return `${this.lang.translate('Sales invoice')} (${this.lang.translate('Sold')})`\r\n      case 1: return `${this.lang.translate('Customer returned invoice')} (${this.lang.translate('Returned')})`\r\n      case 2: return `${this.lang.translate('Sales invoice')} (${this.lang.translate('Cancelled sales')})`\r\n      case 3: return `${this.lang.translate('Customer returned invoice')} (${this.lang.translate('Cancelled return')})`\r\n    }\r\n\r\n  }\r\n  //xuất excel hóa đơn\r\n  export() {\r\n    let data = [];\r\n    let name = `${this.renderNameExcel(this.selectedIndex)}_${this.lang.translate(\"_from\")}_${this.format_date(this.date[0], 'dd_MM_yyyy')}_${this.lang.translate(\"_to\")}_${this.format_date(this.date[0], 'dd_MM_yyyy')}_${this.vhAlgorithm.changeAlias(this.vhQuerySales.getDefaultBranch().name).replace(/\\s/g, \"_\")}`;\r\n    let total: any = new Object();\r\n    total[this.lang.translate('Date')] = ''\r\n    total[this.lang.translate('Invoice code')] = this.lang.translate('Total')\r\n    total[this.lang.translate('Customer')] = ''\r\n    total[this.lang.translate('Payment method')] = ''\r\n    total[this.lang.translate('Employee')] = ''\r\n    total[this.lang.translate('Note')] = ''\r\n    total[this.lang.translate('Total')] = this.vhAlgorithm.vhcurrencyunit(this.totalValInvoice)\r\n    data.push(total)\r\n    for (let bill of this.invoiceShow) {\r\n      let item: any = new Object();\r\n      item[this.lang.translate('Date')] = this.format_date(bill.date, 'dd/MM/yyyy HH:mm')\r\n      item[this.lang.translate('Invoice code')] = bill.bill_code\r\n      item[this.lang.translate('Customer')] = bill.partner_name\r\n      item[this.lang.translate('Payment method')] = `${bill.payment_name} ${(bill.debt_value && bill.payment_type != 2) ? `- ${this.lang.translate('Rest')} ${this.vhAlgorithm.vhcurrencyunit(bill.debt_value)}` : ''}`\r\n      item[this.lang.translate('Note')] = bill.note\r\n      item[this.lang.translate('Total')] = this.vhAlgorithm.vhcurrencyunit(bill.total * (1 + bill.tax / 100))\r\n      data.push(item);\r\n    }\r\n    this.vhAlgorithm.exportXLSX(data, name)\r\n  }\r\n\r\n\r\n  /** hàm sort cho các cột */\r\n  dateCol = false;\r\n  bill_codeCol = false;\r\n  partner_nameCol = false;\r\n  payment_nameCol = false;\r\n  statusCol = false;\r\n  sum_priceCol = false;\r\n  /** Hàm thực hiện sắp xếp theo collection\r\n   *\r\n   * @param colName       // tên cột muôn sắp xếp\r\n   */\r\n  sortTable(colName) {\r\n    switch (colName) {\r\n      case 'date':\r\n        if (this.dateCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortDatebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortDatebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n      case 'bill_code':\r\n        if (this.bill_codeCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n      case 'status': if (this.statusCol) {\r\n        this.invoiceShow = this.vhAlgorithm.sortVietnamesebyASC([...this.invoiceShow], colName);\r\n      } else {\r\n        this.invoiceShow = this.vhAlgorithm.sortVietnamesebyDESC([...this.invoiceShow], colName);\r\n      }\r\n        console.log(this.invoiceShow);\r\n        break;\r\n      case 'partner_name':\r\n        if (this.partner_nameCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        console.log(this.invoiceShow);\r\n        break;\r\n      case 'payment_name':\r\n        if (this.payment_nameCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n      case 'sum_price':\r\n        if (this.sum_priceCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortNumberbyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortNumberbyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n    }\r\n  }\r\n  /**\r\n   * lọc khách hàng theo tên\r\n   * @param value \r\n   */\r\n  searchFilter(value) {\r\n    this.customers = this.vhAlgorithm.searchList(this.vhAlgorithm.changeAlias(value), this.vhQuerySales.getlocalCustomers().filter(item => item.type != 3), ['name'])\r\n  }\r\n\r\n  /**\r\n   * hàm này gửi hóa đơn lên cqt \r\n   * @param invoice \r\n   */\r\n  sendCQT(invoice) {\r\n    // lấy ra chi nhánh hiện tại\r\n    let currentBranch = this.vhQuerySales.getlocalBranch(this.vhQuerySales.getDefaultBranch()._id);\r\n    console.log(currentBranch);\r\n\r\n    // trường hợp chưa có tạo kết nối hóa đơn điện tử\r\n    if (!currentBranch.einvoices?.length) {\r\n      this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n      return\r\n    }\r\n    // trường hợp chỉ có 1 kết nối hóa đơn điện tử thì tạo thẳng luôn\r\n    if (currentBranch.einvoices.length && currentBranch.einvoices.length == 1) {\r\n      // trường hợp ncc hóa đơn điện tử là M-invoice\r\n      if (currentBranch.einvoices[0].invoice_provider == 'M-invoice') {\r\n\r\n        if (!currentBranch.einvoices[0].invoiceSeries.length) {\r\n          this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n          return\r\n        }\r\n        invoice.isLoading = true;\r\n        this.billService.changeBill_byLocal_toInvoice_byMinvoice(invoice._id, currentBranch.einvoices[0].invoiceSeries[0])\r\n          .then((rsp) => {\r\n            if (rsp.vcode == 0) {\r\n              this.vhEinvoice.saveInvoice_Sign_byMinvoice(currentBranch.taxcode, currentBranch.einvoices[0].token, 1, rsp.data)\r\n                .then((res: any) => {\r\n                  invoice.isLoading = false\r\n                  console.log(res);\r\n                  if (res.code == '00') {\r\n                    invoice.cqt_status = 3\r\n                    invoice.status = this.renderStatus(3)\r\n                    this.vhQuerySales.updateBill(invoice._id, { cqt_status: 3 })\r\n                    this.vhComponent.alertMessageDesktop(\"success\", this.lang.translate('Send invoice to CQT successfully'))\r\n                  }\r\n                  else if (res.code == '9999') {\r\n                    this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Vui lòng kiểm tra lại thông tin hóa đơn đẩy lên CQT chưa phù hợp\"))\r\n                  }\r\n                  else {\r\n                    this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(res.message))\r\n                  }\r\n                })\r\n            }\r\n          }, (error: any) => {\r\n            invoice.isLoading = false\r\n            console.log('error', error)\r\n          })\r\n\r\n      }\r\n    }\r\n    // trường hợp chỉ có 2 kết nối hóa đơn điện tử trở lên thì hiện modal chọn ncc  hóa đơn điện tử\r\n    if (currentBranch.einvoices.length && currentBranch.einvoices.length > 1) {\r\n\r\n    }\r\n  }\r\n  /**\r\n   * hàm này ký hóa đơn lên cqt \r\n   * @param invoice \r\n   */\r\n  signature(invoice) {\r\n    // lấy ra chi nhánh hiện tại\r\n    let currentBranch = this.vhQuerySales.getlocalBranch(this.vhQuerySales.getDefaultBranch()._id);\r\n    console.log(currentBranch);\r\n\r\n    // trường hợp chưa có tạo kết nối hóa đơn điện tử\r\n    if (!currentBranch.einvoices?.length) {\r\n      this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n      return\r\n    }\r\n    // trường hợp chỉ có 1 kết nối hóa đơn điện tử thì tạo thẳng luôn\r\n    if (currentBranch.einvoices.length && currentBranch.einvoices.length == 1) {\r\n      // trường hợp ncc hóa đơn điện tử là M-invoice\r\n      if (currentBranch.einvoices[0].invoice_provider == 'M-invoice') {\r\n\r\n        if (!currentBranch.einvoices[0].invoiceSeries.length) {\r\n          this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n          return\r\n        }\r\n        invoice.isLoading = true\r\n        this.billService.changeBill_byLocal_toInvoice_byMinvoice(invoice._id, currentBranch.einvoices[0].invoiceSeries[0])\r\n          .then((rsp) => {\r\n            if (rsp.vcode == 0) {\r\n              this.vhEinvoice.saveInvoice_Sign_byMinvoice(currentBranch.taxcode, currentBranch.einvoices[0].token, 2, rsp.data)\r\n                .then((res: any) => {\r\n                  console.log(res);\r\n                  invoice.isLoading = false\r\n                  if (res.code == '00') {\r\n                    invoice.cqt_status = 3\r\n                    invoice.status = this.renderStatus(3)\r\n                    this.vhComponent.alertMessageDesktop(\"success\", this.lang.translate('Update invoice to CQT successfully'))\r\n                    this.vhQuerySales.updateBill(invoice._id, { cqt_status: 3 })\r\n                  }\r\n                  else if (res.code == '9999') {\r\n                    this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Vui lòng kiểm tra lại thông tin hóa đơn đẩy lên CQT chưa phù hợp\"))\r\n                  }\r\n                  else {\r\n                    this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(res.message))\r\n                  }\r\n                })\r\n            }\r\n          }, (error: any) => {\r\n            invoice.isLoading = false\r\n            console.log('error', error)\r\n          })\r\n\r\n      }\r\n    }\r\n    // trường hợp chỉ có 2 kết nối hóa đơn điện tử trở lên thì hiện modal chọn ncc  hóa đơn điện tử\r\n    if (currentBranch.einvoices.length && currentBranch.einvoices.length > 1) {\r\n\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Đến trang Gửi nhanh tới cơ quan thuế\r\n   */\r\n  goToQuickSendToCQT() {\r\n    let invoices = []\r\n    if (this.selectedIndex == 0) {\r\n      invoices = this.invoices?.filter(item => item.cqt_status == 1 || item.cqt_status == 2 || !item.cqt_status)\r\n    }\r\n    else if (this.selectedIndex == 1) {\r\n      invoices = this.invoices?.filter(item => item.cqt_status == 1 || !item.cqt_status)\r\n    }\r\n    else if (this.selectedIndex == 2) {\r\n      invoices = this.invoices?.filter(item => item.cqt_status == 2)\r\n    }\r\n    console.log(this.selectedIndex)\r\n    console.log(invoices)\r\n    this.router.navigate(['/sales/dashboard/manage/invoice/e-invoice/quick-send-to-cqt'], {\r\n      state: {\r\n        data: invoices,\r\n        filterObj: {\r\n          startTime: this.date[0],\r\n          endTime: this.date[1],\r\n          selectedIndex: this.selectedIndex,\r\n          filterType: this.filterType,\r\n          searchValue: this.searchValue,\r\n          invoice: this.invoices\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  /** Có hiển thị modal chỉnh sửa customer tax hay không */\r\n  isShowModalEditCustomerTax: boolean = false;\r\n  tempCustomerTax: any = null;\r\n\r\n\r\n\r\n  /**\r\n   * Khi nhấn edit cột thông tin khách hàng\r\n   */\r\n  editTax(invoice) {\r\n    this.tempCustomerTax = invoice;\r\n    this.isShowModalEditCustomerTax = true;\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * Khi ok trong modal chỉnh sửa customer tax\r\n   * @param customerTaxInfo \r\n   */\r\n  onOkEditTax(customerTaxInfo) {\r\n    this.isShowModalEditCustomerTax = false;\r\n    Object.assign(this.tempCustomerTax, customerTaxInfo);\r\n  }\r\n\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n\r\n<nz-layout id=\"sales-return-invoice\">\r\n    <div class=\"invoice-header\" nz-row>\r\n        <!-- Tiêu đề -->\r\n        <div nz-col nzSpan=\"5\" class=\"title left-all-content\">\r\n            <b>{{'E-Invoice' | translate}}</b>\r\n        </div>\r\n\r\n        <div nz-col nzSpan=\"13\" class=\"right-all-content\">\r\n            <!-- Thanh tìm kiếm -->\r\n            <nz-input-group [nzSuffix]=\"suffixIconSearch\" style=\"margin-right: 10px;\">\r\n                <input type=\"text\" nz-input [(ngModel)]=\"searchValue\" (ngModelChange)=\"searchBill($event)\"\r\n                    [placeholder]=\"'Search for invoice code, customer name, payment, status' | translate\" />\r\n            </nz-input-group>\r\n            <ng-template #suffixIconSearch>\r\n                <i nz-icon nzType=\"search\"></i>\r\n            </ng-template>\r\n\r\n            <!-- Chọn ngày -->\r\n            <nz-range-picker style=\"min-width: 250px;\" nzFormat='dd/MM/yyyy' [(ngModel)]=\"date\"\r\n                (ngModelChange)=\"changeTime($event)\"></nz-range-picker>\r\n        </div>\r\n\r\n        <div nz-col class=\"right-all-content\" nzSpan=\"6\">\r\n            <div style=\"display: flex; gap: 4px;\">\r\n                <!-- Nút xem -->\r\n                <button class=\"btn-green center-all-content ml-3\" nz-button nzType=\"default\" (click)=\"getInvoices()\">\r\n                    <ion-icon src=\"assets/icon/management/view.svg\"></ion-icon>\r\n                    {{'View' | translate}}\r\n                </button>\r\n                <!-- Nút gửi nhanh tới CQT -->\r\n                <button class=\"center-all-content ml-3\" nz-button nzType=\"default\" (click)=\"goToQuickSendToCQT()\">\r\n                    <ion-icon src=\"assets/icon/management/view.svg\"></ion-icon>\r\n                    {{'Quick send to CQT' | translate}}\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div nz-col  nzSpan=\"24\">\r\n            <nz-tabset [(nzSelectedIndex)]=\"stateObj.tab\" (nzSelectChange)=\"segmentChanged($event.index)\">\r\n                <!-- Tab tất cả -->\r\n                <nz-tab [nzTitle]=\"'All' | translate\">\r\n                </nz-tab>\r\n                <!-- Tab Not sent to CQT -->\r\n                <nz-tab [nzTitle]=\"'Not sent to CQT' | translate\">\r\n                </nz-tab>\r\n                <!-- Tab Not sent to CQT -->\r\n                <nz-tab [nzTitle]=\"'Waiting for signature' | translate\">\r\n                </nz-tab>\r\n                <!-- Tab Not sent to CQT -->\r\n                <nz-tab [nzTitle]=\"'Sent to CQT' | translate\">\r\n                </nz-tab>\r\n            </nz-tabset>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Không có dữ liệu -->\r\n    <div nz-row *ngIf=\"!invoiceShow.length\" style=\"height: 100%;\">\r\n        <div nz-col nzSpan=\"24\" class=\"center-all-content\">\r\n            <p>{{'No invoice today' | translate}}</p>\r\n        </div>\r\n    </div>\r\n\r\n    <div *ngIf=\"invoiceShow.length\" style=\"margin-top: 20px;\">\r\n        <!-- Số lượng -->\r\n        <div class='total-item'>{{'Total' |translate}}<span style=\"color: var(--ion-color-vh-red)\">\r\n                {{invoiceShow.length}} </span>{{'invoices today' |translate}}\r\n        </div>\r\n        <!-- Bảng hiển thị -->\r\n        <nz-table [nzScroll]=\"{ y: tableHeight }\" [nzData]=\"invoiceShow\" #tableSales nzShowPagination nzShowSizeChanger\r\n            [nzNoResult]=\"'No invoice today' | translate\">\r\n            <!-- Header -->\r\n            <thead>\r\n                <tr>\r\n                    <th style=\"cursor: pointer;\" nzAlign='left' (click)=\"dateCol = !dateCol; sortTable('date')\">\r\n                        <b>{{'Date' | translate}}</b>\r\n                        <i nz-icon [nzType]=\"dateCol == true ? 'caret-down' : 'caret-up'\" nzTheme=\"outline\"></i>\r\n                    </th>\r\n                    <th style=\"cursor: pointer;\" nzAlign='left'\r\n                        (click)=\"bill_codeCol = !bill_codeCol; sortTable('bill_code')\">\r\n                        <b>{{'Invoice code' | translate}}</b>\r\n                        <i nz-icon [nzType]=\"bill_codeCol == true ? 'caret-down' : 'caret-up'\" nzTheme=\"outline\"></i>\r\n                    </th>\r\n                    <th style=\"cursor: pointer;\" nzAlign='left' nzWidth=\"23%\"\r\n                        (click)=\"partner_nameCol = !partner_nameCol; sortTable('partner_name')\">\r\n                        <b>{{'Customer' | translate}}</b>\r\n                        <i nz-icon [nzType]=\"partner_nameCol == true ? 'caret-down' : 'caret-up'\" nzTheme=\"outline\"></i>\r\n                    </th>\r\n                    <th style=\"cursor: pointer;\" nzAlign='left'\r\n                        (click)=\"payment_nameCol = !payment_nameCol; sortTable('payment_name')\">\r\n                        <b>{{'Payment method' | translate}}</b>\r\n                        <i nz-icon [nzType]=\"payment_nameCol == true ? 'caret-down' : 'caret-up'\" nzTheme=\"outline\"></i>\r\n                    </th>\r\n                    <th style=\"cursor: pointer;\" nzAlign='left' (click)=\"statusCol = !statusCol; sortTable('status')\">\r\n                        <b>{{'Status CQT' | translate}}</b>\r\n                        <i nz-icon [nzType]=\"statusCol == true ? 'caret-down' : 'caret-up'\" nzTheme=\"outline\"></i>\r\n                    </th>\r\n                    <th style=\"cursor: pointer;\" nzWidth=\"15%\" nzAlign='left'>\r\n                        <b>{{'Function' | translate}}</b>\r\n                    </th>\r\n                    <th style=\"cursor: pointer;\" nzWidth=\"15%\" nzAlign='right'\r\n                        (click)=\"sum_priceCol = !sum_priceCol; sortTable('sum_price')\">\r\n                        <b>{{'Total' | translate}}</b>\r\n                        <i nz-icon [nzType]=\"sum_priceCol == true ? 'caret-down' : 'caret-up'\" nzTheme=\"outline\"></i>\r\n                    </th>\r\n                </tr>\r\n            </thead>\r\n\r\n            <!-- Body -->\r\n            <tbody>\r\n                <!-- Hàng total -->\r\n                <tr>\r\n                    <td style=\"color: var(--ion-color-vh-green);\">{{'Total' | translate}}</td>\r\n                    <td></td>\r\n                    <td></td>\r\n                    <td></td>\r\n                    <td></td>\r\n                    <td></td>\r\n                    <td nzAlign='right' class=\"money-right\">{{vhAlgorithm.vhcurrencyunit_symbol(totalValInvoice)}}</td>\r\n                </tr>\r\n                <!-- Danh sách hóa đơn -->\r\n                <tr *ngFor=\"let invoice of tableSales.data\" style=\"cursor: pointer;\">\r\n                    <!-- Ngày -->\r\n                    <td nzAlign='left'>{{invoice.date | date: 'dd/MM/yyyy HH:mm'}}</td>\r\n\r\n                    <!-- Mã hóa đơn -->\r\n                    <td (click)=\"$event.stopPropagation(); copyBillCode(invoice.bill_code)\" nzAlign='left'>\r\n                        {{invoice.bill_code}} <i nz-icon nzType=\"copy\" nzTheme=\"outline\"></i></td>\r\n\r\n                    <!-- Khách hàng -->\r\n                    <td nzAlign='left' nzWidth=\"23%\">\r\n                        <div>\r\n                            <ng-container *ngIf=\"invoice.tax_buyerDisplayName\">{{invoice.tax_buyerDisplayName}}<br></ng-container>\r\n                            <ng-container *ngIf=\"invoice.tax_buyerLegalName\">{{invoice.tax_buyerLegalName}}<br></ng-container>\r\n                            <ng-container *ngIf=\"invoice.tax_buyerTaxCode\">{{invoice.tax_buyerTaxCode}}<br></ng-container>\r\n                            <ng-container *ngIf=\"invoice.tax_buyerAddressLine\">{{invoice.tax_buyerAddressLine}}<br></ng-container>\r\n                            <ng-container *ngIf=\"invoice.tax_buyerEmail\">{{invoice.tax_buyerEmail}}<br></ng-container>\r\n                        </div>\r\n                        <!-- Sửa -->\r\n                        <i (click)=\"editTax(invoice)\" class=\"cus-icon\" nz-icon nzType=\"edit\" nzTheme=\"outline\" style=\"cursor: pointer;\"></i>\r\n                    </td>\r\n\r\n                    <!-- Phương thức thanh toán -->\r\n                    <td nzAlign='left'>{{invoice.payment_name}}<span\r\n                            *ngIf=\"invoice.debt_value && invoice.payment_type != 2\"> - {{'Rest' |translate}} <b>{{vhAlgorithm.vhcurrencyunit(invoice.debt_value)}}</b>\r\n                        </span>\r\n                    </td>\r\n\r\n                    <!-- Trạng thái -->\r\n                    <td nzAlign='left'>{{invoice.status}}</td>\r\n\r\n                    <!-- Chức năng -->\r\n                    <td nzAlign='left' nzWidth=\"15%\">\r\n                        <!-- Gửi CQT -->\r\n                        <button *ngIf=\"invoice.cqt_status == 1 || !invoice.cqt_status\"\r\n                            style=\"color: white !important; width: 100%;\" nz-button (click)=\"sendCQT(invoice)\"\r\n                            nzType=\"primary\" [nzLoading]=\"invoice.isLoading\">{{'Send CQT' | translate}}</button>\r\n                        <div style=\"display: flex; flex-wrap: wrap; gap: 8px; align-items: center; justify-content: space-evenly;\">\r\n                            <!-- Chờ ký -->\r\n                            <button *ngIf=\"invoice.cqt_status == 2\" style=\"color: white !important; min-width: fit-content; padding: 4px 6px; flex: 1;\"\r\n                                nz-button (click)=\"signature(invoice)\" nzType=\"primary\"\r\n                                [nzLoading]=\"invoice.isLoading\">{{'Waiting for signature' | translate}}</button>\r\n                            <!-- Xem hóa đơn -->\r\n                            <button *ngIf=\"invoice.cqt_status == 2 || invoice.cqt_status == 3\" \r\n                                style=\"min-width: fit-content; padding: 4px 6px; flex: 1;\" nz-button \r\n                                (click)=\"printService.viewEInvoice(infoBranch, invoice)\" nzType=\"outline\">{{'View invoice' | translate}}</button>\r\n                        </div>\r\n                    </td>\r\n                    <!-- Tổng -->\r\n                    <td nzAlign='right' class=\"money-right\">{{vhAlgorithm.vhcurrencyunit_symbol(invoice['sum_price'])}}\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </nz-table>\r\n    </div>\r\n</nz-layout>\r\n\r\n\r\n\r\n<!-- -------------------------------------------- MODAL CHỈNH SỬA THÔNG TIN THUẾ KHÁCH HÀNG -------------------------------------------- -->\r\n<app-edit-customer-tax *ngIf=\"isShowModalEditCustomerTax\" [invoice]=\"tempCustomerTax\"\r\n    (onClose)=\"isShowModalEditCustomerTax = false\" (onOk)=\"isShowModalEditCustomerTax = false; onOkEditTax($event)\">\r\n</app-edit-customer-tax>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { EInvoiceComponent } from './e-invoice.component';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { NgZorroAntModule } from 'src/app/ng-zorro-ant.module';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { TranslateModule } from '@ngx-translate/core'; \r\nimport { ScrollingModule } from '@angular/cdk/scrolling';\r\nimport { QuickSendToCqtComponent } from './quick-send-to-cqt/quick-send-to-cqt.component';\r\nimport { EditCustomerTaxComponent } from './edit-customer-tax/edit-customer-tax.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: \"\",\r\n    children: [\r\n      {\r\n        path: \"\",\r\n        component: EInvoiceComponent\r\n      }, \r\n      {\r\n        path: \"quick-send-to-cqt\",\r\n        component: QuickSendToCqtComponent\r\n      }\r\n    ]\r\n  }\r\n]\r\n@NgModule({\r\n  declarations: [\r\n    EInvoiceComponent,\r\n    QuickSendToCqtComponent,\r\n    EditCustomerTaxComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    RouterModule.forChild(routes),\r\n    NgZorroAntModule,\r\n    IonicModule,\r\n    FormsModule,\r\n    TranslateModule,\r\n    ScrollingModule,\r\n    ReactiveFormsModule,\r\n  ],\r\n  exports : [EditCustomerTaxComponent]\r\n\r\n})\r\nexport class EInvoiceModule { }\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { VhQuerySales } from 'ionic-vhframeworks';\r\n\r\n@Component({\r\n  selector: 'app-edit-customer-tax',\r\n  templateUrl: './edit-customer-tax.component.html',\r\n  styleUrls: ['./edit-customer-tax.component.scss']\r\n})\r\nexport class EditCustomerTaxComponent {\r\n\r\n  /** Dữ liệu invoice được chọn */\r\n  @Input() invoice: any;\r\n\r\n  /** Khi đóng modal */\r\n  @Output() onClose = new EventEmitter<any>();\r\n  /** Khi submit modal */\r\n  @Output() onOk = new EventEmitter<any>();\r\n\r\n  /** FormGroup của modal */\r\n  customerTaxForm: FormGroup;\r\n  /** Có phải khách hàng thành viên hay không */\r\n  isCustomerMember: boolean = false;\r\n\r\n\r\n\r\n  constructor(\r\n    private vhQuerySales: VhQuerySales,\r\n  ) { }\r\n\r\n\r\n\r\n  ngOnInit() {\r\n    this.initForm(this.invoice);\r\n  }\r\n\r\n\r\n  \r\n  /**\r\n   * Khởi tạo form\r\n   */\r\n  initForm(invoice) {\r\n    this.customerTaxForm = new FormGroup({\r\n      tax_buyerDisplayName: new FormControl(invoice ? invoice.tax_buyerDisplayName : ''),\r\n      tax_buyerLegalName: new FormControl(invoice ? invoice.tax_buyerLegalName : ''),\r\n      tax_buyerTaxCode: new FormControl(invoice ? invoice.tax_buyerTaxCode : ''),\r\n      tax_buyerAddressLine: new FormControl(invoice ? invoice.tax_buyerAddressLine : ''),\r\n      tax_buyerEmail: new FormControl(invoice ? invoice.tax_buyerEmail : '', [Validators.email]),\r\n    });\r\n    if(invoice.id_customer !== 'id_retail') {\r\n      this.isCustomerMember = true;\r\n      this.customerTaxForm.get('tax_buyerDisplayName').addValidators(Validators.required);\r\n      this.customerTaxForm.get('tax_buyerDisplayName').updateValueAndValidity();\r\n      this.customerTaxForm.get('tax_buyerLegalName').addValidators(Validators.required);\r\n      this.customerTaxForm.get('tax_buyerLegalName').updateValueAndValidity();\r\n      this.customerTaxForm.get('tax_buyerTaxCode').addValidators(Validators.required);\r\n      this.customerTaxForm.get('tax_buyerTaxCode').updateValueAndValidity();\r\n      this.customerTaxForm.get('tax_buyerAddressLine').addValidators(Validators.required);\r\n      this.customerTaxForm.get('tax_buyerAddressLine').updateValueAndValidity();\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Khi nhấn nút Save\r\n   */\r\n  onSubmit() {\r\n    // Nếu chưa valid thì đánh dấu dirty tất cả các control để hiện lỗi cho người dùng\r\n    if (!this.customerTaxForm.valid) {\r\n      for (const control in this.customerTaxForm.controls) {\r\n        if (this.customerTaxForm.controls.hasOwnProperty(control)) {\r\n          this.customerTaxForm.controls[control].markAsDirty();\r\n          this.customerTaxForm.controls[control].updateValueAndValidity();\r\n        }\r\n      }\r\n      return;\r\n    }\r\n    else {\r\n      this.vhQuerySales.updateBill(this.invoice._id, { \r\n        ...this.customerTaxForm.value,\r\n      })\r\n      this.onOk.emit(this.customerTaxForm.value);\r\n    }\r\n  }\r\n\r\n}\r\n","<nz-modal\r\n  (nzOnOk)=\"onSubmit()\"\r\n  (nzOnCancel)=\"onClose.emit()\" \r\n  [nzTitle]=\"'Edit customer tax information' | translate\" \r\n  nzWidth=\"40vw\" \r\n  [nzMaskClosable]=\"false\"\r\n  [nzFooter]=\"modalFooter\"\r\n  [nzVisible]=\"true\">\r\n\r\n  <ng-container *nzModalContent>\r\n    <form nz-form [formGroup]=\"customerTaxForm\">\r\n\r\n      <!-- Tên hiển thị -->\r\n      <div>\r\n        <div><b>{{'Display name' | translate}}<ng-container *ngIf=\"isCustomerMember\">*</ng-container></b></div>\r\n        <nz-form-item>\r\n          <nz-form-control [nzErrorTip]=\"tax_buyerDisplayName\">\r\n            <nz-input-group>\r\n              <input formControlName=\"tax_buyerDisplayName\" nz-input [placeholder]=\"'Enter display name' | translate\" />\r\n              <ng-template #tax_buyerDisplayName let-control>\r\n                <ng-container *ngIf=\"control.hasError('required')\">{{'Display name is required' | translate}}</ng-container>\r\n              </ng-template>\r\n            </nz-input-group>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n      </div>\r\n      \r\n      <!-- Tên pháp lý -->\r\n      <div>\r\n        <div><b>{{'Legal name' | translate}}<ng-container *ngIf=\"isCustomerMember\">*</ng-container></b></div>\r\n        <nz-form-item>\r\n          <nz-form-control [nzErrorTip]=\"tax_buyerLegalName\">\r\n            <nz-input-group>\r\n              <input formControlName=\"tax_buyerLegalName\" nz-input [placeholder]=\"'Enter legal name' | translate\" />\r\n              <ng-template #tax_buyerLegalName let-control>\r\n                <ng-container *ngIf=\"control.hasError('required')\">{{'Legal name is required' | translate}}</ng-container>\r\n              </ng-template>\r\n            </nz-input-group>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n      </div>\r\n      \r\n      <!-- Mã số thuế -->\r\n      <div>\r\n        <div><b>{{'Tax code' | translate}}<ng-container *ngIf=\"isCustomerMember\">*</ng-container></b></div>\r\n        <nz-form-item>\r\n          <nz-form-control [nzErrorTip]=\"tax_buyerTaxCode\">\r\n            <nz-input-group>\r\n              <input formControlName=\"tax_buyerTaxCode\" nz-input [placeholder]=\"'Enter tax code' | translate\" />\r\n              <ng-template #tax_buyerTaxCode let-control>\r\n                <ng-container *ngIf=\"control.hasError('required')\">{{'Tax code is required' | translate}}</ng-container>\r\n              </ng-template>\r\n            </nz-input-group>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n      </div>\r\n      \r\n      <!-- Địa chỉ -->\r\n      <div>\r\n        <div><b>{{'Address' | translate}}</b><ng-container *ngIf=\"isCustomerMember\">*</ng-container></div>\r\n        <nz-form-item>\r\n          <nz-form-control [nzErrorTip]=\"tax_buyerAddressLine\">\r\n            <nz-input-group>\r\n              <input formControlName=\"tax_buyerAddressLine\" nz-input [placeholder]=\"'Enter address' | translate\" />\r\n              <ng-template #tax_buyerAddressLine let-control>\r\n                <ng-container *ngIf=\"control.hasError('required')\">{{'Address is required' | translate}}</ng-container>\r\n              </ng-template>\r\n            </nz-input-group>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n      </div>\r\n      \r\n      <!-- Email -->\r\n      <div>\r\n        <div><b>{{'Email' | translate}}</b></div>\r\n        <nz-form-item>\r\n          <nz-form-control [nzErrorTip]=\"tax_buyerEmail\">\r\n            <nz-input-group>\r\n              <input formControlName=\"tax_buyerEmail\" type=\"email\" nz-input [placeholder]=\"'Enter email' | translate\" />\r\n              <ng-template #tax_buyerEmail let-control>\r\n                <ng-container *ngIf=\"control.hasError('email')\">{{'Invalid email address' | translate}}</ng-container>\r\n              </ng-template>\r\n            </nz-input-group>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n      </div>\r\n\r\n    </form>\r\n  </ng-container>\r\n\r\n  <!-- Danh sách nút -->\r\n  <ng-template #modalFooter>\r\n    <!-- Hủy -->\r\n    <button (click)=\"onClose.emit()\" \r\n      nz-button class=\"nz-hover-border\"\r\n      style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\">{{'Cancel' | translate}}</button>\r\n    <!-- Lưu -->\r\n    <button (click)=\"onSubmit()\"\r\n      nz-button class=\"nz-hover-border\"\r\n      style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n      class=\"nz-hover-border-green\">{{'Save' | translate}}</button>\r\n  </ng-template>\r\n</nz-modal>\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n  <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n\r\n<nz-layout id=\"sales-return-invoice\">\r\n  <!-- Tiêu đề -->\r\n  <div class=\"invoice-header\" nz-row>\r\n    <div nz-col nzSpan=\"5\" class=\"title left-all-content\">\r\n      <b>{{'Quick send to CQT' | translate}}</b>\r\n    </div>\r\n\r\n    <div nz-col nzSpan=\"16\" class=\"right-all-content\">\r\n      <!-- Thanh tìm kiếm -->\r\n      <nz-input-group [nzSuffix]=\"suffixIconSearch\" style=\"    margin-right: 10px;\">\r\n        <input #box (keyup)=\"searchBill(box.value)\" type=\"text\" nz-input\r\n          [placeholder]=\"'Search for invoice code, customer name, payment, status' | translate\" />\r\n      </nz-input-group>\r\n      <ng-template #suffixIconSearch>\r\n        <i nz-icon nzType=\"search\"></i>\r\n      </ng-template>\r\n    </div>\r\n\r\n    <div nz-col class=\"right-all-content\" nzSpan=\"3\">\r\n      <div>\r\n        <!-- Nút gửi -->\r\n        <button (click)=\"send()\" class=\"btn-green center-all-content ml-3\" nz-button nzType=\"default\">\r\n          {{'Quick Send' | translate}}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Không có dữ liệu -->\r\n  <div nz-row *ngIf=\"!invoiceShow.length\" style=\"height: 100%;\">\r\n    <div nz-col nzSpan=\"24\" class=\"center-all-content\">\r\n      <p>{{'No invoice today' | translate}}</p>\r\n    </div>\r\n  </div>\r\n\r\n  <div *ngIf=\"invoiceShow.length\" style=\"margin-top: 20px;\">\r\n    <!-- Số lượng -->\r\n    <div class='total-item'>{{'Total' |translate}}<span style=\"color:var(--ion-color-vh-red)\">\r\n        {{invoiceShow.length}} </span>{{'invoices' | translate}}\r\n    </div>\r\n\r\n    <!-- Bảng hiển thị -->\r\n    <nz-table [nzData]=\"invoiceShow\"\r\n      [nzScroll]=\"{ y: heightScroll }\" #tableSales \r\n      [nzNoResult]=\"'No invoice today' | translate\"\r\n      [nzShowPagination]=\"false\"\r\n      [nzFrontPagination]=\"false\">\r\n      <!-- Header -->\r\n      <thead>\r\n        <tr>\r\n          <th nzWidth=\"60px\"\r\n            [(nzChecked)]=\"allChecked\"\r\n            [nzIndeterminate]=\"indeterminate\"\r\n            (nzCheckedChange)=\"checkAll($event)\">\r\n            ({{countSelectedBill}})\r\n          </th>\r\n          <th nzAlign=\"center\" nzWidth=\"6%\"><b>{{'No.' | translate}}</b></th>\r\n          <th style=\"cursor: pointer;\" nzAlign='left' (click)=\"dateCol = !dateCol; sortTable('date')\">\r\n            <b>{{'Date' | translate}}</b>\r\n            <i nz-icon [nzType]=\"dateCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n          </th>\r\n          <th style=\"cursor: pointer;\" nzAlign='left' (click)=\"bill_codeCol = !bill_codeCol; sortTable('bill_code')\">\r\n            <b>{{'Invoice code' | translate}}</b>\r\n            <i nz-icon [nzType]=\"bill_codeCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n          </th>\r\n          <th style=\"cursor: pointer;\" nzAlign='left' nzWidth=\"23%\"\r\n            (click)=\"partner_nameCol = !partner_nameCol; sortTable('partner_name')\">\r\n            <b>{{'Customer' | translate}}</b>\r\n            <i nz-icon [nzType]=\"partner_nameCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n          </th>\r\n          <th style=\"cursor: pointer;\" nzAlign='left'\r\n            (click)=\"payment_nameCol = !payment_nameCol; sortTable('payment_name')\">\r\n            <b>{{'Payment method' | translate}}</b>\r\n            <i nz-icon [nzType]=\"payment_nameCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n          </th>\r\n          <th style=\"cursor: pointer;\" nzAlign='left' (click)=\"statusCol = !statusCol; sortTable('status')\">\r\n            <b>{{'Status CQT' | translate}}</b>\r\n            <i nz-icon [nzType]=\"statusCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n          </th>\r\n          <th style=\"cursor: pointer;\" nzAlign='left'>\r\n            <b>{{'Function' | translate}}</b>\r\n          </th>\r\n          <!-- <th nzWidth=\"15%\" nzAlign='left'><b>{{'Note' | translate}}</b></th> -->\r\n          <th style=\"cursor: pointer;\" nzWidth=\"15%\" nzAlign='right'\r\n            (click)=\"sum_priceCol = !sum_priceCol; sortTable('sum_price')\">\r\n            <b>{{'Total' | translate}}</b>\r\n            <i nz-icon [nzType]=\"sum_priceCol == true ? 'caret-down' : 'caret-up'\" nzTheme=\"outline\"></i>\r\n          </th>\r\n        </tr>\r\n      </thead>\r\n\r\n      <!-- Body -->\r\n      <tbody>\r\n        <!-- Hàng total -->\r\n        <tr>\r\n          <td></td>\r\n          <td style=\"color: var(--ion-color-vh-green);\">{{'Total' | translate}}</td>\r\n          <td></td>\r\n          <td></td>\r\n          <td></td>\r\n          <td></td>\r\n          <td></td>\r\n          <td nzAlign='right' class=\"money-right\">\r\n            {{vhAlgorithm.vhcurrencyunit_symbol(totalValInvoice)}}</td>\r\n        </tr>\r\n        <!-- Danh sách hóa đơn -->\r\n        <tr *ngFor=\"let invoice of tableSales.data; index as i\" style=\"cursor: pointer;\">\r\n          <!-- Nút check -->\r\n          <td [(nzChecked)]=\"invoice.checked\"\r\n            (nzCheckedChange)=\"refreshStatus()\">\r\n          </td>\r\n          <td nzAlign=\"center\">{{i + 1}}</td>\r\n          <!-- Ngày -->\r\n          <td nzAlign='left'>{{invoice.date | date: 'dd/MM/yyyy HH:mm'}}</td>\r\n                    \r\n          <!-- Mã hóa đơn -->\r\n          <td (click)=\"$event.stopPropagation();copyBillCode(invoice.bill_code)\" nzAlign='left'>\r\n            {{invoice.bill_code}} <i nz-icon nzType=\"copy\" nzTheme=\"outline\"></i></td>\r\n                    \r\n          <!-- Khách hàng -->\r\n          <td nzAlign='left' nzWidth=\"23%\">\r\n            <div>\r\n              {{invoice.tax_buyerDisplayName}}<br>\r\n              {{invoice.tax_buyerLegalName}}<br>\r\n              {{invoice.tax_buyerTaxCode}}<br>\r\n              <ng-container *ngIf=\"invoice.tax_buyerAddressLine\">{{invoice.tax_buyerAddressLine}}<br></ng-container>\r\n              <ng-container *ngIf=\"invoice.tax_buyerEmail\">{{invoice.tax_buyerEmail}}<br></ng-container>\r\n            </div>\r\n            <!-- Sửa -->\r\n            <i (click)=\"editTax(invoice)\"\r\n                class=\"cus-icon\" nz-icon nzType=\"edit\" nzTheme=\"outline\" style=\"cursor: pointer;\"></i>\r\n          </td>\r\n\r\n          <td nzAlign='left'>{{invoice.payment_name}}<span *ngIf=\"invoice.debt_value && invoice.payment_type !=2\"> -\r\n              {{'Rest' | translate}} <b>{{vhAlgorithm.vhcurrencyunit(invoice.debt_value)}}</b>\r\n            </span>\r\n          </td>\r\n          <!-- Trạng thái -->\r\n          <td nzAlign='left'>{{invoice.status}}</td>\r\n          <!-- Chức năng -->\r\n          <td nzAlign='left'>\r\n            <button *ngIf=\"invoice.cqt_status == 1 || !invoice.cqt_status\" style=\"margin-right: 10px;color: white !important;\" nz-button (click)=\"sendCQTManual(invoice)\"\r\n              nzType=\"primary\" [nzLoading]=\"invoice.isLoading\">{{'Send CQT' | translate}}</button>\r\n            <button *ngIf=\"invoice.cqt_status == 2\" style=\"margin-right: 10px;color: white !important;\" nz-button (click)=\"signatureManual(invoice)\"\r\n              nzType=\"primary\" [nzLoading]=\"invoice.isLoading\">{{'Waiting for signature' | translate}}</button>\r\n          </td>\r\n          <!-- Tổng -->\r\n          <td nzAlign='right' class=\"money-right\">{{vhAlgorithm.vhcurrencyunit_symbol(invoice['sum_price'])}}\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </nz-table>\r\n  </div>\r\n</nz-layout>\r\n\r\n\r\n\r\n<!-- -------------------------------------------- MODAL CHỈNH SỬA THÔNG TIN THUẾ KHÁCH HÀNG -------------------------------------------- -->\r\n<app-edit-customer-tax \r\n    *ngIf=\"isShowModalEditCustomerTax\"\r\n    [invoice]=\"tempCustomerTax\"\r\n    (onClose)=\"isShowModalEditCustomerTax = false\"\r\n    (onOk)=\"isShowModalEditCustomerTax = false; onOkEditTax($event)\">\r\n</app-edit-customer-tax>","import { ChangeDetectorRef, Component } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhEinvoice, VhQuery, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { VhType } from 'src/app/sales/interface/vh-type';\r\nimport { BillService } from 'src/app/sales/services/bill.service';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-quick-send-to-cqt',\r\n  templateUrl: './quick-send-to-cqt.component.html',\r\n  styleUrls: ['./quick-send-to-cqt.component.scss']\r\n})\r\nexport class QuickSendToCqtComponent {\r\n\r\n  /** Danh sách tất cả hóa đơn */\r\n  invoices: any;\r\n  /** Danh sách tất cả hóa đơn hiển thị */\r\n  invoiceShow: any;\r\n  /** Tổng tiền tất cả hóa đơn */\r\n  totalValInvoice: number = 0;\r\n  /** Dữ liệu state khi navigate */\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state;\r\n\r\n  currentBranch = this.vhQuerySales.getlocalBranch(this.vhQuerySales.getDefaultBranch()._id);\r\n\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private cdRef: ChangeDetectorRef,\r\n    private vhComponent: VhComponent,\r\n    private vhQuerySales: VhQuerySales,\r\n    private vhQuery: VhQuery,\r\n    private lang: LanguageService,\r\n    private vhEinvoice: VhEinvoice,\r\n    private billService: BillService,\r\n  ) {\r\n    this.invoices = this.dataRestore.data;\r\n    // set false cho tất cả checkbox\r\n    this.invoices.forEach((data: any) => {\r\n      data.checked = true;\r\n    });\r\n    this.invoiceShow = this.invoices;\r\n    this.totalValInvoice = this.getTotal()\r\n  }\r\n\r\n\r\n\r\n  heightScroll: string;\r\n  ngAfterViewChecked() {\r\n    if (document.querySelector(\"#sales-return-invoice\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".invoice-header\")) {\r\n      this.heightScroll = document.querySelector(\"#sales-return-invoice\").clientHeight\r\n        - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".invoice-header\").clientHeight\r\n        - 80\r\n        + \"px\";\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * trả về tổng daonh số của tất cả hóa đơn đang hiển thị\r\n   * @returns \r\n   */\r\n  getTotal() {\r\n    return this.invoiceShow.reduce((prev: number, next) => prev + next.total * (1 + next.tax / 100), 0);\r\n  }\r\n\r\n\r\n\r\n  allChecked = true;\r\n  indeterminate = true;\r\n\r\n\r\n\r\n  /**\r\n   * Check tất cả\r\n   * @param value \r\n   */\r\n  checkAll(value: boolean): void {\r\n    this.invoiceShow.forEach(data => {\r\n      if (!data.disabled) {\r\n        data.checked = value;\r\n      }\r\n    });\r\n    this.refreshStatus();\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * Check 1 cái\r\n   */\r\n  refreshStatus(): void {\r\n    const validData = this.invoiceShow.filter(value => !value.disabled);\r\n    const allChecked = validData.length > 0 && validData.every(value => value.checked === true);\r\n    const allUnChecked = validData.every(value => !value.checked);\r\n    this.allChecked = allChecked;\r\n    this.indeterminate = !allChecked && !allUnChecked;\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * Trở lại trang trước\r\n   */\r\n  goBack() {\r\n    this.router.navigate(['/sales/dashboard/manage/invoice/e-invoice'], {\r\n      state: this.dataRestore.filterObj\r\n    });\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * lưu mã đơn vào RAM\r\n   * @example this.copyBillCode('230623A001')\r\n   */\r\n  copyBillCode(billCode) {\r\n    this.vhComponent.copyValue(billCode)\r\n  }\r\n\r\n\r\n\r\n  searchBill(value: string) {\r\n    if (value.length) {\r\n      let val: string = this.vhAlgorithm.changeAlias(value.trim().toLowerCase());\r\n      this.invoiceShow = this.vhAlgorithm.searchList(val, this.invoices, ['bill_code', 'partner_name', 'payment_name', 'status']);\r\n    }\r\n    else {\r\n      this.invoiceShow = [...this.invoices];\r\n    }\r\n    this.totalValInvoice = this.getTotal();\r\n  }\r\n\r\n\r\n\r\n  /** hàm sort cho các cột */\r\n  dateCol = false;\r\n  bill_codeCol = false;\r\n  partner_nameCol = false;\r\n  payment_nameCol = false;\r\n  statusCol = false;\r\n  sum_priceCol = false;\r\n  /** Hàm thực hiện sắp xếp theo collection\r\n   *\r\n   * @param colName       // tên cột muôn sắp xếp\r\n   */\r\n  sortTable(colName) {\r\n    switch (colName) {\r\n      case 'date':\r\n        if (this.dateCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortDatebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortDatebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n      case 'bill_code':\r\n        if (this.bill_codeCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n      case 'partner_name':\r\n        if (this.partner_nameCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n      case 'payment_name':\r\n        if (this.payment_nameCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortVietnamesebyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n      case 'sum_price':\r\n        if (this.sum_priceCol) {\r\n          this.invoiceShow = this.vhAlgorithm.sortNumberbyASC([...this.invoiceShow], colName);\r\n        } else {\r\n          this.invoiceShow = this.vhAlgorithm.sortNumberbyDESC([...this.invoiceShow], colName);\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * Khi nhấn nút gửi\r\n   */\r\n  async send() {\r\n    this.invoiceShow = this.invoiceShow.filter((data: any) => data.cqt_status != 3);\r\n    let bills = this.invoiceShow.filter((data: any) => data.checked);\r\n    const batchSize = 1;\r\n    const totalBatches = Math.ceil(bills.length / batchSize);\r\n\r\n    if (!bills.length) {\r\n      this.vhComponent.alertMessageDesktop('error', this.lang.translate(\"Please select at least one invoice\"));\r\n      return;\r\n    }\r\n\r\n    await this.vhComponent.showLoadingNotDuration(this.lang.translate(\"Sending...\"));\r\n\r\n    try {\r\n      for (let i = 0; i < bills.length; i += batchSize) {\r\n        const batch = bills.slice(i, i + batchSize);\r\n        const currentBatchIndex = Math.floor(i / batchSize) + 1;\r\n\r\n        const promises = batch.map(bill => {\r\n          if (bill.cqt_status == 1 || !bill.cqt_status) return this.sendCQT(bill);\r\n          if (bill.cqt_status == 2) return this.signature(bill);\r\n          return Promise.resolve(); // hóa đơn không hợp lệ\r\n        });\r\n\r\n        try {\r\n          const results = await this.vhQuery.asyncPromiseAll(promises);\r\n          console.log(`Batch ${currentBatchIndex}/${totalBatches} done`, results);\r\n        } catch (batchError) {\r\n          console.error(`Error in batch ${currentBatchIndex}:`, batchError);\r\n        }\r\n      }\r\n    } finally {\r\n      // ✅ luôn được gọi sau khi xử lý xong mọi batch\r\n      await this.vhComponent.hideLoading();\r\n\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * hàm này gửi hóa đơn lên cqt và ký luôn\r\n   * @param invoice \r\n   */\r\n  sendCQT(invoice) {\r\n    return new Promise((resolve, reject) => {\r\n      // trường hợp chưa có tạo kết nối hóa đơn điện tử\r\n      if (!this.currentBranch.einvoices?.length) {\r\n        this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n        resolve('');\r\n        return;\r\n      }\r\n      // trường hợp chỉ có 1 kết nối hóa đơn điện tử thì tạo thẳng luôn\r\n      if (this.currentBranch.einvoices.length && this.currentBranch.einvoices.length == 1) {\r\n        // trường hợp ncc hóa đơn điện tử là M-invoice\r\n        if (this.currentBranch.einvoices[0].invoice_provider == 'M-invoice') {\r\n\r\n          if (!this.currentBranch.einvoices[0].invoiceSeries.length) {\r\n            this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n\r\n            resolve('');\r\n            return;\r\n          }\r\n        }\r\n        this.billService.changeBill_byLocal_toInvoice_byMinvoice(invoice._id, this.currentBranch.einvoices[0].invoiceSeries[0])\r\n          .then((rsp) => {\r\n            if (rsp.vcode == 0) {\r\n              this.vhEinvoice.saveInvoice_Sign_byMinvoice(this.currentBranch.taxcode, this.currentBranch.einvoices[0].token, 1, rsp.data)\r\n                .then(async (res: any) => {\r\n\r\n\r\n                  if (res.code == '00') {\r\n                    invoice.cqt_status = 3\r\n                    invoice.status = this.lang.translate(\"Sent to CQT\")\r\n                    await this.vhQuerySales.updateBill(invoice._id, { cqt_status: 3 })\r\n                    resolve('')\r\n                    // this.vhComponent.alertMessageDesktop(\"success\", this.lang.translate('Send invoice to CQT successfully'))\r\n                  }\r\n\r\n                  else if (res.code == '9999') {\r\n                    reject(invoice._id)\r\n                    this.vhComponent.alertMessageDesktop(\"error\", invoice.bill_code + ' ' + this.lang.translate(\"Vui lòng kiểm tra lại thông tin hóa đơn đẩy lên CQT chưa phù hợp\"))\r\n                  }\r\n                  else {\r\n                    reject(invoice._id)\r\n                    this.vhComponent.alertMessageDesktop(\"error\", invoice.bill_code + ' ' + this.lang.translate(res.message))\r\n                  }\r\n                })\r\n            }\r\n          }, (error: any) => {\r\n            console.log('error', error)\r\n            resolve('');\r\n            return;\r\n          })\r\n      }\r\n    })\r\n\r\n  }\r\n  /**\r\n   * hàm này ký hóa đơn lên cqt \r\n   * @param invoice \r\n   */\r\n  signature(invoice) {\r\n    return new Promise((resolve, reject) => {\r\n      // trường hợp chưa có tạo kết nối hóa đơn điện tử\r\n      if (!this.currentBranch.einvoices?.length) {\r\n        this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n        resolve('');\r\n        return;\r\n      }\r\n      // trường hợp chỉ có 1 kết nối hóa đơn điện tử thì tạo thẳng luôn\r\n      if (this.currentBranch.einvoices.length && this.currentBranch.einvoices.length == 1) {\r\n        // trường hợp ncc hóa đơn điện tử là M-invoice\r\n        if (this.currentBranch.einvoices[0].invoice_provider == 'M-invoice') {\r\n\r\n          if (!this.currentBranch.einvoices[0].invoiceSeries.length) {\r\n            this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n\r\n            resolve('');\r\n            return;\r\n          }\r\n        }\r\n        this.billService.changeBill_byLocal_toInvoice_byMinvoice(invoice._id, this.currentBranch.einvoices[0].invoiceSeries[0])\r\n          .then((rsp) => {\r\n            if (rsp.vcode == 0) {\r\n              this.vhEinvoice.saveInvoice_Sign_byMinvoice(this.currentBranch.taxcode, this.currentBranch.einvoices[0].token, 2, rsp.data)\r\n                .then((res: any) => {\r\n\r\n\r\n                  if (res.code == '00') {\r\n                    invoice.cqt_status = 3\r\n                    invoice.status = this.lang.translate(\"Sent to CQT\")\r\n                    // this.vhComponent.alertMessageDesktop(\"success\", this.lang.translate('Update invoice to CQT successfully'))\r\n                    this.vhQuerySales.updateBill(invoice._id, { cqt_status: 3 })\r\n                    resolve('')\r\n                  }\r\n\r\n\r\n                  else if (res.code == '9999') {\r\n                    reject(invoice._id)\r\n                    this.vhComponent.alertMessageDesktop(\"error\", invoice.bill_code + ' ' + this.lang.translate(\"Vui lòng kiểm tra lại thông tin hóa đơn đẩy lên CQT chưa phù hợp\"))\r\n                  }\r\n                  else {\r\n                    reject(invoice._id)\r\n                    this.vhComponent.alertMessageDesktop(\"error\", invoice.bill_code + ' ' + this.lang.translate(res.message))\r\n                  }\r\n                })\r\n            }\r\n          }, (error: any) => {\r\n            console.log('error', error)\r\n            resolve('');\r\n            return;\r\n          })\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * hàm này gửi hóa đơn lên cqt \r\n   * @param invoice \r\n   */\r\n  sendCQTManual(invoice) {\r\n    // lấy ra chi nhánh hiện tại\r\n    let currentBranch = this.vhQuerySales.getlocalBranch(this.vhQuerySales.getDefaultBranch()._id);\r\n    console.log(currentBranch);\r\n\r\n    // trường hợp chưa có tạo kết nối hóa đơn điện tử\r\n    if (!currentBranch.einvoices?.length) {\r\n      this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n      return\r\n    }\r\n    // trường hợp chỉ có 1 kết nối hóa đơn điện tử thì tạo thẳng luôn\r\n    if (currentBranch.einvoices.length && currentBranch.einvoices.length == 1) {\r\n      // trường hợp ncc hóa đơn điện tử là M-invoice\r\n      if (currentBranch.einvoices[0].invoice_provider == 'M-invoice') {\r\n\r\n        if (!currentBranch.einvoices[0].invoiceSeries.length) {\r\n          this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n          return\r\n        }\r\n\r\n\r\n        invoice.isLoading = true\r\n        this.billService.changeBill_byLocal_toInvoice_byMinvoice(invoice._id, currentBranch.einvoices[0].invoiceSeries[0])\r\n          .then((rsp) => {\r\n            if (rsp.vcode == 0) {\r\n              this.vhEinvoice.saveInvoice_Sign_byMinvoice(currentBranch.taxcode, currentBranch.einvoices[0].token, 1, rsp.data)\r\n                .then((res: any) => {\r\n                  invoice.isLoading = false\r\n                  console.log(res);\r\n                  if (res.code == '00') {\r\n                    invoice.cqt_status = 3\r\n                    invoice.status = this.lang.translate(\"Sent to CQT\")\r\n                    this.vhQuerySales.updateBill(invoice._id, { cqt_status: 3 })\r\n                    this.vhComponent.alertMessageDesktop(\"success\", this.lang.translate('Send invoice to CQT successfully'))\r\n                  }\r\n                  else if (res.code == '9999') {\r\n                    this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Vui lòng kiểm tra lại thông tin hóa đơn đẩy lên CQT chưa phù hợp\"))\r\n                  }\r\n                  else {\r\n                    this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(res.message))\r\n                  }\r\n                }, (error: any) => {\r\n                  invoice.isLoading = false\r\n                  this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Có lỗi xảy ra khi khởi tạo hóa đơn đẩy lên CQT\"))\r\n                  console.log('error', error)\r\n                })\r\n            }\r\n            else {\r\n              invoice.isLoading = false\r\n              this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Có lỗi xảy ra khi khởi tạo hóa đơn đẩy lên CQT\"))\r\n            }\r\n          }, (error: any) => {\r\n            this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Có lỗi xảy ra khi khởi tạo hóa đơn đẩy lên CQT\"))\r\n            invoice.isLoading = false\r\n            console.log('error', error)\r\n          })\r\n\r\n      }\r\n    }\r\n    // trường hợp chỉ có 2 kết nối hóa đơn điện tử trở lên thì hiện modal chọn ncc  hóa đơn điện tử\r\n    if (currentBranch.einvoices.length && currentBranch.einvoices.length > 1) {\r\n\r\n    }\r\n  }\r\n  /**\r\n   * hàm này ký hóa đơn lên cqt \r\n   * @param invoice \r\n   */\r\n  signatureManual(invoice) {\r\n    // lấy ra chi nhánh hiện tại\r\n    let currentBranch = this.vhQuerySales.getlocalBranch(this.vhQuerySales.getDefaultBranch()._id);\r\n    console.log(currentBranch);\r\n\r\n    // trường hợp chưa có tạo kết nối hóa đơn điện tử\r\n    if (!currentBranch.einvoices?.length) {\r\n      this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n      return\r\n    }\r\n    // trường hợp chỉ có 1 kết nối hóa đơn điện tử thì tạo thẳng luôn\r\n    if (currentBranch.einvoices.length && currentBranch.einvoices.length == 1) {\r\n      // trường hợp ncc hóa đơn điện tử là M-invoice\r\n      if (currentBranch.einvoices[0].invoice_provider == 'M-invoice') {\r\n\r\n        if (!currentBranch.einvoices[0].invoiceSeries.length) {\r\n          this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Please connect e-invoice for this branch\"))\r\n          return\r\n        }\r\n        invoice.isLoading = true\r\n        this.billService.changeBill_byLocal_toInvoice_byMinvoice(invoice._id, currentBranch.einvoices[0].invoiceSeries[0])\r\n          .then((rsp) => {\r\n            if (rsp.vcode == 0) {\r\n              this.vhEinvoice.saveInvoice_Sign_byMinvoice(currentBranch.taxcode, currentBranch.einvoices[0].token, 2, rsp.data)\r\n                .then((res: any) => {\r\n                  console.log(res);\r\n                  invoice.isLoading = false\r\n                  if (res.code == '00') {\r\n                    invoice.cqt_status = 3\r\n                    invoice.status = this.lang.translate(\"Sent to CQT\")\r\n                    this.vhComponent.alertMessageDesktop(\"success\", this.lang.translate('Update invoice to CQT successfully'))\r\n                    this.vhQuerySales.updateBill(invoice._id, { cqt_status: 3 })\r\n                  }\r\n                  else if (res.code == '9999') {\r\n                    this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Vui lòng kiểm tra lại thông tin hóa đơn đẩy lên CQT chưa phù hợp\"))\r\n                  }\r\n                  else {\r\n                    this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(res.message))\r\n                  }\r\n                }, (error: any) => {\r\n                  invoice.isLoading = false\r\n                  this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Có lỗi xảy ra khi khởi tạo hóa đơn đẩy lên CQT\"))\r\n                  console.log('error', error)\r\n                })\r\n            }\r\n            else {\r\n              invoice.isLoading = false\r\n              this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Có lỗi xảy ra khi khởi tạo hóa đơn đẩy lên CQT\"))\r\n            }\r\n          }, (error: any) => {\r\n            this.vhComponent.alertMessageDesktop(\"error\", this.lang.translate(\"Có lỗi xảy ra khi khởi tạo hóa đơn đẩy lên CQT\"))\r\n            invoice.isLoading = false\r\n            console.log('error', error)\r\n          })\r\n\r\n      }\r\n    }\r\n    // trường hợp chỉ có 2 kết nối hóa đơn điện tử trở lên thì hiện modal chọn ncc  hóa đơn điện tử\r\n    if (currentBranch.einvoices.length && currentBranch.einvoices.length > 1) {\r\n\r\n    }\r\n  }\r\n  \r\n\r\n\r\n\r\n\r\n\r\n  /** Có hiển thị modal chỉnh sửa customer tax hay không */\r\n  isShowModalEditCustomerTax: boolean = false;\r\n  tempCustomerTax: any = null;\r\n\r\n\r\n\r\n  /**\r\n   * Khi nhấn edit cột thông tin khách hàng\r\n   */\r\n  editTax(invoice) {\r\n    this.tempCustomerTax = invoice;\r\n    this.isShowModalEditCustomerTax = true;\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * Khi ok trong modal chỉnh sửa customer tax\r\n   * @param customerTaxInfo \r\n   */\r\n  onOkEditTax(customerTaxInfo) {\r\n    this.isShowModalEditCustomerTax = false;\r\n    Object.assign(this.tempCustomerTax, customerTaxInfo);\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * Đếm số lượng bill đang check\r\n   */\r\n  get countSelectedBill(): number {\r\n    return this.invoiceShow?.filter((e: any) => e.checked)?.filter((data: any) => data.cqt_status != 3)?.length;\r\n  }\r\n\r\n}\r\n"],"names":["i0","$event","ctx_r34","ctx_r35","ctx_r36","ctx_r37","ctx_r38","ctx_r39","ctx_r4","ctx_r42","QuickSendToCqtComponent","constructor","router","vhAlgorithm","cdRef","vhComponent","vhQuerySales","vhQuery","lang","vhEinvoice","billService","getCurrentNavigation","extras","state","getlocalBranch","getDefaultBranch","_id","invoices","dataRestore","data","forEach","checked","invoiceShow","totalValInvoice","getTotal","ngAfterViewChecked","document","querySelector","heightScroll","clientHeight","detectChanges","reduce","prev","next","total","tax","checkAll","value","disabled","refreshStatus","validData","filter","allChecked","length","every","allUnChecked","indeterminate","goBack","navigate","filterObj","copyBillCode","billCode","copyValue","searchBill","val","changeAlias","trim","toLowerCase","searchList","sortTable","colName","dateCol","sortDatebyASC","sortDatebyDESC","bill_codeCol","sortVietnamesebyASC","sortVietnamesebyDESC","partner_nameCol","payment_nameCol","sum_priceCol","sortNumberbyASC","sortNumberbyDESC","send","cqt_status","bills","batchSize","totalBatches","Math","ceil","alertMessageDesktop","translate","showLoadingNotDuration","i","batch","slice","currentBatchIndex","floor","promises","map","bill","sendCQT","signature","Promise","resolve","results","asyncPromiseAll","console","log","batchError","error","hideLoading","invoice","reject","currentBranch","einvoices","_a","invoice_provider","invoiceSeries","changeBill_byLocal_toInvoice_byMinvoice","then","rsp","vcode","saveInvoice_Sign_byMinvoice","taxcode","token","res","code","status","updateBill","bill_code","message","sendCQTManual","isLoading","signatureManual","editTax","tempCustomerTax","isShowModalEditCustomerTax","onOkEditTax","customerTaxInfo","Object","assign","countSelectedBill","e","_b","_c","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"webpack:///"}