{"version":3,"file":"src_app_sales_menu_manage_sales-program_promotions_promotions_module_ts.js","mappings":";;;;;;;;;;;;;AAkBO,MAAM,YAAY;IAYrB,YAAY,YAAiB,IAAI,EAAE,kBAAyB,IAAI;QAXxD,SAAI,GAAS,IAAI,IAAI,EAAE,CAAC;QACxB,eAAU,GAAgB;YAC9B,IAAI,EAAE,EAAE;YACR,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACnC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACjC,MAAM,EAAE,IAAI;YACZ,IAAI,EAAE,CAAC;YACP,GAAG,EAAE,IAAI;SACZ;QACO,qBAAgB,GAAwB,EAAE;QAG9C,IAAI,SAAS,EAAE;YACX,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YAC3G,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,GAAG,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI;YAC5E,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;YACnE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE;YACpE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI;SACtE;QACD,IAAI,eAAe,EAAE;YACjB,IAAI,CAAC,gBAAgB,GAAG,eAAe;SAC1C;IACL,CAAC;IAED,uFAAuF;IAChF,OAAO;QACV,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;IAChC,CAAC;IACM,OAAO,CAAC,KAAa;QACxB,IAAI,CAAC,UAAU,CAAC,IAAI,GAAG,KAAK;IAChC,CAAC;IACM,OAAO;QACV,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;IAChC,CAAC;IACM,OAAO,CAAC,KAAY;QACvB,IAAI,CAAC,UAAU,CAAC,IAAI,GAAG,KAAK;IAChC,CAAC;IACM,YAAY;QACf,OAAO,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC;IACtC,CAAC;IACM,YAAY,CAAC,KAAoB;QACpC,IAAI,CAAC,UAAU,CAAC,UAAU,GAAG,OAAO,KAAK,IAAI,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,WAAW,EAAE;IACvF,CAAC;IACM,UAAU;QACb,OAAO,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC;IACpC,CAAC;IACM,UAAU,CAAC,KAAoB;QAClC,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,OAAO,KAAK,IAAI,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,WAAW,EAAE;IACrF,CAAC;IACM,KAAK;QACR,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG;IAC9B,CAAC;IAEM,mBAAmB,CAAC,OAAO;QAC9B,IAAI,IAAI,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,UAAU,IAAI,OAAO,CAAC,GAAG,CAAC;QACnF,IAAI,IAAI;YAAE,OAAO,KAAK;aACjB;YACD,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC;gBACvB,IAAI,EAAE,OAAO,CAAC,IAAI;gBAClB,UAAU,EAAE,OAAO,CAAC,GAAG;gBACvB,QAAQ,EAAE,CAAC;gBACX,KAAK,EAAE,OAAO,CAAC,KAAK;gBACpB,SAAS,EAAE,OAAO,CAAC,KAAK;gBACxB,GAAG,EAAE,OAAO,CAAC,GAAG;aACnB,CAAC;YACF,OAAO,IAAI;SACd;IACL,CAAC;IACM,sBAAsB,CAAC,EAAE;QAC5B,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAC3G,CAAC;IAEM,mBAAmB;QACtB,OAAO,IAAI,CAAC,gBAAgB;IAChC,CAAC;IACD,uFAAuF;IAEvF,yGAAyG;IAClG,yBAAyB;QAC5B,OAAO,IAAI,CAAC,UAAU;IAC1B,CAAC;IACM,+BAA+B;QAClC,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YACpC,OAAO,EAAE,UAAU,EAAE,IAAI,CAAC,UAAU,EAAE,SAAS,EAAE,IAAI,CAAC,SAAS,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE;QAC9F,CAAC,CAAC;IACN,CAAC;CACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IElGK,0EAAoD;IAClD,sGAAkH;IAAjF,8VAA8B;IAAmD,4DAAkC;IACtJ,4DAAM;;;IAD4D,0DAAiD;IAAjD,iHAAiD;;;;IAEnH,0EAAqD;IACnD,mGAA+G;IAAjF,2VAA8B;IAAmD,4DAA+B;IAChJ,4DAAM;;;IADyD,0DAAiD;IAAjD,iHAAiD;;;;IAEhH,0EAAqD;IACnD,8FAA2G;IAAlF,sVAA8B;IAAoD,4DAA0B;IACvI,4DAAM;;;IADqD,0DAAiD;IAAjD,iHAAiD;;;;IAE5G,0EAAqD;IACnD,iGAAgE;IAApC,oWAAmC;IAAC,4DAA6B;IAC/F,4DAAM;;;;IACN,0EAAoD;IAClD,yGAAwE;IAApC,4WAAmC;IAAC,4DAAqC;IAC/G,4DAAM;;;;IACN,0EAAqD;IACnD,6FAAgG;IAAxE,kWAAoC;IAAoC,4DAAyB;IAC3H,4DAAM;;;;IACN,0EAAoD;IAClD,uGAAyG;IAAvE,0WAAmC;IAAoC,4DAAmC;IAC9I,4DAAM;;;IA+BA,2EAA0G;;;;IAArE,mFAAsB;;;IAG/D,yEAAmD;IACjD,0EAA4C;IAC1C,oEAAG;IAAA,uDAAqC;;IAAA,4DAAI;IAC9C,4DAAM;IACN,yEAAwB;IACtB,uEAA8G;;IAChH,4DAAM;IACR,4DAAM;;IALC,0DAAqC;IAArC,uJAAqC;IAGjC,0DAAyD;IAAzD,gLAAyD;;;IAIpE,yEAAmD;IACjD,oEAAG;IAAA,uDAA+C;;IAAA,4DAAI;IACxD,4DAAM;;IADD,0DAA+C;IAA/C,iKAA+C;;;;IAEpD,0EAAyG;IACvG,uEAAM;IAAA,uDAAyC;;IAAA,4DAAO;IACtD,uEAAM;IACL,4EAA4N;IAAtH,sTAAwB;IAA9H,4DAA4N;IAC5N,6DAAC;IAAA,oEAAG;IAAA,uDAAe;IAAA,4DAAI;IACxB,4DAAO;IAET,4DAAM;;;IANE,0DAAyC;IAAzC,oKAAyC;IAEwJ,0DAAqB;IAArB,+FAAqB;IAA5F,+FAAgC;IAC3J,0DAAe;IAAf,oFAAe;;;;IAItB,yEAAmD;IACjD,4EAAiD;IAA9B,sVAA6B;IAAC,uDAAkE;;IAAA,4DAAQ;IAC7H,4DAAM;;;IADe,0DAA6B;IAA7B,4FAA6B;IAAC,0DAAkE;IAAlE,oLAAkE;;;IAErH,yEAAmD;IACjD,oEAAG;IAAA,uDAA+C;;IAAA,4DAAI;IACxD,4DAAM;;IADD,0DAA+C;IAA/C,iKAA+C;;;;IAEpD,0EAAyG;IACvG,uEAAM;IAAA,uDAAyC;;IAAA,4DAAO;IACrD,uEAAM;IACL,4EAA4N;IAAtH,sTAAwB;IAA9H,4DAA4N;IAC5N,6DAAC;IAAA,oEAAG;IAAA,uDAAe;IAAA,4DAAI;IACxB,4DAAO;IACV,4DAAM;;;IALE,0DAAyC;IAAzC,oKAAyC;IAEyJ,0DAAqB;IAArB,+FAAqB;IAA5F,+FAAgC;IAC3J,0DAAe;IAAf,oFAAe;;;IAIvB,yEAA+F;IAC7F,oEAAG;IAAA,uDAAuC;;IAAA,4DAAI;IAChD,4DAAM;;IADD,0DAAuC;IAAvC,yJAAuC;;;;IAE5C,yEAA+F;IAC7F,4EAAgG;IAA7E,mVAAuC;IAAsC,uDAAuB;;IAAA,4DAAQ;IACjI,4DAAM;;;IADuD,0DAAoC;IAApC,mGAAoC;IAAC,0DAAuB;IAAvB,yIAAuB;;;;IAQrH,sFAA4J;IAA/G,kXAA4B;;IAAmF,4DAAkB;;;IAA7D,gKAAyC;IAA7G,2FAA4B;;;IACzE,uEAA8H;;;IAAzD,mKAA4C;;;;IAPrH,0EAAuD;IACrD,yEAAwB;IACtB,oEAAG;IAAA,uDAA+E;;IAAA,4DAAI;IACxF,4DAAM;IACN,yEAAwB;IAEtB,wIAA8K;IAC9K,oHAA8H;IAChI,4DAAM;IAEN,yEAAwB;IACtB,oEAAG;IAAA,wDAAyC;;IAAA,4DAAI;IAClD,4DAAM;IACN,0EAAwB;IAEtB,uFAA4J;IAA3I,yWAAqC;;IAAsG,4DAAkB;IAEhL,4DAAM;IACR,4DAAM;;;IAhBC,0DAA+E;IAA/E,0NAA+E;IAI/D,0DAAwB;IAAxB,4FAAwB;IACnC,0DAAwB;IAAxB,4FAAwB;IAI7B,0DAAyC;IAAzC,6JAAyC;IAIqD,0DAAyD;IAAzD,kLAAyD;IAAzI,oGAAqC;;ADxG3D,MAAM,YAAY;IA6BvB,YACU,MAAc,EACd,WAAwB,EACxB,IAAqB,EACrB,YAA0B,EAC3B,WAAwB,EACvB,KAAqB;QALrB,WAAM,GAAN,MAAM,CAAQ;QACd,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACrB,iBAAY,GAAZ,YAAY,CAAc;QAC3B,gBAAW,GAAX,WAAW,CAAa;QACvB,UAAK,GAAL,KAAK,CAAgB;QAlCxB,oBAAe,GAAW,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;QACpF,kBAAa,GAAW,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;QAI7F,gBAAW,GAAY,KAAK,CAAC;QAC7B,2BAAsB,GAAY,KAAK,CAAC;QAIxC,uBAAkB,GAAW,CAAC,CAAC;QAC/B,gBAAW,GAAW,CAAC,CAAC;QACxB,SAAI,GAAe;YACjB,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,oBAAoB,EAAE;YACxC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,qBAAqB,EAAE;YACzC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,mBAAmB,EAAE;YACvC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,sCAAsC,EAAC;YACzD,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,uCAAuC,EAAC;YAC1D,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,iCAAiC,EAAC;YACpD,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,qCAAqC,EAAC;SACzD;QACD,YAAO,GAAW,CAAC,CAAC;QACpB,kBAAa,GAA8B,CAAC,CAAC;QAC7C,mBAAc,GAAW,EAAE,CAAC;QAG5B,4BAAuB,GAAG,CAAC,CAAC;QAC5B,oBAAe,GAAG,KAAK,CAAC;QA2PxB,8CAA8C;QAC9C,WAAM,GAAY,KAAK,CAAC;QAlPpB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK;QAChE,IAAI,CAAC,aAAa,EAAE;IACxB,CAAC;IACD;;OAEG;IACH,YAAY,CAAC,KAAK;QAChB,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC;YACxD,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,2DAA2D,CAAC,EAAE,IAAI,CAAC;iBAC1H,IAAI,CAAC,GAAG,EAAE;gBACT,OAAO,IAAI,CAAC,eAAe;YAC7B,CAAC,CAAC;;YACD,IAAI,CAAC,eAAe,GAAG,KAAK;IACnC,CAAC;IACD;;OAEG;IACH,UAAU,CAAC,KAAK;QACd,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC;YAC1D,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,2DAA2D,CAAC,EAAE,IAAI,CAAC;iBAC1H,IAAI,CAAC,GAAG,EAAE;gBACT,OAAO,IAAI,CAAC,aAAa;YAC3B,CAAC,CAAC;;YACD,IAAI,CAAC,aAAa,GAAG,KAAK;IACjC,CAAC;IACD;;OAEG;IACH,mBAAmB,CAAC,KAAK;QACvB,IAAI,CAAC,sBAAsB,GAAG,KAAK;QACnC,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;QAC3B,IAAG,KAAK,IAAI,CAAC,EAAE;YACb,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;gBACxC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;YAChE,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAED;;OAEG;IACH,aAAa,CAAC,KAAK;QACjB,IAAG,KAAK;YAAE,IAAI,CAAC,aAAa,EAAE;IAChC,CAAC;IACD;;OAEG;IACH,aAAa;QACX,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAG,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC;gBAAE,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC1H,CAAC,CAAC,CAAC;IACL,CAAC;IAED,MAAM;QACJ,IAAI,CAAC,MAAM,GAAG,IAAI;QAClB,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,uCAAuC,CAAC,EAAE,IAAI,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;YAC9K,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,kDAAkD,CAAC,EAAC,EAAC,KAAK,EAAC,IAAI,CAAC,SAAS,EAAC,CAAC;QACpG,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;IACtB,CAAC;IACD,aAAa;QACX,gEAAgE;QAChE,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC,KAAoB,EAAE,EAAE;YAC1D,MAAM,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;YAC9B,IAAI,OAAO,KAAK,GAAG,EAAE;gBACnB,KAAK,CAAC,cAAc,EAAE,CAAC;aACxB;YACD,IAAI,OAAO,KAAK,GAAG,EAAE;aAEpB;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,SAAS,CAAC,EAAE;QACV,gDAAgD;QAChD,IAAI,SAAS,GAAQ,EAAE,CAAC;QACxB,IAAG,IAAI,CAAC,aAAa,IAAI,CAAC,EAAE;YAC1B,SAAS,GAAG;gBACV,IAAI,EAAE,IAAI,CAAC,cAAc;gBACzB,UAAU,EAAE,IAAI,CAAC,eAAe;gBAChC,QAAQ,EAAE,IAAI,CAAC,aAAa;gBAC5B,MAAM,EAAE,IAAI;gBACZ,IAAI,EAAE,IAAI,CAAC,aAAa;gBACxB,kBAAkB,EAAE,IAAI,CAAC,kBAAkB;gBAC3C,QAAQ,EAAE,EAAE,CAAC,OAAO;gBACpB,aAAa,EAAE,EAAE,CAAC,QAAQ;aAC3B;SACF;aAAM,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC,EAAE;YAClC,SAAS,GAAG;gBACV,IAAI,EAAE,IAAI,CAAC,cAAc;gBACzB,UAAU,EAAE,IAAI,CAAC,eAAe;gBAChC,QAAQ,EAAE,IAAI,CAAC,aAAa;gBAC5B,MAAM,EAAE,IAAI;gBACZ,IAAI,EAAE,IAAI,CAAC,aAAa;gBACxB,aAAa,EAAE,EAAE;gBACjB,kBAAkB,EAAE,IAAI,CAAC,kBAAkB;gBAC3C,gBAAgB,EAAE,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC;gBAC1D,eAAe,EAAE,IAAI,CAAC,eAAe;aACtC;SACF;aAAM,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC,EAAC;YACjC,SAAS,GAAE;gBACT,IAAI,EAAE,IAAI,CAAC,cAAc;gBACzB,UAAU,EAAE,IAAI,CAAC,eAAe;gBAChC,QAAQ,EAAE,IAAI,CAAC,aAAa;gBAC5B,MAAM,EAAE,IAAI;gBACZ,IAAI,EAAE,IAAI,CAAC,aAAa;gBACxB,QAAQ,EAAE,EAAE;aACb;SACF;aAAM,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC,EAAC;YACjC,SAAS,GAAE;gBACT,IAAI,EAAE,IAAI,CAAC,cAAc;gBACzB,UAAU,EAAE,IAAI,CAAC,eAAe;gBAChC,QAAQ,EAAE,IAAI,CAAC,aAAa;gBAC5B,MAAM,EAAE,IAAI;gBACZ,IAAI,EAAE,IAAI,CAAC,aAAa;gBACxB,QAAQ,EAAE,EAAE;aACb;SACF;aAAM,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC,EAAE;YAClC,SAAS,GAAE;gBACT,IAAI,EAAE,IAAI,CAAC,cAAc;gBACzB,UAAU,EAAE,IAAI,CAAC,eAAe;gBAChC,QAAQ,EAAE,IAAI,CAAC,aAAa;gBAC5B,MAAM,EAAE,IAAI;gBACZ,IAAI,EAAE,IAAI,CAAC,aAAa;gBACxB,sBAAsB,EAAE,IAAI,CAAC,sBAAsB;gBACnD,QAAQ,EAAE,EAAE;aACb;YACD,IAAG,IAAI,CAAC,sBAAsB;gBAAE,SAAS,CAAC,yBAAyB,CAAC,GAAI,IAAI,CAAC,uBAAuB;SACrG;aAAM;YACL,SAAS,GAAE;gBACT,IAAI,EAAE,IAAI,CAAC,cAAc;gBACzB,UAAU,EAAE,IAAI,CAAC,eAAe;gBAChC,QAAQ,EAAE,IAAI,CAAC,aAAa;gBAC5B,MAAM,EAAE,IAAI;gBACZ,sBAAsB,EAAE,IAAI,CAAC,sBAAsB;gBACnD,IAAI,EAAE,IAAI,CAAC,aAAa;gBACxB,QAAQ,EAAE,EAAE;aACb;YACD,IAAG,IAAI,CAAC,sBAAsB;gBAAE,SAAS,CAAC,yBAAyB,CAAC,GAAI,IAAI,CAAC,uBAAuB;SACrG;QAGD,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;aACxI,IAAI,CAAC,GAAG,EAAE;YACT,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE,EAAE,qBAAqB,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBAClE,IAAI,SAAS,CAAC,sBAAsB,EAAE;oBAClC,IAAI,IAAI,CAAC,cAAc,IAAI,EAAE,EAAE;wBAC3B,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,0CAA0C,CAAC,EAAE,CAAC,CAAC;qBAChK;yBACI;wBACH,QAAQ,SAAS,CAAC,IAAI,EAAE;4BACtB,KAAK,CAAC;gCAAE;oCACN,IAAG,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,EAAE;wCACjC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,EAAE,CAAC,CAAC;qCAC/I;yCAAM;wCACL,SAAS,mCAAQ,SAAS,KAAE,YAAY,EAAE,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,GAAC;wCACtF,OAAO,SAAS,CAAC,QAAQ;wCACzB,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;wCAC5B,MAAK;qCACN;oCACD,MAAM;iCACP;gCAAA,CAAC;4BACF,KAAK,CAAC,CAAC,CAAC;gCACN,IAAG,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,EAAE;oCACjC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,EAAE,CAAC,CAAC;iCAC/I;qCAAM;oCACL,SAAS,mCAAQ,SAAS,KAAE,UAAU,EAAE,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,GAAC;oCACpF,OAAO,SAAS,CAAC,QAAQ;oCACzB,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;oCAC5B,MAAK;iCACN;gCACD,MAAM;6BACP;4BACD,KAAK,CAAC,CAAC,CAAC;gCACJ,IAAI,OAAO,GAAI,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC;gCAC9C,IAAG,OAAO,GAAE,GAAG,IAAI,OAAO,GAAG,CAAC,EAAE;oCAC9B,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,4BAA4B,CAAC,EAAE,CAAC,CAAC;iCAClJ;qCACI,IAAG,IAAI,CAAC,cAAc,KAAK,SAAS,EAAE;oCACzC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,yBAAyB,CAAC,EAAE,CAAC,CAAC;iCAC/I;qCACI;oCACH,SAAS,mCAAQ,SAAS,KAAE,cAAc,EAAE,OAAO,GAAC;oCACpD,OAAO,SAAS,CAAC,QAAQ;oCACzB,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;iCAC7B;gCAED,MAAM;6BACT;yBACF;qBACF;iBACF;qBACA;oBACD,IAAI,IAAI,CAAC,cAAc,IAAI,EAAE,EAAE;wBAC7B,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,0CAA0C,CAAC,EAAE,CAAC,CAAC;qBAChK;yBAAM,IAAI,IAAI,CAAC,aAAa,KAAK,CAAC,IAAI,SAAS,CAAC,QAAQ,CAAC,MAAM,IAAI,CAAC,EACnE;wBACA,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,qCAAqC,CAAC,EAAE,CAAC,CAAC;qBACzJ;yBACE,IACH,IAAI,CAAC,aAAa,IAAI,CAAC;wBACvB,SAAS,CAAC,aAAa,CAAC,MAAM,IAAI,CAAC,EACnC;wBACA,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,qCAAqC,CAAC,EAAE,CAAC,CAAC;qBAC3J;yBAAM,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,gBAAgB;wBAC/D,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,iCAAiC,CAAC,EAAE,CAAC,CAAC;yBAEnJ;wBACH,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;qBAC9B;iBACF;YACH,CAAC,CAAC;QACJ,CAAC,EAAE,GAAG,EAAE,GAAE,CAAC,CAAC;IAEd,CAAC;IAED;;OAEG;IACH,YAAY,CAAC,SAAS;QACpB,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,CAAC;aACxC,IAAI,CAAC,CAAC,KAAK,EAAC,EAAE;YACZ,IAAI,KAAK,EAAE;gBACV,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,+BAA+B,CAAC,EAAE,EAAE,eAAe,CAAC,CAAC;gBACtK,IAAI,CAAC,MAAM,GAAG,IAAI;gBAClB,IAAI,IAAI,GAAG;oBACV,KAAK,EAAC,IAAI;oBACV,IAAI,EAAG,IAAI,CAAC,SAAS,CAAC,IAAI;oBAC1B,IAAI,EAAG,IAAI,CAAC,SAAS,CAAC,IAAI;iBAC1B;gBACD,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,kDAAkD,CAAC,EAAC,EAAC,KAAK,EAAC,IAAI,EAAC,CAAC;gBACvF,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC;aAC/B;QACD,CAAC,EAAC,KAAK,GAAE;YACT,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC;QAEnC,CAAC,CAAC,CAAC;IACP,CAAC;IAID,eAAe,CAAC,YAAoC,EAAE,YAAiC,EAAE,SAA+B;QACtH,OAAO,SAAS,CAAC,GAAG,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,+BAA+B,CAAC,EAAE,IAAI,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,OAAO,IAAI,EAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,OAAO,KAAK,EAAC,CAAC,CAAC,CAAC;IAClS,CAAC;IAED,UAAU,CAAC,CAAE;QACX,IAAI,CAAC,kBAAkB,GAAG,CAAC;QAC3B,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;IACvB,CAAC;IACD,YAAY;QACV,IAAG,IAAI,CAAC,kBAAkB,IAAI,IAAI,IAAI,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,WAAW;YAAE,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,WAAW;IAC9H,CAAC;;wEAnSU,YAAY;0GAAZ,YAAY;QCbzB,yEAA4D;QAAnB,iIAAS,YAAQ,IAAC;QACzD,kEAA+C;QAAA,uDACjD;;QAAA,4DAAM;QAEN,+EAA8B;QAC5B,yEAAmB;QACjB,yEAAwB;QAEtB,wGAEM;QACN,wGAEM;QACN,wGAEM;QACN,0GAEM;QACN,0GAEM;QACN,0GAEM;QACN,0GAEM;QAGR,4DAAM;QACN,0EAAyB;QACvB,0EAAsD;QACpD,0EAAwB;QACtB,qEAAG;QAAA,wDAAkC;;QAAA,4DAAI;QAC3C,4DAAM;QACN,0EAAwB;QACtB,6EAAoG;QAA/B,yLAA4B;;QAAjG,4DAAoG;QACtG,4DAAM;QACN,0EAAwB;QACtB,qEAAG;QAAA,wDAA+B;;QAAA,4DAAI;QACxC,4DAAM;QACN,0EAAwB;QACtB,sFACyC;QAAvC,mKAAiB,wBAAoB,IAAC;QAAC,4DAAiB;QAC5D,4DAAM;QACN,0EAAwB;QACtB,qEAAG;QAAA,wDAA6B;;QAAA,4DAAI;QACtC,4DAAM;QACN,0EAAwB;QACtB,sFACuC;QAArC,mKAAiB,sBAAkB,IAAC;QAAC,4DAAiB;QAC1D,4DAAM;QACN,0EAAwB;QACtB,qEAAG;QAAA,wDAAiC;;QAAA,4DAAI;QAC1C,4DAAM;QACN,0EAAwB;QACtB,iFAAmF;QAA9C,8JAAiB,+BAA2B,IAAC;QAChF,uHAA0G;QAC5G,4DAAY;QACd,4DAAM;QACN,2GAOM;QAEN,2GAEM;QACN,2GAOM;QACN,2GAEM;QACN,2GAEM;QACN,2GAMM;QAEN,2GAEM;QACN,2GAEM;QACN,6GAkBM;QACR,4DAAM;QACN,4DAAM;QACR,4DAAM;QACV,4DAAY;;QA3HqC,0DACjD;QADiD,oJACjD;QAMY,0DAAwB;QAAxB,wFAAwB;QAGxB,0DAAwB;QAAxB,wFAAwB;QAGxB,0DAAwB;QAAxB,wFAAwB;QAGxB,0DAAwB;QAAxB,wFAAwB;QAGxB,0DAAwB;QAAxB,wFAAwB;QAGxB,0DAAwB;QAAxB,wFAAwB;QAGxB,0DAAwB;QAAxB,wFAAwB;QASvB,0DAAkC;QAAlC,+JAAkC;QAG9B,0DAAoD;QAApD,8KAAoD;QAAU,uFAA4B;QAG9F,0DAA+B;QAA/B,mJAA+B;QAGwB,0DAA2B;QAA3B,wFAA2B;QAIlF,0DAA6B;QAA7B,iJAA6B;QAG0B,0DAAyB;QAAzB,sFAAyB;QAIhF,0DAAiC;QAAjC,qJAAiC;QAGzB,0DAAyB;QAAzB,sFAAyB;QACN,0DAAO;QAAP,6EAAO;QAGd,0DAAwB;QAAxB,wFAAwB;QASxB,0DAAwB;QAAxB,wFAAwB;QAGxB,0DAAwB;QAAxB,wFAAwB;QAQxB,0DAAwB;QAAxB,wFAAwB;QAGxB,0DAAwB;QAAxB,wFAAwB;QAGxB,0DAAwB;QAAxB,wFAAwB;QAQxB,0DAAoE;QAApE,4IAAoE;QAGpE,0DAAoE;QAApE,4IAAoE;QAGpE,0DAA4B;QAA5B,4FAA4B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtGkB;;;;;;;;;;;;;;;;;;;ICkB3E,0EAA0C;IACtC,oEAAG;IAAA,uDAAyC;;IAAA,4DAAI;IACpD,4DAAM;;IADC,0DAAyC;IAAzC,2JAAyC;;;IAIpD,0EAAsD;IAClD,0EAAY;IACR,qEACM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAAyE;IACrE,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAAwE;IACpE,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;;IAlBM,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,4JACJ;IAEI,0DACJ;IADI,qJACJ;IAEI,0DACJ;IADI,+JACJ;IAEI,0DACJ;IADI,0JACJ;IAEI,0DACJ;IADI,oKACJ;;;;IAKJ,0EAAoD;IAChD,0EAA4B;IACxB,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,0EAAoE;IAChE,0EAAgG;IAAjC,0UAAgC;IAC3F,uDACJ;;IAAA,4DAAM;IACV,4DAAM;IACN,sEAEM;IACN,sEAEM;IACV,4DAAM;IACV,4DAAM;;IAzBU,0DAAe;IAAf,wEAAe;IAef,0DACJ;IADI,2JACJ;;;IAuBI,gFAAsF;IAAA,uDAAW;IAAA,4DAAY;;;IAAlG,gFAAmB;IAAwD,0DAAW;IAAX,4EAAW;;;;IAbjH,0EAA0D;IACtD,0EAA4B;IACxB,0EAAiE;IAA5D,mYAAsB;IACvB,mEAAuG;IAC3G,4DAAM;IACN,0EAA0C;IACtC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAA2C;IACvC,uDACJ;IAAA,4DAAM;IACN,0EAA2C;IACvC,iFAA0E;IAAzC,0aAAwC;IACrE,+IAA6G;IACjH,4DAAY;IAChB,4DAAM;IACN,2EAAoE;IAChE,2EAAiH;IAAlC,+YAAiC;IAC5G,wDACJ;IAAA,4DAAM;IACV,4DAAM;IACN,2EAAuE;IACnE,qEAAG;IAAA,wDAA2F;IAAA,4DAAI;IACtG,4DAAM;IACN,2EAA2C;IACvC,2EAAoH;IAArC,kZAAoC;IAC/G,wDACJ;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IA7BU,0DAAe;IAAf,wEAAe;IAKhB,0DAAa;IAAb,8EAAa;IAGhB,0DACJ;IADI,6HACJ;IAEe,0DAAqB;IAArB,kFAAqB;IACsC,0DAAkB;IAAlB,wFAAkB;IAKpF,0DACJ;IADI,gIACJ;IAGG,0DAA2F;IAA3F,+KAA2F;IAI1F,0DACJ;IADI,yIACJ;;;;IAMhB,yFAAgJ;IAA1D,2ZAAyD;IAC/I,4DAAqB;;;IADyB,uGAAuC;;;IAOjF,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC6D;IACjE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGwB,0DAA6B;IAA7B,8FAA6B;;;;IAKzD,6EAEqC;IAAjC,oWAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,8VAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IApB3F,+EAEsE;IAFS,0XAAsC;;IAGjH,wJASe;IACf,kOAQc;IAClB,4DAAW;;;;IArBP,8KAAuD;IADjD,0EAAqC;;;IA4B3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACmE;IACvE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAG2B,0DAAgC;IAAhC,iGAAgC;;;;IAK/D,6EAE6C;IAAzC,4WAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,sWAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,6XAAyC;;IAG1H,wJASe;IACf,kOAQc;IAClB,4DAAW;;;;IArBP,mKAA4C;IADtC,0EAAwC;;;IA4B9C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC+D;IACnE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGqC,0DAA4B;IAA5B,6FAA4B;;;;IAKrE,6EAEwC;IAApC,uWAAmC;IAAC,uDACxB;;IAAA,4DAAS;IACzB,6EAEgE;IAA9B,iWAA6B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACxB;IADwB,0IACxB;IAGgD,0DAAsB;IAAtB,wIAAsB;;;;IApB9F,+EAE4E;IAFS,6XAAyC;IAG1H,wJASe;IACf,kOAQc;IAClB,4DAAW;;;;IAtBD,0EAAwC;;ADvJ3C,MAAM,6BAA6B;IAMxC,YACU,MAAc,EACf,WAAwB,EACvB,WAAwB,EACxB,IAAqB,EACtB,YAA0B,EACzB,KAAqB;QALrB,WAAM,GAAN,MAAM,CAAQ;QACf,gBAAW,GAAX,WAAW,CAAa;QACvB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QACzB,UAAK,GAAL,KAAK,CAAgB;QAXrB,kBAAa,GAAG,IAAI,uDAAY,EAAO,CAAC;QACzC,SAAI,GAAQ,EAAE,CAAC;QACxB,sBAAiB,GAAY,KAAK,CAAC;QACnC,SAAI,GAAW,CAAC,CAAC;QACjB,uBAAkB,GAAW,CAAC,CAAC;QA0G/B,2BAAsB,GAAY,KAAK,CAAC;QACxC,UAAK,GAAQ,CAAC,CAAC;QAoCf,8BAAyB,GAAY,KAAK,CAAC;QAC3C,aAAQ,GAAQ,CAAC,CAAC;QA4ClB,yBAAyB;QAExB,2BAA2B;QAC3B,iBAAY,GAAQ,CAAC,CAAC;QACtB,8BAAyB,GAAY,KAAK,CAAC;IAxLzC,CAAC;IAEJ,QAAQ,KAAU,CAAC;IAEnB;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,IAAI;QACjB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,KAAK,CAAC;QACjE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,KAAK,CAAC;QACjE,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACnB,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,oDAAoD;QACpD,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;gBAC5B,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,iBAAiB;gBACxC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAClD,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ;gBACnC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;aACzB,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBAC1C,OAAO;wBACL,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK;wBACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;wBACvB,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;qBACtC;gBACH,CAAC,CAAC;gBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;aACzC;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QACD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpC,IAAI,UAAU,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,CAAC,CAAC,mCAAQ,IAAI,CAAC,CAAC,CAAC,KAAE,UAAU,GAAE,CAAC;gBACrC,mBAAmB;gBACnB,wBAAwB;gBACxB,cAAc;gBACd,8BAA8B;gBAC9B,0BAA0B;gBAC1B,4BAA4B;gBAC5B,8CAA8C;gBAC9C,KAAK;gBACL,2CAA2C;gBAC3C,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;oBACjB,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;iBACrE;gBACD,IAAI,iBAAiB,GAAG,CAAC,CAAC;gBAC1B,IAAI,QAAQ,GAAG,CAAC,CAAC;gBACjB,IAAI,CAAC,CAAC,CAAC,mCACF,IAAI,CAAC,CAAC,CAAC,KACV,iBAAiB,EAAE,iBAAiB,EACpC,QAAQ,EAAE,QAAQ,GACnB,CAAC;gBACF,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAOD;;OAEG;IACH,iBAAiB,CAAC,MAAM;QACtB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACjC,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;SACjE;aAAM,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,GAAG,CAAC;YACrC,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,EACvD,aAAa,CACd,CAAC;QACJ,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAOD;;OAEG;IACH,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;QACnB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,sBAAsB;QACpB,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACpC,IAAI,CAAC,IAAI,CAAC,iBAAiB,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;SACvE;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CACxD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAED;;OAEG;IACI,MAAM,CAAC,IAAI;QAChB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC3D,CAAC,CAAC;IACL,CAAC;IAQD;;OAEG;IACF,oBAAoB;QAClB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QAEtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC;IAEL,CAAC;IAEF;;OAEG;IACF,iBAAiB;QACf,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,EACtC;YACA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAChC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CACnD,CAAC;gBACF,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;gBACpE,IAAI,CAAC,kBAAkB,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;aACtE;SACF;aAAM,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,GAAG,CAAC;YAC5C,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,EACvD,aAAa,CACd,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAEF;;OAEG;IACF,uBAAuB;QACrB,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;;0GA9OS,6BAA6B;2HAA7B,6BAA6B;QCZ1C,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAAsG;QAAlC,qJAAS,2BAAuB,IAAC;QACjG,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,sJAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,2HAEM;QACV,4DAAM;QAEN,6HAuBM;QAEN,0EAAwF;QACpF,4HA0BM;QACN,6HA8BM;QACV,4DAAM;QAEN,0JACqB;QAGrB,sIAsBW;QAGX,sIAsBW;QAGX,sIAsBW;;QAzLgD,wEAAe;QAE/D,0DAA6C;QAA7C,gKAA6C;QAMxC,0DAA6B;QAA7B,2JAA6B;QAIzB,0DAAyB;QAAzB,sFAAyB;QAE7B,0DACJ;QADI,qJACJ;QAGF,0DAAkB;QAAlB,kFAAkB;QAKO,0DAAiB;QAAjB,iFAAiB;QA0Bf,0DAAiB;QAAjB,iFAAiB;QA2BD,0DAAO;QAAP,6EAAO;QAiCvC,0DAAuB;QAAvB,uFAAuB;QAIK,0DAA4B;QAA5B,4FAA4B;QAyBzB,0DAA+B;QAA/B,+FAA+B;QAyB/B,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnKJ;;;;;;;;;;;;;;;;;;;ICoBvE,oEAAyB;IAAA,uDAAsE;;IAAA,4DAAI;;IAA1E,0DAAsE;IAAtE,wLAAsE;;;IADnG,0EAAqD;IACjD,+HAAmG;IACvG,4DAAM;;;IADE,0DAAkB;IAAlB,qFAAkB;;;IAE1B,0EAAoD;IAChD,wEAAkD;IAAA,uDAAuC;;IAAA,4DAAI;IACjG,4DAAM;;IADgD,0DAAuC;IAAvC,yJAAuC;;;IAI7F,0EAAsD;IAClD,0EAAY;IACR,qEACM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA2C;IACvC,wDACJ;;IAAA,4DAAM;IACN,2EAAwE;IACpE,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;;IAlBM,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,4JACJ;IAEI,0DACJ;IADI,qJACJ;IAEI,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,0JACJ;IAEI,0DACJ;IADI,yJACJ;;;IA+CY,gFAAiF;IAAA,uDAAW;IAAA,4DAAY;;;IAA7F,gFAAmB;IAAmD,0DAAW;IAAX,4EAAW;;;;IAf5G,0EAAyF;IACrF,0EAA4B;IACxB,0EAAiE;IAA5D,mZAAsB;IACvB,mEAC+D;IACnE,4DAAM;IACN,0EAA0C;IACtC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAA2C;IACvC,uDACJ;IAAA,4DAAM;IACN,0EAA0C;IACtC,iFAA0E;IAAzC,0bAAwC;IAErE,8JAAwG;IAC5G,4DAAY;IAChB,4DAAM;IACN,2EAAoE;IAEhE,2EACkC;IAAlC,+ZAAiC;IACjC,wDAAqE;IAAA,4DAAM;IAC/E,4DAAM;IACN,2EAAuE;IACnE,qEAAG;IAAA,wDAAkL;IAAA,4DAAI;IAC7L,4DAAM;IACN,2EAAoI;IAArC,kaAAoC;IAC/H,wDAA2B;IAAA,oEAAsE;IACrG,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IA9BU,0DAAe;IAAf,wEAAe;IAMhB,0DAAa;IAAb,8EAAa;IAGhB,0DACJ;IADI,gLACJ;IAEe,0DAAqB;IAArB,kFAAqB;IAEsC,0DAAa;IAAb,mFAAa;IAOnF,0DAAqE;IAArE,gKAAqE;IAGlE,0DAAkL;IAAlL,uSAAkL;IAGrL,0DAA2B;IAA3B,sGAA2B;;;;;IAzD3C,0EAA4G;IACxG,0EAAgC;IAC5B,0EAA4B;IACxB,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,0EAAoE;IAChE,0EAAiE;IAAjC,sVAAgC;IAC5D,uDACJ;;IAAA,4DAAM;IACV,4DAAM;IACN,sEAEM;IACN,sEAEM;IACV,4DAAM;IACV,4DAAM;IAEN,4IA+BM;IACV,4DAAM;;;IA3Dc,0DAAe;IAAf,wEAAe;IAef,0DACJ;IADI,8JACJ;IAWqC,0DAAsC;IAAtC,yLAAsC;;;IAtD/F,0EAAoF;IAChF,qIAuBM;IACN,oIA6DM;IACV,4DAAM;;;IAtFI,0DAAiB;IAAjB,oFAAiB;IAwBjB,0DAAiB;IAAjB,oFAAiB;;;;IAgE3B,yFAAgJ;IAA1D,6ZAAyD;IAC/I,4DAAqB;;;IADyB,uGAAuC;;;IAgB7E,0EAA8B;IAC1B,qEAEM;IACN,0EAAwB;IACpB,4EAA0B;IAAA,uDAAsD;;IAAA,4DAAQ;IAC5F,4DAAM;IACV,4DAAM;;IAF4B,0DAAsD;IAAtD,wKAAsD;;;IAd5F,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC6D;IACjE,4DAAM;IACV,4DAAM;IACN,uJAOM;IACV,qEAAe;;;IAfmC,0DAC1C;IAD0C,qJAC1C;IAGwB,0DAA6B;IAA7B,8FAA6B;IAG5C,0DAAe;IAAf,mFAAe;;;;IAU5B,6EAEqC;IAAjC,sWAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,gWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IA5B3F,+EAEsE;IAFS,4XAAsC;IAGjH,0JAiBe;IACf,oOAQc;IAClB,4DAAW;;;;IA9BD,0EAAqC;;;IA6CvC,0EAAkC;IAC9B,qEAEM;IACN,0EAAwB;IACpB,4EAA0B;IAAA,uDAAsD;;IAAA,4DAAQ;IAC5F,4DAAM;IACV,4DAAM;;IAF4B,0DAAsD;IAAtD,wKAAsD;;;IAd5F,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACwD;IAC5D,4DAAM;IACV,4DAAM;IACN,uJAOM;IACV,qEAAe;;;IAfmC,0DAC1C;IAD0C,uKAC1C;IAGqC,0DAAqB;IAArB,sFAAqB;IAGjD,0DAAmB;IAAnB,uFAAmB;;;;IAUhC,6EAEwC;IAApC,yWAAmC;IAAC,uDACxB;;IAAA,4DAAS;IACzB,6EAEgE;IAA9B,mWAA6B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACxB;IADwB,0IACxB;IAGgD,0DAAsB;IAAtB,wIAAsB;;;;IA5B9F,+EAE4E;IAFS,+XAAyC;;IAG1H,0JAiBe;IACf,oOAQc;IAClB,4DAAW;;;;IA7BP,sLAA+D;IADzD,0EAAwC;;;IAoC9C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACmE;IACvE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAG2B,0DAAgC;IAAhC,iGAAgC;;;;IAK/D,6EAE6C;IAAzC,8WAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,wWAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,+XAAyC;;IAG1H,0JASe;IACf,oOAQc;IAClB,4DAAW;;;;IArBP,4JAAqC;IAD/B,0EAAwC;;ADzK3C,MAAM,+BAA+B;IAK1C,YACU,MAAc,EACf,WAAwB,EACvB,WAAwB,EACxB,IAAqB,EACrB,KAAqB,EACtB,YAA0B;QALzB,WAAM,GAAN,MAAM,CAAQ;QACf,gBAAW,GAAX,WAAW,CAAa;QACvB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACrB,UAAK,GAAL,KAAK,CAAgB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QAVzB,aAAQ,GAAG,IAAI,uDAAY,EAAO,CAAC;QAE7C,SAAI,GAAQ,EAAE,CAAC;QACf,sBAAiB,GAAY,KAAK,CAAC;QAyDnC,2BAA2B;QAC3B,iBAAY,GAAQ,CAAC,CAAC;QACtB,8BAAyB,GAAY,KAAK,CAAC;QAC3C,gBAAW,GAAW,CAAC,CAAC;QACxB,iBAAY,GAAY,IAAI,CAAC;QA8B7B,2BAAsB,GAAY,KAAK,CAAC;QACxC,UAAK,GAAQ,CAAC,CAAC;QACf,aAAQ,GAAY,IAAI,CAAC;QAkFzB,8BAAyB,GAAY,KAAK,CAAC;QAC3C,aAAQ,GAAQ,CAAC,CAAC;IAxKf,CAAC;IAEJ,QAAQ;IACR,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,CAAC;QACd,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QAC5D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK;QAC3D,IAAI,CAAC,IAAI,GAAG,CAAC;IACf,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACxC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;gBAC5B,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAClD,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;gBAChC,cAAc,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;gBACjE,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;gBACxB,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,iBAAiB;aACzC,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBAC1C,OAAO;wBACL,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK;wBACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;wBACvB,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;qBACtC;gBACH,CAAC,CAAC;gBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;aACzC;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QACD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC/B,CAAC;IAOD,eAAe;IACf,oBAAoB;QAClB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;IACxC,CAAC;IAED,uBAAuB;IACvB,iBAAiB;QACf,IACE,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;YACnE,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,GAAG,EACrE;YACA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;gBACvF,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;gBACzB,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;aACxC;SACF;aAAM;YACL,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;SAE3B;IACH,CAAC;IAED,gBAAgB;IAChB,uBAAuB;QACrB,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAQD;;OAEG;IACH,iBAAiB,CAAC,MAAyB;QACzC,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;IACrC,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IACE,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;YAC/D,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,GAAG,EACjE;YACA,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACtF,sDAAsD;YACtD,4EAA4E;YAC5E,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;SACrC;aAAM;YACL,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;SACvB;IACH,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpC,IAAI,UAAU,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAC,UAAU,GAAE;gBAClC,mBAAmB;gBACnB,wBAAwB;gBACxB,cAAc;gBACd,8BAA8B;gBAC9B,0BAA0B;gBAC1B,4BAA4B;gBAC5B,8CAA8C;gBAC9C,KAAK;gBACL,2CAA2C;gBAC3C,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;oBACjB,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;iBACpE;gBACD,IAAI,QAAQ,GAAG,CAAC,CAAC;gBACjB,IAAI,iBAAiB,GAAG,CAAC;gBACzB,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAE,QAAQ,EAAE,QAAQ,EAAE,iBAAiB,EAAE,iBAAiB,GAAC;gBAChF,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aAEF;SAEF;QACD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAOD;;OAEG;IACH,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;QACnB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,sBAAsB;QACpB,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACpC,IAAI,CAAC,IAAI,CAAC,iBAAiB,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;SACvE;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CACxD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAED;;OAEG;IACI,MAAM,CAAC,IAAI;QAChB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC5D,CAAC,CAAC;IACL,CAAC;;8GA9NU,+BAA+B;6HAA/B,+BAA+B;QChB5C,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EACoC;QADgC,uJAAS,2BAAuB,IAAC;QAEjG,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,wJAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,6HAEM;QACN,6HAEM;QACV,4DAAM;QACN,6HAuFM;QAEN,2JACqB;QAGrB,uIA8BW;QAGX,wIA8BW;QAGX,wIAsBW;;QA/MgD,wEAAe;QAE/D,0DAA6C;QAA7C,gKAA6C;QAK5C,0DAAmC;QAAnC,gGAAmC;QAE/B,0DAA6B;QAA7B,2JAA6B;QAM7B,0DACJ;QADI,qJACJ;QAGF,0DAA6B;QAA7B,6FAA6B;QAG7B,0DAA4B;QAA5B,4FAA4B;QAIe,0DAA6B;QAA7B,6FAA6B;QAyF7D,0DAAuB;QAAvB,uFAAuB;QAIK,0DAA4B;QAA5B,4FAA4B;QAiCzB,0DAA+B;QAA/B,+FAA+B;QAiC/B,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzLJ;;;;;;;;;;;;;;;;;;;ICkB3E,0EAA0C;IACtC,oEAAG;IAAA,uDAAyC;;IAAA,4DAAI;IACpD,4DAAM;;IADC,0DAAyC;IAAzC,2JAAyC;;;IAIpD,0EAAsD;IAClD,0EAAY;IACR,qEACM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAAyE;IACrE,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAAwE;IACpE,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;;IAlBM,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,4JACJ;IAEI,0DACJ;IADI,qJACJ;IAEI,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,0JACJ;IAEI,0DACJ;IADI,8JACJ;;;;IAKJ,0EAAoD;IAChD,0EAA4B;IACxB,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,0EAAoE;IAChE,0EAAgG;IAAjC,iVAAgC;IAC3F,uDACJ;;IAAA,4DAAM;IACV,4DAAM;IACN,sEAEM;IACN,sEAEM;IACV,4DAAM;IACV,4DAAM;;IAzBU,0DAAe;IAAf,wEAAe;IAef,0DACJ;IADI,6JACJ;;;IAuBI,gFAAsF;IAAA,uDAAW;IAAA,4DAAY;;;IAAlG,gFAAmB;IAAwD,0DAAW;IAAX,4EAAW;;;;IAbjH,0EAA0D;IACtD,0EAA4B;IACxB,0EAAiE;IAA5D,0YAAsB;IACvB,mEAAuG;IAC3G,4DAAM;IACN,0EAA0C;IACtC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAA2C;IACvC,uDACJ;IAAA,4DAAM;IACN,0EAA2C;IACvC,iFAA0E;IAAzC,ibAAwC;IACrE,sJAA6G;IACjH,4DAAY;IAChB,4DAAM;IACN,2EAAoE;IAChE,2EAAgG;IAAlC,sZAAiC;IAC3F,wDACJ;IAAA,4DAAM;IACV,4DAAM;IACN,2EAAuE;IAEnE,qEAAG;IAAA,wDAA4E;IAAA,4DAAI;IACvF,4DAAM;IACN,2EAA2C;IACvC,2EAAoH;IAArC,yZAAoC;IAC/G,wDACJ;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IA9BU,0DAAe;IAAf,wEAAe;IAKhB,0DAAa;IAAb,8EAAa;IAGhB,0DACJ;IADI,6HACJ;IAEe,0DAAqB;IAArB,kFAAqB;IACsC,0DAAkB;IAAlB,wFAAkB;IAKpF,0DACJ;IADI,iIACJ;IAIG,0DAA4E;IAA5E,4KAA4E;IAI3E,0DACJ;IADI,sGACJ;;;;IAMhB,yFAAgJ;IAA1D,kaAAyD;IAC/I,4DAAqB;;;IADyB,uGAAuC;;;IAgB7E,0EAA8B;IAC1B,qEAEM;IACN,0EAAwB;IACpB,4EAA0B;IAAA,oHAAgC;IAAA,4DAAQ;IACtE,4DAAM;IACV,4DAAM;;;IAhBV,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC6D;IACjE,4DAAM;IACV,4DAAM;IACN,4JAOM;IACV,qEAAe;;;IAfmC,0DAC1C;IAD0C,qJAC1C;IAGwB,0DAA6B;IAA7B,8FAA6B;IAG5C,0DAAe;IAAf,mFAAe;;;;IAU5B,6EAEqC;IAAjC,2WAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAC6D;IAA3B,qWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAHvD,0DACrB;IADqB,0IACrB;IAE6C,0DAAsB;IAAtB,wIAAsB;;;;IA3B3F,+EAEsE;IAFS,iYAAsC;;IAGjH,+JAiBe;IACf,yOAOc;IAClB,4DAAW;;;;IA5BP,sKAA+C;IADzC,0EAAqC;;;IA4CvC,0EAAkC;IAC9B,qEAEM;IACN,0EAAwB;IACpB,4EAA0B;IAAA,oHAAgC;IAAA,4DAAQ;IACtE,4DAAM;IACV,4DAAM;;;IAhBV,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACkE;IACtE,4DAAM;IACV,4DAAM;IACN,4JAOM;IACV,qEAAe;;;IAfmC,0DAC1C;IAD0C,qJAC1C;IAG4B,0DAA8B;IAA9B,+FAA8B;IAGjD,0DAAmB;IAAnB,uFAAmB;;;;IAUhC,6EAEwC;IAApC,8WAAmC;IAAC,uDACxB;;IAAA,4DAAS;IACzB,6EACgE;IAA9B,wWAA6B;IAAC,uDAAsB;;IAAA,4DAAS;;IAHvD,0DACxB;IADwB,0IACxB;IAEgD,0DAAsB;IAAtB,wIAAsB;;;;IA3B9F,+EAE4E;IAFS,oYAAyC;;IAG1H,+JAiBe;IACf,yOAOc;IAClB,4DAAW;;;;IA5BP,qKAA8C;IADxC,0EAAwC;;;IAmC9C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACmE;IACvE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAG2B,0DAAgC;IAAhC,iGAAgC;;;;IAK/D,6EAE6C;IAAzC,mXAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,6WAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,oYAAyC;;IAG1H,+JASe;IACf,yOAQc;IAClB,4DAAW;;;;IArBP,sKAA+C;IADzC,0EAAwC;;ADrK3C,MAAM,oCAAoC;IAM/C,YACU,MAAc,EACf,WAAwB,EACvB,WAAwB,EACxB,IAAqB,EACrB,KAAqB,EACtB,YAA0B;QALzB,WAAM,GAAN,MAAM,CAAQ;QACf,gBAAW,GAAX,WAAW,CAAa;QACvB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACrB,UAAK,GAAL,KAAK,CAAgB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QAV1B,SAAI,GAAQ,EAAE,CAAC;QACd,kBAAa,GAAG,IAAI,uDAAY,EAAO,CAAC;QAClD,sBAAiB,GAAY,KAAK,CAAC;QACnC,yBAAoB,GAAG,CAAC;QA4GvB,2BAAsB,GAAY,KAAK,CAAC;QACxC,YAAO,GAAQ,CAAC,CAAC;QACjB,aAAQ,GAAY,IAAI,CAAC;QAmC1B,8BAAyB,GAAY,KAAK,CAAC;QAC3C,aAAQ,GAAQ,CAAC,CAAC;QA8ClB,kDAAkD;QAClD,iBAAY,GAAQ,CAAC,CAAC;QACtB,8BAAyB,GAAY,KAAK,CAAC;QAC3C,iBAAY,GAAY,IAAI,CAAC;IAzL7B,CAAC;IAED,QAAQ;IAER,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,IAAI;QACjB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,KAAK,CAAC;QAC/D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,KAAK;QAC9D,IAAI,CAAC,IAAI,GAAG,IAAI;IAClB,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;gBAC5B,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,iBAAiB;gBACxC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAClD,cAAc,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ;gBACrC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;aACzB,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBAC1C,OAAO;wBACL,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK;wBACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;wBACvB,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;qBACtC;gBACH,CAAC,CAAC;gBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;aACzC;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QAED,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAEpC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAGD;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpC,IAAI,UAAU,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAC,UAAU,GAAE;gBAClC,mBAAmB;gBACnB,wBAAwB;gBACxB,cAAc;gBACd,8BAA8B;gBAC9B,0BAA0B;gBAC1B,4BAA4B;gBAC5B,8CAA8C;gBAC9C,KAAK;gBACL,2CAA2C;gBAC3C,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;oBACjB,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;iBACpE;gBACD,IAAI,iBAAiB,GAAG,CAAC,CAAC;gBAC1B,IAAI,QAAQ,GAAG,CAAC,CAAC;gBACjB,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAE,iBAAiB,EAAE,iBAAiB,EAAE,QAAQ,EAAE,QAAQ,GAAC;gBAChF,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAQD;;OAEG;IACF,iBAAiB,CAAC,MAAM;QACtB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QAC3D,CAAC,CAAC,CAAC;IACL,CAAC;IAEF;;OAEG;IACF,cAAc;QACZ,IAAK,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,IAAI,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,IAAI,GAAG,EAAE;YACjG,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;YACjE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACpB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;SACtC;aAAM;YACJ,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;SACxB;IAEH,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAOF;;OAEG;IACF,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;QACnB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAEF;;OAEG;IACF,sBAAsB;QACpB,IAAK,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACrC,IAAI,CAAC,IAAI,CAAC,iBAAiB,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;SACvE;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CAExD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAGF;;OAEG;IACI,MAAM,CAAC,IAAI;QAChB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC5D,CAAC,CAAC;IACL,CAAC;IAOD;;OAEG;IACH,oBAAoB;QACjB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QAEtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC;IAEL,CAAC;IAEF;;OAEG;IACF,iBAAiB;QACf,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,GAAG,EAAE;YAClF,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAChC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CACnD,CAAC;gBACF,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;gBACpE,IAAI,CAAC,oBAAoB,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;gBACxE,IAAI,CAAC,YAAY,GAAG,IAAI;aACzB;YACD,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;SACxC;aAAM;YACN,IAAI,CAAC,YAAY,GAAG,KAAK;SACzB;IACH,CAAC;IAEF;;OAEG;IACF,uBAAuB;QACrB,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;;wHA9OS,oCAAoC;kIAApC,oCAAoC;QCbjD,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAAsG;QAAlC,4JAAS,2BAAuB,IAAC;QACjG,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,6JAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,kIAEM;QACV,4DAAM;QAEN,oIAuBM;QAEN,0EAAwF;QACpF,mIA0BM;QACN,oIA+BM;QACV,4DAAM;QAEN,iKACqB;QAGrB,6IA6BW;QAGX,6IA6BW;QAGX,6IAsBW;;QAxMgD,wEAAe;QAE/D,0DAA6C;QAA7C,gKAA6C;QAMxC,0DAA6B;QAA7B,2JAA6B;QAIzB,0DAAyB;QAAzB,sFAAyB;QAE7B,0DACJ;QADI,qJACJ;QAGF,0DAAkB;QAAlB,kFAAkB;QAKO,0DAAiB;QAAjB,iFAAiB;QA0Bf,0DAAiB;QAAjB,iFAAiB;QA2BD,0DAAO;QAAP,6EAAO;QAkCvC,0DAAuB;QAAvB,uFAAuB;QAIK,0DAA4B;QAA5B,4FAA4B;QAgCzB,0DAA+B;QAA/B,+FAA+B;QAgC/B,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjLJ;;;;;;;;;;;;;;;;;;;ICkBvE,oEAAyB;IAAA,uDAAsE;;IAAA,4DAAI;;IAA1E,0DAAsE;IAAtE,wLAAsE;;;IADnG,0EAAqD;IACjD,iIAAmG;IACvG,4DAAM;;;IADE,0DAAkB;IAAlB,qFAAkB;;;IAE1B,0EAAoD;IAChD,wEAAkD;IAAA,uDAAuC;;IAAA,4DAAI;IACjG,4DAAM;;IADgD,0DAAuC;IAAvC,yJAAuC;;;IAI7F,0EAAsD;IAClD,0EAAY;IACR,qEACM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA2C;IACvC,mFACJ;IAAA,4DAAM;IACN,2EAAwE;IACpE,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;;IAlBM,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,4JACJ;IAKI,0DACJ;IADI,kKACJ;IAEI,0DACJ;IADI,0JACJ;IAEI,0DACJ;IADI,yJACJ;;;IA6CY,gFAAsF;IAAA,uDAAW;IAAA,4DAAY;;;IAAlG,gFAAmB;IAAwD,0DAAW;IAAX,4EAAW;;;;IAdjH,0EAAyF;IACrF,0EAA4B;IACxB,0EAAiE;IAA5D,qZAAsB;IACvB,mEAC+D;IACnE,4DAAM;IACN,0EAA0C;IACtC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAA2C;IACvC,uDACJ;IAAA,4DAAM;IACN,0EAA0C;IACtC,iFAA0E;IAAzC,4bAAwC;IACrE,gKAA6G;IACjH,4DAAY;IAChB,4DAAM;IACN,2EAAoE;IAChE,2EAAkE;IAAlC,iaAAiC;IAC7D,wDAA6C;IAAA,4DAAM;IAC3D,4DAAM;IACN,2EAAuE;IACnE,qEAAG;IAAA,wDAAuK;IAAA,4DAAI;IAClL,4DAAM;IACN,2EAAoI;IAArC,oaAAoC;IAC/H,wDAA2B;IAAA,oEAAsE;IACrG,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IA3BU,0DAAe;IAAf,wEAAe;IAMhB,0DAAa;IAAb,8EAAa;IAGhB,0DACJ;IADI,8HACJ;IAEe,0DAAqB;IAArB,kFAAqB;IACsC,0DAAkB;IAAlB,wFAAkB;IAKpF,0DAA6C;IAA7C,gIAA6C;IAG9C,0DAAuK;IAAvK,4QAAuK;IAG1K,0DAA2B;IAA3B,sGAA2B;;;;;IArD3C,0EAA4G;IACxG,0EAAgC;IAC5B,0EAA4B;IACxB,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,0EAAoE;IAChE,0EAAiE;IAAjC,wVAAgC;IAC5D,uFACJ;IAAA,4DAAM;IACV,4DAAM;IACN,sEAEM;IACN,sEAEM;IACV,4DAAM;IACV,4DAAM;IACN,8IA4BM;IACV,4DAAM;;;IAvDc,0DAAe;IAAf,wEAAe;IA0BkB,2DAAsC;IAAtC,yLAAsC;;;IArD/F,0EAAqF;IACjF,uIAuBM;IACN,sIAyDM;IACV,4DAAM;;;IAlFI,0DAAiB;IAAjB,oFAAiB;IAwBjB,0DAAiB;IAAjB,oFAAiB;;;;IA4D3B,yFAC8D;IAA1D,+ZAAyD;IAC7D,4DAAqB;;;IAFyB,uGAAuC;;;IAQjF,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC6D;IACjE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGwB,0DAA6B;IAA7B,8FAA6B;;;;IAKzD,6EAEqC;IAAjC,wWAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,kWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IApB3F,+EAEsE;IAFS,8XAAsC;IAGjH,4JASe;IACf,sOAQc;IAClB,4DAAW;;;;IAtBD,0EAAqC;;;IA4B3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC4C;IAChD,4DAAM;IACV,4DAAM;IACV,qEAAe;;IAPmC,0DAC1C;IAD0C,oJAC1C;;;;IAQJ,6EAEwC;IAApC,2WAAmC;IAAC,uDACxB;;IAAA,4DAAS;IACzB,6EAEgE;IAA9B,qWAA6B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACxB;IADwB,0IACxB;IAGgD,0DAAsB;IAAtB,wIAAsB;;;;IApB9F,+EAE4E;IAFS,iYAAyC;IAG1H,4JASe;IACf,sOAQc;IAClB,4DAAW;;;;IAtBD,0EAAwC;;;IA4B9C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACmE;IACvE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAG2B,0DAAgC;IAAhC,iGAAgC;;;;IAK/D,6EAE6C;IAAzC,gXAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,0WAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,iYAAyC;;IAG1H,4JASe;IACf,sOAQc;IAClB,4DAAW;;;;IArBP,4JAAqC;IAD/B,0EAAwC;;ADpJ3C,MAAM,iCAAiC;IAM5C,YACU,MAAc,EACf,WAAwB,EACvB,WAAwB,EACxB,IAAqB,EACrB,KAAqB,EACtB,YAA0B;QALzB,WAAM,GAAN,MAAM,CAAQ;QACf,gBAAW,GAAX,WAAW,CAAa;QACvB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACrB,UAAK,GAAL,KAAK,CAAgB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QAXzB,aAAQ,GAAG,IAAI,uDAAY,EAAO,CAAC;QACpC,SAAI,GAAQ,EAAE,CAAC;QACf,2BAAsB,GAAY,KAAK,CAAC;QACjD,sBAAiB,GAAY,KAAK,CAAC;QACnC,8BAAyB,GAAY,KAAK,CAAC;QAuB3C,2BAA2B;QAC3B,iBAAY,GAAQ,CAAC,CAAC;QAgDtB,2BAAsB,GAAY,KAAK,CAAC;QACxC,UAAK,GAAQ,CAAC,CAAC;QAqHf,8BAAyB,GAAY,KAAK,CAAC;QAC3C,aAAQ,GAAQ,CAAC,CAAC;IAvLf,CAAC;IAEJ,QAAQ;QACN,GAAG;IACL,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,CAAC;QACd,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QAC9D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QAC9D,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;IAChB,CAAC;IAKD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QAEtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,iBAAiB;QACf,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACxC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAChC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CACnD,CAAC;gBACF,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;gBACpE,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;oBAC9C,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS;wBACpB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;iBACpE;aACF;SACF;aAAM,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,GAAG,CAAC;YAC5C,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,EACvD,aAAa,CACd,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAED;;OAEG;IACH,uBAAuB;QACrB,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAOD;;OAEG;IACH,iBAAiB,CAAC,MAAyB;QACzC,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACjC,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;SACjE;aAAM;YACL,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,EACvD,aAAa,CACd,CAAC;SACH;QACD,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;gBAC5B,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAClD,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ;gBACnC,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;gBAChC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;gBACxB,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,iBAAiB;aACzC,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAI,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACvB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;oBAC5C,OAAO;wBACL,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK;wBACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;wBACvB,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;qBACtC,CAAC;gBACJ,CAAC,CAAC,CAAC;gBACH,QAAQ,mCAAQ,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAE,CAAC;aAC5C;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QAED,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC/B,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpC,IAAI,UAAU,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,CAAC,CAAC,mCAAQ,IAAI,CAAC,CAAC,CAAC,KAAE,UAAU,GAAE,CAAC;gBACrC,mBAAmB;gBACnB,wBAAwB;gBACxB,cAAc;gBACd,8BAA8B;gBAC9B,0BAA0B;gBAC1B,4BAA4B;gBAC5B,8CAA8C;gBAC9C,KAAK;gBACL,2CAA2C;gBAC3C,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;oBACjB,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;iBACrE;gBACD,IAAI,QAAQ,GAAG,CAAC,CAAC;gBACjB,IAAI,iBAAiB,GAAG,CAAC;gBACzB,IAAI,CAAC,CAAC,CAAC,mCAAQ,IAAI,CAAC,CAAC,CAAC,KAAE,QAAQ,EAAE,QAAQ,EAAE,iBAAiB,EAAE,iBAAiB,GAAC,CAAC;gBAClF,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,IAAI,GAAG,EAAE;oBACzC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAOD;;OAEG;IACH,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;QACnB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,sBAAsB;QACpB,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACpC,IAAI,CAAC,IAAI,CAAC,iBAAiB,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;SACvE;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CACxD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,IAAI;QACT,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC3D,CAAC,CAAC;IACL,CAAC;;kHA9OU,iCAAiC;+HAAjC,iCAAiC;QCjB9C,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAA0I;QAAlC,yJAAS,2BAAuB,IAAC;QACrI,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,0JAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,+HAEM;QACN,+HAEM;QACV,4DAAM;QACN,+HAmFM;QAEN,6JAEqB;QAGrB,yIAsBW;QAGX,0IAsBW;QAGX,0IAsBW;;QA3LgD,wEAAe;QAE/D,0DAA6C;QAA7C,gKAA6C;QAIpC,0DAAmC;QAAnC,gGAAmC;QAEvC,0DAA6B;QAA7B,2JAA6B;QAM7B,0DACJ;QADI,qJACJ;QAGF,0DAA6B;QAA7B,6FAA6B;QAG7B,0DAA4B;QAA5B,4FAA4B;QAIe,0DAA6B;QAA7B,6FAA6B;QAqF7D,0DAAuB;QAAvB,uFAAuB;QAKK,0DAA4B;QAA5B,4FAA4B;QAyBzB,0DAA+B;QAA/B,+FAA+B;QAyB/B,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrKJ;;;;;;;;;;;;;;;;;;ICkB3E,0EAA0C;IACtC,oEAAG;IAAA,uDAAyC;;IAAA,4DAAI;IACpD,4DAAM;;IADC,0DAAyC;IAAzC,2JAAyC;;;IA4C5B,gFAAsF;IAAA,uDAAW;IAAA,4DAAY;;;IAAlG,+EAAmB;IAAwD,0DAAW;IAAX,2EAAW;;;;IAf7G,0EAAoE;IAChE,0EAA4D;IACxD,wEAAsF;IAAvB,0YAAsB;IAAC,4DAAI;IAC9F,4DAAM;IACN,0EAAoC;IAChC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAAiD;IAC7C,uDACJ;IAAA,4DAAM;IACN,0EAA2I;IAAxF,wZAAgC;IAC/E,uDACJ;IAAA,4DAAM;IACN,2EAA0C;IACtC,iFAA0E;IAAzC,qbAAwC;IACrE,2JAA6G;IACjH,4DAAY;IAChB,4DAAM;IACN,2EAA6I;IAAzF,0ZAAiC;IACjF,wDACJ;IAAA,4DAAM;IACV,4DAAM;;;;IAhBK,0DAAa;IAAb,6EAAa;IAGhB,0DACJ;IADI,4HACJ;IAEI,0DACJ;IADI,qGACJ;IAEe,0DAAqB;IAArB,iFAAqB;IACsC,0DAAkB;IAAlB,uFAAkB;IAIxF,0DACJ;IADI,iIACJ;;;IA9ChB,0EAAwE;IACpE,0EAA2B;IACvB,0EAAsC;IAClC,oEAAG;IAAA,gGAAsB;IAAA,4DAAI;IAAC,uDAClC;IAAA,4DAAM;IACN,0EAA4C;IACxC,qEAEM;IACN,0EAA+D;IAC3D,wFACJ;IAAA,4DAAM;IACN,2EAAkE;IAC9D,+EACJ;IAAA,4DAAM;IACN,2EAAoE;IAChE,0EACJ;IAAA,4DAAM;IACN,2EAAqE;IACjE,mFACJ;IAAA,4DAAM;IACN,2EAAqE;IACjE,+EACJ;IAAA,4DAAM;IACV,4DAAM;IACN,2EAA+C;IAC3C,yIAqBM;IACV,4DAAM;IACV,4DAAM;IACV,4DAAM;;;IA/CoC,0DAClC;IADkC,8FAClC;IAsB+D,2DAAO;IAAP,gFAAO;;;;IA2B9E,yFAAgJ;IAA1D,gaAAyD;IAC/I,4DAAqB;;;IADyB,uGAAuC;;;IAOjF,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC+D;IACnE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGwB,0DAA+B;IAA/B,gGAA+B;;;;IAK3D,6EAEqC;IAAjC,yWAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,mWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IApB3F,+EAEsE;IAFS,+XAAsC;IAGjH,6JASe;IACf,uOAQc;IAClB,4DAAW;;;;IAtBD,0EAAqC;;;IA4B3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACyE;IAC7E,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAGiC,0DAAgC;IAAhC,iGAAgC;;;;IAKrE,6EAEyC;IAArC,6WAAoC;IAAC,uDACzB;;IAAA,4DAAS;IACzB,6EAEiE;IAA/B,uWAA8B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACzB;IADyB,0IACzB;IAGiD,0DAAsB;IAAtB,wIAAsB;;;;IApB/F,+EAE8E;IAFD,8XAAqC;IAG9G,6JASe;IACf,uOAQc;IAClB,4DAAW;;;;IAtBD,0EAAoC;;AD5FvC,MAAM,kCAAkC;IAM7C,YACU,WAAwB,EACxB,IAAqB,EACrB,KAAqB,EACtB,YAA0B,EAC1B,WAAwB;QAJvB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACrB,UAAK,GAAL,KAAK,CAAgB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QAC1B,gBAAW,GAAX,WAAW,CAAa;QATvB,kBAAa,GAAG,IAAI,uDAAY,EAAO,CAAC;QACxC,gBAAW,GAAG,IAAI,uDAAY,EAAU,CAAC;QACnD,sBAAiB,GAAY,KAAK,CAAC;QACnC,SAAI,GAAG,EAAE;QAqBT,2BAAsB,GAAY,KAAK,CAAC;QAsCxC,0BAAqB,GAAY,KAAK,CAAC;IApDnC,CAAC;IAEL,QAAQ;IACR,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAOD;;OAEG;IACH,iBAAiB,CAAC,MAAM;QACtB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACjC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QAC7D,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACrC,IAAI,CAAC,UAAU,CAAC,UAAU,GAAG,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,CAAC;SACvE;aAAM,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,GAAG,CAAC;YACzC,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,6CAA6C,CAAC,EAClE,aAAa,CACd,CAAC;QACJ,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAQD;;OAEG;IACH,gBAAgB,CAAC,MAAM;QACrB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;QACnB,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;QAClC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,sBAAsB,CAAC,CAAC;QACzE,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,kBAAkB;QAChB,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACxC,IAAI,CAAC,IAAI,CAAC,iBAAiB,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;SAC3E;aAAM,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,GAAG,CAAC;YAC5C,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,mDAAmD,CAAC,EACxE,aAAa,CACd,CAAC;QACJ,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC;IACrC,CAAC;IACD;;OAEG;IACH,wBAAwB;QACtB,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC;IACrC,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,CAAC;QACd,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QAC5D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK;QAC3D,IAAI,CAAC,IAAI,GAAG,CAAC;IACf,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;gBAC5B,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAClD,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU;gBAC9B,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,iBAAiB;gBACxC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;aACzB,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBAC1C,IAAI,KAAK,GAAE;wBACT,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK;wBACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;qBACxB;oBACD,IAAG,IAAI,CAAC,aAAa;wBAAE,KAAK,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC,aAAa;oBAClE,OAAQ,KAAK;gBACf,CAAC,CAAC;gBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;aACzC;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QACD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC;IACnC,CAAC;IAED;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpC,IAAI,UAAU,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAC,UAAU,GAAE;gBAClC,mBAAmB;gBACnB,wBAAwB;gBACxB,cAAc;gBACd,8BAA8B;gBAC9B,0BAA0B;gBAC1B,4BAA4B;gBAC5B,8CAA8C;gBAC9C,KAAK;gBACL,2CAA2C;gBAC3C,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;oBACjB,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;iBACpE;gBACD,IAAI,UAAU,GAAG,CAAC,CAAC;gBACnB,IAAI,iBAAiB,GAAG,CAAC,CAAC;gBAC1B,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAE,UAAU,EAAE,UAAU,EAAE,iBAAiB,EAAE,iBAAiB,GAAC;gBACpF,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;QACvC,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAED;;OAEG;IACI,MAAM,CAAC,IAAI;QAChB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE;gBACX,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBAC5C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;YACzC,CAAC;SACF,CAAC,CAAC;IACL,CAAC;;oHAjMU,kCAAkC;gIAAlC,kCAAkC;QCZ/C,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAAsG;QAAlC,0JAAS,2BAAuB,IAAC;QACjG,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,2JAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,gIAEM;QACV,4DAAM;QACN,iIAkDM;QAGN,8JACqB;QAGrB,0IAsBW;QAGX,2IAsBW;;QA9HgD,wEAAe;QAE/D,0DAA6C;QAA7C,+JAA6C;QAMxC,0DAA6B;QAA7B,2JAA6B;QAM7B,0DACJ;QADI,qJACJ;QAGF,0DAAkB;QAAlB,kFAAkB;QAIyB,0DAAiB;QAAjB,iFAAiB;QAqDjD,0DAAuB;QAAvB,uFAAuB;QAIK,0DAA4B;QAA5B,4FAA4B;QAyB7B,0DAA2B;QAA3B,2FAA2B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxGI;;;;;;;;;;;;;;;;;;;ICkB3E,0EAA0C;IACtC,oEAAG;IAAA,uDAA4C;;IAAA,4DAAI;IACvD,4DAAM;;IADC,0DAA4C;IAA5C,8JAA4C;;;IA+D/B,gFAAsF;IAAA,uDAAW;IAAA,4DAAY;;;IAAlG,+EAAmB;IAAwD,0DAAW;IAAX,2EAAW;;;;IAdjH,0EAA0D;IACtD,0EAA4B;IACxB,0EAAiE;IAA5D,oYAAsB;IACvB,mEAC+D;IACnE,4DAAM;IACN,0EAA0C;IACtC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAA2C;IACvC,uDACJ;IAAA,4DAAM;IACN,0EAA0C;IACtC,iFAA0E;IAAzC,6aAAwC;IACrE,mJAA6G;IACjH,4DAAY;IAChB,4DAAM;IACN,2EAAoE;IAChE,2EAAiC;IAC7B,wDAA0C;IAAA,4DAAM;IACxD,4DAAM;IACN,2EAAoI;IAArC,qZAAoC;IAC/H,wDAA2B;IAAA,oEAAsE;IACrG,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IAxBU,0DAAe;IAAf,wEAAe;IAMhB,0DAAa;IAAb,6EAAa;IAGhB,0DACJ;IADI,sKACJ;IAEe,0DAAqB;IAArB,iFAAqB;IACsC,0DAAkB;IAAlB,uFAAkB;IAKpF,0DAA0C;IAA1C,+HAA0C;IAG9C,0DAA2B;IAA3B,qGAA2B;;;;IAjE/C,0EAAyE;IACrE,0EAAkC;IAC9B,0EAAY;IACR,qEACM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,2EAA0C;IACtC,wDACJ;;IAAA,4DAAM;IACN,2EAAwE;IACpE,wDACJ;;IAAA,4DAAM;IACN,2EAAwE;IACpE,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;IACN,2EAAwF;IACpF,2EAAgC;IAC5B,2EAA4B;IACxB,sEAEM;IACN,sEAEM;IACN,sEAEM;IACN,sEAEM;IACN,2EAA0J;IAA/B,yUAA8B;IACrJ,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;IAEN,iIAyBM;IACV,4DAAM;IACV,4DAAM;;;IAhEU,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,6JACJ;IAEI,0DACJ;IADI,qJACJ;IAEI,0DACJ;IADI,0JACJ;IAEI,0DACJ;IADI,yJACJ;IAKY,0DAAe;IAAf,wEAAe;IAcnB,0DACJ;IADI,oKACJ;IAIyC,0DAAO;IAAP,gFAAO;;;;IA6BhE,yFAC8D;IAA1D,wZAAyD;IAC7D,4DAAqB;;;IAFyB,uGAAuC;;;IAQjF,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACoD;IACxD,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGiC,0DAAoB;IAApB,qFAAoB;;;;IAKzD,6EAEqC;IAAjC,iWAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,2VAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IApB3F,+EAEsE;IAFS,uXAAsC;;IAGjH,qJASe;IACf,+NAQc;IAClB,4DAAW;;;;IArBP,yKAAkD;IAD5C,0EAAqC;;;IA2B3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACyE;IAC7E,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAG2B,0DAAsC;IAAtC,uGAAsC;;;;IAKrE,6EAE6C;IAAzC,yWAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,mWAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,0XAAyC;;IAG1H,qJASe;IACf,+NAQc;IAClB,4DAAW;;;;IArBP,4JAAqC;IAD/B,0EAAwC;;ADlH3C,MAAM,0BAA0B;IAQrC,YACU,MAAc,EACf,WAAwB,EACvB,IAAqB,EACrB,KAAqB,EACtB,YAA0B,EACzB,WAAuB;QALvB,WAAM,GAAN,MAAM,CAAQ;QACf,gBAAW,GAAX,WAAW,CAAa;QACvB,SAAI,GAAJ,IAAI,CAAiB;QACrB,UAAK,GAAL,KAAK,CAAgB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QACzB,gBAAW,GAAX,WAAW,CAAY;QAbvB,aAAQ,GAAG,IAAI,uDAAY,EAAO,CAAC;QACpC,SAAI,GAAQ,EAAE,CAAC;QAIxB,sBAAiB,GAAY,KAAK,CAAC;QACnC,eAAU,GAAW,CAAC,CAAC;QAyBvB,2BAAsB,GAAY,KAAK,CAAC;QACxC,UAAK,GAAQ,CAAC,CAAC;QA4Gf,aAAQ,GAAQ,CAAC,CAAC;QAClB,8BAAyB,GAAG,KAAK;IA/H9B,CAAC;IAEJ,QAAQ;IAER,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,CAAC;QACd,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QAC5D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QAC5D,IAAI,CAAC,IAAI,GAAG,CAAC;IACf,CAAC;IAOD;;OAEG;IACH,kBAAkB;QAChB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;IACL,CAAC;IAGD;;OAEG;IACH,cAAc;QACZ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAG;YAC1C,IAAG,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;gBAC5D,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;aACvD;iBAAM;gBACL,IAAI,CAAC,UAAU,GAAG,CAAC;aACpB;SACF;QACD,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;gBAC5B,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAClD,UAAU,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;gBACjD,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;gBACxB,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,iBAAiB;aACzC,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBAC1C,OAAO;wBACL,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;wBACvB,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;qBACtC;gBACH,CAAC,CAAC;gBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;aACzC;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QACD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC/B,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,sBAAsB,CAAC,IAAI;QAEzB,IAAI,IAAI,EAAE;YACR,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpC,IAAI,UAAU,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAC,UAAU,GAAE;gBAClC,mBAAmB;gBACnB,wBAAwB;gBACxB,cAAc;gBACd,8BAA8B;gBAC9B,0BAA0B;gBAC1B,4BAA4B;gBAC5B,8CAA8C;gBAC9C,KAAK;gBACL,2CAA2C;gBAC3C,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;oBACjB,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;iBACpE;gBACD,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAE,iBAAiB,EAAE,CAAC,GAAC;gBAC5C,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAGD;;OAEG;IACH,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,sBAAsB;QACpB,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACpC,IAAI,CAAC,UAAU,CAAC,iBAAiB,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;SAC7E;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CACxD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,MAAM,CAAC,IAAI;QACT,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC5D,CAAC,CAAC;IACL,CAAC;;oGAtLU,0BAA0B;wHAA1B,0BAA0B;QCZvC,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAAsG;QAAlC,kJAAS,2BAAuB,IAAC;QACjG,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,mJAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,wHAEM;QAIV,4DAAM;QACN,0HAsEM;QAEN,sJAEqB;QAGrB,kIAsBW;QAEX,kIAsBW;;QApJgD,wEAAe;QAE/D,0DAA6C;QAA7C,+JAA6C;QAMxC,0DAA6B;QAA7B,2JAA6B;QAM7B,0DACJ;QADI,qJACJ;QAGF,0DAAkB;QAAlB,kFAAkB;QAOyB,0DAAiB;QAAjB,iFAAiB;QAwEjD,0DAAuB;QAAvB,uFAAuB;QAKK,0DAA4B;QAA5B,4FAA4B;QAwBzB,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9HJ;;;;;;;;;;;;;;;;;;ICyD3C,gFAAsF;IAAA,uDAAW;IAAA,4DAAY;;;IAAlG,+EAAmB;IAAwD,0DAAW;IAAX,2EAAW;;;;IAXrH,0EAAwD;IACpD,0EAAuB;IACnB,wEAAuG;IAAvB,yXAAsB;IAAC,4DAAI;IAC/G,4DAAM;IACN,0EAAwB;IACpB,0EAAwB;IACpB,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAAqD;IACjD,0EAAyC;IACrC,gFAA0E;IAAzC,maAAwC;IACrE,2IAA6G;IACjH,4DAAY;IAChB,4DAAM;IAEN,2EAAuI;IAAhH,4YAAoC;IACvD,wDACJ;IAAA,4DAAM;IACN,2EAAiD;IAC7C,wDACJ;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IAjBS,0DAAa;IAAb,6EAAa;IAID,0DAAqB;IAArB,iFAAqB;IACsC,0DAAkB;IAAlB,uFAAkB;IAKxF,0DACJ;IADI,uHACJ;IAEI,0DACJ;IADI,4HACJ;;;IAsBQ,gFAAsF;IAAA,uDAAW;IAAA,4DAAY;;;IAAlG,gFAAmB;IAAwD,0DAAW;IAAX,4EAAW;;;;IAXrH,0EAAwD;IACpD,0EAAuB;IACnB,wEAA2G;IAA3B,iYAA0B;IAAC,4DAAI;IACnH,4DAAM;IACN,0EAAwB;IACpB,0EAAwB;IACpB,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAAqD;IACjD,0EAAyC;IACrC,gFAA0E;IAAzC,qaAAwC;IACrE,2IAA6G;IACjH,4DAAY;IAChB,4DAAM;IACN,2EAAuI;IAAhH,8YAAoC;IACvD,wDACJ;IAAA,4DAAM;IAEN,2EAAqG;IAAnC,4YAAkC;IAChG,wDAAgD;IAAA,oEAAsE;IAC1H,4DAAM;IACV,4DAAM;IACV,4DAAM;IAEV,4DAAM;;;;IAlBS,0DAAa;IAAb,8EAAa;IAID,0DAAqB;IAArB,kFAAqB;IACsC,0DAAkB;IAAlB,wFAAkB;IAIxF,0DACJ;IADI,wHACJ;IAGI,0DAAgD;IAAhD,kIAAgD;;;;IAchF,yFAAgJ;IAA1D,uZAAyD;IAAC,4DAAqB;;;IAAvH,uGAAuC;;;;IACrF,yFAAgJ;IAA1D,uZAAyD;IAAC,4DAAqB;;;IAAvH,uGAAuC;;;IAMjF,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACyD;IAC7D,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGiC,0DAAyB;IAAzB,0FAAyB;;;;IAK9D,6EAEqC;IAAjC,gWAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,0VAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IApB3F,+EAEsE;IAFS,sXAAsC;;IAGjH,oJASe;IACf,8NAQc;IAClB,4DAAW;;;;IArBP,uKAAgD;IAD1C,0EAAqC;;;IA4B3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC0E;IAC9E,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAG2B,0DAAuC;IAAvC,wGAAuC;;;;IAKtE,6EAE6C;IAAzC,wWAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,kWAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,yXAAyC;;IAG1H,oJASe;IACf,8NAQc;IAClB,4DAAW;;;;IArBP,qKAA8C;IADxC,0EAAwC;;ADhI3C,MAAM,yBAAyB;IAapC,YACU,YAA0B,EAC3B,WAAwB,EACvB,IAAqB,EACrB,WAAwB,EACxB,KAAqB;QAJrB,iBAAY,GAAZ,YAAY,CAAc;QAC3B,gBAAW,GAAX,WAAW,CAAa;QACvB,SAAI,GAAJ,IAAI,CAAiB;QACrB,gBAAW,GAAX,WAAW,CAAa;QACxB,UAAK,GAAL,KAAK,CAAgB;QAhBrB,mBAAc,GAAG,IAAI,uDAAY,EAAO,CAAC;QACzC,gBAAW,GAAG,IAAI,uDAAY,EAAU,CAAC;QACnD,sBAAiB,GAAY,KAAK,CAAC;QACnC,sBAAiB,GAAY,KAAK,CAAC;QACnC,aAAQ,GAAW,CAAC,CAAC;QACrB,QAAG,GAAG,EAAE,CAAC;QACT,SAAI,GAAG,EAAE;QACT,SAAI,GAAG;YACL,OAAO,EAAE,EAAE;YACX,QAAQ,EAAE,EAAE;SACb;QAwND,2BAAsB,GAAY,KAAK,CAAC;QACxC,UAAK,GAAQ,CAAC,CAAC;QAiCf,8BAAyB,GAAY,KAAK,CAAC;IAnPvC,CAAC;IAGL,QAAQ;IAER,CAAC;IAGD,SAAS,CAAC,KAAK;QACb,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;IAC1B,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI;IAC/B,CAAC;IAGD;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,CAAC;QACd,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QAC5D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK;QAC3D,IAAI,CAAC,IAAI,GAAG,CAAC;IACf,CAAC;IAED;;;OAGG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpC,IAAI,UAAU,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAC,UAAU,GAAE;gBAClC,mBAAmB;gBACnB,wBAAwB;gBACxB,cAAc;gBACd,8BAA8B;gBAC9B,0BAA0B;gBAC1B,4BAA4B;gBAC5B,8CAA8C;gBAC9C,KAAK;gBACL,2CAA2C;gBAC3C,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;oBACjB,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;iBACpE;gBACD,IAAI,iBAAiB,GAAG,CAAC,CAAC;gBAC1B,IAAI,UAAU,GAAG,CAAC;gBAClB,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAE,iBAAiB,EAAE,iBAAiB,EAAE,UAAU,EAAE,UAAU,GAAC;gBACpF,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;QACvC,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IAEjC,CAAC;IAED;;;OAGG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpC,IAAI,UAAU,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAC,UAAU,GAAE;gBAClC,mBAAmB;gBACnB,wBAAwB;gBACxB,cAAc;gBACd,8BAA8B;gBAC9B,0BAA0B;gBAC1B,4BAA4B;gBAC5B,8CAA8C;gBAC9C,KAAK;gBACL,2CAA2C;gBAC3C,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;oBACjB,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;iBACpE;gBACD,IAAI,iBAAiB,GAAG,CAAC,CAAC;gBAC1B,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,CAAC,CAAC,KAAE,iBAAiB,EAAE,iBAAiB,GAAC;gBAC5D,IAAG,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBACzC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC3B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QAED,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IACD;;OAEG;IACH,cAAc;QACZ,IAAI,CAAC,IAAI,GAAG;YACV,OAAO,EAAE,EAAE;YACX,QAAQ,EAAE,EAAE;SACb;QACD,8BAA8B;QAC9B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACxC,IAAI,MAAM,GAAQ;gBAChB,UAAU,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG;gBAC3B,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAChD,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,iBAAiB;gBACvC,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI;gBACvB,4EAA4E;aAC7E;YACD,IAAG,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC5B,MAAM,mCAAO,MAAM,KAAE,aAAa,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aAC/D;YACD,IAAG,MAAM,CAAC,KAAK,IAAI,CAAC,EAAE;gBACpB,IAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBACzC,IAAI,KAAK,GAAE;wBACT,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK;wBACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;qBACxB;oBACD,IAAG,IAAI,CAAC,aAAa;wBAAE,KAAK,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC,aAAa;oBAClE,OAAQ,KAAK;gBACf,CAAC,CAAC;gBACF,MAAM,mCAAO,MAAM,KAAE,MAAM,EAAE,MAAM,GAAC;aACrC;YACD,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SAEhC;QACD,+BAA+B;QAC/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,OAAO,GAAQ;gBACjB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;gBAC5B,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAClD,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,iBAAiB;gBACxC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU;gBAC9B,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;aACzB;YACD,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,OAAO,mCAAO,OAAO,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aAClE;YACD,IAAG,OAAO,CAAC,KAAK,IAAI,CAAC,EAAE;gBACrB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBAC1C,IAAI,KAAK,GAAE;wBACT,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK;wBACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;qBACxB;oBACD,IAAG,IAAI,CAAC,aAAa;wBAAE,KAAK,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC,aAAa;oBAClE,OAAQ,KAAK;gBACf,CAAC,CAAC;gBACF,OAAO,mCAAO,OAAO,KAAE,MAAM,EAAE,MAAM,GAAC;aACvC;YACD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC;SACjC;QACF,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;IAEpC,CAAC;IAED;;OAEG;IACI,MAAM,CAAC,IAAI;QAChB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAE,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC1D,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,UAAU,CAAC,IAAI;QACb,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE;gBACX,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBAC5C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;YACzC,CAAC;SACF,CAAC,CAAC;IACL,CAAC;IAOD;;OAEG;IACH,kBAAkB,CAAC,MAAM;QACvB,IAAI,CAAC,IAAI,GAAG,MAAM;QAClB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAG,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YAC5D,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;SAC5D;aAAM;YACL,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,CAAC;SACzB;QACD,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAOD;;OAEG;IACH,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,WAAW,GAAG,MAAM,CAAC;QAC1B,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QACxE,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,sBAAsB;QACpB,IAAI,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YAC7C,IAAI,CAAC,WAAW,CAAC,iBAAiB,GAAG,UAAU,CAAC,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,CAAC,CAAC;SACvF;aAAM,IAAI,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,GAAG,CAAC;YACjD,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CACxD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;;kGAtSU,yBAAyB;uHAAzB,yBAAyB;QCXtC,yEAAmH;QAC/G,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAC0D;QAA3B,iJAAS,oBAAgB,IAAC;QACrD,uDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACV,4DAAM;QACN,0EAAoD;QAChD,0EAAuB;QACnB,0EAA0D;QACtD,0EAAsC;QAClC,0EAA0C;QACtC,oFACJ;QAAA,4DAAM;QACN,0EAAqD;QACjD,qFACJ;QAAA,4DAAM;QACN,0EAAqD;QACjD,oFACJ;QAAA,4DAAM;QACV,4DAAM;QACN,0EAAsC;QAClC,0EAA0C;QACtC,0FACJ;QAAA,4DAAM;QACN,0EAAqD;QACjD,qFACJ;QAAA,4DAAM;QACN,0EAAqD;QACjD,oFACJ;QAAA,4DAAM;QACV,4DAAM;QACV,4DAAM;QAEN,2EAA6C;QACzC,2EAAyC;QACrC,2EAA6E;QAAlC,+IAAS,2BAAuB,IAAC;QACxE,oEAAiD;QACjD,8FACJ;QAAA,4DAAM;QACN,yHAuBM;QACV,4DAAM;QAEN,2EAAyC;QACrC,2EAA6E;QAAlC,+IAAS,2BAAuB,IAAC;QACxE,oEAAiD;QACjD,+GACJ;QAAA,4DAAM;QACN,yHAwBM;QACV,4DAAM;QAEV,4DAAM;QAEV,4DAAM;QACV,4DAAM;QAGN,sJAAqK;QACrK,sJAAqK;QAGrK,kIAsBW;QAGX,kIAsBW;;QAjKwF,wEAAe;QAEvG,0DAA6C;QAA7C,+JAA6C;QAMxC,0DACJ;QADI,oJACJ;QAqCmD,2DAAM;QAAN,4EAAM;QA+BN,0DAAO;QAAP,6EAAO;QAiCjD,0DAAuB;QAAvB,uFAAuB;QACvB,0DAAuB;QAAvB,uFAAuB;QAGK,0DAA4B;QAA5B,4FAA4B;QAyBzB,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3ImB;AAE7C;;;;;;;;;;;;;;;;;;ICU/C,wEAAwE;;;;IAAvC,uJAA6B;;;IAepD,sEAA0B;IACxB,uDACA;;IAAA,2EAAiD;IAAA,uDAAmC;IAAA,4DAAO;IAC7F,4DAAM;;;;IAFJ,0DACA;IADA,qJACA;IAAiD,0DAAmC;IAAnC,2GAAmC;;;;IAT5F,wFAA8I;IAA3H,0dAA6B;IAC9C,0FAAyB;IACvB,2EAAkE;IAChE,uDACA;IAAA,sEAAK;IACH,+EAAS;IAAA,2EAA6B;IAAA,uDAAiD;IAAA,4DAAO;IAChG,4DAAM;IACN,sKAGM;IACR,4DAAO;IACT,4DAA0B;IAC5B,4DAAoB;;;;IAb6B,iJAAyE;IAGpH,0DACA;IADA,wFACA;IACwC,0DAAiD;IAAjD,wHAAiD;IAEnF,0DAAkB;IAAlB,sFAAkB;;;;IAXhC,mFAC2B;IAEzB,4EAA6E;IAA1D,6VAA2B;IAA+B,4DAAQ;IACrF,8KAaoB;IACtB,4DAAe;;;IAfM,0DAA2B;IAA3B,qFAA2B;IAC8E,0DAAgB;IAAhB,+EAAgB;;;IAkB9I,2EAA+D;;;;;IApCzE,wEAA+B;IAC7B,yEAAY;IACV,yEAAwB;IAAA,8EAEqE;IAF9D,qUAAsB;;IAA7B,4DAEqE;IAC7F,4DAAM;IACR,4DAAM;IACN,yEAAY;IACV,yEAAwB;IACtB,+EAA0G;IAA/F,qZAAiE;IAC1E,uIAAwE;IAC1E,4DAAY;IACZ,kGAAwE;IACtE,2EAAS;IACP,sJAkBe;IAIf,wJAA+D;IACjE,4DAAU;IACZ,4DAA8B;IAChC,4DAAM;IACR,4DAAM;IACR,qEAAe;;;IAtCP,0DAAiE;IAAjE,uLAAiE;IAAC,kFAAoB;IAMX,0DAA4B;IAA5B,4FAA4B;IAC/E,0DAAO;IAAP,gFAAO;IAIU,0DAAa;IAAb,8FAAa;IAsBpC,0DAA6B;IAA7B,gGAA6B;;;;IAQrD,0EAA0B;IACxB,6EAAgE;IAAnB,kUAAkB;IAAC,mEAAG;IAAA,4DAAS;IAC5E,6EAA6D;IAA1B,yUAAyB;IAAC,6DAAE;IAAA,4DAAS;IAC1E,4DAAM;;ADxCH,MAAM,sBAAsB;IAOjC,YACS,WAAwB,EACvB,YAA0B;QAD3B,gBAAW,GAAX,WAAW,CAAa;QACvB,iBAAY,GAAZ,YAAY,CAAc;QAPR,sBAAiB,GAAY,IAAI,CAAC;QAClC,sBAAiB,GAAY,IAAI,CAAC;QAC5B,2BAAsB,GAAG,IAAI,uDAAY,EAAO,CAAC;QACnF,cAAS,GAAW,IAAI,CAAC,YAAY,CAAC,gBAAgB,EAAE,CAAC,GAAG;QAC5D,aAAQ,GAAW,CAAC;QAKb,aAAQ,GAAU,EAAE,CAAC;QACrB,eAAU,GAAU,EAAE,CAAC;QACvB,cAAS,GAAG,CAAC,CAAC;QACrB,WAAM,GAAW,EAAE,CAAC;QAEpB,cAAS,GAAQ,EAAE,CAAC;QAiBpB,YAAO,GAAW,EAAE;QAqBpB,SAAI,GAAQ,CAAC,SAAS,EAAE,SAAS,EAAE,OAAO,CAAC;IA5CvC,CAAC;IAQL,QAAQ;QACN,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC;IACrC,CAAC;IACD,WAAW;QACT,yCAAyC;IAC3C,CAAC;IACD,eAAe;QACb,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;IAC1C,CAAC;IACD,WAAW;QACT,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;IAC1C,CAAC;IACD,MAAM;QACJ,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC1C,CAAC;IAED,aAAa,CAAC,KAAa;QACzB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;QACjE,IAAI,KAAK,CAAC,MAAM;YACd,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;;YAC5F,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,QAAQ;IACtC,CAAC;IACD,aAAa,CAAC,IAAI;QAChB,IAAI,CAAC,QAAQ,GAAG,CAAC,IAAI,CAAC,QAAQ;IAChC,CAAC;IAED,aAAa;QACX,IAAI,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,CAAC;QACtE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;QACpD,GAAG;QAEH,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SAClD;IACH,CAAC;IAGD,cAAc,CAAC,KAAK;QAClB,IAAI,IAAI,GAAW,2EAAc,CAAC;QAClC,QAAQ,KAAK,EAAE;YACb,KAAK,CAAC;gBAAE,IAAI,GAAG,2EAAc,CAAC;gBAAC,MAAM;YACrC,KAAK,CAAC;gBAAE,IAAI,GAAG,2EAAc,CAAC;gBAAC,MAAM;YACrC;gBAAS,IAAI,GAAG,yEAAY,CAAC;gBAAC,MAAM;SACrC;QACD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAC9J,IAAI,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;YAC3D,uCAAY,IAAI,GAAK,IAAI,EAAE;QAC7B,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC;IAClC,CAAC;;4FAnEU,sBAAsB;oHAAtB,sBAAsB;;;;;;QCTnC,+EACiD;QAA/C,yJAAa,YAAQ,IAAC;QACtB,sIAyCe;QAEf,8MAKc;QAChB,4DAAY;;;QAnDD,gFAAuB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACA6C;;;;;;;;;;;;;;;;;;;ICmBvE,oEAAyB;IAAA,uDAAsE;;IAAA,4DAAI;;IAA1E,0DAAsE;IAAtE,wLAAsE;;;IADnG,0EAAqD;IACjD,kIAAmG;IACvG,4DAAM;;;IADE,0DAAkB;IAAlB,qFAAkB;;;IAE1B,0EAAoD;IAChD,wEAAkD;IAAA,uDAAuC;;IAAA,4DAAI;IACjG,4DAAM;;IADgD,0DAAuC;IAAvC,yJAAuC;;;IAI7F,0EAAsD;IAClD,0EAAY;IACR,qEACM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA2C;IACvC,wDACJ;;IAAA,4DAAM;IACN,2EAAwE;IACpE,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;;IAlBM,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,4JACJ;IAEI,0DACJ;IADI,qJACJ;IAEI,0DACJ;IADI,mKACJ;IAEI,0DACJ;IADI,sKACJ;IAEI,0DACJ;IADI,yJACJ;;;IA6CY,gFAAuF;IAAA,uDAAW;IAAA,4DAAY;;;IAAnG,iFAAoB;IAAwD,0DAAW;IAAX,4EAAW;;;;IAdlH,0EAAyF;IACrF,0EAA4B;IACxB,0EAAiE;IAA5D,sZAAsB;IACvB,mEAC+D;IACnE,4DAAM;IACN,0EAA0C;IACtC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAA2C;IACvC,uDACJ;IAAA,4DAAM;IACN,0EAA0C;IACtC,iFAA2E;IAAzC,6bAAwC;IACtE,iKAA8G;IAClH,4DAAY;IAChB,4DAAM;IACN,2EAAoE;IAChE,2EAAkE;IAAlC,kaAAiC;IAC7D,wDAAiE;IAAA,4DAAM;IAC/E,4DAAM;IACN,2EAAuE;IACnE,qEAAG;IAAA,wDAAyG;IAAA,4DAAI;IACpH,4DAAM;IACN,2EAAoI;IAArC,qaAAoC;IAC/H,wDAAkB;IAAA,oEAAsE;IAC5F,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IA3BU,0DAAe;IAAf,wEAAe;IAMhB,0DAAa;IAAb,8EAAa;IAGhB,0DACJ;IADI,qIACJ;IAEe,0DAAsB;IAAtB,mFAAsB;IACsC,0DAAkB;IAAlB,wFAAkB;IAKrF,0DAAiE;IAAjE,wJAAiE;IAGlE,0DAAyG;IAAzG,8LAAyG;IAG5G,0DAAkB;IAAlB,6FAAkB;;;;;IArDlC,0EAA4G;IACxG,0EAAgC;IAC5B,0EAA4B;IACxB,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,0EAAoE;IAChE,0EAAiE;IAAjC,yVAAgC;IAC5D,uFACJ;IAAA,4DAAM;IACV,4DAAM;IACN,sEAEM;IACN,sEAEM;IACV,4DAAM;IACV,4DAAM;IACN,+IA4BM;IACV,4DAAM;;;IAvDc,0DAAe;IAAf,wEAAe;IA0BkB,2DAAsC;IAAtC,yLAAsC;;;IArD/F,0EAAoF;IAChF,wIAuBM;IACN,uIAyDM;IACV,4DAAM;;;IAlFI,0DAAiB;IAAjB,oFAAiB;IAwBjB,0DAAiB;IAAjB,oFAAiB;;;;IA4D3B,yFAC8D;IAA1D,gaAAyD;IAC7D,4DAAqB;;;IAFyB,uGAAuC;;;IAQjF,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC6D;IACjE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGwB,0DAA6B;IAA7B,8FAA6B;;;;IAKzD,6EAEqC;IAAjC,yWAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,mWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IApB3F,+EAEsE;IAFS,+XAAsC;;IAGjH,6JASe;IACf,uOAQc;IAClB,4DAAW;;;;IArBP,6KAAsD;IADhD,0EAAqC;;;IA4B3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC4C;IAChD,4DAAM;IACV,4DAAM;IACV,qEAAe;;IAPmC,0DAC1C;IAD0C,oJAC1C;;;;IAQJ,6EAEwC;IAApC,4WAAmC;IAAC,uDACxB;;IAAA,4DAAS;IACzB,6EAEgE;IAA9B,sWAA6B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACxB;IADwB,0IACxB;IAGgD,0DAAsB;IAAtB,wIAAsB;;;;IApB9F,+EAE4E;IAFS,kYAAyC;;IAG1H,6JASe;IACf,uOAQc;IAClB,4DAAW;;;;IArBP,mLAA4D;IADtD,0EAAwC;;;IA4B9C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC0D;IAC9D,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAG2B,0DAAuB;IAAvB,wFAAuB;;;;IAKtD,6EAE6C;IAAzC,iXAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,2WAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,kYAAyC;;IAG1H,6JASe;IACf,uOAQc;IAClB,4DAAW;;;;IArBP,4JAAqC;IAD/B,0EAAwC;;ADxJ3C,MAAM,kCAAkC;IAQ7C,YACU,MAAc,EACf,WAAwB,EACvB,WAAwB,EACxB,IAAqB,EACtB,YAA0B,EACzB,KAAqB;QALrB,WAAM,GAAN,MAAM,CAAQ;QACf,gBAAW,GAAX,WAAW,CAAa;QACvB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QACzB,UAAK,GAAL,KAAK,CAAgB;QAZrB,kBAAa,GAAG,IAAI,uDAAY,EAAO,CAAC;QACzC,SAAI,GAAQ,EAAE,CAAC;QAGxB,sBAAiB,GAAY,KAAK,CAAC;QACnC,8BAAyB,GAAY,KAAK,CAAC;QA2F3C,2BAAsB,GAAY,KAAK,CAAC;QA6HxC,8BAAyB,GAAY,KAAK,CAAC;QAC3C,aAAQ,GAAQ,CAAC,CAAC;IAhNf,CAAC;IAEJ,QAAQ;QACR,IAAG,CAAC,IAAI,CAAC,sBAAsB;YAAE,IAAI,CAAC,WAAW,EAAE,CAAC;IACpD,CAAC;IAED,wBAAwB;IACxB,WAAW;QACT,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,CAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;YAC1I,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;YACjC,OAAO,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC;YAC3B,IAAI,OAAO,CAAC,KAAK,EAAE;gBACjB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,uCAAuC;gBACjH,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY;aACrD;iBAAM;gBACL,IAAI,QAAQ,GAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY;gBACvC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,KAAE,UAAU,EAAE,OAAO,CAAC,YAAY,CAAC,EAAE,QAAQ,EAAE,QAAQ,GAAC,CAAC;aACzF;SACF;IACH,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,KAAK;QAClB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,KAAK,CAAC;QACxE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QACtF,IAAI,CAAC,KAAK,GAAI,KAAK;QACnB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,IAAI;IAChE,CAAC;IAKD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QAEtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC;IAEL,CAAC;IAED;;OAEG;IACH,iBAAiB;QACf,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACxC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAChC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CACnD,CAAC;gBACF,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;gBACpE,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;oBAC9C,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS;wBACpB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;iBACpE;aACF;SACF;aAAM,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,GAAG,CAAC;YAC9D,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,EACvD,aAAa,CACd,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAED;;OAEG;IACH,uBAAuB;QACrB,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAOD;;OAEG;IACH,iBAAiB,CAAC,MAAM;QACtB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACjC,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;YAChE,IAAI,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE;gBACpD,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,CAAC,CAAC;aAC/B;;gBACC,IAAI,CAAC,UAAU,CAAC,SAAS;oBACvB,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;SAClE;aAAM;YACL,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,EACvD,aAAa,CACd,CAAC;SACH;QACD,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAED;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU;gBACnC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;gBACzB,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ;gBACnC,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY;gBACvC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;gBACzB,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ;aAChC,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM;gBAChC,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;aACzC;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QACD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACnC,IAAI,QAAQ,GAAQ;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;oBACvB,YAAY,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;oBAC3B,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACxC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,QAAQ,EAAE,CAAC;oBACX,QAAQ,EAAE,CAAC;oBACX,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBACnB,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;iBAC1B;gBACD,IAAG,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;oBACxB,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;iBAC/D;gBACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;oBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;wBACrC,OAAO;4BACL,UAAU,EAAE,IAAI,CAAC,UAAU;4BAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;4BAChB,KAAK,EAAE,IAAI,CAAC,KAAK;4BACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;4BAClC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;4BAChC,QAAQ,EAAE,IAAI,CAAC,QAAQ;4BACvB,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;yBACjC;oBACH,CAAC,CAAC;oBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;iBACzC;gBACD,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;iBAC7B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAOD;;OAEG;IACH,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;QACnB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,sBAAsB;QACpB,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACpC,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;SAC9D;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CACxD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,IAAI;QACT,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC5D,CAAC,CAAC;IACL,CAAC;;oHA1QU,kCAAkC;gIAAlC,kCAAkC;QCb/C,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAA0I;QAAlC,0JAAS,2BAAuB,IAAC;QACrI,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,2JAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,gIAEM;QACN,gIAEM;QACV,4DAAM;QACN,gIAmFM;QAEN,8JAEqB;QAGrB,0IAsBW;QAGX,0IAsBW;QAGX,0IAsBW;;QA3LgD,wEAAe;QAE/D,0DAA6C;QAA7C,gKAA6C;QAIpC,0DAAmC;QAAnC,gGAAmC;QAEvC,0DAA6B;QAA7B,2JAA6B;QAM7B,0DACJ;QADI,qJACJ;QAGF,0DAA6B;QAA7B,6FAA6B;QAG7B,0DAA4B;QAA5B,4FAA4B;QAIe,0DAA6B;QAA7B,6FAA6B;QAqF7D,0DAAuB;QAAvB,uFAAuB;QAKK,0DAA4B;QAA5B,4FAA4B;QAyBzB,0DAA+B;QAA/B,+FAA+B;QAyB/B,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrKJ;;;;;;;;;;;;;;;;;;;ICkB3E,0EAA0C;IACtC,oEAAG;IAAA,uDAAyC;;IAAA,4DAAI;IACpD,4DAAM;;IADC,0DAAyC;IAAzC,2JAAyC;;;IAIpD,0EAAsD;IAClD,0EAAY;IACR,qEACM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAAyE;IACrE,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAAoG;IAChG,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;;IAlBM,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,4JACJ;IAEI,0DACJ;IADI,qJACJ;IAEI,0DACJ;IADI,+JACJ;IAEI,0DACJ;IADI,0JACJ;IAEI,0DACJ;IADI,oKACJ;;;IA4CY,gFAAuF;IAAA,uDAAW;IAAA,4DAAY;;;IAAnG,gFAAoB;IAAwD,0DAAW;IAAX,2EAAW;;;;IAblH,0EAA0D;IACtD,yEAA4B;IACxB,0EAAiE;IAA5D,sYAAsB;IACvB,mEAAuG;IAC3G,4DAAM;IACN,0EAA0C;IACtC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAA4C;IACxC,uDACJ;IAAA,4DAAM;IACN,0EAA2C;IACvC,iFAA2E;IAAzC,6aAAwC;IACtE,oJAA8G;IAClH,4DAAY;IAChB,4DAAM;IACN,2EAAoE;IAChE,2EAAiH;IAAlC,kZAAiC;IAC5G,wDACJ;IAAA,4DAAM;IACV,4DAAM;IACN,2EAAuE;IACnE,qEAAG;IAAA,wDAAqG;IAAA,4DAAI;IAChH,4DAAM;IACN,2EAA2C;IACvC,2EAAmG;IAArC,qZAAoC;IAC9F,wDACJ;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IA7BU,0DAAe;IAAf,wEAAe;IAKhB,0DAAa;IAAb,6EAAa;IAGhB,0DACJ;IADI,iIACJ;IAEe,0DAAsB;IAAtB,kFAAsB;IACsC,0DAAkB;IAAlB,uFAAkB;IAKrF,0DACJ;IADI,+HACJ;IAGG,0DAAqG;IAArG,qLAAqG;IAIpG,0DACJ;IADI,+HACJ;;;;IAMhB,yFAC8D;IAA1D,gaAAyD;IAC7D,4DAAqB;;;IAFyB,uGAAuC;;;IASjF,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC6D;IACjE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGwB,0DAA6B;IAA7B,8FAA6B;;;;IAKzD,6EAEqC;IAAjC,yWAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,mWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IApB3F,+EAEsE;IAFS,+XAAsC;;IAGjH,6JASe;IACf,uOAQc;IAClB,4DAAW;;;;IArBP,sKAA+C;IADzC,0EAAqC;;;IA4B3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC0D;IAC9D,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAG2B,0DAAuB;IAAvB,wFAAuB;;;;IAKtD,6EAE6C;IAAzC,iXAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,2WAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,kYAAyC;;IAG1H,6JASe;IACf,uOAQc;IAClB,4DAAW;;;;IArBP,mKAA4C;IADtC,0EAAwC;;;IA4B9C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC+D;IACnE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGqC,0DAA4B;IAA5B,6FAA4B;;;;IAKrE,6EAEwC;IAApC,4WAAmC;IAAC,uDACxB;;IAAA,4DAAS;IACzB,6EAEgE;IAA9B,sWAA6B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACxB;IADwB,0IACxB;IAGgD,0DAAsB;IAAtB,wIAAsB;;;;IApB9F,+EAE4E;IAFS,kYAAyC;IAG1H,6JASe;IACf,uOAQc;IAClB,4DAAW;;;;IAtBD,0EAAwC;;ADxJ3C,MAAM,kCAAkC;IAO7C,YACU,MAAc,EACf,WAAwB,EACvB,WAAwB,EACxB,IAAqB,EACtB,YAA0B,EACzB,KAAqB;QALrB,WAAM,GAAN,MAAM,CAAQ;QACf,gBAAW,GAAX,WAAW,CAAa;QACvB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QACzB,UAAK,GAAL,KAAK,CAAgB;QAXrB,kBAAa,GAAG,IAAI,uDAAY,EAAO,CAAC;QACzC,SAAI,GAAQ,EAAE;QACvB,sBAAiB,GAAY,KAAK,CAAC;QACnC,SAAI,GAAW,CAAC,CAAC;QACjB,uBAAkB,GAAW,CAAC,CAAC;QAqI/B,2BAAsB,GAAY,KAAK,CAAC;QACxC,UAAK,GAAQ,CAAC,CAAC;QAqCb,8BAAyB,GAAY,KAAK,CAAC;QAC5C,aAAQ,GAAQ,CAAC,CAAC;QA6CjB,sBAAsB;QAEvB,2BAA2B;QAC3B,iBAAY,GAAQ,CAAC,CAAC;QACtB,8BAAyB,GAAY,KAAK,CAAC;IAnN5C,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,WAAW,EAAE;IACpB,CAAC;IAEA,wBAAwB;IACxB,WAAW;QACV,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,CAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;YAG1I,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI;YAChC,0CAA0C;YAC1C,OAAO,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC;YAC3B,IAAI,OAAO,CAAC,KAAK,EAAE;gBACjB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,uCAAuC;gBACjH,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK;gBAC5G,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY;aACrD;iBAAM;gBACL,IAAI,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY;gBACxC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,KAAE,UAAU,EAAE,OAAO,CAAC,YAAY,CAAC,EAAE,QAAQ,EAAE,QAAQ,GAAC,CAAC;aACzF;SACF;IAEH,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,KAAK;QAClB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,KAAK,CAAC;QACtE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QAClF,IAAI,CAAC,KAAK,GAAE,KAAK;QACjB,IAAI,CAAC,IAAI,GAAI,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,IAAI;IACjE,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU;gBACnC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ;gBAC/B,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAClD,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;gBAC/D,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;aAC1B,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM;gBAChC,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;aACzC;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QACD,GAAG;QAEH,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAID;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACnC,IAAI,QAAQ,GAAQ;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;oBACvB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;oBACzB,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACxC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,QAAQ,EAAE,CAAC;oBACX,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,QAAQ,EAAE,CAAC;oBACX,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBACnB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;iBAC1B;gBACD,IAAG,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;oBACxB,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;iBAC/D;gBACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;oBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;wBACrC,OAAO;4BACL,UAAU,EAAE,IAAI,CAAC,UAAU;4BAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;4BAChB,KAAK,EAAE,IAAI,CAAC,KAAK;4BACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;4BAClC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;4BAChC,QAAQ,EAAE,IAAI,CAAC,QAAQ;4BACvB,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;yBACjC;oBACH,CAAC,CAAC;oBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;iBACzC;gBACD,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;iBAC7B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAOD;;OAEG;IACH,iBAAiB,CAAC,MAAM;QACtB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAK,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YAClC,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;SACjE;aAAM,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,GAAG,CAAC;YACrC,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,EACvD,aAAa,CACd,CAAC;QACJ,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAQD;;OAEG;IACF,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;QACnB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAEF;;OAEG;IACF,sBAAsB;QACpB,IAAK,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACrC,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;SAC9D;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CAExD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAEF;;OAEG;IACI,MAAM,CAAC,IAAI;QAChB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC5D,CAAC,CAAC;IACL,CAAC;IAQD;;OAEG;IACF,oBAAoB;QAClB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QAEtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC;IAEL,CAAC;IAEF;;OAEG;IACF,iBAAiB;QACf,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,EACtC;YACA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAChC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CACnD,CAAC;gBACF,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;gBACpE,IAAI,CAAC,kBAAkB,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;aACtE;SACF;aAAM,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,GAAG,CAAC;YAC5C,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,EACvD,aAAa,CACd,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAEF;;OAEG;IACF,uBAAuB;QACrB,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;;oHA5QS,kCAAkC;gIAAlC,kCAAkC;QCZ/C,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAAsG;QAAlC,0JAAS,2BAAuB,IAAC;QACjG,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,2JAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,gIAEM;QACV,4DAAM;QAEN,kIAuBM;QAEN,0EAAwF;QACpF,0EAA4B;QACxB,sEAEM;QACN,sEAEM;QACN,sEAEM;QACN,sEAEM;QACN,2EAAoE;QAChE,2EAAiG;QAAjC,wJAAS,0BAAsB,IAAC;QAC5F,wDACJ;;QAAA,4DAAM;QACV,4DAAM;QACN,sEAEM;QACN,sEAEM;QACV,4DAAM;QAEN,kIA8BM;QACV,4DAAM;QAEN,+JAEqB;QAIrB,2IAsBW;QAGX,2IAsBW;QAGX,2IAsBW;;QA1LgD,wEAAe;QAE/D,0DAA6C;QAA7C,gKAA6C;QAMxC,0DAA6B;QAA7B,2JAA6B;QAIzB,0DAAyB;QAAzB,sFAAyB;QAE7B,0DACJ;QADI,qJACJ;QAGF,0DAAkB;QAAlB,kFAAkB;QAKO,0DAAiB;QAAjB,iFAAiB;QA0BpC,0DAAe;QAAf,wEAAe;QAef,0DACJ;QADI,6JACJ;QAUyC,0DAAO;QAAP,6EAAO;QAiCvC,0DAAuB;QAAvB,uFAAuB;QAMK,0DAA4B;QAA5B,4FAA4B;QAyBzB,0DAA+B;QAA/B,+FAA+B;QAyB/B,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpKJ;AAQrB;;;;;;;;;;;;;;;;;;;ICWlD,oEAAyB;IAAA,uDAAsE;;IAAA,4DAAI;;IAA1E,0DAAsE;IAAtE,wLAAsE;;;IADnG,0EAAqD;IACjD,qIAAmG;IACvG,4DAAM;;;IADE,0DAAkB;IAAlB,qFAAkB;;;IAE1B,0EAAoD;IAChD,wEAAkD;IAAA,uDAAuC;;IAAA,4DAAI;IACjG,4DAAM;;IADgD,0DAAuC;IAAvC,yJAAuC;;;IAI7F,0EAAsD;IAClD,0EAAY;IACR,qEACM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA2C;IACvC,wDACJ;;IAAA,4DAAM;IACN,2EAAwE;IACpE,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;;IAlBM,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,4JACJ;IAEI,0DACJ;IADI,qJACJ;IAEI,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,0JACJ;IAEI,0DACJ;IADI,yJACJ;;;IA6CY,gFAAuF;IAAA,uDAAW;IAAA,4DAAY;;;IAAnG,iFAAoB;IAAwD,0DAAW;IAAX,4EAAW;;;;IAdlH,0EAAyF;IACrF,0EAA4B;IACxB,0EAAiE;IAA5D,yZAAsB;IACvB,mEAC+D;IACnE,4DAAM;IACN,0EAA0C;IACtC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAA2C;IACvC,uDACJ;IAAA,4DAAM;IACN,0EAA0C;IACtC,iFAA2E;IAAzC,gcAAwC;IACtE,oKAA8G;IAClH,4DAAY;IAChB,4DAAM;IACN,2EAAoE;IAChE,2EAAkE;IAAlC,qaAAiC;IAC7D,wDAAoF;IAAA,4DAAM;IAClG,4DAAM;IACN,2EAAuE;IACnE,qEAAG;IAAA,wDAAyF;IAAA,4DAAI;IACpG,4DAAM;IACN,2EAAoI;IAArC,waAAoC;IAC/H,wDAAkB;IAAA,oEAAsE;IAC5F,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IA3BU,0DAAe;IAAf,wEAAe;IAMhB,0DAAa;IAAb,8EAAa;IAGhB,0DACJ;IADI,qIACJ;IAEe,0DAAsB;IAAtB,mFAAsB;IACsC,0DAAkB;IAAlB,wFAAkB;IAKrF,0DAAoF;IAApF,+KAAoF;IAGrF,0DAAyF;IAAzF,0KAAyF;IAG5F,0DAAkB;IAAlB,6FAAkB;;;;;IArDlC,0EAA4G;IACxG,0EAAgC;IAC5B,0EAA4B;IACxB,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,0EAAoE;IAChE,0EAAiE;IAAjC,4VAAgC;IAC5D,uFACJ;IAAA,4DAAM;IACV,4DAAM;IACN,sEAEM;IACN,sEAEM;IACV,4DAAM;IACV,4DAAM;IACN,kJA4BM;IACV,4DAAM;;;IAvDc,0DAAe;IAAf,wEAAe;IA0BkB,2DAAsC;IAAtC,yLAAsC;;;IArD/F,0EAAoF;IAChF,2IAuBM;IACN,0IAyDM;IACV,4DAAM;;;IAlFI,0DAAiB;IAAjB,oFAAiB;IAwBjB,0DAAiB;IAAjB,oFAAiB;;;;IA4D3B,yFAC8D;IAA1D,maAAyD;IAC7D,4DAAqB;;;IAFyB,uGAAuC;;;IAiB7E,0EAA8B;IAC1B,qEAEM;IACN,0EAAwB;IACpB,4EAA0B;IAAA,uDAAsD;;IAAA,4DAAQ;IAC5F,4DAAM;IACV,4DAAM;;IAF4B,0DAAsD;IAAtD,wKAAsD;;;IAd5F,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACqE;IACzE,4DAAM;IACV,4DAAM;IACN,6JAOM;IACV,qEAAe;;;IAfmC,0DAC1C;IAD0C,qJAC1C;IAGwB,0DAAqC;IAArC,sGAAqC;IAGpD,0DAAe;IAAf,mFAAe;;;;IAU5B,6EAEqC;IAAjC,4WAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,sWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IA5B3F,+EAEsE;IAFS,kYAAsC;;IAGjH,gKAiBe;IACf,0OAQc;IAClB,4DAAW;;;;IA7BP,sKAA+C;IADzC,0EAAqC;;;IA6CvC,0EAAkC;IAC9B,qEAEM;IACN,0EAAwB;IACpB,4EAA0B;IAAA,uDAAsD;;IAAA,4DAAQ;IAC5F,4DAAM;IACV,4DAAM;;IAF4B,0DAAsD;IAAtD,wKAAsD;;;IAd5F,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACwD;IAC5D,4DAAM;IACV,4DAAM;IACN,6JAOM;IACV,qEAAe;;;IAfmC,0DAC1C;IAD0C,qJAC1C;IAGqC,0DAAqB;IAArB,sFAAqB;IAGjD,0DAAmB;IAAnB,uFAAmB;;;;IAUhC,6EAEwC;IAApC,+WAAmC;IAAC,uDACxB;;IAAA,4DAAS;IACzB,6EAEgE;IAA9B,yWAA6B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACxB;IADwB,0IACxB;IAGgD,0DAAsB;IAAtB,wIAAsB;;;;IA5B9F,+EAE4E;IAFS,qYAAyC;;IAG1H,gKAiBe;IACf,0OAQc;IAClB,4DAAW;;;;IA7BP,8LAAuE;IADjE,0EAAwC;;;IAoC9C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC0D;IAC9D,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAG2B,0DAAuB;IAAvB,wFAAuB;;;;IAKtD,6EAE6C;IAAzC,oXAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,8WAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,qYAAyC;;IAG1H,gKASe;IACf,0OAQc;IAClB,4DAAW;;;;IArBP,4JAAqC;IAD/B,0EAAwC;;ADrK3C,MAAM,qCAAqC;IAQhD,YACU,MAAc,EACf,WAAwB,EACvB,WAAwB,EACxB,IAAqB,EACtB,YAA0B,EACzB,KAAqB;QALrB,WAAM,GAAN,MAAM,CAAQ;QACf,gBAAW,GAAX,WAAW,CAAa;QACvB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QACzB,UAAK,GAAL,KAAK,CAAgB;QAZrB,kBAAa,GAAG,IAAI,uDAAY,EAAO,CAAC;QACzC,SAAI,GAAQ,EAAE,CAAC;QAEjB,gBAAW,GAAiB,IAAI,0FAAY,EAAE,CAAC;QACtD,sBAAiB,GAAY,KAAK,CAAC;QACnC,8BAAyB,GAAY,KAAK,CAAC;QA8C3C,iBAAY,GAAY,IAAI,CAAC;QAC7B,gBAAW,GAAW,CAAC,CAAC;QAqCxB,2BAAsB,GAAY,KAAK,CAAC;QAExC,aAAQ,GAAY,IAAI,CAAC;QAkHzB,8BAAyB,GAAY,KAAK,CAAC;QAC3C,aAAQ,GAAQ,CAAC,CAAC;IAhMf,CAAC;IAEJ,QAAQ;QACN,yEAAyE;QACzE,GAAG;QACH,IAAG,CAAC,IAAI,CAAC,sBAAsB;YAAG,IAAI,CAAC,WAAW,EAAE,CAAC;IACvD,CAAC;IAED,wBAAwB;IACxB,WAAW;QACT,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;YACzI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;YACjC,OAAO,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC;YAC3B,IAAI,OAAO,CAAC,KAAK,EAAE;gBACjB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,uCAAuC;gBACjH,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,kBAAkB,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,cAAc;aAC/D;iBAAM;gBACL,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,kBAAkB,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,cAAc;gBAC9D,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,KAAE,UAAU,EAAE,OAAO,CAAC,YAAY,CAAC,GAAC,CAAC;aACrE;SAEF;IAEH,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,KAAK;QAClB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,KAAK,CAAC;QACxE,IAAI,CAAC,KAAK,GAAI,KAAK;QACnB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,IAAI;IAChE,CAAC;IAMD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;IACxC,CAAC;IAED;;OAEG;IACH,iBAAiB;QACf,IACE,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;YACnE,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,GAAG,EACrE;YACA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,gBAAgB,GAAG,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;gBAC/F,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;gBAClF,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;gBACzB,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;aACxC;SACF;aAAM;YACL,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;SAC3B;QACD,0CAA0C;IAC5C,CAAC;IAED;;OAEG;IACH,uBAAuB;QACrB,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAQD;;OAEG;IACH,iBAAiB,CAAC,MAAM;QACtB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;IACrC,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;YACjE,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,GAAG,EAAE;YACnE,IAAI,CAAC,UAAU,CAAC,gBAAgB,GAAG,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YAC9F,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACpB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;SACtC;aAAM;YACL,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;SACvB;IACH,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU;gBACnC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;gBACzB,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY;gBACvC,cAAc,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,gBAAgB;gBAC7C,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;gBACzB,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ;aAChC,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM;gBAChC,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;aACzC;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QAED,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACnC,IAAI,QAAQ,GAAQ;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;oBACvB,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACxC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,YAAY,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;oBAC3B,gBAAgB,EAAE,CAAC;oBACnB,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBACnB,QAAQ,EAAE,CAAC;oBACX,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;iBAC1B;gBACD,IAAG,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;oBACxB,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;iBAC/D;gBACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;oBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;wBACrC,OAAO;4BACL,UAAU,EAAE,IAAI,CAAC,UAAU;4BAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;4BAChB,KAAK,EAAE,IAAI,CAAC,KAAK;4BACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;4BAClC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;4BAChC,QAAQ,EAAE,IAAI,CAAC,QAAQ;4BACvB,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;yBACjC;oBACH,CAAC,CAAC;oBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;iBACzC;gBACD,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;iBAC7B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAOD;;OAEG;IACH,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;QACnB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,sBAAsB;QACpB,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACpC,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;SAC9D;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CACxD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,IAAI;QACT,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC5D,CAAC,CAAC;IACL,CAAC;;0HA1PU,qCAAqC;mIAArC,qCAAqC;QChBlD,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAA0I;QAAlC,6JAAS,2BAAuB,IAAC;QACrI,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,8JAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,mIAEM;QACN,mIAEM;QACV,4DAAM;QACN,mIAmFM;QAEN,iKAEqB;QAGrB,6IA8BW;QAGX,6IA8BW;QAGX,6IAsBW;;QA3MgD,wEAAe;QAE/D,0DAA6C;QAA7C,gKAA6C;QAIpC,0DAAmC;QAAnC,gGAAmC;QAEvC,0DAA6B;QAA7B,2JAA6B;QAM7B,0DACJ;QADI,qJACJ;QAGF,0DAA6B;QAA7B,6FAA6B;QAG7B,0DAA4B;QAA5B,4FAA4B;QAIe,0DAA6B;QAA7B,6FAA6B;QAqF7D,0DAAuB;QAAvB,uFAAuB;QAKK,0DAA4B;QAA5B,4FAA4B;QAiCzB,0DAA+B;QAA/B,+FAA+B;QAiC/B,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrLJ;;;;;;;;;;;;;;;;;;;ICkB3E,0EAA0C;IACtC,oEAAG;IAAA,uDAAyC;;IAAA,4DAAI;IACpD,4DAAM;;IADC,0DAAyC;IAAzC,2JAAyC;;;IAIpD,0EAAsD;IAClD,0EAAY;IACR,qEACM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAAyE;IACrE,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAA4C;IACxC,wDACJ;;IAAA,4DAAM;IACN,2EAAoG;IAChG,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;;IAlBM,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,4JACJ;IAEI,0DACJ;IADI,qJACJ;IAEI,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,0JACJ;IAEI,0DACJ;IADI,yJACJ;;;;IAKJ,0EAAgD;IAC5C,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,qEAEM;IACN,0EAAoE;IAChE,0EAAgG;IAAjC,mVAAgC;IAC3F,uDACJ;;IAAA,4DAAM;IACV,4DAAM;IACN,qEAEM;IACN,sEAEM;IACV,4DAAM;;IAxBM,wEAAe;IAef,0DACJ;IADI,6JACJ;;;IAuBQ,gFAAuF;IAAA,uDAAW;IAAA,4DAAY;;;IAAnG,iFAAoB;IAAwD,0DAAW;IAAX,4EAAW;;;;IAdlH,0EAA0D;IACtD,0EAA4B;IACxB,0EAAiE;IAA5D,4YAAsB;IACvB,mEAAuG;IAC3G,4DAAM;IACN,0EAA0C;IACtC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAA2C;IACvC,uDACJ;IAAA,4DAAM;IAEN,0EAA2C;IACvC,iFAA2E;IAAzC,mbAAwC;IACtE,wJAA8G;IAClH,4DAAY;IAChB,4DAAM;IACN,2EAAoE;IAChE,2EAAiH;IAAlC,wZAAiC;IAC5G,wDACJ;IAAA,4DAAM;IACV,4DAAM;IACN,2EAAwE;IACpE,qEAAG;IAAA,wDAAiI;IAAA,4DAAI;IAC5I,4DAAM;IACN,2EAA2C;IACvC,2EAAoH;IAArC,2ZAAoC;IAC/G,wDACJ;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IA9BU,0DAAe;IAAf,wEAAe;IAKhB,0DAAa;IAAb,8EAAa;IAGhB,0DACJ;IADI,kIACJ;IAGe,0DAAsB;IAAtB,mFAAsB;IACsC,0DAAkB;IAAlB,wFAAkB;IAKrF,0DACJ;IADI,+KACJ;IAGG,0DAAiI;IAAjI,yNAAiI;IAIhI,0DACJ;IADI,6FACJ;;;;IAMhB,yFAC8D;IAA1D,oaAAyD;IAC7D,4DAAqB;;;IAFyB,uGAAuC;;;IAmB7E,0EAA8B;IAC1B,qEAEM;IACN,0EAAwB;IACpB,4EAA0B;IAAA,oHAAgC;IAAA,4DAAQ;IACtE,4DAAM;IACV,4DAAM;;;IAjBV,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACqE;IACzE,4DAAM;IAEV,4DAAM;IACN,8JAOM;IACV,qEAAe;;;IAhBmC,0DAC1C;IAD0C,qJAC1C;IAGwB,0DAAqC;IAArC,sGAAqC;IAIpD,0DAAe;IAAf,mFAAe;;;;IAU5B,6EAEqC;IAAjC,6WAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,uWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IA7B3F,+EAEsE;IAFS,mYAAsC;;IAGjH,iKAkBe;IACf,2OAQc;IAClB,4DAAW;;;;IA9BP,sKAA+C;IADzC,0EAAqC;;;IAqC3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC0D;IAC9D,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAG2B,0DAAuB;IAAvB,wFAAuB;;;;IAKtD,6EAE6C;IAAzC,qXAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,+WAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,sYAAyC;;IAG1H,iKASe;IACf,2OAQc;IAClB,4DAAW;;;;IArBP,mKAA4C;IADtC,0EAAwC;;;IAqC1C,0EAAkC;IAC9B,qEAEM;IACN,0EAAwB;IACpB,4EAA0B;IAAA,oHAAgC;IAAA,4DAAQ;IACtE,4DAAM;IACV,4DAAM;;;IAhBV,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACkE;IACtE,4DAAM;IACV,4DAAM;IACN,8JAOM;IACV,qEAAe;;;IAfmC,0DAC1C;IAD0C,qJAC1C;IAG4B,0DAA8B;IAA9B,+FAA8B;IAGjD,0DAAmB;IAAnB,uFAAmB;;;;IAUhC,6EAEwC;IAApC,gXAAmC;IAAC,uDACxB;;IAAA,4DAAS;IACzB,6EACgE;IAA9B,0WAA6B;IAAC,uDAAsB;;IAAA,4DAAS;;IAHvD,0DACxB;IADwB,0IACxB;IAEgD,0DAAsB;IAAtB,wIAAsB;;;;IA3B9F,+EAE4E;IAFS,sYAAyC;;IAG1H,iKAiBe;IACf,2OAOc;IAClB,4DAAW;;;;IA5BP,qKAA8C;IADxC,0EAAwC;;ADjK3C,MAAM,sCAAsC;IAOjD,YACU,MAAc,EACf,WAAwB,EACvB,WAAwB,EACxB,IAAqB,EACtB,YAA0B,EACzB,KAAqB;QALrB,WAAM,GAAN,MAAM,CAAQ;QACf,gBAAW,GAAX,WAAW,CAAa;QACvB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QACzB,UAAK,GAAL,KAAK,CAAgB;QAXrB,kBAAa,GAAG,IAAI,uDAAY,EAAO,CAAC;QACzC,SAAI,GAAQ,EAAE;QACvB,sBAAiB,GAAY,KAAK,CAAC;QACnC,SAAI,GAAW,CAAC,CAAC;QACjB,yBAAoB,GAAW,CAAC;QAkIhC,2BAAsB,GAAY,KAAK,CAAC;QACxC,YAAO,GAAQ,CAAC,CAAC;QACjB,aAAQ,GAAY,IAAI,CAAC;QAmCzB,8BAAyB,GAAY,KAAK,CAAC;QAC3C,aAAQ,GAAQ,CAAC,CAAC;QA6ClB,iBAAY,GAAQ,CAAC,CAAC;QACtB,8BAAyB,GAAY,KAAK,CAAC;QAC3C,iBAAY,GAAY,IAAI,CAAC;IA7M7B,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,WAAW,EAAE;IACpB,CAAC;IAED,wBAAwB;IACxB,WAAW;QACT,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;YACzI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI;YAChC,0CAA0C;YAC1C,OAAO,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC;YAC3B,IAAI,OAAO,CAAC,KAAK,EAAE;gBACjB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,uCAAuC;gBACjH,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK;gBAC5G,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,kBAAkB,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,cAAc;aAC/D;iBAAM;gBACL,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,kBAAkB,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,cAAc;gBAC9D,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,mCAAQ,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,KAAE,UAAU,EAAE,OAAO,CAAC,YAAY,CAAC,GAAE,CAAC;aACvE;SACF;IAEH,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,KAAK;QAClB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,KAAK,CAAC;QACtE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,QAAQ;QAC5C,IAAI,CAAC,KAAK,GAAG,KAAK;QAClB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,IAAI;IAChE,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU;gBACnC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ;gBAC/B,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAClD,cAAc,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,gBAAgB;gBAC7C,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;aAC1B,CAAC;YACF,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC9B,QAAQ,mCAAQ,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAE;aACtE;YACD,IAAI,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACvB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM;gBAChC,QAAQ,mCAAQ,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAE;aAC3C;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAEzB;QAED,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAGD;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpC,IAAI,QAAQ,GAAQ;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;oBACvB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;oBACzB,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACxC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,gBAAgB,EAAE,CAAC;oBACnB,QAAQ,EAAE,CAAC;oBACX,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBACnB,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;iBAC1B;gBACD,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;oBACzB,QAAQ,mCAAQ,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAE;iBACjE;gBACD,IAAI,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;oBACvB,IAAI,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;wBACrC,OAAO;4BACL,UAAU,EAAE,IAAI,CAAC,UAAU;4BAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;4BAChB,KAAK,EAAE,IAAI,CAAC,KAAK;4BACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;4BAClC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;4BAChC,QAAQ,EAAE,IAAI,CAAC,QAAQ;4BACvB,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;yBACjC;oBACH,CAAC,CAAC;oBACF,QAAQ,mCAAQ,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAE;iBAC3C;gBACD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC3C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;iBAC7B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IASD;;OAEG;IACH,iBAAiB,CAAC,MAAM;QACtB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QAC3D,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,IAAI,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,IAAI,GAAG,EAAE;YAChG,IAAI,CAAC,UAAU,CAAC,gBAAgB,GAAG,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;YACzE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;SACrC;aAAM;YACL,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;SACvB;IACH,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAOD;;OAEG;IACH,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;QACnB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,sBAAsB;QACpB,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACpC,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;SAC9D;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CAExD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IAED;;OAEG;IACI,MAAM,CAAC,IAAI;QAChB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC3D,CAAC,CAAC;IACL,CAAC;IAMD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QAEtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC;IAEL,CAAC;IAED;;OAEG;IACH,iBAAiB;QACf,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,GAAG,GAAG,EAAE;YACjF,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,gBAAgB,GAAG,UAAU,CACxC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CACnD,CAAC;gBACF,wEAAwE;gBACxE,IAAI,CAAC,oBAAoB,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;gBACxE,IAAI,CAAC,YAAY,GAAG,IAAI;aACzB;YACD,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;SACxC;aAAM;YACL,IAAI,CAAC,YAAY,GAAG,KAAK;SAC1B;IACH,CAAC;IAED;;OAEG;IACH,uBAAuB;QACrB,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;;4HAnQU,sCAAsC;oIAAtC,sCAAsC;QCZnD,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAAsG;QAAlC,8JAAS,2BAAuB,IAAC;QACjG,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,+JAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,oIAEM;QACV,4DAAM;QAEN,sIAuBM;QAEN,0EAAwF;QACpF,qIAwBM;QACN,sIA+BM;QACV,4DAAM;QAEN,mKAEqB;QAIrB,+IA+BW;QAGX,+IAsBW;QAGX,+IA6BW;;QA1MgD,wEAAe;QAE/D,0DAA6C;QAA7C,gKAA6C;QAMxC,0DAA6B;QAA7B,2JAA6B;QAIzB,0DAAyB;QAAzB,sFAAyB;QAE7B,0DACJ;QADI,qJACJ;QAGF,0DAAkB;QAAlB,kFAAkB;QAKO,0DAAiB;QAAjB,iFAAiB;QA0BnB,0DAAiB;QAAjB,iFAAiB;QAyBG,0DAAO;QAAP,6EAAO;QAkCvC,0DAAuB;QAAvB,uFAAuB;QAMK,0DAA4B;QAA5B,4FAA4B;QAkCzB,0DAA+B;QAA/B,+FAA+B;QAyB/B,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7KJ;;;;;;;;;;;;;;;;;;;ICkB3E,0EAAqE;IACjE,oEAAG;IAAA,uDAA4C;;IAAA,4DAAI;IACvD,4DAAM;;IADC,0DAA4C;IAA5C,8JAA4C;;;IAEnD,0EAAoD;IAChD,wEAAkD;IAAA,uDAAuC;;IAAA,4DAAI;IACjG,4DAAM;;IADgD,0DAAuC;IAAvC,yJAAuC;;;IA4DzE,gFAAuF;IAAA,uDAAW;IAAA,4DAAY;;;IAAnG,gFAAoB;IAAwD,0DAAW;IAAX,2EAAW;;;;IAdlH,0EAA0D;IACtD,0EAA4B;IACxB,0EAAiE;IAA5D,4YAAsB;IACvB,mEAC+D;IACnE,4DAAM;IACN,0EAA0C;IACtC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAA2C;IACvC,uDACJ;IAAA,4DAAM;IACN,0EAA0C;IACtC,iFAA2E;IAAzC,mbAAwC;IACtE,yJAA8G;IAClH,4DAAY;IAChB,4DAAM;IACN,2EAAoE;IAChE,2EAAiC;IAC7B,wDAAqE;IAAA,4DAAM;IACnF,4DAAM;IACN,2EAAoI;IAArC,2ZAAoC;IAC/H,wDAAkB;IAAA,oEAAsE;IAC5F,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IAxBU,0DAAe;IAAf,wEAAe;IAMhB,0DAAa;IAAb,6EAAa;IAGhB,0DACJ;IADI,sKACJ;IAEe,0DAAsB;IAAtB,kFAAsB;IACsC,0DAAkB;IAAlB,uFAAkB;IAKrF,0DAAqE;IAArE,yJAAqE;IAGzE,0DAAkB;IAAlB,4FAAkB;;;;IAjEtC,0EAAwE;IACpE,0EAAkC;IAC9B,0EAAY;IACR,qEACM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,0EAA0C;IACtC,uDACJ;;IAAA,4DAAM;IACN,2EAA0C;IACtC,wDACJ;;IAAA,4DAAM;IACN,2EAAwE;IACpE,wDACJ;;IAAA,4DAAM;IACN,2EAAwE;IACpE,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;IACN,2EAAwF;IACpF,2EAAgC;IAC5B,2EAA4B;IACxB,sEAEM;IACN,sEAEM;IACN,sEAEM;IACN,sEAEM;IACN,2EAA2J;IAA/B,+UAA8B;IACtJ,wDACJ;;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;IAEN,uIAyBM;IACV,4DAAM;IACV,4DAAM;;;IAhEU,0DACJ;IADI,2JACJ;IAEI,0DACJ;IADI,6JACJ;IAEI,0DACJ;IADI,qJACJ;IAEI,0DACJ;IADI,0JACJ;IAEI,0DACJ;IADI,yJACJ;IAKY,0DAAe;IAAf,wEAAe;IAcnB,0DACJ;IADI,oKACJ;IAIyC,0DAAO;IAAP,gFAAO;;;;IA6BhE,yFAC8D;IAA1D,8ZAAyD;IAC7D,4DAAqB;;;IAFyB,uGAAuC;;;IAQjF,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACoD;IACxD,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGiC,0DAAoB;IAApB,qFAAoB;;;;IAKzD,6EAEqC;IAAjC,uWAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,iWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IApB3F,+EAEsE;IAFS,6XAAsC;;IAGjH,2JASe;IACf,qOAQc;IAClB,4DAAW;;;;IArBP,yKAAkD;IAD5C,0EAAqC;;;IA2B3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACgE;IACpE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAG2B,0DAA6B;IAA7B,8FAA6B;;;;IAK5D,6EAE6C;IAAzC,+WAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,yWAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,gYAAyC;;IAG1H,2JASe;IACf,qOAQc;IAClB,4DAAW;;;;IArBP,4JAAqC;IAD/B,0EAAwC;;ADlH3C,MAAM,gCAAgC;IAO3C,YACU,MAAc,EACf,WAAwB,EACvB,WAAwB,EACxB,IAAqB,EACtB,YAA0B,EACzB,KAAqB;QALrB,WAAM,GAAN,MAAM,CAAQ;QACf,gBAAW,GAAX,WAAW,CAAa;QACvB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACtB,iBAAY,GAAZ,YAAY,CAAc;QACzB,UAAK,GAAL,KAAK,CAAgB;QAZrB,kBAAa,GAAG,IAAI,uDAAY,EAAO,CAAC;QACzC,SAAI,GAAQ,EAAE,CAAC;QAGxB,sBAAiB,GAAY,KAAK,CAAC;QACnC,eAAU,GAAW,CAAC,CAAC;QAsDvB,2BAAsB,GAAY,KAAK,CAAC;QACxC,UAAK,GAAQ,CAAC,CAAC;QAkIf,aAAQ,GAAQ,CAAC,CAAC;QAClB,8BAAyB,GAAG,KAAK;IAjL9B,CAAC;IAEJ,QAAQ;QAEN,IAAI,CAAC,WAAW,EAAE;IACpB,CAAC;IAED,wBAAwB;IACxB,WAAW;QACT,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,KAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;YACxI,IAAI,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;YAC/E,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI;YAChC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK;YACpC,OAAO,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC;YAC3B,mBAAmB;YACnB,wBAAwB;YACxB,cAAc;YACd,8BAA8B;YAC9B,0BAA0B;YAC1B,4BAA4B;YAC5B,8CAA8C;YAC9C,KAAK;YACL,2CAA2C;YAE3C,IAAI,OAAO,CAAC,KAAK,EAAE;gBACjB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,uCAAuC;aAClH;iBAAM;gBACL,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,KAAE,UAAU,EAAE,OAAO,CAAC,YAAY,CAAC,GAAC,CAAC;aACrE;SACF;IACH,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,KAAK;QAClB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,KAAK,CAAC;QACtE,IAAI,CAAC,KAAK,GAAG,KAAK;QAClB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,IAAI;IAEhE,CAAC;IAOD;;OAEG;IACH,kBAAkB;QAChB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QAEzD,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,cAAc;QAEZ,IAAG,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YAChC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAG;gBAC1C,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE;oBAC5B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;oBAC3C,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;iBAChE;qBACI;oBACH,uCAAuC;oBACvC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU;iBAC1C;aACF;SACF;QACD,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU;gBACnC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;gBACzB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU;gBACnC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;gBACzB,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ;aAChC,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM;gBAChC,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;aACzC;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QACD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACnC,IAAI,QAAQ,GAAQ;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;oBACvB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;oBACzB,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACxC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,KAAK,EAAE,IAAI,CAAC,UAAU;oBACtB,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBACnB,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;oBACzB,QAAQ,EAAG,CAAC;iBACb;gBACD,IAAG,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;oBACxB,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;iBAC/D;gBACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;oBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;wBACrC,OAAO;4BACL,UAAU,EAAE,IAAI,CAAC,UAAU;4BAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;4BAChB,KAAK,EAAE,IAAI,CAAC,KAAK;4BACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;4BAClC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;4BAChC,QAAQ,EAAE,IAAI,CAAC,QAAQ;4BACvB,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;yBACjC;oBACH,CAAC,CAAC;oBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;iBACzC;gBACD,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;iBAC7B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,IAAI;QACT,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAC5D,CAAC,CAAC;IACL,CAAC;IAIA;;MAEE;IACH,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,sBAAsB;QACpB,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACpC,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;SACpE;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,GAAG,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CACxD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;;gHA9NU,gCAAgC;8HAAhC,gCAAgC;QCZ7C,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAA0I;QAAlC,wJAAS,2BAAuB,IAAC;QACrI,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,yJAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,8HAEM;QACN,8HAEM;QACV,4DAAM;QACN,gIAsEM;QAEN,4JAEqB;QAGrB,wIAsBW;QAEX,wIAsBW;;QApJgD,wEAAe;QAE/D,0DAA6C;QAA7C,gKAA6C;QAIpC,0DAAmC;QAAnC,gGAAmC;QAEvC,0DAA6B;QAA7B,2JAA6B;QAM7B,0DACJ;QADI,qJACJ;QAGF,0DAA6C;QAA7C,iHAA6C;QAG7C,0DAA4B;QAA5B,4FAA4B;QAIe,0DAAiB;QAAjB,iFAAiB;QAwEjD,0DAAuB;QAAvB,uFAAuB;QAKK,0DAA4B;QAA5B,4FAA4B;QAwBzB,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9HJ;;;;;;;;;;;;;;;;;;ICkE3C,gFAAuF;IAAA,uDAAW;IAAA,4DAAY;;;IAAnG,gFAAoB;IAAwD,0DAAW;IAAX,2EAAW;;;;IAXtH,0EAA6D;IACzD,0EAAuB;IACnB,wEAAsG;IAAvB,+XAAsB;IAAC,4DAAI;IAC9G,4DAAM;IACN,0EAAwB;IACpB,0EAAwB;IACpB,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAAqD;IACjD,0EAAyC;IACrC,gFAA2E;IAAzC,yaAAwC;IACtE,iJAA8G;IAClH,4DAAY;IAChB,4DAAM;IAEN,2EAAuI;IAAhH,kZAAoC;IACvD,wDACJ;IAAA,4DAAM;IACN,2EAAiD;IAC7C,wDACJ;IAAA,4DAAM;IACV,4DAAM;IACV,4DAAM;IACV,4DAAM;;;;IAjBS,0DAAa;IAAb,6EAAa;IAID,0DAAsB;IAAtB,kFAAsB;IACsC,0DAAkB;IAAlB,uFAAkB;IAKzF,0DACJ;IADI,8GACJ;IAEI,0DACJ;IADI,iIACJ;;;IAsBQ,gFAAuF;IAAA,uDAAW;IAAA,4DAAY;;;IAAnG,iFAAoB;IAAwD,0DAAW;IAAX,4EAAW;;;;IAXtH,0EAA6D;IACzD,0EAAuB;IACnB,wEAA2G;IAA3B,uYAA0B;IAAC,4DAAI;IACnH,4DAAM;IACN,0EAAwB;IACpB,0EAAwB;IACpB,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAAqD;IACjD,0EAAyC;IACrC,gFAA2E;IAAzC,2aAAwC;IACtE,iJAA8G;IAClH,4DAAY;IAChB,4DAAM;IACN,2EAAuI;IAAhH,oZAAoC;IACvD,wDACJ;IAAA,4DAAM;IAEN,2EAAqG;IAAnC,kZAAkC;IAChG,wDAAgD;IAAA,oEAAsE;IAC1H,4DAAM;IACV,4DAAM;IACV,4DAAM;IAEV,4DAAM;;;;IAlBS,0DAAa;IAAb,8EAAa;IAID,0DAAsB;IAAtB,mFAAsB;IACsC,0DAAkB;IAAlB,wFAAkB;IAIzF,0DACJ;IADI,+GACJ;IAGI,0DAAgD;IAAhD,kIAAgD;;;;IAchF,yFAAgJ;IAA1D,6ZAAyD;IAAC,4DAAqB;;;IAAvH,uGAAuC;;;;IACrF,yFAAgJ;IAA1D,6ZAAyD;IAAC,4DAAqB;;;IAAvH,uGAAuC;;;IAMjF,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACyD;IAC7D,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGiC,0DAAyB;IAAzB,0FAAyB;;;;IAK9D,6EAEqC;IAAjC,sWAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,gWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IApB3F,+EAEsE;IAFS,4XAAsC;;IAGjH,0JASe;IACf,oOAQc;IAClB,4DAAW;;;;IArBP,uKAAgD;IAD1C,0EAAqC;;;IA4B3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACiE;IACrE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,sJAC1C;IAG2B,0DAA8B;IAA9B,+FAA8B;;;;IAK7D,6EAE6C;IAAzC,8WAAwC;IAAC,uDAC7B;;IAAA,4DAAS;IACzB,6EAEqE;IAAnC,wWAAkC;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DAC7B;IAD6B,0IAC7B;IAGqD,0DAAsB;IAAtB,wIAAsB;;;;IApBnG,+EAEsF;IAFD,+XAAyC;;IAG1H,0JASe;IACf,oOAQc;IAClB,4DAAW;;;;IArBP,mKAA4C;IADtC,0EAAwC;;ADzI3C,MAAM,+BAA+B;IAc1C,YACS,YAA0B,EAC1B,WAAwB,EACvB,IAAqB,EACrB,WAAwB,EACxB,KAAqB;QAJtB,iBAAY,GAAZ,YAAY,CAAc;QAC1B,gBAAW,GAAX,WAAW,CAAa;QACvB,SAAI,GAAJ,IAAI,CAAiB;QACrB,gBAAW,GAAX,WAAW,CAAa;QACxB,UAAK,GAAL,KAAK,CAAgB;QAjBrB,mBAAc,GAAG,IAAI,uDAAY,EAAO,CAAC;QACzC,gBAAW,GAAG,IAAI,uDAAY,EAAO,CAAC;QACvC,aAAQ,GAAQ,EAAE,CAAC;QACnB,cAAS,GAAQ,EAAE,CAAC;QAE7B,sBAAiB,GAAY,KAAK,CAAC;QACnC,sBAAiB,GAAY,KAAK,CAAC;QACnC,aAAQ,GAAW,CAAC,CAAC;QACrB,SAAI,GAAG;YACL,OAAO,EAAE,EAAE;YACX,QAAQ,EAAE,EAAE;SACb;QAsRD,2BAAsB,GAAY,KAAK,CAAC;QACxC,UAAK,GAAQ,CAAC,CAAC;QAiCd,8BAAyB,GAAY,KAAK,CAAC;IA/SxC,CAAC;IAGL,QAAQ;QACN,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC;IAEA,+BAA+B;IAC/B,cAAc;QACb,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC7C,IAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,KAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;YACpJ,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI;YACpC,8CAA8C;YAC9C,OAAO,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC;YAC3B,IAAI,OAAO,CAAC,KAAK,EAAE;gBACjB,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,uCAAuC;gBACrH,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK;aACzH;iBAAM;gBACL,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,KAAE,UAAU,EAAE,OAAO,CAAC,YAAY,CAAC,GAAC,CAAC;aAC7E;SACF;IACH,CAAC;IAED,SAAS,CAAC,KAAK;QACb,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;IAC1B,CAAC;IAED,gCAAgC;IAChC,eAAe;QACb,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC9C,IAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,KAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;YACvJ,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI;YACrC,+CAA+C;YAC/C,OAAO,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC;YAC3B,IAAI,OAAO,CAAC,KAAK,EAAE;gBACjB,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,uCAAuC;gBACtH,4HAA4H;gBAC5H,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK;aAE1D;iBAAM;gBACL,IAAI,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK;gBACxC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,KAAE,UAAU,EAAE,OAAO,CAAC,YAAY,CAAC,EAAE,UAAU,EAAE,UAAU,GAAC,CAAC;aACvG;SACF;IACH,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI;IAC/B,CAAC;IAGD;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,CAAC;QACd,oEAAoE;QACpE,IAAI,CAAC,KAAK,GAAG,CAAC;QACd,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,IAAI;IAC5D,CAAC;IAED;;;OAGG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACnC,IAAI,QAAQ,GAAQ;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;oBACvB,UAAU,EAAE,CAAC;oBACb,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACxC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,QAAQ,EAAE,CAAC;oBACX,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBACnB,wCAAwC;oBACxC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;iBAC1B;gBACD,IAAG,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;oBACxB,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;iBAC/D;gBACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;oBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;wBACrC,OAAO;4BACL,UAAU,EAAE,IAAI,CAAC,UAAU;4BAC3B,aAAa,EAAE,IAAI,CAAC,aAAa;4BACjC,KAAK,EAAE,IAAI,CAAC,IAAI;4BAChB,KAAK,EAAE,IAAI,CAAC,KAAK;4BACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;4BAClC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;4BAChC,QAAQ,EAAE,IAAI,CAAC,QAAQ;4BACvB,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;yBACjC;oBACH,CAAC,CAAC;oBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;iBACzC;gBACD,IAAG,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC/C,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;QAC5C,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IAEjC,CAAC;IAED;;;OAGG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACnC,IAAI,QAAQ,GAAQ;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;oBACvB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;oBACzB,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACxC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,QAAQ,EAAE,CAAC;oBACX,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBACnB,wCAAwC;oBACxC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;iBAC1B;gBACD,IAAG,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;oBACxB,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;iBAC/D;gBACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;oBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;wBACrC,OAAO;4BACL,UAAU,EAAE,IAAI,CAAC,UAAU;4BAC3B,aAAa,EAAE,IAAI,CAAC,aAAa;4BACjC,KAAK,EAAE,IAAI,CAAC,IAAI;4BAChB,KAAK,EAAE,IAAI,CAAC,KAAK;4BACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;4BAClC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;4BAChC,QAAQ,EAAE,IAAI,CAAC,QAAQ;4BACvB,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;yBACjC;oBACH,CAAC,CAAC;oBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;iBACzC;gBACD,IAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC9C,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBAChC;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aAEF;SACF;QAED,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IACD;;OAEG;IACH,cAAc;QACZ,IAAI,CAAC,IAAI,GAAG;YACV,OAAO,EAAE,EAAE;YACX,QAAQ,EAAE,EAAE;SACb;QACD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC7C,IAAI,MAAM,GAAQ;gBAChB,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,UAAU;gBACvC,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC1D,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ;gBACnC,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK;gBAC7B,gDAAgD;aACjD;YACD,IAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBACjC,MAAM,mCAAO,MAAM,KAAE,aAAa,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,MAAM,CAAC,KAAK,IAAI,CAAC,EAAE;gBACpB,IAAI,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBAC9C,IAAI,KAAK,GAAE;wBACT,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK;wBACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;qBACxB;oBACD,IAAG,IAAI,CAAC,aAAa;wBAAE,KAAK,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC,aAAa;oBAClE,OAAQ,KAAK;gBACf,CAAC,CAAC;gBACF,MAAM,mCAAO,MAAM,KAAE,MAAM,EAAE,MAAM,GAAC;aACrC;YAED,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SAChC;QACD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC9C,IAAI,OAAO,GAAQ;gBACjB,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,UAAU;gBACxC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC5D,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ;gBACpC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,UAAU;gBACnC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK;gBAC9B,iDAAiD;aAClD;YACD,IAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAClC,OAAO,mCAAO,OAAO,KAAE,aAAa,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACvE;YACD,IAAG,OAAO,CAAC,KAAK,IAAI,CAAC,EAAE;gBACrB,IAAI,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBAC/C,IAAI,KAAK,GAAE;wBACT,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK;wBACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;qBACxB;oBACD,IAAG,IAAI,CAAC,aAAa;wBAAE,KAAK,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC,aAAa;oBAClE,OAAQ,KAAK;gBACf,CAAC,CAAC;gBACF,OAAO,mCAAO,OAAO,KAAE,MAAM,EAAE,MAAM,GAAC;aACvC;YACD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC;SACjC;QACD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;IACnC,CAAC;IAEH;;OAEG;IACI,MAAM,CAAC,IAAI;QAChB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE,CAAE,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACpE,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,UAAU,CAAC,IAAI;QACb,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE;gBACX,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBACtD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAC9C,CAAC;SACF,CAAC,CAAC;IAEL,CAAC;IAOD;;OAEG;IACH,kBAAkB,CAAC,MAAM;QACvB,IAAI,CAAC,IAAI,GAAG,MAAM;QAClB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAG,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YAC5D,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;SAC5D;aAAM;YACL,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,CAAC;SACzB;QACD,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAOD;;OAEG;IACF,oBAAoB,CAAC,MAAM;QACzB,IAAI,CAAC,WAAW,GAAG,MAAM,CAAC;QAC1B,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QACxE,CAAC,CAAC,CAAC;IACL,CAAC;IAEF;;OAEG;IACF,sBAAsB;QACpB,IAAI,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YAC7C,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,CAAC,CAAC;SAC9E;aAAM,IAAI,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,GAAG,CAAC;YACjD,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAClC,OAAO,EACP,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kCAAkC,CAAC,CACxD,CAAC;QACJ,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;IACD;;OAEG;IACH,4BAA4B;QAC1B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;IACzC,CAAC;;8GArWS,+BAA+B;6HAA/B,+BAA+B;QCX5C,yEAAmH;QAC/G,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAO9C,sEAAK;QACD,4EAC0D;QAA3B,uJAAS,oBAAgB,IAAC;QACrD,uDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QAIV,4DAAM;QACN,0EAAoD;QAChD,0EAAuB;QACnB,0EAA0D;QACtD,0EAAsC;QAClC,0EAA0C;QACtC,oFACJ;QAAA,4DAAM;QACN,0EAAqD;QACjD,qFACJ;QAAA,4DAAM;QACN,0EAAqD;QACjD,oFACJ;QAAA,4DAAM;QACV,4DAAM;QACN,0EAAsC;QAClC,0EAA0C;QACtC,0FACJ;QAAA,4DAAM;QACN,0EAAqD;QACjD,qFACJ;QAAA,4DAAM;QACN,0EAAqD;QACjD,oFACJ;QAAA,4DAAM;QACV,4DAAM;QACV,4DAAM;QAEN,2EAA4C;QACxC,2EAAyC;QACrC,2EAA6E;QAAlC,qJAAS,2BAAuB,IAAC;QACxE,oEAAiD;QACjD,8FACJ;QAAA,4DAAM;QACN,+HAuBM;QACV,4DAAM;QAEN,2EAAyC;QACrC,2EAA6E;QAAlC,qJAAS,2BAAuB,IAAC;QACxE,oEAAiD;QACjD,oGACJ;QAAA,4DAAM;QACN,+HAwBM;QACV,4DAAM;QAEV,4DAAM;QAEV,4DAAM;QACV,4DAAM;QAGN,4JAAqK;QACrK,4JAAqK;QAGrK,wIAsBW;QAGX,wIAsBW;;QA1KwF,wEAAe;QAEvG,0DAA6C;QAA7C,+JAA6C;QAYxC,0DACJ;QADI,oJACJ;QAwCmD,2DAAW;QAAX,iFAAW;QA+BX,0DAAY;QAAZ,kFAAY;QAiCtD,0DAAuB;QAAvB,uFAAuB;QACvB,0DAAuB;QAAvB,uFAAuB;QAGK,0DAA4B;QAA5B,4FAA4B;QAyBzB,0DAA+B;QAA/B,+FAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpJJ;;;;;;;;;;;;;;;;;;ICkB3E,0EAA0C;IACtC,oEAAG;IAAA,uDAAyC;;IAAA,4DAAI;IACpD,4DAAM;;IADC,0DAAyC;IAAzC,2JAAyC;;;IA4C5B,gFAAuF;IAAA,uDAAW;IAAA,4DAAY;;;IAAnG,gFAAoB;IAAwD,0DAAW;IAAX,2EAAW;;;;IAf9G,0EAAoE;IAChE,0EAAoC;IAChC,wEAAsF;IAAvB,2YAAsB;IAAC,4DAAI;IAC9F,4DAAM;IACN,0EAAoC;IAChC,oEAAG;IAAA,uDAAa;IAAA,4DAAI;IACxB,4DAAM;IACN,0EAAiD;IAC7C,uDACJ;IAAA,4DAAM;IACN,0EAA2I;IAAxF,yZAAgC;IAC/E,uDACJ;IAAA,4DAAM;IACN,2EAA0C;IACtC,iFAA2E;IAAzC,sbAAwC;IACtE,4JAA8G;IAClH,4DAAY;IAChB,4DAAM;IACN,2EAA8I;IAA1F,2ZAAiC;IACjF,wDACJ;IAAA,4DAAM;IACV,4DAAM;;;;IAhBK,0DAAa;IAAb,6EAAa;IAGhB,0DACJ;IADI,iIACJ;IAEI,0DACJ;IADI,4FACJ;IAEe,0DAAsB;IAAtB,kFAAsB;IACsC,0DAAkB;IAAlB,uFAAkB;IAIzF,0DACJ;IADI,4HACJ;;;IA9ChB,0EAAwE;IACpE,0EAA2B;IACvB,0EAAsC;IAClC,oEAAG;IAAA,gGAAsB;IAAA,4DAAI;IAAC,uDAClC;IAAA,4DAAM;IACN,0EAA4C;IACxC,qEAEM;IACN,0EAA+D;IAC3D,wFACJ;IAAA,4DAAM;IACN,2EAAkE;IAC9D,+EACJ;IAAA,4DAAM;IACN,2EAAoE;IAChE,0EACJ;IAAA,4DAAM;IACN,2EAAqE;IACjE,wDACJ;;IAAA,4DAAM;IACN,2EAAqE;IACjE,+EACJ;IAAA,4DAAM;IACV,4DAAM;IACN,2EAA+C;IAC3C,0IAqBM;IACV,4DAAM;IACV,4DAAM;IACV,4DAAM;;;IA/CoC,0DAClC;IADkC,8FAClC;IAeQ,2DACJ;IADI,oJACJ;IAM2D,0DAAO;IAAP,gFAAO;;;;IA2B9E,yFAAgJ;IAA1D,iaAAyD;IAC/I,4DAAqB;;;IADyB,uGAAuC;;;IAOjF,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEAC0D;IAC9D,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGwB,0DAA0B;IAA1B,2FAA0B;;;;IAKtD,6EAEqC;IAAjC,0WAAgC;IAAC,uDACrB;;IAAA,4DAAS;IACzB,6EAE6D;IAA3B,oWAA0B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACrB;IADqB,0IACrB;IAG6C,0DAAsB;IAAtB,wIAAsB;;;;IApB3F,+EAEsE;IAFS,gYAAsC;;IAGjH,8JASe;IACf,wOAQc;IAClB,4DAAW;;;;IAtBD,0EAAqC;;;IA4B3C,wEAA8B;IAC1B,0EAAY;IACR,0EAA0C;IAAA,uDAC1C;;IAAA,4DAAM;IACN,0EAAwB;IACpB,uEACgE;IACpE,4DAAM;IACV,4DAAM;IACV,qEAAe;;;IAPmC,0DAC1C;IAD0C,oJAC1C;IAGiC,0DAAuB;IAAvB,wFAAuB;;;;IAK5D,6EAEyC;IAArC,8WAAoC;IAAC,uDACzB;;IAAA,4DAAS;IACzB,6EAEiE;IAA/B,wWAA8B;IAAC,uDAAsB;;IAAA,4DAAS;;IAJvD,0DACzB;IADyB,0IACzB;IAGiD,0DAAsB;IAAtB,wIAAsB;;;;IApB/F,+EAE8E;IAFD,+XAAqC;;IAG9G,8JASe;IACf,wOAQc;IAClB,4DAAW;;;;IAtBD,0EAAoC;;AD7FvC,MAAM,mCAAmC;IAO9C,YACU,WAAwB,EACxB,IAAqB,EACtB,WAAwB,EACxB,YAA0B,EACzB,KAAqB;QAJrB,gBAAW,GAAX,WAAW,CAAa;QACxB,SAAI,GAAJ,IAAI,CAAiB;QACtB,gBAAW,GAAX,WAAW,CAAa;QACxB,iBAAY,GAAZ,YAAY,CAAc;QACzB,UAAK,GAAL,KAAK,CAAgB;QAVrB,mBAAc,GAAG,IAAI,uDAAY,EAAO,CAAC;QACzC,gBAAW,GAAG,IAAI,uDAAY,EAAO,CAAC;QAEhD,sBAAiB,GAAY,KAAK,CAAC;QA2CnC,2BAAsB,GAAY,KAAK,CAAC;QAsCxC,0BAAqB,GAAY,KAAK,CAAC;IAxEnC,CAAC;IAEL,QAAQ;QACN,IAAI,CAAC,WAAW,EAAE;IAEpB,CAAC;IAED,wBAAwB;IACxB,WAAW;QACT,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,KAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;YACxI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;YACjC,2CAA2C;YAC3C,OAAO,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC;YAC3B,IAAI,OAAO,CAAC,KAAK,EAAE;gBACjB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,uCAAuC;gBACjH,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK;aAC7G;iBAAM;gBACL,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,mCAAO,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,KAAE,UAAU,EAAE,OAAO,CAAC,YAAY,CAAC,GAAC,CAAC;aACrE;SACF;IAEH,CAAC;IAGD;;OAEG;IACH,qBAAqB;QACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAOD;;OAEG;IACH,iBAAiB,CAAC,MAAM;QACtB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACjC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QAC7D,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACrC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,CAAC;SAClE;aAAM,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,GAAG,CAAC;YACzC,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,6CAA6C,CAAC,EAClE,aAAa,CACd,CAAC;QACJ,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IACD;;OAEG;IACH,oBAAoB;QAClB,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACtC,CAAC;IAQD;;OAEG;IACH,gBAAgB,CAAC,MAAM;QACrB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;QACnB,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;QAClC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,sBAAsB,CAAC,CAAC;QACzE,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,kBAAkB;QAChB,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;YACxC,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;SAClE;aAAM,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,GAAG,CAAC;YAC5C,IAAI,CAAC,WAAW,CAAC,SAAS,CACxB,IAAI,EACJ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,mDAAmD,CAAC,EACxE,aAAa,CACd,CAAC;QACJ,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC;IACrC,CAAC;IACD;;OAEG;IACH,wBAAwB;QACtB,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC;IACrC,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,CAAC;QACd,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QAClE,IAAI,CAAC,KAAK,GAAI,CAAC;QACf,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,IAAI;IAC5D,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,QAAQ,GAAQ;gBAClB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU;gBACnC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAClD,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;gBACzB,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ;gBAC/B,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;aAC1B,CAAC;YACF,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;gBAC7B,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;aACpE;YACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBAC1C,IAAI,KAAK,GAAE;wBACT,UAAU,EAAE,IAAI,CAAC,UAAU;wBAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;wBAChB,KAAK,EAAE,IAAI,CAAC,KAAK;wBACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBAClC,QAAQ,EAAE,IAAI,CAAC,QAAQ;qBACxB;oBACD,IAAG,IAAI,CAAC,aAAa;wBAAE,KAAK,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC,aAAa;oBAClE,OAAQ,KAAK;gBACf,CAAC,CAAC;gBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;aACzC;YACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzB;QACD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,sBAAsB,CAAC,IAAI;QACzB,IAAI,IAAI,EAAE;YACR,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACnC,IAAI,QAAQ,GAAQ;oBAClB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;oBACvB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;oBACzB,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACxC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,QAAQ,EAAE,CAAC;oBACX,KAAK,EAAE,CAAC;oBACR,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBAClB,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;oBACnB,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK;iBAC1B;gBACD,IAAG,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;oBACxB,QAAQ,mCAAO,QAAQ,KAAE,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,aAAa,GAAC;iBAC/D;gBACD,IAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,EAAE;oBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;wBACrC,OAAO;4BACL,UAAU,EAAE,IAAI,CAAC,UAAU;4BAC3B,KAAK,EAAE,IAAI,CAAC,IAAI;4BAChB,KAAK,EAAE,IAAI,CAAC,KAAK;4BACjB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;4BAClC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;4BAChC,QAAQ,EAAE,IAAI,CAAC,QAAQ;4BACvB,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW;yBACjC;oBACH,CAAC,CAAC;oBACF,QAAQ,mCAAO,QAAQ,KAAE,MAAM,EAAE,MAAM,GAAC;iBACzC;gBACD,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;oBAC1C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;wBACf,OAAO,EAAE,qCAAqC;wBAC9C,SAAS,EAAE,qCAAqC;qBACjD,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;SACF;QACD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;QACvC,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAED;;OAEG;IACI,MAAM,CAAC,IAAI;QAChB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACjB,OAAO,EAAE,kBAAkB,IAAI,CAAC,IAAI,iBAAiB;YACrD,+BAA+B;YAC/B,MAAM,EAAE,GAAG,EAAE;gBACX,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBAC5C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;YACzC,CAAC;SACF,CAAC,CAAC;IACL,CAAC;;sHAlOU,mCAAmC;iIAAnC,mCAAmC;QCXhD,yEAA2E;QACvE,yEAAsC;QAClC,oEAAG;QAAA,uDAA6C;;QAAA,4DAAI;QACxD,4DAAM;QACN,yEAAkD;QAC9C,sEAAK;QACD,4EAAsG;QAAlC,2JAAS,2BAAuB,IAAC;QACjG,kEAAiD;QACjD,uDAA6B;;QAAA,4DAAS;QAC9C,4DAAM;QAEN,uEAAK;QACD,6EAC0D;QAA3B,4JAAS,oBAAgB,IAAC;QACrD,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACN,iIAEM;QACV,4DAAM;QACN,kIAkDM;QAGN,+JACqB;QAGrB,2IAsBW;QAGX,2IAsBW;;QA9HgD,wEAAe;QAE/D,0DAA6C;QAA7C,+JAA6C;QAMxC,0DAA6B;QAA7B,2JAA6B;QAM7B,0DACJ;QADI,qJACJ;QAGF,0DAAkB;QAAlB,kFAAkB;QAIyB,0DAAiB;QAAjB,iFAAiB;QAqDjD,0DAAuB;QAAvB,uFAAuB;QAIK,0DAA4B;QAA5B,4FAA4B;QAyB7B,0DAA2B;QAA3B,2FAA2B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IEhG/D,0EAAoG;IAChG,uGAAgK;IAA9H,6WAAoC;IAA0F,4DAAmC;IACvM,4DAAM;;;IADqE,0DAA2D;IAA3D,2HAA2D;;;;IAGtI,0EAAoG;IAChG,0GAAoK;IAA/H,gXAAoC;IAA2F,4DAAsC;IAC9M,4DAAM;;;IADwE,0DAA2D;IAA3D,2HAA2D;;;;IAGzI,0EAAoG;IAChG,qGAA8J;IAA9H,2WAAoC;IAA0F,4DAAiC;IACnM,4DAAM;;;IADmE,0DAA2D;IAA3D,2HAA2D;;;;IAEpI,0EAAoG;IAChG,uGAAmG;IAAjE,8WAAoC;IAA6B,4DAAmC;IAC1I,4DAAM;;;IADqE,0DAA2B;IAA3B,2FAA2B;;;;IAEtG,0EAAoG;IAChG,2GAAwG;IAAlE,kXAAoC;IAA8B,4DAAuC;IACnJ,4DAAM;;;IADyE,0DAA2B;IAA3B,2FAA2B;;;;IAE1G,0EAAoG;IAChG,oGAA8K;IAA/I,6WAAqC;IAA0G,4DAAgC;IAClN,4DAAM;;;IADsG,0DAA+B;IAA/B,+FAA+B;;;;IAE3I,0EAAoG;IAChG,wGAA6I;IAA1G,iXAAqC;IAAqE,4DAAoC;IACrL,4DAAM;;;IAD0G,0DAAgC;IAAhC,gGAAgC;;;;IAmC5I,0EAAoD;IAChD,0EAAwB;IACtB,oEAAG;IAAA,uDAAqC;;IAAA,4DAAI;IAC9C,4DAAM;IACN,0EAAwB;IACtB,4EAA4L;IAA3C,oWAAwC;;IAAzL,4DAA4L;IAC9L,4DAAM;IAEV,4DAAM;;;IANG,0DAAqC;IAArC,uJAAqC;IAGjC,0DAAyD;IAAzD,gLAAyD;IAAmC,oGAAoC;;;IAK7I,0EAAoD;IAChD,oEAAG;IAAA,uDAA+C;;IAAA,4DAAI;IACxD,4DAAM;;IADD,0DAA+C;IAA/C,iKAA+C;;;;IAEpD,0EAA0G;IACxG,uEAAM;IAAA,oHAAsB;IAAA,4DAAO;IACnC,uEAAM;IACN,4EAAsO;IAAhI,yTAAwB;IAA9H,4DAAsO;IACtO,6DAAC;IAAA,oEAAG;IAAA,uDAAe;IAAA,4DAAI;IACvB,4DAAO;IAET,4DAAM;;;IAJ4M,0DAAqB;IAArB,8FAAqB;IAAtG,wGAA0C;IACrK,0DAAe;IAAf,mFAAe;;;;IAKrB,0EAAsD;IACpD,4EAA2D;IAAxC,mWAAuC;IAAC,uDAAkE;;IAAA,4DAAQ;IACvI,4DAAM;;;IADe,0DAAuC;IAAvC,sGAAuC;IAAC,0DAAkE;IAAlE,oLAAkE;;;IAEjI,0EAAoD;IAChD,oEAAG;IAAA,uDAA+C;;IAAA,4DAAI;IACxD,4DAAM;;IADD,0DAA+C;IAA/C,iKAA+C;;;;IAEpD,0EAA0G;IACxG,uEAAM;IAAA,oHAAsB;IAAA,4DAAO;IACnC,uEAAM;IACN,4EAAsO;IAAhI,yTAAwB;IAA9H,4DAAsO;IACtO,6DAAC;IAAA,oEAAG;IAAA,uDAAe;IAAA,4DAAI;IACvB,4DAAO;IACT,4DAAM;;;IAH4M,0DAAqB;IAArB,+FAAqB;IAAtG,yGAA0C;IACrK,0DAAe;IAAf,oFAAe;;;;IAiBjB,sFAAuK;IAAzH,qYAAsC;;IAAmF,4DAAkB;;;IAA7D,gKAAyC;IAAvH,qGAAsC;;;;IACpF,4EAA2J;IAAvH,qWAA0B;;IAA9D,4DAA2J;;;IAAzD,mKAA4C;IAA1G,yFAA0B;;;;IAPlE,0EAAiE;IAC/D,0EAAwB;IACtB,oEAAG;IAAA,uDAAgF;;IAAA,4DAAI;IACzF,4DAAM;IACN,0EAAwB;IAEtB,iJAAyL;IACzL,6HAA2J;IAC7J,4DAAM;IAEN,0EAAwB;IACtB,oEAAG;IAAA,wDAAyC;;IAAA,4DAAI;IAClD,4DAAM;IACN,2EAAwB;IAEtB,uFAAsK;IAArJ,6XAA+C;;IAAsG,4DAAkB;IAE1L,4DAAM;IACR,4DAAM;;;IAhBC,0DAAgF;IAAhF,2NAAgF;IAIhE,0DAAyB;IAAzB,6FAAyB;IACpC,0DAAyB;IAAzB,6FAAyB;IAI9B,0DAAyC;IAAzC,6JAAyC;IAI+D,0DAAyD;IAAzD,kLAAyD;IAAnJ,8GAA+C;;;;IAtBvE,0EAAuF;IACtF,0EAAwB;IACpB,oEAAG;IAAA,uDAAuC;;IAAA,4DAAI;IAChD,4DAAM;IACN,0EAAwB;IACtB,4EAA0G;IAAvF,sVAAuC;IAAgD,6FAAc;IAAA,4DAAQ;IAClI,4DAAM;IACN,qHAkBM;IACT,4DAAM;;;IAxBE,0DAAuC;IAAvC,yJAAuC;IAGiB,0DAA8C;IAA9C,6GAA8C;IAElF,0DAAsC;IAAtC,0GAAsC;;AD9F1E,MAAM,eAAe;IAa1B,YACU,MAAc,EACd,WAAwB,EACxB,YAA0B,EAC1B,IAAqB,EACtB,WAAwB,EACvB,KAAwB,EACxB,KAAqB;QANrB,WAAM,GAAN,MAAM,CAAQ;QACd,gBAAW,GAAX,WAAW,CAAa;QACxB,iBAAY,GAAZ,YAAY,CAAc;QAC1B,SAAI,GAAJ,IAAI,CAAiB;QACtB,gBAAW,GAAX,WAAW,CAAa;QACvB,UAAK,GAAL,KAAK,CAAmB;QACxB,UAAK,GAAL,KAAK,CAAgB;QAf/B,SAAI,GAAQ,EAAE,CAAC;QACf,cAAS,GAAQ,EAAE,CAAC;QACpB,kBAAa,GAA8B,CAAC,CAAC;QAezC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK;QAChE,IAAI,CAAC,SAAS,qBAAO,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAG/C,IAAG,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,EAAE;YAC3B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,MAAM,CAAC;SACxD;QACD,IAAG,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,EAAE;YAC3B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,MAAM,CAAC;YACvD,IAAI,CAAC,aAAa,EAAE;SACrB;QAED,IAAG,IAAI,CAAC,SAAS,CAAC,sBAAsB,EAAE;YACzC,IAAG,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC;gBAAI,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY;YAC9E,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAK,CAAC;gBAAG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU;YAC5E,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,EAAE;YAC5B,IAAI,CAAC,aAAa,EAAE;SACrB;IACL,CAAC;IAED,QAAQ;IACP,CAAC;IAED;;;OAGG;IACJ,eAAe,CAAC,EAAE;QACd,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAC,EAAE,EAAC,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,gBAAgB,IAAI,EAAC,IAAI,EAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;aAC/H,IAAI,CAAC,GAAG,EAAE;YACP,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,EAAC,EAAE;gBAC7C,IAAI,IAAI,EAAE;oBACR,IAAI,IAAI,GAAG;wBACT,KAAK,EAAC,IAAI;wBACV,IAAI,EAAG,IAAI,CAAC,SAAS,CAAC,IAAI;wBAC1B,IAAI,EAAG,IAAI,CAAC,SAAS,CAAC,IAAI;qBAC1B;oBACF,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,2BAA2B,EAAE,eAAe,CAAC,CAAC;oBAC/E,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,kDAAkD,CAAC,EAAC,EAAC,KAAK,EAAC,IAAI,EAAC,CAAC;iBACxF;YACH,CAAC,EAAE,KAAK,CAAC,EAAE;gBACT,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,sBAAsB,EAAE,aAAa,CAAC;YACzE,CAAC,CAAC;QACR,CAAC,EACD,GAAG,EAAE,GAAE,CAAC,CACT,CAAC;IACN,CAAC;IACD;;OAEG;IACH,aAAa,CAAC,KAAK;QACjB,IAAG,KAAK;YAAE,IAAI,CAAC,aAAa,EAAE;IAChC,CAAC;IACD;;OAEG;IACH,aAAa;QACX,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YACxC,IAAG,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC;gBAAE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QACvJ,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;;OAGG;IACH,UAAU,CAAC,QAAQ;QACjB,0BAA0B;QAC1B,IAAI,SAAc,CAAC;QAEnB,IAAG,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,EAAE;YAC3B,SAAS,GAAG;gBACV,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU;gBACrC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ;gBACjC,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM;gBAC7B,kBAAkB,EAAE,IAAI,CAAC,SAAS,CAAC,kBAAkB;gBACrD,QAAQ,EAAE,QAAQ,CAAC,OAAO;gBAC1B,aAAa,EAAE,QAAQ,CAAC,QAAQ;aACjC;SACF;aAAM,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,EAAE;YACnC,SAAS,GAAG;gBACV,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU;gBACrC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ;gBACjC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM;gBAC7B,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,aAAa,EAAE,QAAQ;gBACvB,kBAAkB,EAAE,IAAI,CAAC,SAAS,CAAC,kBAAkB;gBACrD,gBAAgB,EAAE,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC;gBAC5D,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,eAAe;aAEhD;SACF;aAAM,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,EAAC;YAClC,SAAS,GAAE;gBACT,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU;gBACrC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ;gBACjC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM;gBAC7B,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,QAAQ,EAAE,QAAQ;aACnB;SACF;aAAM,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,EAAC;YAClC,SAAS,GAAE;gBACT,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU;gBACrC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ;gBACjC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM;gBAC7B,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,QAAQ,EAAE,QAAQ;aACnB;SACF;aAAM,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,EAAC;YAClC,SAAS,GAAE;gBACT,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU;gBACrC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ;gBACjC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM;gBAC7B,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,sBAAsB,EAAE,IAAI,CAAC,SAAS,CAAC,sBAAsB;gBAC7D,QAAQ,EAAE,QAAQ;gBAClB,UAAU,EAAG,IAAI,CAAC,YAAY;aAC/B;YACD,IAAG,IAAI,CAAC,SAAS,CAAC,sBAAsB;gBAAE,SAAS,CAAC,yBAAyB,CAAC,GAAI,IAAI,CAAC,SAAS,CAAC,uBAAuB;SACzH;aACK;YACJ,SAAS,GAAE;gBACT,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU;gBACrC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ;gBACjC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM;gBAC7B,sBAAsB,EAAE,IAAI,CAAC,SAAS,CAAC,sBAAsB;gBAC7D,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;gBACzB,QAAQ,EAAE,QAAQ;aACnB;YACD,IAAG,IAAI,CAAC,SAAS,CAAC,sBAAsB;gBAAE,SAAS,CAAC,yBAAyB,CAAC,GAAI,IAAI,CAAC,SAAS,CAAC,uBAAuB;SACzH;QACD,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;aACxI,IAAI,CAAC,GAAG,EAAE;YACT,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE,EAAE,qBAAqB,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBAClE,IAAI,SAAS,CAAC,sBAAsB,EAAE;oBAClC,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,EAAE,EAAE;wBAC7B,OAAQ,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,0CAA0C,CAAC,EAAE,EAAE,aAAa,CAAC,CAAC;qBACxK;yBACI;wBACH,QAAQ,SAAS,CAAC,IAAI,EAAE;4BACtB,KAAK,CAAC,CAAC;4BACP,KAAK,CAAC,CAAC,CAAC;gCACL,IAAG,CAAC,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,EAAE;oCACnC,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAC,uBAAuB,EAAE,aAAa,CAAC,CAAC;iCAC3H;qCAAM;oCACL,SAAS,mCAAQ,SAAS,KAAE,YAAY,EAAE,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,GAAC;oCACrF,OAAO,SAAS,CAAC,QAAQ;oCACzB,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC;oCAC/B,MAAM;iCACP;6BACF;4BACD,KAAK,CAAC,CAAC,CAAC;gCACJ,IAAI,OAAO,GAAI,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC;gCACxD,IAAG,OAAO,GAAE,GAAG,IAAI,OAAO,GAAG,CAAC,EAAE;oCAC/B,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAC,4BAA4B,EAAE,aAAa,CAAC,CAAC;iCAC/H;qCACI,IAAG,IAAI,CAAC,SAAS,CAAC,cAAc,KAAK,SAAS,EAAE;oCACnD,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAC,yBAAyB,EAAE,aAAa,CAAC,CAAC;iCAC7H;qCACI;oCACD,SAAS,mCAAQ,SAAS,KAAE,cAAc,EAAE,OAAO,GAAC;oCACpD,OAAO,SAAS,CAAC,QAAQ;oCACzB,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC;oCAC/B,MAAM;iCACP;6BACN;yBACF;qBACF;iBACF;qBACA;oBACD,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,EAAE,EAAE;wBAC7B,OAAQ,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,0CAA0C,CAAC,EAAE,EAAE,aAAa,CAAC,CAAC;qBAC1K;yBAAM,IAAG,SAAS,CAAC,IAAI,KAAK,CAAC,IAAI,SAAS,CAAC,QAAQ,CAAC,MAAM,IAAI,CAAC;wBAAE,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,qCAAqC,CAAC,EAAE,EAAE,aAAa,CAAC,CAAC;yBAChO,IAAG,SAAS,CAAC,IAAI,IAAI,CAAC,IAAI,SAAS,CAAC,aAAa,CAAC,MAAM,IAAI,CAAC;wBAAG,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,qCAAqC,CAAC,EAAE,EAAE,aAAa,CAAC,CAAC;yBACnO;wBACJ,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC;qBAC/B;iBAAC;YACN,CAAC,CAAC;QACJ,CAAC,EAAE,GAAG,EAAE,GAAE,CAAC,CAAC;IACd,CAAC;IAED;;;OAGG;IACH,eAAe,CAAC,SAAS;QACvB,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC;aACzD,IAAI,CAAC,CAAC,KAAK,EAAC,EAAE;YACT,IAAI,KAAK,EAAE;gBACT,IAAI,IAAI,GAAG;oBACT,KAAK,EAAC,IAAI;oBACV,IAAI,EAAG,IAAI,CAAC,SAAS,CAAC,IAAI;oBAC1B,IAAI,EAAG,IAAI,CAAC,SAAS,CAAC,IAAI;iBAC1B;gBACF,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,kDAAkD,CAAC,EAAC,EAAC,KAAK,EAAC,IAAI,EAAC,CAAC;gBACvF,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC;aAChC;QACH,CAAC,EAAC,KAAK,GAAE;YAEP,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,2BAA2B,EAAE,aAAa,CAAC,CAAC;YAC7E,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;IACb,CAAC;IAID;;OAEG;IACH,YAAY,CAAC,KAAK;QAChB,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC;YAC7D,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,2DAA2D,CAAC,EAAE,IAAI,CAAC;iBAC1H,IAAI,CAAC,GAAG,EAAE;gBACT,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU;YAClD,CAAC,CAAC;;YACD,IAAI,CAAC,SAAS,CAAC,UAAU,GAAG,KAAK;IAExC,CAAC;IACD;;OAEG;IACH,UAAU,CAAC,KAAK;QACd,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC;YAC/D,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,2DAA2D,CAAC,EAAE,IAAI,CAAC;iBAC1H,IAAI,CAAC,GAAG,EAAE;gBACT,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ;YAC9C,CAAC,CAAC;;YACD,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,KAAK;IACtC,CAAC;IACD;;OAEG;IACH,MAAM,CAAC,KAAK;QACV,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;IAC7B,CAAC;IAED,2BAA2B;IAC3B,MAAM;QACJ,qBAAqB;QACrB,sRAAsR;QACtR,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,kDAAkD,CAAC,EAAE,EAAC,KAAK,EAAC,IAAI,CAAC,SAAS,EAAC,CAAC;IACpG,CAAC;IAED;;;;;OAKG;IACI,UAAU,CAAC,IAAI;QACpB,QAAQ,IAAI,EAAE;YACZ,KAAK,CAAC,CAAC,CAAC,OAAO,eAAe;YAC9B,KAAK,CAAC,CAAC,CAAC,OAAO,oBAAoB;YACnC,KAAK,CAAC,CAAC,CAAC,OAAO,mBAAmB;YAClC,KAAK,CAAC,CAAC,CAAC,OAAO,sCAAsC;YACrD,KAAK,CAAC,CAAC,CAAC,OAAO,uCAAuC;YACtD,KAAK,CAAC,CAAC,CAAC,OAAO,iCAAiC;YAChD,KAAK,CAAC,CAAC,CAAC,OAAO,qCAAqC;SACrD;IACH,CAAC;IAED,UAAU,CAAC,CAAE;QACX,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;QACrB,IAAI,CAAC,SAAS,CAAC,kBAAkB,GAAG,CAAC;IAEvC,CAAC;IAED,YAAY;QACV,IAAG,IAAI,CAAC,SAAS,CAAC,kBAAkB,IAAI,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC,kBAAkB,GAAG,IAAI,CAAC,WAAW;YAAE,IAAI,CAAC,SAAS,CAAC,kBAAkB,GAAG,IAAI,CAAC,WAAW;IAC5J,CAAC;;8EAzSU,eAAe;6GAAf,eAAe;QCb5B,yEAA4D;QAAnB,oIAAS,YAAQ,IAAC;QACvD,kEAA+C;QAAA,uDACnD;;QAAA,4DAAM;QAEN,+EAAiC;QAC7B,yEAAmB;QACf,yEAAwB;QAEpB,2GAEM;QAEN,2GAEM;QAEN,2GAEM;QACN,6GAEM;QACN,6GAEM;QACN,6GAEM;QACN,6GAEM;QACV,4DAAM;QACN,0EAAyB;QACrB,0EAAsD;QAClD,0EAA2C;QACvC,6EAAiE;QAAzC,wIAAS,sCAA8B,IAAC;QAAC,oEAAoE;QAAC,qEAAG;QAAA,4DAAS;QACtJ,4DAAM;QACN,2EAAyB;QACrB,qEAAG;QAAA,wDAAkC;;QAAA,4DAAI;QAC7C,4DAAM;QACN,2EAAwB;QACpB,6EAAmG;QAA9B,4LAA4B;;QAAjG,4DAAmG;QACvG,4DAAM;QAEN,2EAAwB;QACpB,qEAAG;QAAA,wDAA+B;;QAAA,4DAAI;QAC1C,4DAAM;QACN,2EAAwB;QACpB,sFACyC;QAAvC,sKAAiB,wBAAoB,IAAC;QAAC,4DAAiB;QAC5D,4DAAM;QACR,2EAAwB;QACpB,qEAAG;QAAA,wDAA6B;;QAAA,4DAAI;QACxC,4DAAM;QACN,2EAAwB;QACpB,sFACuC;QAArC,sKAAiB,sBAAkB,IAAC;QAAC,4DAAiB;QAC1D,4DAAM;QACR,2EAAwB;QACpB,qEAAG;QAAA,wDAAiC;;QAAA,4DAAI;QAC5C,4DAAM;QACN,2EAAwB;QACpB,wEAAmG;QACvG,4DAAM;QACN,8GAQM;QAEN,8GAEQ;QACN,8GAOM;QAEN,8GAEM;QACR,8GAEQ;QACN,8GAMM;QAET,8GA0BM;QACT,4DAAM;QACV,4DAAM;QACV,4DAAM;QACV,4DAAY;;QAjIuC,0DACnD;QADmD,oJACnD;QAMkB,0DAAyB;QAAzB,yFAAyB;QAIzB,0DAAyB;QAAzB,yFAAyB;QAIzB,0DAAyB;QAAzB,yFAAyB;QAGzB,0DAAyB;QAAzB,yFAAyB;QAGzB,0DAAyB;QAAzB,yFAAyB;QAGzB,0DAAyB;QAAzB,yFAAyB;QAGzB,0DAAyB;QAAzB,yFAAyB;QAUpB,0DAAkC;QAAlC,+JAAkC;QAG9B,0DAAoD;QAApD,8KAAoD;QAAU,uFAA4B;QAI9F,0DAA+B;QAA/B,mJAA+B;QAGwB,0DAAgC;QAAhC,6FAAgC;QAIvF,0DAA6B;QAA7B,iJAA6B;QAG0B,0DAA8B;QAA9B,2FAA8B;QAIrF,0DAAiC;QAAjC,qJAAiC;QAGM,0DAAoC;QAApC,qGAAoC;QAEzD,0DAAyB;QAAzB,yFAAyB;QAUzB,0DAAyB;QAAzB,yFAAyB;QAGvB,0DAAyB;QAAzB,yFAAyB;QASxB,0DAAyB;QAAzB,yFAAyB;QAG5B,0DAAyB;QAAzB,yFAAyB;QAGvB,0DAAyB;QAAzB,yFAAyB;QAQvC,0DAAuE;QAAvE,+IAAuE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IE1FpF,2EACY;;;;IADoC,kFAAsB;;;;IAmDtE,yEAAoI;IAAnE,0YAAyC;IACtG,yEAAiB;IAAA,uDAAO;IAAA,4DAAK;IAC7B,yEAAkB;IAAA,uDAAkB;IAAA,4DAAK;IACzC,yEAAkB;IAAA,uDAAkD;;IAAA,4DAAK;IACzE,yEAAkB;IAAA,uDAAiD;;IAAA,4DAAK;IACxE,0EAAkB;IAAA,wDAAqC;;IAAA,4DAAK;IAC5D,0EAAkB;IACd,iFAAmI;IAAxH,2JAAS,wBAAwB,IAAC;IAAsF,4DAAY;IACnJ,4DAAK;IACT,4DAAK;;;;IARgB,0DAAO;IAAP,yEAAO;IACN,0DAAkB;IAAlB,kFAAkB;IAClB,0DAAkD;IAAlD,6KAAkD;IAClD,0DAAiD;IAAjD,4KAAiD;IACjD,0DAAqC;IAArC,4JAAqC;IAEL,0DAA8B;IAA9B,wFAA8B;;;;ADzD7F,MAAM,mBAAmB;IAgB9B,YACU,MAAc,EACd,YAA0B,EAC1B,KAAwB,EACxB,WAAwB,EACxB,WAAwB;QAJxB,WAAM,GAAN,MAAM,CAAQ;QACd,iBAAY,GAAZ,YAAY,CAAc;QAC1B,UAAK,GAAL,KAAK,CAAmB;QACxB,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAa;QApB3B,eAAU,GAAU,EAAE,CAAC;QAEvB,SAAI,GAAW,CAAC,IAAI,IAAI,EAAE,EAAE,IAAI,IAAI,EAAE,CAAC,CAAC;QAC/C,SAAI,GAAQ,KAAK;QACjB,oBAAe,GAAe;YAC5B,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE;YAC7B,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,oBAAoB,EAAE;YACxC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,qBAAqB,EAAE;YACzC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,mBAAmB,EAAE;YACvC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,sCAAsC,EAAE;YAC1D,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,uCAAuC,EAAE;YAC3D,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,iCAAiC,EAAE;YACrD,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,qCAAqC,EAAE;SAC1D;QACD,gBAAW,GAAQ,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK;QAmHlE,2BAA2B;QAC3B,YAAO,GAAG,KAAK,CAAC;QAChB,kBAAa,GAAG,KAAK,CAAC;QACtB,gBAAW,GAAG,KAAK,CAAC;QACpB,mBAAc,GAAG,KAAK,CAAC;IAhHnB,CAAC;IAEL,QAAQ;QACN,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;QACrC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI;YACjC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI;YACjC,oFAAoF;YACpF,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK;gBAAE,IAAI,CAAC,6BAA6B,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC;;gBAC/J,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI;SAC7C;IACH,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;YACzC,IAAI,CAAC,6BAA6B,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC;QAChJ,CAAC,CAAC;IACJ,CAAC;IAGD;;OAEG;IACH,6BAA6B,CAAC,QAAQ,EAAE,MAAM,EAAE,IAAI,EAAE,KAAM;QAC1D,IAAI,CAAC,YAAY,CAAC,6BAA6B,CAAC,QAAQ,EAAE,MAAM,EAAE,IAAI,CAAC;aACpE,IAAI,CAAC,CAAC,QAAQ,EAAE,EAAE;YACjB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;gBAClF,uCACK,IAAI,KACP,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,IACxC;YACH,CAAC,CAAC;YAGF,IAAI,KAAK;gBAAE,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE;QAC3C,CAAC,EAAE,GAAG,CAAC,EAAE,GAAE,CAAC,CAAC;IACjB,CAAC;IACD;;OAEG;IACH,UAAU,CAAC,KAAK;QACd,IAAI,CAAC,IAAI,GAAG,KAAK;IACnB,CAAC;IACD;;OAEG;IACH,UAAU,CAAC,KAAK;QACd,IAAI,CAAC,IAAI,GAAG,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IACtD,CAAC;IACD,gCAAgC;IAChC;;OAEG;IACH,YAAY;QACV,IAAI,IAAI,GAAG;YACT,IAAI,EAAE,IAAI,CAAC,UAAU;YACrB,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,IAAI,EAAE,IAAI,CAAC,IAAI;SAChB;QACD,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,sDAAsD,CAAC,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;IAClG,CAAC;IACD;;OAEG;IACH,oBAAoB,CAAC,SAAS;QAC5B,IAAI,IAAI,GAAG;YACT,SAAS,EAAE,SAAS;YACpB,IAAI,EAAE,IAAI,CAAC,UAAU;YACrB,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,IAAI,EAAE,IAAI,CAAC,IAAI;SAChB;QACD,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,yDAAyD,CAAC,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;IACpG,CAAC;IACD;;OAEG;IACI,UAAU,CAAC,IAAI;QACpB,QAAQ,IAAI,EAAE;YACZ,KAAK,CAAC,CAAC,CAAC,OAAO,oBAAoB;YACnC,KAAK,CAAC,CAAC,CAAC,OAAO,qBAAqB;YACpC,KAAK,CAAC,CAAC,CAAC,OAAO,mBAAmB;YAClC,KAAK,CAAC,CAAC,CAAC,OAAO,sCAAsC;YACrD,KAAK,CAAC,CAAC,CAAC,OAAO,uCAAuC;YACtD,KAAK,CAAC,CAAC,CAAC,OAAO,iCAAiC;YAChD,KAAK,CAAC,CAAC,CAAC,OAAO,qCAAqC;SACrD;IACH,CAAC;IACD;;OAEG;IACI,YAAY,CAAC,GAAG,EAAE,KAAK;QAC5B,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,GAAG,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;IACtE,CAAC;IACD,kBAAkB;QAChB,IAAI,QAAQ,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAAC,YAAY,IAAI,QAAQ,CAAC,aAAa,CAAC,yBAAyB,CAAC,IAAI,QAAQ,CAAC,aAAa,CAAC,kBAAkB,CAAC,IAAI,QAAQ,CAAC,aAAa,CAAC,uBAAuB,CAAC,EAAE;YACzN,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAAC,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,yBAAyB,CAAC,CAAC,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,kBAAkB,CAAC,CAAC,YAAY;kBACzM,QAAQ,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC,YAAY,GAAG,EAAE,GAAG,IAAI,CAAC;SAC9E;QACD,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;IAC7B,CAAC;IACD,MAAM;QACJ,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,uCAAuC,CAAC,CAAC,CAAC;IAClE,CAAC;IAOD;;;OAGG;IACH,SAAS,CAAC,OAAO;QACf,QAAQ,OAAO,EAAE;YACf,KAAK,MAAM;gBACT,IAAI,IAAI,CAAC,OAAO,EAAE;oBAChB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,CAAC;iBACvF;qBAAM;oBACL,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,CAAC;iBACxF;gBACD,MAAM;YACR,KAAK,YAAY;gBACf,IAAI,IAAI,CAAC,aAAa,EAAE;oBACtB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,CAAC;iBACjF;qBAAM;oBACL,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,CAAC;iBAClF;gBACD,MAAM;YACR,KAAK,UAAU;gBACb,IAAI,IAAI,CAAC,WAAW,EAAE;oBACpB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,CAAC;iBACjF;qBAAM;oBACL,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,CAAC;iBAClF;gBACD,MAAM;YACR,KAAK,aAAa;gBAChB,IAAI,IAAI,CAAC,cAAc,EAAE;oBACvB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,CAAC;iBACvF;qBAAM;oBACL,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,CAAC;iBACxF;gBACD,MAAM;SACT;IACH,CAAC;;sFA1KU,mBAAmB;iHAAnB,mBAAmB;QCXhC,yEAA4D;QAAnB,wIAAS,YAAQ,IAAC;QACvD,kEAA+C;QAAA,uDACnD;;QAAA,4DAAM;QACN,+EAAwC;QACpC,yEAA2C;QACvC,yEAAsD;QAClD,oEAAG;QAAA,uDAA2B;;QAAA,4DAAI;QACtC,4DAAM;QACN,0EAAwD;QACpD,gFAAgF;QAArE,0LAAkB,6GAAkB,sBAAkB,IAApC;QACzB,6HACY;QAChB,4DAAY;QAChB,4DAAM;QACN,0EAA+C;QAC3C,wDACA;;QAAA,sFAA+F;QAAxD,gMAAkB,mHAAkB,sBAAkB,IAApC;QAAsC,4DAAkB;QACrH,4DAAM;QACN,2EAA8D;QAC1D,2EAA0B;QACtB,8EAAwG;QAA3B,4IAAS,oBAAgB,IAAC;QACnG,2EAAoF;QACpF,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACN,2EAA0B;QACtB,8EAA8G;QAAzB,4IAAS,kBAAc,IAAC;QACzG,2EAAwE;QACxE,wDACJ;;QAAA,4DAAS;QACb,4DAAM;QACV,4DAAM;QACV,4DAAM;QACN,2EAA+B;QAC3B,uEAAK;QAAA,wDAAsB;;QAAA,4EAA0B;QAAC,wDAAsB;QAAA,4DAAO;QAAA,wDACnF;;QAAA,4DAAM;QACN,oFAA6N;;QACzN,yEAAO;QACH,sEAAI;QACA,0EAAiB;QAAA,qEAAG;QAAA,wDAAmB;;QAAA,4DAAI;QAAA,4DAAK;QAChD,0EAA0F;QAA/C,oKAA4B,cAAU,MAAM,CAAC,IAAC;QACrF,qEAAG;QAAA,wDAAiC;;QAAA,4DAAI;QACxC,oEAAsF;QAC1F,4DAAK;QACL,0EAA4G;QAAjE,gLAAwC,cAAU,YAAY,CAAC,IAAC;QACvG,qEAAG;QAAA,wDAA+B;;QAAA,4DAAI;QACtC,oEAA4F;QAChG,4DAAK;QACL,0EAAsG;QAA3D,4KAAoC,cAAU,UAAU,CAAC,IAAC;QACjG,qEAAG;QAAA,wDAA6B;;QAAA,4DAAI;QACpC,oEAA0F;QAC9F,4DAAK;QACL,0EAA+G;QAApE,kLAA0C,cAAU,aAAa,CAAC,IAAC;QAC1G,qEAAG;QAAA,wDAAiC;;QAAA,4DAAI;QACxC,oEAA6F;QACjG,4DAAK;QACL,0EAAkB;QACd,qEAAG;QAAA,wDAAsB;;QAAA,4DAAI;QAAA,4DAAK;QAC1C,4DAAK;QACT,4DAAQ;QACR,yEAAO;QACH,kHASK;QACT,4DAAQ;QACZ,4DAAW;QACf,4DAAM;QACV,4DAAY;;;QAzEuC,0DACnD;QADmD,oJACnD;QAIe,0DAA2B;QAA3B,+IAA2B;QAGnB,0DAAkB;QAAlB,6EAAkB;QACG,0DAAkB;QAAlB,wFAAkB;QAKlD,0DACA;QADA,+JACA;QAAuC,0DAAkB;QAAlB,6EAAkB;QAMjD,0DACJ;QADI,qJACJ;QAKI,0DACJ;QADI,oJACJ;QAKH,0DAAsB;QAAtB,2IAAsB;QAA2B,0DAAsB;QAAtB,iGAAsB;QAAO,0DACnF;QADmF,0JACnF;QACsL,0DAAsC;QAAtC,+JAAsC;QAAlN,0EAAiB;QAGK,0DAAmB;QAAnB,uIAAmB;QAEhC,0DAAiC;QAAjC,qJAAiC;QACzB,0DAAoD;QAApD,mHAAoD;QAG5D,0DAA+B;QAA/B,mJAA+B;QACvB,0DAA0D;QAA1D,yHAA0D;QAGlE,0DAA6B;QAA7B,iJAA6B;QACrB,0DAAwD;QAAxD,uHAAwD;QAGhE,0DAAiC;QAAjC,qJAAiC;QACzB,0DAA2D;QAA3D,0HAA2D;QAGnE,0DAAsB;QAAtB,4IAAsB;QAIP,0DAAwB;QAAxB,6EAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5DnB;AACc;AACV;AACI;AACW;AACH;AACT;AACT;AACiD;AAClC;AACH;AACL;AACqD;AACY;AACiB;AACH;AACS;AACjB;AACO;AACA;AACT;AACb;AACgB;AACe;AACG;AACT;;;AACrI,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,sEAAmB;KAC/B;IACD;QACE,IAAI,EAAE,KAAK;QACX,SAAS,EAAE,4DAAY;QACvB,aAAa,EAAE,CAAC,8DAAY,CAAC;KAC9B;IACD;QACE,IAAI,EAAE,QAAQ;QACd,SAAS,EAAE,qEAAe;KAC3B;CACF;AAeM,MAAM,gBAAgB;;gFAAhB,gBAAgB;8GAAhB,gBAAgB;kHAXlB;YACP,0DAAY;YACZ,mEAAqB,CAAC,MAAM,CAAC;YAC7B,wDAAW;YACX,gEAAmB;YACnB,yEAAgB;YAChB,iEAAe;YACf,wDAAW;YACX,oEAAe;SAChB;oIAEU,gBAAgB,mBAZZ,sEAAmB,EAAE,4DAAY,EAAE,uGAAsB,EAAE,qEAAe,EAAE,kHAAyB,EAAE,8HAA6B,EAAE,+IAAkC,EAAE,4IAAiC,EAAE,sJAAoC,EAAE,qIAA+B,EAAE,4IAAkC,EAAE,4IAAkC,EAAE,mIAA+B,EAAE,sHAA0B,EAAE,sIAAgC,EAAE,qJAAqC,EAAE,wJAAsC,EAAE,+IAAmC,aAE1jB,0DAAY,8DAEZ,wDAAW;QACX,gEAAmB;QACnB,yEAAgB;QAChB,iEAAe;QACf,wDAAW;QACX,oEAAe","sources":["./src/app/sales/interface/vh-promotions-money-rate.ts","./src/app/sales/menu/manage/sales-program/promotions/add/add.component.ts","./src/app/sales/menu/manage/sales-program/promotions/add/add.component.html","./src/app/sales/menu/manage/sales-program/promotions/components/discount-many-products/discount-many-products.component.ts","./src/app/sales/menu/manage/sales-program/promotions/components/discount-many-products/discount-many-products.component.html","./src/app/sales/menu/manage/sales-program/promotions/components/discount-percent-product/discount-percent-product.component.ts","./src/app/sales/menu/manage/sales-program/promotions/components/discount-percent-product/discount-percent-product.component.html","./src/app/sales/menu/manage/sales-program/promotions/components/discount-percent-total-product/discount-percent-total-product.component.ts","./src/app/sales/menu/manage/sales-program/promotions/components/discount-percent-total-product/discount-percent-total-product.component.html","./src/app/sales/menu/manage/sales-program/promotions/components/discount-price-each-product/discount-price-each-product.component.ts","./src/app/sales/menu/manage/sales-program/promotions/components/discount-price-each-product/discount-price-each-product.component.html","./src/app/sales/menu/manage/sales-program/promotions/components/discount-price-total-invoice/discount-price-total-invoice.component.ts","./src/app/sales/menu/manage/sales-program/promotions/components/discount-price-total-invoice/discount-price-total-invoice.component.html","./src/app/sales/menu/manage/sales-program/promotions/components/discount-same-price/discount-same-price.component.ts","./src/app/sales/menu/manage/sales-program/promotions/components/discount-same-price/discount-same-price.component.html","./src/app/sales/menu/manage/sales-program/promotions/components/discount-take-gift/discount-take-gift.component.ts","./src/app/sales/menu/manage/sales-program/promotions/components/discount-take-gift/discount-take-gift.component.html","./src/app/sales/menu/manage/sales-program/promotions/components/search-product/search-product.component.ts","./src/app/sales/menu/manage/sales-program/promotions/components/search-product/search-product.component.html","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-each-product/detail-discount-each-product.component.ts","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-each-product/detail-discount-each-product.component.html","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-many-product/detail-discount-many-product.component.ts","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-many-product/detail-discount-many-product.component.html","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-percent-product/detail-discount-percent-product.component.ts","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-percent-product/detail-discount-percent-product.component.html","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-percent-products/detail-discount-percent-products.component.ts","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-percent-products/detail-discount-percent-products.component.html","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-same-price/detail-discount-same-price.component.ts","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-same-price/detail-discount-same-price.component.html","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-take-gift/detail-discount-take-gift.component.ts","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-take-gift/detail-discount-take-gift.component.html","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-total-invoice/detail-discount-total-invoice.component.ts","./src/app/sales/menu/manage/sales-program/promotions/detail/detail-discount-total-invoice/detail-discount-total-invoice.component.html","./src/app/sales/menu/manage/sales-program/promotions/detail/detail.component.ts","./src/app/sales/menu/manage/sales-program/promotions/detail/detail.component.html","./src/app/sales/menu/manage/sales-program/promotions/promotions.component.ts","./src/app/sales/menu/manage/sales-program/promotions/promotions.component.html","./src/app/sales/menu/manage/sales-program/promotions/promotions.module.ts"],"sourcesContent":["export interface VhPromotion {\r\n    name: string;\r\n    date_start: string;\r\n    date_end: string;\r\n    status: boolean;\r\n    type: 1 | 2; // 1: Giảm giá tiền, 2: Giảm giá %\r\n    _id?: string;\r\n}\r\nexport interface VhPromotionDetail {\r\n    id_product: string;\r\n    _id?: string;\r\n    id_promotions?: string;\r\n    discount: number;\r\n    new_price: number;\r\n    price?: number;\r\n    img?: string;\r\n    name?: string\r\n}\r\nexport class VhPromotions {\r\n    private date: Date = new Date();\r\n    private promotions: VhPromotion = {\r\n        name: '',\r\n        date_start: this.date.toISOString(),\r\n        date_end: this.date.toISOString(),\r\n        status: true,\r\n        type: 1, // 1: Giảm giá tiền, 2: Giảm giá %\r\n        _id: null\r\n    }\r\n    private promotionsDetail: VhPromotionDetail[] = []\r\n\r\n    constructor(promotion: any = null, promotionDetail: any[] = null) {\r\n        if (promotion) {\r\n            this.promotions['date_start'] = promotion['date_start'] ? promotion['date_start'] : this.date.toISOString()\r\n            this.promotions['date_end'] = promotion['date_end'] ? promotion['date_end'] : this.date.toISOString()\r\n            this.promotions['status'] = promotion['status'] ? promotion['status'] : true\r\n            this.promotions['type'] = promotion['type'] ? promotion['type'] : 1\r\n            this.promotions['name'] = promotion['name'] ? promotion['name'] : ''\r\n            this.promotions['_id'] = promotion['_id'] ? promotion['_id'] : null\r\n        }\r\n        if (promotionDetail) {\r\n            this.promotionsDetail = promotionDetail\r\n        }\r\n    }\r\n\r\n    /************************************XỬ lý *******************************************/\r\n    public getName(): string {\r\n        return this.promotions.name;\r\n    }\r\n    public setName(value: string) {\r\n        this.promotions.name = value\r\n    }\r\n    public getType(): 1 | 2 {\r\n        return this.promotions.type;\r\n    }\r\n    public setType(value: 1 | 2) {\r\n        this.promotions.type = value\r\n    }\r\n    public getDateStart(): string {\r\n        return this.promotions.date_start;\r\n    }\r\n    public setDateStart(value: string | Date) {\r\n        this.promotions.date_start = typeof value == 'string' ? value : value.toISOString()\r\n    }\r\n    public getDateEnd(): string {\r\n        return this.promotions.date_end;\r\n    }\r\n    public setDateEnd(value: string | Date) {\r\n        this.promotions.date_end = typeof value == 'string' ? value : value.toISOString()\r\n    }\r\n    public getID(): string {\r\n        return this.promotions._id\r\n    }\r\n\r\n    public addPromotionsDetail(product): boolean {\r\n        let item = this.promotionsDetail.find(element => element.id_product == product._id)\r\n        if (item) return false\r\n        else {\r\n            this.promotionsDetail.push({\r\n                name: product.name,\r\n                id_product: product._id,\r\n                discount: 0,\r\n                price: product.price,\r\n                new_price: product.price,\r\n                img: product.img\r\n            })\r\n            return true\r\n        }\r\n    }\r\n    public removePromotionsDetail(id) {\r\n        this.promotionsDetail.splice(this.promotionsDetail.findIndex(detail => detail['id_product'] == id), 1);\r\n    }\r\n\r\n    public getPromotionsDetail(): VhPromotionDetail[] {\r\n        return this.promotionsDetail\r\n    }\r\n    /************************************XỬ lý *******************************************/\r\n\r\n    /******************************create - update - delete invoice / detail *******************************/\r\n    public getCreateUpdatePromotions() {\r\n        return this.promotions\r\n    }\r\n    public getCreateUpdatePromotionsDetail(): VhPromotionDetail[] {\r\n        return this.promotionsDetail.map(item => {\r\n            return { id_product: item.id_product, new_price: item.new_price, discount: item.discount }\r\n        })\r\n    }\r\n}","import {Component } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { Observable } from 'rxjs';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-add',\r\n  templateUrl: './add.component.html',\r\n  styleUrls: ['./add.component.scss']\r\n})\r\nexport class AddComponent {\r\n  public startTimeBackup: string = (new Date(new Date().setHours(0, 0, 0, 0))).toISOString();\r\n  public endTimeBackup: string = (new Date(new Date().setHours(23, 59, 59, 59))).toISOString();\r\n  tableHeight: any;\r\n  checked_customer: false;\r\n  checked_member: false;\r\n  visible_add: boolean = false;\r\n  promotion_all_products: boolean = false;\r\n  price_reduce:any;\r\n  percent_reduce:any;\r\n  billTotal: any;\r\n  promotions_maximum: number = 0;\r\n  gift_length: number = 0;\r\n  list: Array<any> = [\r\n    { value: 1, name: \"Discount in amount\" },\r\n    { value: 2, name: \"Discount in percent\" }, \r\n    { value: 3, name: \"Sản phẩm đồng giá\" }, \r\n    { value: 4, name: \"Giảm giá tiền khi mua đủ SL sản phẩm\"},\r\n    { value: 5, name: \"Giảm phần trăm khi mua đủ SL sản phẩm\"},\r\n    { value: 6, name: \"Tặng quà khi mua nhiều sản phẩm\"},\r\n    { value: 7, name: \"Tặng quà theo tổng giá trị đơn hàng\"},\r\n  ]\r\n  percent: number = 0;\r\n  promotionType: 1 | 2 | 3 | 4 | 5 | 6 | 7 = 1;\r\n  promotion_name: string = '';\r\n  discount_price: any;\r\n  dataStore:any;\r\n  quantity_promotions_all = 1;\r\n  variable_enable = false;\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    private vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private modal: NzModalService\r\n\r\n  ) {\r\n      this.dataStore = this.router.getCurrentNavigation().extras.state\r\n      this.eventKeypress()\r\n  }\r\n  /**\r\n   * bắt sk thay đổi ngày bắt đầu KM\r\n   */\r\n  setDateStart(value) {\r\n    if (Date.parse(value) - Date.parse(this.endTimeBackup) > 0)\r\n      this.vhComponent.alertMessage(\"\", \"\", this.lang.translate(\"Staring date must be less than or the same as ending date\"), \"OK\")\r\n        .then(() => {\r\n          return this.startTimeBackup\r\n        })\r\n    else this.startTimeBackup = value\r\n  }\r\n  /**\r\n   * bắt sk thay đổi ngày kết thúc KM\r\n   */\r\n  setDateEnd(value) {\r\n    if (Date.parse(value) - Date.parse(this.startTimeBackup) < 0)\r\n      this.vhComponent.alertMessage(\"\", \"\", this.lang.translate(\"Staring date must be less than or the same as ending date\"), \"OK\")\r\n        .then(() => {\r\n          return this.endTimeBackup\r\n        })\r\n    else this.endTimeBackup = value\r\n  }\r\n  /**\r\n   * bắt sk thay đổi loại KM\r\n   */\r\n  changePromotionType(value) { \r\n    this.promotion_all_products = false\r\n    this.promotionType = value;\r\n    if(value == 7) {\r\n      this.vhAlgorithm.waitingStack().then(() => {\r\n        this.billTotal = this.vhAlgorithm.vhnumeral(\".price_discout\");\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * bắt sk thiết lập áp dụng cho tất cả sp\r\n   */\r\n  setAllProduct(event){\r\n    if(event) this.initNumberral()\r\n  }\r\n  /**\r\n   * tạo cleavejs cho giá giảm để xử lý\r\n   */\r\n  initNumberral(){\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      if(this.promotionType == 1 || this.promotionType == 3) this.price_reduce = this.vhAlgorithm.vhnumeral(\".price_discout\");\r\n    });\r\n  }\r\n\r\n  goBack() {\r\n    this.isExit = true\r\n    this.vhComponent.alertConfirm(this.lang.translate(\"Confirm\"), \"\", this.lang.translate(\"Are you sure to cancel the promotions\"), \"OK\", (this.lang.translate(\"Cancel\"))).then(() => {\r\n       this.router.navigate([\"/sales/dashboard/manage/sales-program/promotions\"],{state:this.dataStore}) \r\n    }).catch(() => { });\r\n  }\r\n  eventKeypress() {\r\n    // ----lắng nghe sự kiện f4 để show nz-drawer search product----\r\n    window.addEventListener('keydown', (event: KeyboardEvent) => {\r\n      const keycode = event.keyCode;\r\n      if (keycode === 114) {\r\n        event.preventDefault();\r\n      }\r\n      if (keycode === 115) {\r\n       \r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * lưu khuyến mãi\r\n   */\r\n  SavePromt(ev) {   \r\n    // xử lý dữ liệu để lưu vào DB  cho từng loại km\r\n    let promotion: any = {};\r\n    if(this.promotionType == 6) {\r\n      promotion = {\r\n        name: this.promotion_name,\r\n        date_start: this.startTimeBackup,\r\n        date_end: this.endTimeBackup,\r\n        status: true,\r\n        type: this.promotionType,\r\n        promotions_maximum: this.promotions_maximum,\r\n        products: ev.dataBuy,\r\n        products_gift: ev.dataGift\r\n      }\r\n    } else if (this.promotionType == 7) {\r\n      promotion = {\r\n        name: this.promotion_name,\r\n        date_start: this.startTimeBackup,\r\n        date_end: this.endTimeBackup,\r\n        status: true,\r\n        type: this.promotionType,\r\n        products_gift: ev,\r\n        promotions_maximum: this.promotions_maximum,\r\n        total_bill_value: parseFloat(this.billTotal.getRawValue()),\r\n        variable_enable: this.variable_enable\r\n      }\r\n    } else if (this.promotionType == 4){\r\n      promotion= {\r\n        name: this.promotion_name,\r\n        date_start: this.startTimeBackup,\r\n        date_end: this.endTimeBackup,\r\n        status: true,\r\n        type: this.promotionType,\r\n        products: ev\r\n      }\r\n    } else if (this.promotionType == 5){\r\n      promotion= {\r\n        name: this.promotion_name,\r\n        date_start: this.startTimeBackup,\r\n        date_end: this.endTimeBackup,\r\n        status: true,\r\n        type: this.promotionType,\r\n        products: ev\r\n      }\r\n    } else if (this.promotionType == 3) {\r\n      promotion= {\r\n        name: this.promotion_name,\r\n        date_start: this.startTimeBackup,\r\n        date_end: this.endTimeBackup,\r\n        status: true,\r\n        type: this.promotionType,\r\n        promotion_all_products: this.promotion_all_products,\r\n        products: ev\r\n      }\r\n      if(this.promotion_all_products) promotion['quantity_promotions_all']  = this.quantity_promotions_all\r\n    } else {\r\n      promotion= {\r\n        name: this.promotion_name,\r\n        date_start: this.startTimeBackup,\r\n        date_end: this.endTimeBackup,\r\n        status: true,\r\n        promotion_all_products: this.promotion_all_products,\r\n        type: this.promotionType,\r\n        products: ev\r\n      }\r\n      if(this.promotion_all_products) promotion['quantity_promotions_all']  = this.quantity_promotions_all\r\n    }\r\n    \r\n\r\n    this.vhComponent.alertConfirm(this.lang.translate(\"Confirm\"), \"\", this.lang.translate(\"Save\") + \"?\", 'OK', this.lang.translate(\"Cancel\"))\r\n    .then(() => {\r\n      this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n      if (promotion.promotion_all_products) {\r\n          if (this.promotion_name == '') {\r\n              this.vhComponent.hideLoading(0).then(() => this.vhComponent.alertMessageDesktop(\"error\", `${this.lang.translate(\"Vui lòng không để trống tên khuyến mại !\")}`))\r\n            }  \r\n            else {\r\n              switch (promotion.type) {\r\n                case 1: {\r\n                  if(!this.price_reduce.getRawValue()) {\r\n                      this.vhComponent.hideLoading(0).then(() => this.vhComponent.alertMessageDesktop(\"error\", `${this.lang.translate(\"Vui lòng nhập giá trị\")}`))\r\n                  } else {\r\n                    promotion = { ...promotion, price_reduce: parseFloat(this.price_reduce.getRawValue())}\r\n                    delete promotion.products\r\n                    this.addPromotion(promotion)\r\n                    break\r\n                  }\r\n                  break;\r\n                };\r\n                case 3: {\r\n                  if(!this.price_reduce.getRawValue()) {\r\n                      this.vhComponent.hideLoading(0).then(() => this.vhComponent.alertMessageDesktop(\"error\", `${this.lang.translate(\"Vui lòng nhập giá trị\")}`))\r\n                  } else {\r\n                    promotion = { ...promotion, price_same: parseFloat(this.price_reduce.getRawValue())}\r\n                    delete promotion.products\r\n                    this.addPromotion(promotion)\r\n                    break\r\n                  }\r\n                  break;\r\n                }\r\n                case 2: {\r\n                    let percent =  parseFloat(this.percent_reduce)\r\n                    if(percent> 100 || percent < 0) {\r\n                      this.vhComponent.hideLoading(0).then(() => this.vhComponent.alertMessageDesktop(\"error\", `${this.lang.translate(\"Giá trị % <= 100 hoặc >= 0\")}`))\r\n                    }\r\n                    else if(this.percent_reduce === undefined) {\r\n                      this.vhComponent.hideLoading(0).then(() => this.vhComponent.alertMessageDesktop(\"error\", `${this.lang.translate(\"Vui lòng nhập giá trị %\")}`))\r\n                    }\r\n                    else {\r\n                      promotion = { ...promotion, percent_reduce: percent}\r\n                      delete promotion.products\r\n                      this.addPromotion(promotion)\r\n                    }\r\n                  \r\n                    break;\r\n                }               \r\n              }\r\n            }\r\n          }\r\n      else {\r\n          if (this.promotion_name == '') {\r\n            this.vhComponent.hideLoading(0).then(() => this.vhComponent.alertMessageDesktop(\"error\", `${this.lang.translate(\"Vui lòng không để trống tên khuyến mại !\")}`))\r\n          } else if (this.promotionType !== 7 && promotion.products.length == 0)\r\n            {\r\n            this.vhComponent.hideLoading(0).then(() => this.vhComponent.alertMessageDesktop(\"error\", `${this.lang.translate(\"Vui lòng thêm sản phẩm khuyến mãi !\")}`))\r\n            }\r\n          else if (\r\n            this.promotionType == 7 &&\r\n            promotion.products_gift.length == 0\r\n          ) {\r\n            this.vhComponent.hideLoading(0).then(() => this.vhComponent.alertMessageDesktop(\"error\", `${this.lang.translate(\"Vui lòng thêm sản phẩm khuyến mãi !\")}`))\r\n          } else if (this.promotionType == 7 && !promotion.total_bill_value)\r\n            this.vhComponent.hideLoading(0).then(() => this.vhComponent.alertMessageDesktop(\"error\", `${this.lang.translate(\"Vui lòng nhập giá trị hóa đơn !\")}`))\r\n\r\n          else {\r\n            this.addPromotion(promotion);\r\n          }\r\n        }\r\n      })\r\n    }, () => {})\r\n\r\n  }\r\n\r\n  /**\r\n   * thêm km vào DB\r\n   */\r\n  addPromotion(promotion){\r\n    this.vhQuerySales.addPromotion(promotion)\r\n    .then((promt)=>{\r\n       if (promt) {    \r\n        this.vhComponent.showToast(1500, `${this.lang.translate(\"Promotions\")} ${this.promotion_name} ${this.lang.translate(\"has been created successfully\")}`, \"success-toast\");\r\n           this.isExit = true\r\n           let data = {\r\n            check:true, // set true để khi quay về get lại danh sách km mới nhất\r\n            type : this.dataStore.type,\r\n            date : this.dataStore.date\r\n           }\r\n           this.router.navigate(['/sales/dashboard/manage/sales-program/promotions'],{state:data})\r\n           this.vhComponent.hideLoading(0)\r\n          }\r\n          },error=>{\r\n          this.vhComponent.hideLoading(0)\r\n          \r\n      });\r\n  }\r\n  \r\n  /** ===============Thoát trang==============*/\r\n  isExit: boolean = false;\r\n  checkDeactivate(currentRoute: ActivatedRouteSnapshot, currentState: RouterStateSnapshot, nextState?: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    return nextState.url == '/login' ? true : (this.isExit ? this.isExit : this.vhComponent.alertConfirm(this.lang.translate(\"Confirm\"), \"\", this.lang.translate(\"The changes will not be saved\"), \"OK\", (this.lang.translate(\"Cancel\"))).then(() => { return true }).catch(() => { return false }))\r\n  }\r\n\r\n  giftLength(e?) {\r\n    this.promotions_maximum = e\r\n    this.gift_length = e;\r\n  }\r\n  checkMaximum(){\r\n    if(this.promotions_maximum == null || this.promotions_maximum > this.gift_length) this.promotions_maximum = this.gift_length\r\n  }\r\n\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n  <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n\r\n<nz-layout id=\"promotion-add\">\r\n  <div class=\"sales\">\r\n    <div class=\"sales-cart\">\r\n\r\n      <div *ngIf=\"promotionType == 1\" style=\"height:100%\">\r\n        <app-discount-price-each-product (changeVl)=\"SavePromt($event)\" [promotion_all_products]=\"promotion_all_products\"></app-discount-price-each-product>\r\n      </div>\r\n      <div *ngIf=\"promotionType == 2\"  style=\"height:100%\">\r\n        <app-discount-percent-product (changeVl)=\"SavePromt($event)\" [promotion_all_products]=\"promotion_all_products\"></app-discount-percent-product>\r\n      </div>\r\n      <div *ngIf=\"promotionType == 3\"  style=\"height:100%\">\r\n        <app-discount-same-price (changeVl)=\"SavePromt($event)\"  [promotion_all_products]=\"promotion_all_products\"></app-discount-same-price>\r\n      </div>\r\n      <div *ngIf=\"promotionType == 4\"  style=\"height:100%\">\r\n        <app-discount-many-products (updateProduct)=\"SavePromt($event)\"></app-discount-many-products>\r\n      </div>\r\n      <div *ngIf=\"promotionType == 5\" style=\"height:100%\">\r\n        <app-discount-percent-total-product (updateProduct)=\"SavePromt($event)\"></app-discount-percent-total-product>\r\n      </div>\r\n      <div *ngIf=\"promotionType == 6\" style=\"height: 100%\">\r\n        <app-discount-take-gift (updateProducts)=\"SavePromt($event)\" (gift_length)=\"giftLength($event)\"></app-discount-take-gift>\r\n      </div>\r\n      <div *ngIf=\"promotionType == 7\" style=\"height:100%\">\r\n        <app-discount-price-total-invoice (updateProduct)=\"SavePromt($event)\" (gift_length)=\"giftLength($event)\"></app-discount-price-total-invoice>\r\n      </div>\r\n\r\n\r\n    </div>\r\n    <div class=\"sales-bills\">\r\n      <div nz-row class=\"sales-bills-content hideScrollbar\">\r\n        <div nz-col nzSpan=\"24\">\r\n          <b>{{'Promotions name' | translate}}*</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"24\">\r\n          <input placeholder=\"{{'Enter promotions name' |translate}}\" nz-input [(ngModel)]=\"promotion_name\" />\r\n        </div>\r\n        <div nz-col nzSpan=\"24\">\r\n          <b>{{'Starting date' | translate}}</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"24\">\r\n          <nz-date-picker nzShowTime nzFormat=\"dd/MM/yyyy HH:mm:ss\" [ngModel]=\"startTimeBackup\"\r\n            (ngModelChange)=\"setDateStart($event)\"></nz-date-picker>\r\n        </div>\r\n        <div nz-col nzSpan=\"24\">\r\n          <b>{{'Ending date' | translate}}</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"24\">\r\n          <nz-date-picker nzShowTime nzFormat=\"dd/MM/yyyy HH:mm:ss\" [ngModel]=\"endTimeBackup\"\r\n            (ngModelChange)=\"setDateEnd($event)\"></nz-date-picker>\r\n        </div>\r\n        <div nz-col nzSpan=\"24\">\r\n          <b>{{'Promotions type' | translate}}</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"24\">\r\n          <nz-select [ngModel]=\"promotionType\" (ngModelChange)=\"changePromotionType($event)\">\r\n            <nz-option *ngFor=\"let item of list\" [nzValue]=\"item.value\" [nzLabel]=\"item.name | translate\"></nz-option>\r\n          </nz-select>\r\n        </div>\r\n        <div nz-col nzSpan=\"24\" *ngIf=\"promotionType == 7\">\r\n          <div nz-col nzSpan=\"24\" style=\"width: 100%\">\r\n            <b>{{'Total invoice value' | translate}}</b>\r\n          </div>\r\n          <div nz-col nzSpan=\"24\">\r\n            <input placeholder=\"{{'Enter total invoice value' | translate}}\" class=\"price_discout\" type=\"text\" nz-input />\r\n          </div>\r\n        </div>\r\n\r\n        <div nz-col nzSpan=\"24\" *ngIf=\"promotionType == 7\">\r\n          <b>{{'Allow selecting gift quantity' | translate}}</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"24\" *ngIf=\"promotionType == 7\" style=\"display:flex; justify-content: space-between;\">\r\n          <span>{{'Selected gift quantity' | translate}} </span>\r\n          <span>\r\n           <input style=\"width: 64px; height: 32px;border: 1px solid lightgray;border-radius: 5px\" type=\"number\" (keyup)=\"checkMaximum()\" [(ngModel)]=\"promotions_maximum\" id=\"quantity\" name=\"quantity\" min=\"0\" max=\"{{gift_length}}\">\r\n           /<b>{{gift_length}}</b>\r\n          </span>\r\n            \r\n        </div>\r\n        <div nz-col nzSpan=\"24\" *ngIf=\"promotionType == 7\">\r\n          <label nz-checkbox [(ngModel)]=\"variable_enable\">{{'Gift quantity increases with total invoice value' | translate}}</label> \r\n        </div>\r\n        <div nz-col nzSpan=\"24\" *ngIf=\"promotionType == 6\">\r\n          <b>{{'Allow selecting gift quantity' | translate}}</b>\r\n        </div> \r\n        <div nz-col nzSpan=\"24\" *ngIf=\"promotionType == 6\" style=\"display:flex; justify-content: space-between;\">\r\n          <span>{{'Selected gift quantity' | translate}} </span>\r\n           <span>\r\n            <input style=\"width: 64px; height: 32px;border: 1px solid lightgray;border-radius: 5px\" type=\"number\" (keyup)=\"checkMaximum()\" [(ngModel)]=\"promotions_maximum\" id=\"quantity\" name=\"quantity\" min=\"0\" max=\"{{gift_length}}\">\r\n            /<b>{{gift_length}}</b>\r\n           </span>\r\n        </div>\r\n\r\n        <div nz-col nzSpan=\"24\" *ngIf=\"promotionType == 1 || promotionType == 2 || promotionType == 3\">\r\n          <b>{{'Apply to all products' | translate}}</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"24\" *ngIf=\"promotionType == 1 || promotionType == 2 || promotionType == 3\">\r\n          <label nz-checkbox (ngModelChange)=\"setAllProduct($event)\" [(ngModel)]=\"promotion_all_products\">{{'Apply' | translate}}</label>          \r\n        </div>\r\n        <div nz-row nzSpan=\"24\" *ngIf=\"promotion_all_products\">\r\n          <div nz-col nzSpan=\"24\">\r\n            <b>{{ promotionType == 2 ? 'Nhập % giảm' :  'Enter amount discount' | translate}}*</b>\r\n          </div>\r\n          <div nz-col nzSpan=\"24\">\r\n            <!-- <input *ngIf=\"promotionType == 2\" [(ngModel)]=\"percent_reduce\" type=\"text\"  placeholder=\"{{'Enter %' | translate}}\" nz-input  /> -->\r\n            <nz-input-number  *ngIf=\"promotionType == 2\" [(ngModel)]=\"percent_reduce\" [nzMin]=\"1\" [nzMax]=\"100\" [nzStep]=\"1\" nzPlaceHolder=\"{{'Enter %' | translate}}\" ></nz-input-number>\r\n            <input *ngIf=\"promotionType != 2\" class=\"price_discout\" type=\"text\"  placeholder=\"{{'Enter amount' | translate}}\" nz-input  />\r\n          </div>\r\n\r\n          <div nz-col nzSpan=\"24\">\r\n            <b>{{'Enter purchase quantity' | translate}}</b>\r\n          </div>\r\n          <div nz-col nzSpan=\"24\">\r\n            <!-- <input *ngIf=\"promotionType == 2\" [(ngModel)]=\"percent_reduce\" type=\"text\"  placeholder=\"{{'Enter %' | translate}}\" nz-input  /> -->\r\n            <nz-input-number [(ngModel)]=\"quantity_promotions_all\" [nzMin]=\"1\" [nzMax]=\"999999\" [nzStep]=\"1\" nzPlaceHolder=\"{{'Enter purchase quantity' | translate}}\" ></nz-input-number>\r\n            \r\n          </div>\r\n        </div>\r\n      </div>\r\n      </div>\r\n    </div>\r\n</nz-layout>","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-discount-many-products',\r\n  templateUrl: './discount-many-products.component.html',\r\n  styleUrls: ['./discount-many-products.component.scss'],\r\n})\r\nexport class DiscountManyProductsComponent implements OnInit {\r\n  @Output() updateProduct = new EventEmitter<any>();\r\n  @Input() data: any = [];\r\n  searchProductList: boolean = false;\r\n  type: number = 4;\r\n  discount_price_all: number = 0;\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    private modal: NzModalService\r\n  ) {}\r\n\r\n  ngOnInit(): void {}\r\n\r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, unit) {\r\n    item.price = item.unit_array.find((it) => it.unit == unit).price;\r\n    item.ratio = item.unit_array.find((it) => it.unit == unit).ratio;\r\n    item.unit = unit;\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {\r\n    // clear dữ liệu products để truyền về output lưu DB\r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i]._id,\r\n        quantity: this.data[i].quantity_discount,\r\n        ratio: this.data[i].ratio ? this.data[i].ratio : 1,\r\n        price_reduce: this.data[i].discount,\r\n        ptype: this.data[i].type\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if(new_item.ptype == 5) {\r\n        let combos = this.data[i].combos.map(item => {\r\n          return { \r\n            id_product: item.id_product, \r\n            ptype: item.type,\r\n            price: item.price,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n            id_category: this.data[i].id_category\r\n          }\r\n        })\r\n        new_item = {...new_item, combos: combos}\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    this.updateProduct.emit(products);\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n  \r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        let unit_array = [];\r\n        data[i] = { ...data[i], unit_array };\r\n        // let unitMain = {\r\n        //   unit: data[i].unit,\r\n        //   ratio: 1,\r\n        //   barcode: data[i].barcode,\r\n        //   price: data[i].price,\r\n        //   price2: data[i].price2,\r\n        //   price_important: data[i].price_important,\r\n        // };\r\n        // data[i]['unit_array'].unshift(unitMain);\r\n        if (data[i].units) {\r\n          data[i]['unit_array'] = data[i]['unit_array'].concat(data[i].units);\r\n        }\r\n        let quantity_discount = 1;\r\n        let discount = 0;\r\n        data[i] = {\r\n          ...data[i],\r\n          quantity_discount: quantity_discount,\r\n          discount: discount,\r\n        };\r\n        if((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(data[i]);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  price: any = 0;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrice(detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if (this.price.getRawValue() >= 0) {\r\n      this.tempDetail.discount = parseFloat(this.price.getRawValue());\r\n    } else if (this.price.getRawValue() < 0)\r\n      this.vhComponent.showToast(\r\n        2000,\r\n        this.lang.translate('Invalid data, please check again'),\r\n        'alert-toast'\r\n      );\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n  // -------modal edit unit quantity-------\r\n  temp: any;\r\n  isVisibleEditUnitQuantity: boolean = false;\r\n  quantity: any = 0;\r\n\r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  openEditUnitQuantity(detail) {\r\n    this.temp = detail;\r\n    this.isVisibleEditUnitQuantity = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.quantity = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleEditUnitQuantity() {\r\n    if (this.quantity.getRawValue() >= 0) {\r\n      this.temp.quantity_discount = parseFloat(this.quantity.getRawValue());\r\n    } else if (this.quantity.getRawValue() < 0)\r\n      this.vhComponent.alertMessageDesktop(\r\n        \"error\",\r\n        this.lang.translate('Invalid data, please check again')\r\n      );\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleCancelEditUnitQuantity() {\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  public remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () => this.data.splice(this.data.indexOf(item), 1),\r\n    });\r\n  }\r\n\r\n  /* Giảm giá cho tất cả */\r\n\r\n   /** Modal edit all price */\r\n   new_discount: any = 0;\r\n   isVisibleEditUnitPriceAll: boolean = false;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm cho tất cả\r\n   */\r\n   openEditUnitPriceAll() {\r\n     this.isVisibleEditUnitPriceAll = true;\r\n  \r\n     this.vhAlgorithm.waitingStack().then(() => {\r\n       this.new_discount = this.vhAlgorithm.vhnumeral('.unit_price_all');\r\n     });\r\n     \r\n   }\r\n \r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm cho tất cả\r\n   */\r\n   handleEditUnitAll() {\r\n     if (this.new_discount.getRawValue() >= 0\r\n     ) {\r\n       for (let i = 0; i < this.data.length; i++) {\r\n         this.data[i].discount = parseFloat(\r\n           document.getElementById('unit_price_all')['value']\r\n         );\r\n         this.data[i].discount = parseFloat(this.new_discount.getRawValue());\r\n         this.discount_price_all = parseFloat(this.new_discount.getRawValue())\r\n       }\r\n     } else if (this.new_discount.getRawValue() < 0)\r\n       this.vhComponent.showToast(\r\n         2000,\r\n         this.lang.translate('Invalid data, please check again'),\r\n         'alert-toast'\r\n       );\r\n     this.isVisibleEditUnitPriceAll = false;\r\n   }\r\n \r\n  /**\r\n   * đóng modal nhập giá giảm cho tất cả và ko lưu\r\n   */\r\n   handleCancelEditUnitAll() {\r\n     this.isVisibleEditUnitPriceAll = false;\r\n   }\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button [disabled]=\"!data.length\" class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!data.length\" class=\"no-data\">\r\n        <p>{{'Please select a product' | translate}}</p>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"invoiceDetail-header\" *ngIf=\"data.length\">\r\n    <div nz-row>\r\n        <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n        </div>\r\n        <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n            {{\"Product name\" | translate}}\r\n        </div>\r\n        <div class=\"text-right\" nz-col nzSpan=\"3\">\r\n            {{\"Selling price\" | translate}}\r\n        </div>        \r\n        <div class=\"invoiceDetail-header-quantity text-center\" nz-col nzSpan=\"3\">\r\n            {{'Unit' | translate}}\r\n        </div>\r\n        <div nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n            {{'Discount value' | translate}}\r\n        </div>\r\n        <div nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n            {{'New price' | translate}}\r\n        </div>\r\n        <div class=\"invoiceDetail-header-quantity text-right\" nz-col nzSpan=\"3\">\r\n            {{'Sufficient quantity' | translate}}\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"invoiceDetail-item-scroll hideScrollbar\" id=\"invoiceDetail-item-scroll-add\">\r\n    <div class=\"invoiceDetail-item\" *ngIf=\"data.length\">\r\n        <div nz-row [nzGutter]=\"16\">\r\n            <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n                \r\n            </div>\r\n            <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n                \r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n               \r\n            </div>       \r\n            <div class=\"text-center\" nz-col nzSpan=\"2\">\r\n               \r\n            </div>\r\n            <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"5\">\r\n                <div style=\"text-align: right; border-bottom: 1px solid #eee;\" (click)=\"openEditUnitPriceAll()\">\r\n                    {{'Discount all' | translate}}\r\n                </div>\r\n            </div>\r\n            <div style=\"text-align: right;\" nz-col nzSpan=\"2\" class=\"ion-text-end\">\r\n               \r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                \r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"invoiceDetail-item\" *ngFor=\"let item of data\">\r\n        <div nz-row [nzGutter]=\"16\">\r\n            <div (click)=\"remove(item)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                <i nz-icon nzType=\"close\" nzTheme=\"outline\" style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n            </div>\r\n            <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n                <b>{{item.name}}</b>\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                {{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n            </div>       \r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                <nz-select [ngModel]=\"item.unit\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                    <nz-option [nzValue]=\"un.unit\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                </nz-select>\r\n            </div>\r\n            <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"3\">\r\n                <div style=\"text-align: right; border-bottom: 1px solid #eee; cursor: pointer\" (click)=\"openEditUnitPrice(item)\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.discount)}}\r\n                </div>\r\n            </div>\r\n            <div style=\"text-align: right;\" nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                <b>{{vhAlgorithm.vhcurrencyunit(item.price > item.discount ? item.price - item.discount : 0)}}</b>\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                <div style=\"text-align: right; border-bottom: 1px solid #eee; cursor: pointer\" (click)=\"openEditUnitQuantity(item)\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.quantity_discount)}}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\" (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Discount amount per product' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" [value]=\"tempDetail.discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'Reduced quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"temp.quantity_discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit discount all-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPriceAll\" *ngIf=\"isVisibleEditUnitPriceAll\" [(nzVisible)]=\"isVisibleEditUnitPriceAll\"\r\n    nzTitle=\"Giảm giá tiền cho tất cả sản phẩm\"\r\n    (nzOnCancel)=\"handleCancelEditUnitAll()\" (nzOnOk)=\"handleEditUnitAll()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price_all\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price_all\" nz-input [value]=\"discount_price_all\"/>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPriceAll>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitAll()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitAll()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport {\r\n  VhPromotionDetail,\r\n  VhPromotions,\r\n} from 'src/app/sales/interface/vh-promotions-money-rate';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-discount-percent-product',\r\n  templateUrl: './discount-percent-product.component.html',\r\n  styleUrls: ['./discount-percent-product.component.scss'],\r\n})\r\nexport class DiscountPercentProductComponent implements OnInit {\r\n  @Output() changeVl = new EventEmitter<any>();\r\n  @Input() promotion_all_products\r\n  data: any = [];\r\n  searchProductList: boolean = false;\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    private modal: NzModalService,\r\n    public vhQuerySales: VhQuerySales,\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, e) {\r\n    item.price = item.unit_array.find(it => it.unit == e).price;\r\n    item.ratio = item.unit_array.find(it => it.unit == e).ratio\r\n    item.unit = e\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {\r\n    let products = [];\r\n    for(let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i]._id,\r\n        ratio: this.data[i].ratio ? this.data[i].ratio : 1,\r\n        price_origin: this.data[i].price,\r\n        percent_reduce: this.data[i].discount ? this.data[i].discount : 0,\r\n        ptype: this.data[i].type,\r\n        quantity: this.data[i].quantity_discount\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if(new_item.ptype == 5) {\r\n        let combos = this.data[i].combos.map(item => {\r\n          return { \r\n            id_product: item.id_product, \r\n            ptype: item.type,\r\n            price: item.price,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n            id_category: this.data[i].id_category\r\n          }\r\n        })\r\n        new_item = {...new_item, combos: combos}\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    this.changeVl.emit(products);\r\n  }\r\n\r\n  /** Modal edit all price */\r\n  new_discount: any = 0;\r\n  isVisibleEditUnitPriceAll: boolean = false;\r\n  percent_all: number = 0;\r\n  disabled_all: boolean = true;\r\n  /** Mở modal */\r\n  openEditUnitPriceAll() {\r\n    this.isVisibleEditUnitPriceAll = true;\r\n  }\r\n\r\n  /** sửa phần model % */\r\n  handleEditUnitAll() {\r\n    if (\r\n      parseFloat(document.getElementById('unit_price_all')['value']) >= 0 &&\r\n      parseFloat(document.getElementById('unit_price_all')['value']) <= 100\r\n    ) {\r\n      for (let i = 0; i < this.data.length; i++) {\r\n        this.data[i].discount = parseFloat(document.getElementById('unit_price_all')['value']);\r\n        this.disabled_all = true;\r\n        this.isVisibleEditUnitPriceAll = false;\r\n      }\r\n    } else {\r\n      this.disabled_all = false;\r\n      \r\n    }\r\n  }\r\n\r\n  /** Tắt modal */\r\n  handleCancelEditUnitAll() {\r\n    this.isVisibleEditUnitPriceAll = false;\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  price: any = 0;\r\n  disabled: boolean = true;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrice(detail: VhPromotionDetail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if (\r\n      parseFloat(document.getElementById('unit_price')['value']) >= 0 &&\r\n      parseFloat(document.getElementById('unit_price')['value']) <= 100\r\n    ) {\r\n      this.tempDetail.discount = parseFloat(document.getElementById('unit_price')['value']);\r\n      // this.tempDetail.new_price = this.tempDetail.price *\r\n      //   (1 - parseFloat(document.getElementById('unit_price')['value']) / 100);\r\n      this.disabled = true;\r\n      this.isVisibleEditUnitPrice = false;\r\n    } else {\r\n      this.disabled = false;\r\n    }\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        let unit_array = [];\r\n        data[i] = {...data[i],unit_array }\r\n        // let unitMain = {\r\n        //   unit: data[i].unit,\r\n        //   ratio: 1,\r\n        //   barcode: data[i].barcode,\r\n        //   price: data[i].price,\r\n        //   price2: data[i].price2,\r\n        //   price_important: data[i].price_important,\r\n        // };\r\n        // data[i]['unit_array'].unshift(unitMain);\r\n        if (data[i].units) {\r\n          data[i]['unit_array'] = data[i]['unit_array'].concat(data[i].units)\r\n        }\r\n        let discount = 0;\r\n        let quantity_discount = 1\r\n        data[i] = {...data[i], discount: discount, quantity_discount: quantity_discount}\r\n        if((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(data[i]);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n        \r\n      }\r\n      \r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n\r\n  // -------modal edit unit quantity-------\r\n  temp: any;\r\n  isVisibleEditUnitQuantity: boolean = false;\r\n  quantity: any = 0;\r\n\r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  openEditUnitQuantity(detail) {\r\n    this.temp = detail;\r\n    this.isVisibleEditUnitQuantity = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.quantity = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleEditUnitQuantity() {\r\n    if (this.quantity.getRawValue() >= 0) {\r\n      this.temp.quantity_discount = parseFloat(this.quantity.getRawValue());\r\n    } else if (this.quantity.getRawValue() < 0)\r\n      this.vhComponent.alertMessageDesktop(\r\n        'error',\r\n        this.lang.translate('Invalid data, please check again')\r\n      );\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleCancelEditUnitQuantity() {\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  public remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  this.data.splice(this.data.indexOf(item), 1)\r\n    });\r\n  }\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\"\r\n            [disabled]=\"promotion_all_products\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!promotion_all_products\" class=\"no-data\">\r\n        <p *ngIf=\"!data.length \">{{'Select promotional products or apply to all products' | translate}}</p>\r\n    </div>\r\n    <div *ngIf=\"promotion_all_products\" class=\"no-data\">\r\n        <p style=\"font-weight: bold; font-size: 0.95rem;\">{{'Apply to all products' | translate}}</p>\r\n    </div>\r\n</div>\r\n<div class=\"hideScrollbar sales-cart-invoiceDetail\" *ngIf=\"!promotion_all_products\">\r\n    <div *ngIf=\"data.length\" class=\"invoiceDetail-header\">\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n            </div>\r\n            <div nz-col nzSpan=\"6\" class=\"center-col\">\r\n                {{\"Product name\" | translate}}\r\n            </div>\r\n            <div class=\"text-right\" nz-col nzSpan=\"3\">\r\n                {{\"Selling price\" | translate}}\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"4\">\r\n                {{'Unit' | translate}}\r\n            </div>\r\n            <div class=\"invoiceDetail-header-quantity text-right\" nz-col nzSpan=\"3\">\r\n                {{'Discount %' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                {{\"New price\" | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                {{'Quantity' | translate}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"data.length\" class=\"invoiceDetail-item-scroll hideScrollbar\" id=\"invoiceDetail-item-scroll-add\">\r\n        <div class=\"invoiceDetail-item\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    \r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"center-col\">\r\n                    \r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                    \r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"4\">\r\n                    \r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">                    \r\n                    <div style=\"text-align: right;\" (click)=\"openEditUnitPriceAll()\">\r\n                        {{'Discount % all' | translate}}\r\n                    </div>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                    \r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                    \r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"invoiceDetail-item\" *ngFor=\"let item of !promotion_all_products ? data : []\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div (click)=\"remove(item)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"center-col\">\r\n                    <b>{{item.name}}</b>\r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.price_unit ? item.price_unit : item.price)}}đ\r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                    <nz-select [ngModel]=\"item.unit\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                        <!-- <nz-option [nzValue]=\"item.unit\" [nzLabel]=\"item.unit\" *ngIf=\"item.unit\">{{item.unit}}</nz-option> -->\r\n                        <nz-option [nzValue]=\"un.unit\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.units\">{{un.unit}}</nz-option>\r\n                    </nz-select>\r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"3\">                    \r\n                    \r\n                    <div style=\"text-align: right;\"\r\n                    (click)=\"openEditUnitPrice(item)\">\r\n                    {{vhAlgorithm.vhpercent(item.discount/100 ? item.discount/100 : 0)}} </div>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                    <b>{{vhAlgorithm.vhcurrencyunit((item.price_unit ? item.price_unit: item.price) > item.discount ? (item.price_unit ? item.price_unit: item.price) * (1- item.discount / 100) : 0 )}}đ</b>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\" style=\"cursor: pointer\" (click)=\"openEditUnitQuantity(item)\">\r\n                    {{item.quantity_discount}} <i nz-icon nzType=\"edit\" nzTheme=\"outline\" style=\"color: #00A859\"></i>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\" (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"Giảm phần trăm sản phẩm\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Percent' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" [value]=\"tempDetail.discount\" nz-input />\r\n            </div>\r\n        </div>\r\n        <div nz-row *ngIf=\"!disabled\">\r\n            <div nz-col nzSpan=\"8\">\r\n\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <label style=\"color: red\">{{'Percentage required >= 0 and <= 100!' | translate}}</label>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit discount all-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPriceAll\" *ngIf=\"isVisibleEditUnitPriceAll\" [(nzVisible)]=\"isVisibleEditUnitPriceAll\"\r\n    nzTitle=\"{{'Discount percentage of all products' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitAll()\" (nzOnOk)=\"handleEditUnitAll()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Percentage applied to all' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price_all\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price_all\" nz-input [value]=\"percent_all\"/>\r\n            </div>\r\n        </div>\r\n        <div nz-row *ngIf=\"!disabled_all\">\r\n            <div nz-col nzSpan=\"8\">\r\n\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <label style=\"color: red\">{{'Percentage required >= 0 and <= 100!' | translate}}</label>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPriceAll>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitAll()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitAll()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'_Quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"temp.quantity_discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { VhPromotionDetail, VhPromotions } from 'src/app/sales/interface/vh-promotions-money-rate';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-discount-percent-total-product',\r\n  templateUrl: './discount-percent-total-product.component.html',\r\n  styleUrls: ['./discount-percent-total-product.component.scss']\r\n})\r\nexport class DiscountPercentTotalProductComponent implements OnInit {\r\n\r\n  @Input() data: any = [];\r\n  @Output() updateProduct = new EventEmitter<any>();\r\n  searchProductList: boolean = false;\r\n  discount_percent_all = 0\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    private modal: NzModalService,\r\n    public vhQuerySales: VhQuerySales,\r\n\r\n  ) { \r\n  }\r\n\r\n  ngOnInit(): void {\r\n   \r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, unit) {\r\n    item.price = item.unit_array.find(it => it.unit == unit).price;\r\n    item.ratio = item.unit_array.find(it => it.unit == unit).ratio\r\n    item.unit = unit\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {\r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i]._id,\r\n        quantity: this.data[i].quantity_discount,\r\n        ratio: this.data[i].ratio ? this.data[i].ratio : 1,        \r\n        percent_reduce: this.data[i].discount,\r\n        ptype: this.data[i].type,\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if(new_item.ptype == 5) {\r\n        let combos = this.data[i].combos.map(item => {\r\n          return { \r\n            id_product: item.id_product, \r\n            ptype: item.type,\r\n            price: item.price,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n            id_category: this.data[i].id_category\r\n          }\r\n        })\r\n        new_item = {...new_item, combos: combos}\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    \r\n    this.updateProduct.emit(products);\r\n    \r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  \r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data){\r\n    if (data) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        let unit_array = [];\r\n        data[i] = {...data[i],unit_array }\r\n        // let unitMain = {\r\n        //   unit: data[i].unit,\r\n        //   ratio: 1,\r\n        //   barcode: data[i].barcode,\r\n        //   price: data[i].price,\r\n        //   price2: data[i].price2,\r\n        //   price_important: data[i].price_important,\r\n        // };\r\n        // data[i]['unit_array'].unshift(unitMain);\r\n        if (data[i].units) {\r\n          data[i]['unit_array'] = data[i]['unit_array'].concat(data[i].units)\r\n        }\r\n        let quantity_discount = 1;\r\n        let discount = 0;\r\n        data[i] = {...data[i], quantity_discount: quantity_discount, discount: discount}\r\n        if((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(data[i]);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }        \r\n      }\r\n    }\r\n    this.searchProductList = false;        \r\n  }\r\n\r\n   // -------modal edit unit price-------\r\n   tempDetail: any;\r\n   isVisibleEditUnitPrice: boolean = false;\r\n   percent: any = 0;\r\n   disabled: boolean = true;\r\n \r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n   openEditUnitPrice(detail) {\r\n     this.tempDetail = detail;     \r\n     this.isVisibleEditUnitPrice = true;\r\n     this.vhAlgorithm.waitingStack().then(() => {\r\n       this.percent = this.vhAlgorithm.vhnumeral('.unit_price');\r\n     });\r\n   }\r\n \r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n   handleEditUnit() {    \r\n     if ( parseFloat(this.percent.getRawValue()) >= 0 && parseFloat(this.percent.getRawValue()) <= 100) {\r\n       this.tempDetail.discount = parseFloat(this.percent.getRawValue())\r\n       this.disabled = true;\r\n        this.isVisibleEditUnitPrice = false;\r\n     } else {\r\n        this.disabled = false;\r\n     }\r\n\r\n   }\r\n   /**\r\n    * đóng modal nhập giá giảm sp và ko lưu\r\n    */\r\n   handleCancelEditUnit() {\r\n     this.isVisibleEditUnitPrice = false;\r\n   }\r\n\r\n    // -------modal edit unit quantity-------\r\n  temp: any;\r\n  isVisibleEditUnitQuantity: boolean = false;\r\n  quantity: any = 0;\r\n \r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n   openEditUnitQuantity(detail) {\r\n     this.temp = detail;\r\n     this.isVisibleEditUnitQuantity = true;\r\n     this.vhAlgorithm.waitingStack().then(() => {\r\n       this.quantity = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n     });\r\n   }\r\n \r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n   handleEditUnitQuantity() {\r\n     if ( this.quantity.getRawValue() >= 0) {\r\n       this.temp.quantity_discount = parseFloat(this.quantity.getRawValue());\r\n     } else if (this.quantity.getRawValue() < 0)\r\n       this.vhComponent.alertMessageDesktop(\r\n         'error',\r\n         this.lang.translate('Invalid data, please check again')\r\n         \r\n       );\r\n     this.isVisibleEditUnitQuantity = false;\r\n   }\r\n   /**\r\n    * đóng modal chỉnh sửa số lượng sp trong km\r\n    */\r\n   handleCancelEditUnitQuantity() {\r\n     this.isVisibleEditUnitQuantity = false;\r\n   }\r\n\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  public remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  this.data.splice(this.data.indexOf(item), 1)\r\n    });\r\n  }\r\n\r\n  // ----------- modal edit discount all -----------\r\n  new_discount: any = 0;\r\n  isVisibleEditUnitPriceAll: boolean = false;\r\n  disabled_all: boolean = true;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm cho tất cả\r\n   */\r\n  openEditUnitPriceAll() {\r\n     this.isVisibleEditUnitPriceAll = true;\r\n  \r\n     this.vhAlgorithm.waitingStack().then(() => {\r\n       this.new_discount = this.vhAlgorithm.vhnumeral('.unit_price_all');\r\n     });\r\n     \r\n   }\r\n \r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm cho tất cả\r\n   */\r\n   handleEditUnitAll() {\r\n     if (this.new_discount.getRawValue() >= 0 && this.new_discount.getRawValue() <= 100) {\r\n       for (let i = 0; i < this.data.length; i++) {\r\n         this.data[i].discount = parseFloat(\r\n           document.getElementById('unit_price_all')['value']\r\n         );\r\n         this.data[i].discount = parseFloat(this.new_discount.getRawValue());\r\n         this.discount_percent_all = parseFloat(this.new_discount.getRawValue());\r\n         this.disabled_all = true\r\n       }\r\n       this.isVisibleEditUnitPriceAll = false;\r\n     } else {\r\n      this.disabled_all = false\r\n     }\r\n   }\r\n \r\n  /**\r\n   * đóng modal nhập giá giảm cho tất cả và ko lưu\r\n   */\r\n   handleCancelEditUnitAll() {\r\n     this.isVisibleEditUnitPriceAll = false;\r\n   }\r\n\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button [disabled]=\"!data.length\" class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!data.length\" class=\"no-data\">\r\n        <p>{{'Please select a product' | translate}}</p>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"invoiceDetail-header\" *ngIf=\"data.length\">\r\n    <div nz-row>\r\n        <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n        </div>\r\n        <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n            {{\"Product name\" | translate}}\r\n        </div>\r\n        <div class=\"text-right\" nz-col nzSpan=\"3\">\r\n            {{\"Selling price\" | translate}}\r\n        </div>        \r\n        <div class=\"invoiceDetail-header-quantity text-center\" nz-col nzSpan=\"3\">\r\n            {{'Unit' | translate}}\r\n        </div>\r\n        <div nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n            {{\"Discount %\" | translate}}\r\n        </div>\r\n        <div nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n            {{\"New price\" | translate}}\r\n        </div>\r\n        <div class=\"invoiceDetail-header-quantity text-right\" nz-col nzSpan=\"3\">\r\n            {{'Quantity from' | translate}}\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"invoiceDetail-item-scroll hideScrollbar\" id=\"invoiceDetail-item-scroll-add\">\r\n    <div class=\"invoiceDetail-item\" *ngIf=\"data.length\">\r\n        <div nz-row [nzGutter]=\"16\">\r\n            <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n                \r\n            </div>\r\n            <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n                \r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n               \r\n            </div>       \r\n            <div class=\"text-center\" nz-col nzSpan=\"2\">\r\n               \r\n            </div>\r\n            <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"5\">\r\n                <div style=\"text-align: right; border-bottom: 1px solid #eee;\" (click)=\"openEditUnitPriceAll()\">\r\n                    {{'Discount % all' | translate}}\r\n                </div>\r\n            </div>\r\n            <div style=\"text-align: right;\" nz-col nzSpan=\"2\" class=\"ion-text-end\">\r\n               \r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                \r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"invoiceDetail-item\" *ngFor=\"let item of data\">\r\n        <div nz-row [nzGutter]=\"16\">\r\n            <div (click)=\"remove(item)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                <i nz-icon nzType=\"close\" nzTheme=\"outline\" style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n            </div>\r\n            <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n                <b>{{item.name}}</b>\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                {{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n            </div>            \r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                <nz-select [ngModel]=\"item.unit\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                    <nz-option [nzValue]=\"un.unit\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                </nz-select>\r\n            </div>\r\n            <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"3\">\r\n                <div style=\"text-align: right; border-bottom: 1px solid #eee\" (click)=\"openEditUnitPrice(item)\">\r\n                    {{vhAlgorithm.vhpercent(item.discount/100)}}\r\n                </div>\r\n            </div>\r\n            <div style=\"text-align: right;\" nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                <!-- <input nz-input [(ngModel)]=\"item.new_price\" [disabled]=\"true\" /> -->\r\n                <b>{{vhAlgorithm.vhcurrencyunit(item.price - (item.price*item.discount)/100)}}đ</b>\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                <div style=\"text-align: right; border-bottom: 1px solid #eee; cursor: pointer\" (click)=\"openEditUnitQuantity(item)\">\r\n                    {{item.quantity_discount}}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\" (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Discount in percent' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Percent' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" [value]=\"tempDetail.discount\" nz-input />\r\n            </div>\r\n        </div>\r\n        <div nz-row *ngIf=\"!disabled\">\r\n            <div nz-col nzSpan=\"8\">\r\n\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <label style=\"color: red\">Phần trăm yêu cầu > 0 và < 100 !</label>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\" style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit discount all-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPriceAll\" *ngIf=\"isVisibleEditUnitPriceAll\" [(nzVisible)]=\"isVisibleEditUnitPriceAll\"\r\n    nzTitle=\"{{'Discount % for all' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitAll()\" (nzOnOk)=\"handleEditUnitAll()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Percent' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price_all\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price_all\" [value]=\"discount_percent_all\" nz-input />\r\n            </div>\r\n        </div>\r\n        <div nz-row *ngIf=\"!disabled_all\">\r\n            <div nz-col nzSpan=\"8\">\r\n\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <label style=\"color: red\">Phần trăm yêu cầu > 0 và < 100 !</label>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPriceAll>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitAll()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\" style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitAll()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'Discount in percent' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"temp.quantity_discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>","import { Type } from '@angular/compiler';\r\nimport { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport {\r\n  VhPromotionDetail,\r\n  VhPromotions,\r\n} from 'src/app/sales/interface/vh-promotions-money-rate';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-discount-price-each-product',\r\n  templateUrl: './discount-price-each-product.component.html',\r\n  styleUrls: ['./discount-price-each-product.component.scss'],\r\n})\r\nexport class DiscountPriceEachProductComponent implements OnInit {\r\n  @Output() changeVl = new EventEmitter<any>();\r\n  @Input() data: any = [];\r\n  @Input() promotion_all_products: boolean = false;\r\n  searchProductList: boolean = false;\r\n  isVisibleEditUnitPriceAll: boolean = false;\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    private modal: NzModalService,\r\n    public vhQuerySales: VhQuerySales\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    // \r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, e) {\r\n    item.price = item.unit_array.find((it) => it.unit == e).price;\r\n    item.ratio = item.unit_array.find((it) => it.unit == e).ratio;\r\n    item.unit = e;\r\n  }\r\n\r\n  /** Modal edit all price */\r\n  new_discount: any = 0;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm cho tất cả\r\n   */\r\n  openEditUnitPriceAll() {\r\n    this.isVisibleEditUnitPriceAll = true;\r\n\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.new_discount = this.vhAlgorithm.vhnumeral('.unit_price_all');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm cho tất cả\r\n   */\r\n  handleEditUnitAll() {\r\n    if (this.new_discount.getRawValue() >= 0) {\r\n      for (let i = 0; i < this.data.length; i++) {\r\n        this.data[i].discount = parseFloat(\r\n          document.getElementById('unit_price_all')['value']\r\n        );\r\n        this.data[i].discount = parseFloat(this.new_discount.getRawValue());\r\n        if (this.data[i].discount > this.data[i].price) {\r\n          this.data[i].new_price = 0;\r\n        } else {\r\n          this.data[i].new_price =\r\n            this.data[i].price - parseFloat(this.new_discount.getRawValue());\r\n        }\r\n      }\r\n    } else if (this.new_discount.getRawValue() < 0)\r\n      this.vhComponent.showToast(\r\n        2000,\r\n        this.lang.translate('Invalid data, please check again'),\r\n        'alert-toast'\r\n      );\r\n    this.isVisibleEditUnitPriceAll = false;\r\n  }\r\n\r\n  /**\r\n   * đóng modal nhập giá giảm cho tất cả và ko lưu\r\n   */\r\n  handleCancelEditUnitAll() {\r\n    this.isVisibleEditUnitPriceAll = false;\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  price: any = 0;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrice(detail: VhPromotionDetail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if (this.price.getRawValue() >= 0) {\r\n      this.tempDetail.discount = parseFloat(this.price.getRawValue());\r\n    } else {\r\n      this.vhComponent.showToast(\r\n        2000,\r\n        this.lang.translate('Invalid data, please check again'),\r\n        'alert-toast'\r\n      );\r\n    }\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {\r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i]._id,\r\n        ratio: this.data[i].ratio ? this.data[i].ratio : 1,\r\n        price_reduce: this.data[i].discount,\r\n        price_origin: this.data[i].price,\r\n        ptype: this.data[i].type,\r\n        quantity: this.data[i].quantity_discount,\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if (new_item.ptype == 5) {\r\n        let combos = this.data[i].combos.map((item) => {\r\n          return {\r\n            id_product: item.id_product,\r\n            ptype: item.type,\r\n            price: item.price,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n            id_category: this.data[i].id_category,\r\n          };\r\n        });\r\n        new_item = { ...new_item, combos: combos };\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    \r\n    this.changeVl.emit(products);\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        let unit_array = [];\r\n        data[i] = { ...data[i], unit_array };\r\n        // let unitMain = {\r\n        //   unit: data[i].unit,\r\n        //   ratio: 1,\r\n        //   barcode: data[i].barcode,\r\n        //   price: data[i].price,\r\n        //   price2: data[i].price2,\r\n        //   price_important: data[i].price_important,\r\n        // };\r\n        // data[i]['unit_array'].unshift(unitMain);\r\n        if (data[i].units) {\r\n          data[i]['unit_array'] = data[i]['unit_array'].concat(data[i].units);\r\n        }\r\n        let discount = 0;\r\n        let quantity_discount = 1\r\n        data[i] = { ...data[i], discount: discount, quantity_discount: quantity_discount};\r\n        if (this.data.length + data.length <= 100) {\r\n          this.data.unshift(data[i]);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !',\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n\r\n  // -------modal edit unit quantity-------\r\n  temp: any;\r\n  isVisibleEditUnitQuantity: boolean = false;\r\n  quantity: any = 0;\r\n\r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  openEditUnitQuantity(detail) {\r\n    this.temp = detail;\r\n    this.isVisibleEditUnitQuantity = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.quantity = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleEditUnitQuantity() {\r\n    if (this.quantity.getRawValue() >= 0) {\r\n      this.temp.quantity_discount = parseFloat(this.quantity.getRawValue());\r\n    } else if (this.quantity.getRawValue() < 0)\r\n      this.vhComponent.alertMessageDesktop(\r\n        'error',\r\n        this.lang.translate('Invalid data, please check again')\r\n      );\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleCancelEditUnitQuantity() {\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () => this.data.splice(this.data.indexOf(item), 1),\r\n    });\r\n  }\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button [disabled]=\"promotion_all_products\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!promotion_all_products\" class=\"no-data\">\r\n        <p *ngIf=\"!data.length \">{{'Select promotional products or apply to all products' | translate}}</p>\r\n    </div>\r\n    <div *ngIf=\"promotion_all_products\" class=\"no-data\">\r\n        <p style=\"font-weight: bold; font-size: 0.95rem;\">{{'Apply to all products' | translate}}</p>\r\n    </div>\r\n</div>\r\n<div class=\"hideScrollbar sales-cart-invoiceDetail\" *ngIf=\"!promotion_all_products\" >\r\n    <div *ngIf=\"data.length\" class=\"invoiceDetail-header\">\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n            </div>\r\n            <div nz-col nzSpan=\"6\" class=\"center-col\">  \r\n                {{\"Product name\" | translate}}\r\n            </div>\r\n            <div class=\"text-right\" nz-col nzSpan=\"3\">\r\n                {{\"Selling price\" | translate}}\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"4\">\r\n                Đơn vị\r\n            </div>\r\n            <div class=\"invoiceDetail-header-quantity text-right\" nz-col nzSpan=\"3\">\r\n                {{\"Discount in amount\" | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                {{'New price' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                {{'Quantity' | translate}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"data.length\" class=\"invoiceDetail-item-scroll hideScrollbar\" id=\"invoiceDetail-item-scroll-add\">\r\n        <div class=\"invoiceDetail-item\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    \r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"center-col\">\r\n                    \r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                   \r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n\r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                    <div style=\"text-align: right;\" (click)=\"openEditUnitPriceAll()\">\r\n                        Giảm tất cả\r\n                    </div>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                    \r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                    \r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"invoiceDetail-item\" *ngFor=\"let item of !promotion_all_products ? data : []\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div (click)=\"remove(item)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"center-col\">\r\n                    <b>{{item.name}}</b>\r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                    <nz-select [ngModel]=\"item.unit\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                        <nz-option [nzValue]=\"un.unit\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                    </nz-select>\r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"3\">\r\n                    <div style=\"text-align: right;\" (click)=\"openEditUnitPrice(item)\">\r\n                        {{vhAlgorithm.vhcurrencyunit(item.discount)}}</div>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                    <b>{{vhAlgorithm.vhcurrencyunit((item.price_unit ? item.price_unit : item.price) > item.discount ? (item.price_unit ? item.price_unit : item.price) - item.discount : 0)}}</b>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\" style=\"cursor: pointer\" (click)=\"openEditUnitQuantity(item)\">\r\n                    {{item.quantity_discount}} <i nz-icon nzType=\"edit\" nzTheme=\"outline\" style=\"color: #00A859\"></i>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"Giảm giá tiền cho sản phẩm\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" [value]=\"tempDetail.discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit discount all-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPriceAll\" *ngIf=\"isVisibleEditUnitPriceAll\" [(nzVisible)]=\"isVisibleEditUnitPriceAll\"\r\n    nzTitle=\"Giảm giá tiền cho tất cả sản phẩm\"\r\n    (nzOnCancel)=\"handleCancelEditUnitAll()\" (nzOnOk)=\"handleEditUnitAll()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price_all\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price_all\" nz-input value=\"0\"/>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPriceAll>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitAll()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitAll()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'_Quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"temp.quantity_discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { VhPromotionDetail, VhPromotions } from 'src/app/sales/interface/vh-promotions-money-rate';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-discount-price-total-invoice',\r\n  templateUrl: './discount-price-total-invoice.component.html',\r\n  styleUrls: ['./discount-price-total-invoice.component.scss']\r\n})\r\nexport class DiscountPriceTotalInvoiceComponent implements OnInit {\r\n\r\n  @Output() updateProduct = new EventEmitter<any>();\r\n  @Output() gift_length = new EventEmitter<number>();\r\n  searchProductList: boolean = false;\r\n  data = []\r\n  constructor(\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    private modal: NzModalService,\r\n    public vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n  \r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  new_price: any;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrice(detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n      this.vhAlgorithm.waitingStack().then(() => {\r\n        this.new_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n      });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if (this.new_price.getRawValue() >= 0) {\r\n      this.tempDetail.price_gift = parseFloat(this.new_price.getRawValue());     \r\n    } else if (this.new_price.getRawValue() < 0)\r\n      this.vhComponent.showToast(\r\n        2000,\r\n        this.lang.translate('Giá mới phải lớn hơn 0. Vui lòng nhập lại !'),\r\n        'alert-toast'\r\n      );\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n\r\n  // -------modal edit unit discount-------\r\n  temp: any;\r\n  isVisibleEditDiscount: boolean = false;\r\n  new_discount: any;\r\n\r\n  /**\r\n   * mở modal chỉnh sửa số lượng áp dụng sp trong km\r\n   */\r\n  openEditDiscount(detail) {    \r\n    this.temp = detail;\r\n    this.isVisibleEditDiscount = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.new_discount = this.vhAlgorithm.vhnumeral('.unit_price_discount');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng áp dụng sp trong km\r\n   */\r\n  handleEditDiscount() {\r\n    if (this.new_discount.getRawValue() >= 0) {\r\n      this.temp.quantity_discount = parseFloat(this.new_discount.getRawValue());     \r\n    } else if (this.new_discount.getRawValue() < 0)\r\n      this.vhComponent.showToast(\r\n        2000,\r\n        this.lang.translate('Số lượng không thể nhỏ hơn 0. Vui lòng nhập lại !'),\r\n        'alert-toast'\r\n      );\r\n    this.isVisibleEditDiscount = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng áp dụng sp trong km\r\n   */\r\n  handleCancelEditDiscount() {\r\n    this.isVisibleEditDiscount = false;\r\n  }\r\n  \r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, e) {\r\n    item.price = item.unit_array.find(it => it.unit == e).price;\r\n    item.ratio = item.unit_array.find(it => it.unit == e).ratio\r\n    item.unit = e\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {\r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i]._id,\r\n        ratio: this.data[i].ratio ? this.data[i].ratio : 1,\r\n        price: this.data[i].price_gift,\r\n        quantity: this.data[i].quantity_discount,\r\n        ptype: this.data[i].type,\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if(new_item.ptype == 5) {\r\n        let combos = this.data[i].combos.map(item => {\r\n          let combo ={ \r\n            id_product: item.id_product, \r\n            ptype: item.type,\r\n            price: item.price,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n          }\r\n          if(item.id_subproduct) combo['id_subproduct'] = item.id_subproduct\r\n          return  combo\r\n        })\r\n        new_item = {...new_item, combos: combos}\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    this.updateProduct.emit(products)\r\n  }\r\n\r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data){\r\n    if (data) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        let unit_array = [];\r\n        data[i] = {...data[i],unit_array }\r\n        // let unitMain = {\r\n        //   unit: data[i].unit,\r\n        //   ratio: 1,\r\n        //   barcode: data[i].barcode,\r\n        //   price: data[i].price,\r\n        //   price2: data[i].price2,\r\n        //   price_important: data[i].price_important,\r\n        // };\r\n        // data[i]['unit_array'].unshift(unitMain);\r\n        if (data[i].units) {\r\n          data[i]['unit_array'] = data[i]['unit_array'].concat(data[i].units)\r\n        }\r\n        let price_gift = 0;\r\n        let quantity_discount = 1;\r\n        data[i] = {...data[i], price_gift: price_gift, quantity_discount: quantity_discount}\r\n        if((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(data[i]);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.gift_length.emit(this.data.length)\r\n    this.searchProductList = false;    \r\n  }\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  public remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  {\r\n        this.data.splice(this.data.indexOf(item), 1)\r\n        this.gift_length.emit(this.data.length)\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!data.length\" class=\"no-data\">\r\n        <p>{{'Please select a product' | translate}}</p>\r\n    </div>\r\n</div>\r\n<div class=\"hideScrollbar sales-cart-invoiceDetail\" *ngIf=\"data.length\">\r\n    <div class=\"total-invoice\">\r\n        <div nz-row nzSpan=\"24\" class=\"total\">\r\n            <b>Tổng sản phẩm : &nbsp;</b> {{data.length}} \r\n        </div>\r\n        <div nz-row nzSpan=\"24\" class=\"title-table\">\r\n            <div nz-col nzSpan=\"1\">\r\n\r\n            </div>\r\n            <div class=\"title-name title-text text-left\" nz-col nzSpan=\"9\">\r\n                Tên sản phẩm\r\n            </div>\r\n            <div class=\"title-price title-text text-center\" nz-col nzSpan=\"3\">\r\n                Giá bán\r\n            </div>\r\n            <div class=\"title-quantity title-text text-right\" nz-col nzSpan=\"3\">\r\n                Sl tặng\r\n            </div>\r\n            <div class=\"title-new-price title-text text-right\" nz-col nzSpan=\"4\">\r\n                Đơn vị\r\n            </div>\r\n            <div class=\"title-new-price title-text text-right\" nz-col nzSpan=\"4\">\r\n                Giá mới\r\n            </div>\r\n        </div>\r\n        <div nzSpan=\"24\" class=\"total-invoice-content\">\r\n            <div nz-row nzSpan=\"24\" class=\"list-item\" *ngFor=\"let item of data\">\r\n                <div class=\"name\" nz-col nzSpan=\"1\" style=\"cursor: pointer\">\r\n                    <i nz-icon nzType=\"close\" nzTheme=\"outline\" style=\"color: red\" (click)=\"remove(item)\"></i>\r\n                </div>\r\n                <div class=\"name\" nz-col nzSpan=\"9\">\r\n                    <b>{{item.name}}</b>\r\n                </div>\r\n                <div class=\"price text-center\" nz-col nzSpan=\"3\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n                </div>\r\n                <div class=\"quantity text-right\" nz-col nzSpan=\"3\" (click)=\"openEditDiscount(item)\" style=\"cursor: pointer; border-bottom: 1px solid #eee\">\r\n                    {{item.quantity_discount}}\r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                    <nz-select [ngModel]=\"item.unit\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                        <nz-option [nzValue]=\"un.unit\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                    </nz-select>\r\n                </div>\r\n                <div class=\"new-price text-right\" nz-col nzSpan=\"4\" (click)=\"openEditUnitPrice(item)\" style=\"cursor: pointer; border-bottom: 1px solid #ccc\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.price_gift)}}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\" (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!-- ---------edit price-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"Nhập số tiền áp dụng\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" [value]=\"tempDetail.price_gift\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditDiscount\" *ngIf=\"isVisibleEditDiscount\" [(nzVisible)]=\"isVisibleEditDiscount\"\r\n    nzTitle=\"Nhập số lượng áp dụng\"\r\n    (nzOnCancel)=\"handleCancelEditDiscount()\" (nzOnOk)=\"handleEditDiscount()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price_discount\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price_discount\" [value]=\"temp.quantity_discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditDiscount>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditDiscount()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditDiscount()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-discount-same-price',\r\n  templateUrl: './discount-same-price.component.html',\r\n  styleUrls: ['./discount-same-price.component.scss'],\r\n})\r\nexport class DiscountSamePriceComponent implements OnInit {\r\n  @Output() changeVl = new EventEmitter<any>();\r\n  @Input() data: any = [];\r\n  @Input() promotion_all_products\r\n  // @Input() promotion_all_products\r\n  public vhPromotion: any;\r\n  searchProductList: boolean = false;\r\n  price_same: number = 0;\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private lang: LanguageService,\r\n    private modal: NzModalService,\r\n    public vhQuerySales: VhQuerySales,\r\n    private vhComponent:VhComponent\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n   \r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, e) {\r\n    item.price = item.unit_array.find(it => it.unit == e).price;\r\n    item.ratio = item.unit_array.find(it => it.unit == e).ratio;\r\n    item.unit = e\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  price: any = 0;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrices() {\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    for( let i = 0; i < this.data.length; i++ ) {\r\n      if(this.price.getRawValue() && this.price.getRawValue() >= 0) {\r\n        this.price_same = parseFloat(this.price.getRawValue())\r\n      } else {\r\n        this.price_same = 0\r\n      }\r\n    }\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {\r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i]._id,\r\n        ratio: this.data[i].ratio ? this.data[i].ratio : 1,\r\n        price_same: this.price_same ? this.price_same : 0,\r\n        ptype: this.data[i].type,\r\n        quantity: this.data[i].quantity_discount,\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if(new_item.ptype == 5) {\r\n        let combos = this.data[i].combos.map(item => {\r\n          return { \r\n            id_product: item.id_product, \r\n            ptype: item.type,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n            id_category: this.data[i].id_category\r\n          }\r\n        })\r\n        new_item = {...new_item, combos: combos}\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    this.changeVl.emit(products);\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data) {\r\n    \r\n    if (data) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        let unit_array = [];\r\n        data[i] = {...data[i],unit_array }\r\n        // let unitMain = {\r\n        //   unit: data[i].unit,\r\n        //   ratio: 1,\r\n        //   barcode: data[i].barcode,\r\n        //   price: data[i].price,\r\n        //   price2: data[i].price2,\r\n        //   price_important: data[i].price_important,\r\n        // };\r\n        // data[i]['unit_array'].unshift(unitMain);\r\n        if (data[i].units) {\r\n          data[i]['unit_array'] = data[i]['unit_array'].concat(data[i].units)\r\n        }\r\n        data[i] = {...data[i], quantity_discount: 1}\r\n        if((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(data[i]);          \r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n  quantity: any = 0;\r\n  isVisibleEditUnitQuantity = false\r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  openEditUnitQuantity(detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitQuantity = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.quantity = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleEditUnitQuantity() {\r\n    if (this.quantity.getRawValue() >= 0) {\r\n      this.tempDetail.quantity_discount = parseFloat(this.quantity.getRawValue());\r\n    } else if (this.quantity.getRawValue() < 0)\r\n      this.vhComponent.alertMessageDesktop(\r\n        'error',\r\n        this.lang.translate('Invalid data, please check again')\r\n      );\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleCancelEditUnitQuantity() {\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  this.data.splice(this.data.indexOf(item), 1)\r\n    });\r\n  }\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!data.length\" class=\"no-data\">\r\n        <p>{{'Select promotional product' | translate}}</p>\r\n    </div>\r\n    <!-- <div *ngIf=\"promotion_all_products\" class=\"no-data\">\r\n        <p style=\"font-weight: bold; font-size: 0.95rem;\">{{'Apply to all products' | translate}}</p>\r\n    </div> -->\r\n</div>\r\n<div class=\"hideScrollbar sales-cart-invoiceDetail\" *ngIf=\"data.length\" >\r\n    <div class=\"invoiceDetail-header\">\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n            </div>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">  \r\n                {{\"Product name\" | translate}}\r\n            </div>\r\n            <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                {{\"Selling price\" | translate}}\r\n            </div>\r\n            <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                {{'Unit' | translate}}\r\n            </div>\r\n            <div class=\"invoiceDetail-header-quantity text-right\" nz-col nzSpan=\"4\">\r\n                {{\"New price\" | translate}}\r\n            </div>\r\n            <div class=\"invoiceDetail-header-quantity text-right\" nz-col nzSpan=\"3\">\r\n                {{\"Quantity\" | translate}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"invoiceDetail-item-scroll hideScrollbar\" id=\"invoiceDetail-item-scroll-add\">\r\n        <div class=\"invoiceDetail-item\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    \r\n                </div>\r\n                <div nz-col nzSpan=\"8\" class=\"center-col\">\r\n                   \r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n\r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"4\">\r\n                    \r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" style=\"border-bottom: 1px solid #ccc; cursor: pointer\" nz-col nzSpan=\"7\" (click)=\"openEditUnitPrices()\">\r\n                    {{'Enter uniform price' | translate}}\r\n                </div>                \r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"invoiceDetail-item\" *ngFor=\"let item of data\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div (click)=\"remove(item)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                </div>\r\n                <div nz-col nzSpan=\"8\" class=\"center-col\">\r\n                    <b>{{item.name}}</b>\r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"4\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.price_unit ? item.price_unit : item.price)}}\r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                    <nz-select [ngModel]=\"item.unit\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                        <nz-option [nzValue]=\"un.unit\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                    </nz-select>\r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                    <div style=\"text-align: right;\" >\r\n                        {{vhAlgorithm.vhcurrencyunit(price_same)}}</div>\r\n                </div>        \r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\" style=\"cursor: pointer\" (click)=\"openEditUnitQuantity(item)\">\r\n                    {{item.quantity_discount}} <i nz-icon nzType=\"edit\" nzTheme=\"outline\" style=\"color: #00A859\"></i>\r\n                </div>        \r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Discount uniform price' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" nz-input [value]=\"price_same\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'_Quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"tempDetail.quantity_discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-discount-take-gift',\r\n  templateUrl: './discount-take-gift.component.html',\r\n  styleUrls: ['./discount-take-gift.component.scss']\r\n})\r\nexport class DiscountTakeGiftComponent implements OnInit {\r\n\r\n  @Output() updateProducts = new EventEmitter<any>();\r\n  @Output() gift_length = new EventEmitter<number>();\r\n  searchProductList: boolean = false;\r\n  searchProductGift: boolean = false;\r\n  quantity: number = 1;\r\n  buy = [];\r\n  gift = []\r\n  data = {\r\n    dataBuy: [],\r\n    dataGift: []\r\n  }\r\n  constructor(\r\n    private vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private lang: LanguageService,\r\n    private vhComponent: VhComponent,\r\n    private modal: NzModalService\r\n  ) { }\r\n  \r\n  \r\n  ngOnInit(): void {\r\n\r\n  }\r\n  \r\n\r\n  mathRound(value) {\r\n    return Math.round(value)\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp mua\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp tặng\r\n   */\r\n  openSearchProductGift() {\r\n    this.searchProductGift = true\r\n  }\r\n\r\n  \r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, e) {\r\n    item.price = item.unit_array.find(it => it.unit == e).price;\r\n    item.ratio = item.unit_array.find(it => it.unit == e).ratio\r\n    item.unit = e\r\n  }\r\n\r\n  /**\r\n   * bắt sk đóng drawer chọn sp tặng\r\n   * @param data \r\n   */\r\n  closeSearchProductGift(data) {\r\n    if (data) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        let unit_array = [];\r\n        data[i] = {...data[i],unit_array }\r\n        // let unitMain = {\r\n        //   unit: data[i].unit,\r\n        //   ratio: 1,\r\n        //   barcode: data[i].barcode,\r\n        //   price: data[i].price,\r\n        //   price2: data[i].price2,\r\n        //   price_important: data[i].price_important,\r\n        // };\r\n        // data[i]['unit_array'].unshift(unitMain);\r\n        if (data[i].units) {\r\n          data[i]['unit_array'] = data[i]['unit_array'].concat(data[i].units)\r\n        }\r\n        let quantity_discount = 1;\r\n        let price_gift = 0\r\n        data[i] = {...data[i], quantity_discount: quantity_discount, price_gift: price_gift}\r\n        if((this.gift.length + data.length) <= 100) {\r\n          this.gift.unshift(data[i]);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.gift_length.emit(this.gift.length)\r\n    this.searchProductGift = false;\r\n\r\n  }\r\n\r\n  /**\r\n   * bắt sk đóng drawer chọn sp mua\r\n   * @param data \r\n   */\r\n  closeSearchProductList(data) {     \r\n    if (data) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        let unit_array = [];\r\n        data[i] = {...data[i],unit_array }\r\n        // let unitMain = {\r\n        //   unit: data[i].unit,\r\n        //   ratio: 1,\r\n        //   barcode: data[i].barcode,\r\n        //   price: data[i].price,\r\n        //   price2: data[i].price2,\r\n        //   price_important: data[i].price_important,\r\n        // };\r\n        // data[i]['unit_array'].unshift(unitMain);\r\n        if (data[i].units) {\r\n          data[i]['unit_array'] = data[i]['unit_array'].concat(data[i].units)\r\n        }\r\n        let quantity_discount = 1;\r\n        data[i] = {...data[i], quantity_discount: quantity_discount}\r\n        if((this.buy.length + data.length) <= 100) {\r\n          this.buy.unshift(data[i]);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.searchProductList = false;\r\n  }\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions(){\r\n    this.data = {\r\n      dataBuy: [],\r\n      dataGift: []\r\n    } \r\n    // clear data sp mua để lưu DB\r\n    for (let i = 0; i < this.buy.length; i++) {\r\n      let dt_Buy: any = {\r\n        id_product: this.buy[i]._id,\r\n        ratio: this.buy[i].ratio ? this.buy[i].ratio : 1,\r\n        quantity: this.buy[i].quantity_discount,\r\n        ptype: this.buy[i].type,\r\n        // id_subproduct: this.buy[i].id_subproduct ? this.buy[i].id_subproduct : ''\r\n      }\r\n      if(this.buy[i].id_subproduct) {\r\n        dt_Buy = {...dt_Buy, id_subproduct: this.buy[i].id_subproduct}\r\n      }\r\n      if(dt_Buy.ptype == 5) {\r\n        let combos = this.buy[i].combos.map(item => {\r\n          let combo ={ \r\n            id_product: item.id_product, \r\n            ptype: item.type,\r\n            price: item.price,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n          }\r\n          if(item.id_subproduct) combo['id_subproduct'] = item.id_subproduct\r\n          return  combo\r\n        })\r\n        dt_Buy = {...dt_Buy, combos: combos}\r\n      }\r\n      this.data.dataBuy.push(dt_Buy);\r\n      \r\n    }\r\n    // clear data sp tặng để lưu DB\r\n    for (let j = 0; j < this.gift.length; j++) {\r\n      let dt_gift: any = {\r\n        id_product: this.gift[j]._id,\r\n        ratio: this.gift[j].ratio ? this.gift[j].ratio : 1,\r\n        quantity: this.gift[j].quantity_discount,\r\n        price: this.gift[j].price_gift,\r\n        ptype: this.gift[j].type,\r\n      }\r\n      if(this.gift[j].id_subproduct) {\r\n        dt_gift = {...dt_gift, id_subproduct: this.gift[j].id_subproduct}\r\n      }\r\n      if(dt_gift.ptype == 5) {\r\n        let combos = this.gift[j].combos.map(item => {\r\n          let combo ={ \r\n            id_product: item.id_product, \r\n            ptype: item.type,\r\n            price: item.price,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n          }\r\n          if(item.id_subproduct) combo['id_subproduct'] = item.id_subproduct\r\n          return  combo\r\n        })\r\n        dt_gift = {...dt_gift, combos: combos}\r\n      }\r\n      this.data.dataGift.push(dt_gift)\r\n    }    \r\n   this.updateProducts.emit(this.data)\r\n    \r\n  }\r\n\r\n  /**\r\n   * xóa sp mua\r\n   */\r\n  public remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  this.buy.splice(this.buy.indexOf(item), 1)\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xóa sp tặng\r\n   */\r\n  removeGift(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  {\r\n        this.gift.splice(this.gift.indexOf(item), 1)\r\n        this.gift_length.emit(this.gift.length)\r\n      }\r\n    });\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  temp: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  price: any = 0;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrices(detail) {\r\n    this.temp = detail\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if(this.price.getRawValue() && this.price.getRawValue() >= 0) {\r\n      this.temp.price_gift = parseFloat(this.price.getRawValue())\r\n    } else {\r\n      this.temp.price_gift = 0\r\n    }\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n  // -------modal edit unit quantity-------\r\n  buyQuantity: any;\r\n  isVisibleEditUnitQuantity: boolean = false;\r\n  quantity_discount: any;\r\n\r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  openEditUnitQuantity(detail) {\r\n    this.buyQuantity = detail;\r\n    this.isVisibleEditUnitQuantity = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.quantity_discount = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleEditUnitQuantity() {\r\n    if (this.quantity_discount.getRawValue() >= 0) {\r\n      this.buyQuantity.quantity_discount = parseFloat(this.quantity_discount.getRawValue());\r\n    } else if (this.quantity_discount.getRawValue() < 0)\r\n      this.vhComponent.alertMessageDesktop(\r\n        \"error\",\r\n        this.lang.translate('Invalid data, please check again')\r\n      );\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleCancelEditUnitQuantity() {\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" style=\"height: 6%; margin-bottom: 4px;\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n    <div class=\"take-gift\">\r\n        <div nz-row nzSpan=\"24\" style=\"height: 10%; z-index: 99;\">\r\n            <div class=\"slide\" nz-col nzSpan=\"12\">\r\n                <div class=\"slide-item\" nz-col nzSpan=\"8\">\r\n                    Sản phẩm mua\r\n                </div>\r\n                <div class=\"slide-item text-right\" nz-col nzSpan=\"8\">\r\n                    Số lượng\r\n                </div>\r\n                <div class=\"slide-item text-right\" nz-col nzSpan=\"8\">\r\n                    Đơn giá\r\n                </div>\r\n            </div>\r\n            <div class=\"slide\" nz-col nzSpan=\"12\">\r\n                <div class=\"slide-item\" nz-col nzSpan=\"8\">\r\n                    Sản phẩm tặng\r\n                </div>\r\n                <div class=\"slide-item text-right\" nz-col nzSpan=\"8\">\r\n                    Số lượng\r\n                </div>\r\n                <div class=\"slide-item text-right\" nz-col nzSpan=\"8\">\r\n                    Đơn giá\r\n                </div>\r\n            </div>\r\n        </div>\r\n    \r\n        <div nz-row nzSpan=\"24\" style=\"height: 90%;\">\r\n            <div nz-col nzSpan=\"12\" class=\"products\">\r\n                <div nz-col nzSpan=\"24\" class=\"btn-search\" (click)=\"openSearchProductList()\">\r\n                    <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                    Chọn sản phẩm mua\r\n                </div>\r\n                <div nz-row class=\"list-item\" *ngFor=\"let item of buy\" >\r\n                    <div nz-col nzSpan=\"2\">\r\n                        <i nz-icon nzType=\"close\" nzTheme=\"outline\" style=\"color: red; cursor: pointer\" (click)=\"remove(item)\"></i>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"22\">\r\n                        <div nz-row nzSpan=\"24\">\r\n                            <b>{{item.name}}</b>\r\n                        </div>\r\n                        <div nz-row nzSpan=\"24\" style=\"align-items: center;\">\r\n                            <div nz-col nzSpan=\"8\" class=\"text-left\">\r\n                                <nz-select [ngModel]=\"item.unit\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                                    <nz-option [nzValue]=\"un.unit\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                                </nz-select>\r\n                            </div>\r\n                            \r\n                            <div nz-col nzSpan=\"8\" (click)=\"openEditUnitQuantity(item)\" style=\"text-align: center; border-bottom: 1px solid #eee; cursor: pointer\">\r\n                                {{mathRound(item.quantity_discount)}}\r\n                            </div>\r\n                            <div nz-col nzSpan=\"8\" style=\"text-align: right\">\r\n                                {{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n    \r\n            <div nz-col nzSpan=\"12\" class=\"products\">\r\n                <div nz-col nzSpan=\"24\" class=\"btn-search\" (click)=\"openSearchProductGift()\">\r\n                    <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                    Chọn sản phẩm khuyến mãi  \r\n                </div>\r\n                <div nz-row class=\"list-item\" *ngFor=\"let item of gift\">\r\n                    <div nz-col nzSpan=\"2\">\r\n                        <i nz-icon nzType=\"close\" nzTheme=\"outline\" style=\"color: red; cursor: pointer\" (click)=\"removeGift(item)\"></i>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"22\">\r\n                        <div nz-row nzSpan=\"24\">\r\n                            <b>{{item.name}}</b>\r\n                        </div>\r\n                        <div nz-row nzSpan=\"24\" style=\"align-items: center;\">\r\n                            <div nz-col nzSpan=\"8\" class=\"text-left\">\r\n                                <nz-select [ngModel]=\"item.unit\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                                    <nz-option [nzValue]=\"un.unit\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                                </nz-select>\r\n                            </div>\r\n                            <div nz-col nzSpan=\"8\" (click)=\"openEditUnitQuantity(item)\" style=\"text-align: center; border-bottom: 1px solid #eee; cursor: pointer\">\r\n                                {{mathRound(item.quantity_discount)}}\r\n                            </div>\r\n                            \r\n                            <div nz-col nzSpan=\"8\" style=\"text-align: right; cursor: pointer\" (click)=\"openEditUnitPrices(item)\">\r\n                                {{vhAlgorithm.vhcurrencyunit(item.price_gift)}} <i nz-icon nzType=\"edit\" nzTheme=\"outline\" style=\"color: #00A859\"></i>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                </div>\r\n            </div>\r\n    \r\n        </div>\r\n    \r\n    </div>\r\n</div>\r\n\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\" (closeSearchProductList)=\"closeSearchProductList($event)\"></app-search-product>\r\n<app-search-product *ngIf=\"searchProductGift\" [searchProductList]=\"searchProductGift\" (closeSearchProductList)=\"closeSearchProductGift($event)\"></app-search-product>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Gift discount amount' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" nz-input [value]=\"temp.price_gift\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'Gift/Sale quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"buyQuantity.quantity_discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>","import { Component, OnInit, Output, EventEmitter, Input, ElementRef, ViewChild } from '@angular/core';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { VhType } from 'src/app/sales/interface/vh-type';\r\n\r\n@Component({\r\n  selector: 'app-search-product',\r\n  templateUrl: './search-product.component.html',\r\n  styleUrls: ['./search-product.component.scss']\r\n})\r\nexport class SearchProductComponent implements OnInit {\r\n  @ViewChild(\"inputSearchPromotion\") myInputField: ElementRef;\r\n  @Input(\"searchProductList\") searchProductList: boolean = true;\r\n  @Input(\"searchProductList\") searchProductGift: boolean = true;\r\n  @Output(\"closeSearchProductList\") closeSearchProductList = new EventEmitter<any>();\r\n  id_branch: string = this.vhQuerySales.getDefaultBranch()._id\r\n  indexTab: number = 0\r\n  constructor(\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhQuerySales: VhQuerySales\r\n  ) { }\r\n  public goodList: any[] = [];\r\n  public searchList: any[] = [];\r\n  public typeGoods = 0;\r\n  search: string = '';\r\n  observableProducts: any;\r\n  list_data: any = [];\r\n\r\n  ngOnInit(): void {\r\n    this.changeTypeGood(this.typeGoods)\r\n  }\r\n  ngOnDestroy() {\r\n    // this.observableProducts.unsubscribe();\r\n  }\r\n  ngAfterViewInit() {\r\n    this.myInputField.nativeElement.focus();\r\n  }\r\n  acticeFocus() {\r\n    this.myInputField.nativeElement.focus();\r\n  }\r\n  goBack() {\r\n    this.closeSearchProductList.emit(false);\r\n  }\r\n  tempVal: string = ''\r\n  searchProduct(value: string) {\r\n    this.tempVal = this.vhAlgorithm.changeAlias(value.toLowerCase());\r\n    if (value.length)\r\n      this.searchList = this.vhAlgorithm.searchList(this.tempVal, this.goodList, ['name', 'barcode'])\r\n    else this.searchList = this.goodList\r\n  }\r\n  chooseProduct(item) {\r\n    item.selected = !item.selected\r\n  }\r\n\r\n  submitProduct() {\r\n    let list_select = this.goodList.filter(item => item.selected == true);\r\n    this.list_data = this.list_data.concat(list_select);\r\n    // \r\n\r\n    if (this.list_data) {\r\n      this.closeSearchProductList.emit(this.list_data);\r\n    }\r\n  }\r\n\r\n  tabs: any = ['Product', 'Service', 'Combo']\r\n  changeTypeGood(event) {\r\n    let type: number = VhType.PRODUCT;\r\n    switch (event) {\r\n      case 0: type = VhType.PRODUCT; break;\r\n      case 1: type = VhType.SERVICE; break;\r\n      default: type = VhType.COMBO; break;\r\n    }\r\n    this.goodList = this.vhQuerySales.getlocalDetailProducts(type).filter(e => !e.delete_hidden).filter(e => !e.manylot || (e.manylot && e.lots.length)).map(item => {\r\n      let unit = this.vhQuerySales.getUnit_byRatio(item.units, 1)\r\n      return { ...item, ...unit }\r\n    });\r\n    this.searchProduct(this.tempVal)\r\n  }\r\n}\r\n","<nz-drawer [nzMaskClosable]=\"true\" [nzWidth]=\"500\" [nzVisible]=\"searchProductList\"\r\n  (nzOnClose)=\"goBack()\"  [nzFooter]=\"footerTpl\">\r\n  <ng-container *nzDrawerContent>\r\n    <div nz-row>\r\n      <div nz-col nzSpan=\"24\"><input (blur)=\"acticeFocus()\" #inputSearchPromotion class=\"nz-hover-border\"\r\n          placeholder=\"{{ 'Search for product name, barcode' | translate}}\" [(ngModel)]=\"search\"\r\n          (ngModelChange)=\"searchProduct($event)\" [ngModelOptions]=\"{standalone: true}\" nz-input />\r\n      </div>\r\n    </div>\r\n    <div nz-row>\r\n      <div nz-col nzSpan=\"24\">\r\n        <nz-tabset (nzSelectedIndexChange)=\"changeTypeGood($event);indexTab =$event\" [nzSelectedIndex]=\"indexTab\">\r\n          <nz-tab *ngFor=\"let tab of tabs\" nzTitle=\"{{tab | translate}}\"></nz-tab>\r\n        </nz-tabset>\r\n        <cdk-virtual-scroll-viewport itemSize=\"67.2\" class=\"infinite-container\">\r\n          <nz-list>\r\n            <nz-list-item *cdkVirtualFor=\"let item of searchList\"\r\n              style=\"cursor: pointer;\">\r\n\r\n              <label nz-checkbox [(ngModel)]=\"item.selected\" (click)=\"chooseProduct(item)\"></label>\r\n              <nz-list-item-meta (click)=\"chooseProduct(item)\" nzAvatar=\"{{item.img ? item.img : 'assets/icon/management/noimage.svg'}}\" *ngIf=\"!item.subs\">\r\n                <nz-list-item-meta-title>\r\n                  <span style=\"font-size: 0.9rem; color: var(--ion-color-vh-black)\">\r\n                    {{item.name}}\r\n                    <div>\r\n                      Giá bán: <span style=\"color: #00A859\">{{vhAlgorithm.vhcurrencyunit_symbol(item.price)}}</span> \r\n                    </div>                    \r\n                    <div *ngIf=\"indexTab ==0\">\r\n                      {{'Stock' | translate}}:\r\n                      <span style=\" color: var(--ion-color-vh-orange)\">{{item.quantity_branch[id_branch]}}</span>\r\n                    </div>\r\n                  </span>\r\n                </nz-list-item-meta-title>\r\n              </nz-list-item-meta>\r\n            </nz-list-item>\r\n\r\n            \r\n            \r\n            <nz-list-empty *ngIf=\"searchList.length === 0\"></nz-list-empty>\r\n          </nz-list>\r\n        </cdk-virtual-scroll-viewport>\r\n      </div>\r\n    </div>\r\n  </ng-container>\r\n\r\n  <ng-template #footerTpl>\r\n    <div style=\"float: right\">\r\n      <button nz-button style=\"margin-right: 8px;\" (click)=\"goBack()\">Hủy</button>\r\n      <button nz-button nzType=\"primary\" (click)=\"submitProduct()\">Ok</button>\r\n    </div>\r\n  </ng-template>\r\n</nz-drawer>\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\n\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-detail-discount-each-product',\r\n  templateUrl: './detail-discount-each-product.component.html',\r\n  styleUrls: ['./detail-discount-each-product.component.scss'],\r\n})\r\nexport class DetailDiscountEachProductComponent implements OnInit {\r\n  @Input() promotion_all_products\r\n  @Output() updateProduct = new EventEmitter<any>();\r\n  @Input() data: any = [];\r\n  @Input() type: number;\r\n  public vhPromotion: any;\r\n  searchProductList: boolean = false;\r\n  isVisibleEditUnitPriceAll: boolean = false;\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    private modal: NzModalService\r\n\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n  if(!this.promotion_all_products) this.getDataById();    \r\n  }\r\n\r\n  /** Lấy dữ liệu local */\r\n  getDataById() {\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let product = this.vhQuerySales.getlocalDetailProduct( this.data[i].id_subproduct ? this.data[i].id_subproduct : this.data[i].id_product);\r\n      this.data[i].name = product.name;\r\n      product['unit_array'] = [];\r\n      if (product.units) {\r\n        this.data[i]['unit_array'] = product['unit_array'].concat(product.units); //thêm mảng unit để chọn unit, chọn giá\r\n        this.data[i]['discount'] = this.data[i].price_reduce\r\n      } else {\r\n        let discount =this.data[i].price_reduce\r\n        this.data[i] = {...this.data[i], unit_array: product['unit_array'], discount: discount};\r\n      }   \r\n    }\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, ratio) {\r\n    item.price_origin = item.unit_array.find(it => it.ratio == ratio).price;\r\n    item.price = item.price_origin > item.discount ? item.price_origin - item.discount : 0\r\n    item.ratio =  ratio\r\n    item.unit = item.unit_array.find(it => it.ratio == ratio).unit\r\n  }\r\n\r\n  /** Modal edit all price */\r\n  new_discount: any;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm cho tất cả\r\n   */\r\n  openEditUnitPriceAll() {\r\n    this.isVisibleEditUnitPriceAll = true;\r\n\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.new_discount = this.vhAlgorithm.vhnumeral('.unit_price_all');\r\n    });\r\n    \r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm cho tất cả\r\n   */\r\n  handleEditUnitAll() {\r\n    if (this.new_discount.getRawValue() >= 0) {\r\n      for (let i = 0; i < this.data.length; i++) {\r\n        this.data[i].discount = parseFloat(\r\n          document.getElementById('unit_price_all')['value']\r\n        );\r\n        this.data[i].discount = parseFloat(this.new_discount.getRawValue());\r\n        if (this.data[i].discount > this.data[i].price) {\r\n          this.data[i].new_price = 0;\r\n        } else {\r\n          this.data[i].new_price =\r\n            this.data[i].price - parseFloat(this.new_discount.getRawValue());\r\n        }\r\n      }\r\n    } else if (this.type == 1 && this.new_discount.getRawValue() < 0)\r\n      this.vhComponent.showToast(\r\n        2000,\r\n        this.lang.translate('Invalid data, please check again'),\r\n        'alert-toast'\r\n      );\r\n    this.isVisibleEditUnitPriceAll = false;\r\n  }\r\n\r\n  /**\r\n   * đóng modal nhập giá giảm cho tất cả và ko lưu\r\n   */\r\n  handleCancelEditUnitAll() {\r\n    this.isVisibleEditUnitPriceAll = false;\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  price: any;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrice(detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if (this.price.getRawValue() >= 0) {\r\n      this.tempDetail.discount = parseFloat(this.price.getRawValue());\r\n      if (this.tempDetail.discount > this.tempDetail.price) {\r\n        this.tempDetail.new_price = 0;\r\n      } else\r\n        this.tempDetail.new_price =\r\n          this.tempDetail.price - parseFloat(this.price.getRawValue());\r\n    } else {\r\n      this.vhComponent.showToast(\r\n        2000,\r\n        this.lang.translate('Invalid data, please check again'),\r\n        'alert-toast'\r\n      );\r\n    }\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {    \r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i].id_product,\r\n        ratio: this.data[i].ratio, \r\n        price_reduce: this.data[i].discount,\r\n        price_origin: this.data[i].price_origin,\r\n        ptype: this.data[i].ptype,\r\n        quantity: this.data[i].quantity,\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if(new_item.ptype == 5) {\r\n        let combos = this.data[i].combos\r\n        new_item = {...new_item, combos: combos}\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    this.updateProduct.emit(products);\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      for(let i = 0; i < data.length; i++) {\r\n        let new_item: any = {\r\n          id_product: data[i]._id,\r\n          price_origin: data[i].price,\r\n          ratio: data[i].ratio ? data[i].ratio : 1,\r\n          unit: data[i].unit,\r\n          discount: 0,\r\n          quantity: 1,\r\n          ptype: data[i].type,          \r\n          name: data[i].name,\r\n          unit_array: data[i].units  \r\n        }\r\n        if(data[i].id_subproduct) {\r\n          new_item = {...new_item, id_subproduct: data[i].id_subproduct}\r\n        }\r\n        if(new_item.ptype == 5) {          \r\n          let combos = data[i].combos.map(item => {\r\n            return {\r\n              id_product: item.id_product, \r\n              ptype: item.type,\r\n              price: item.price,\r\n              ratio: item.ratio ? item.ratio : 1,\r\n              unit: item.unit ? item.unit : '',\r\n              quantity: item.quantity,\r\n              id_category: data[i].id_category\r\n            }\r\n          })\r\n          new_item = {...new_item, combos: combos}\r\n        }\r\n        if((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(new_item);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }    \r\n    this.searchProductList = false;\r\n  }\r\n\r\n  // -------modal edit unit quantity-------\r\n  temp: any;\r\n  isVisibleEditUnitQuantity: boolean = false;\r\n  quantity: any = 0;\r\n\r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  openEditUnitQuantity(detail) {\r\n    this.temp = detail;\r\n    this.isVisibleEditUnitQuantity = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.quantity = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleEditUnitQuantity() {\r\n    if (this.quantity.getRawValue() >= 0) {\r\n      this.temp.quantity = parseFloat(this.quantity.getRawValue());\r\n    } else if (this.quantity.getRawValue() < 0)\r\n      this.vhComponent.alertMessageDesktop(\r\n        'error',\r\n        this.lang.translate('Invalid data, please check again')\r\n      );\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleCancelEditUnitQuantity() {\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  this.data.splice(this.data.indexOf(item), 1)\r\n    });\r\n  }\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button [disabled]=\"promotion_all_products\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!promotion_all_products\" class=\"no-data\">\r\n        <p *ngIf=\"!data.length \">{{'Select promotional products or apply to all products' | translate}}</p>\r\n    </div>\r\n    <div *ngIf=\"promotion_all_products\" class=\"no-data\">\r\n        <p style=\"font-weight: bold; font-size: 0.95rem;\">{{'Apply to all products' | translate}}</p>\r\n    </div>\r\n</div>\r\n<div class=\"hideScrollbar sales-cart-invoiceDetail\" *ngIf=\"!promotion_all_products\">\r\n    <div *ngIf=\"data.length\" class=\"invoiceDetail-header\">\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n            </div>\r\n            <div nz-col nzSpan=\"6\" class=\"center-col\">  \r\n                {{\"Product name\" | translate}}\r\n            </div>\r\n            <div class=\"text-right\" nz-col nzSpan=\"3\">\r\n                {{\"Selling price\" | translate}}\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"4\">\r\n                {{\"Unit\" | translate}}\r\n            </div>\r\n            <div class=\"invoiceDetail-header-quantity text-right\" nz-col nzSpan=\"3\">\r\n                {{\"Discount in amount\" | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                {{'New price per product' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                {{'Quantity' | translate}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"data.length\" class=\"invoiceDetail-item-scroll hideScrollbar\" id=\"invoiceDetail-item-scroll-add\">\r\n        <div class=\"invoiceDetail-item\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    \r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"center-col\">\r\n                    \r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                   \r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n\r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                    <div style=\"text-align: right;\" (click)=\"openEditUnitPriceAll()\">\r\n                        Giảm tất cả\r\n                    </div>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                    \r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                    \r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"invoiceDetail-item\" *ngFor=\"let item of !promotion_all_products ? data : []\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div (click)=\"remove(item)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"center-col\">\r\n                    <b>{{item.name}}</b>\r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.price_origin)}}\r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                    <nz-select [ngModel]=\"item.ratio\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                        <nz-option [nzValue]=\"un.ratio\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                    </nz-select>\r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"3\">\r\n                    <div style=\"text-align: right;\" (click)=\"openEditUnitPrice(item)\">\r\n                        {{vhAlgorithm.vhcurrencyunit(item.discount ? item.discount : 0)}}</div>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                    <b>{{vhAlgorithm.vhcurrencyunit(item.price_origin > item.discount ? item.price_origin - item.discount : 0)}}</b>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\" style=\"cursor: pointer\" (click)=\"openEditUnitQuantity(item)\">\r\n                    {{item.quantity}} <i nz-icon nzType=\"edit\" nzTheme=\"outline\" style=\"color: #00A859\"></i>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Discount amount by product' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" [value]=\"tempDetail.discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit discount all-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPriceAll\" *ngIf=\"isVisibleEditUnitPriceAll\" [(nzVisible)]=\"isVisibleEditUnitPriceAll\"\r\n    nzTitle=\"{{'Discount amount for all products' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitAll()\" (nzOnOk)=\"handleEditUnitAll()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price_all\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price_all\" nz-input value=\"0\"/>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPriceAll>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitAll()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitAll()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'_Quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"temp.quantity\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-detail-discount-many-product',\r\n  templateUrl: './detail-discount-many-product.component.html',\r\n  styleUrls: ['./detail-discount-many-product.component.scss']\r\n})\r\nexport class DetailDiscountManyProductComponent implements OnInit {\r\n\r\n  @Output() updateProduct = new EventEmitter<any>();\r\n  @Input() data: any = []\r\n  searchProductList: boolean = false;\r\n  type: number = 4;\r\n  discount_price_all: number = 0;\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    private modal: NzModalService\r\n\r\n  ) { \r\n  }\r\n\r\n  ngOnInit(): void {  \r\n    this.getDataById()\r\n  }\r\n\r\n   /** Lấy dữ liệu local */\r\n   getDataById() {\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let product = this.vhQuerySales.getlocalDetailProduct( this.data[i].id_subproduct ? this.data[i].id_subproduct : this.data[i].id_product);\r\n      \r\n      \r\n      this.data[i].name = product.name\r\n      // this.data[i].price_unit = product.price\r\n      product['unit_array'] = [];\r\n      if (product.units) {\r\n        this.data[i]['unit_array'] = product['unit_array'].concat(product.units); //thêm mảng unit để chọn unit, chọn giá\r\n        this.data[i]['price_unit'] = this.data[i]['unit_array'].find(item => item.ratio == this.data[i].ratio).price\r\n        this.data[i]['discount'] = this.data[i].price_reduce\r\n      } else {\r\n        let discount = this.data[i].price_reduce\r\n        this.data[i] = {...this.data[i], unit_array: product['unit_array'], discount: discount};\r\n      }\r\n    }\r\n    \r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, ratio) {\r\n    item.price_unit = item.unit_array.find(it => it.ratio == ratio).price;\r\n    item.price = item.price_unit > item.discount ? item.price_unit - item.discount : 0\r\n    item.ratio =ratio\r\n    item.unit =  item.unit_array.find(it => it.ratio == ratio).unit \r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {\r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i].id_product,\r\n        quantity: this.data[i].quantity,\r\n        ratio: this.data[i].ratio ? this.data[i].ratio : 1,\r\n        price_reduce: this.data[i].discount ? this.data[i].discount : 0,\r\n        ptype: this.data[i].ptype\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if(new_item.ptype == 5) {\r\n        let combos = this.data[i].combos\r\n        new_item = {...new_item, combos: combos}\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    // \r\n    \r\n    this.updateProduct.emit(products);\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  \r\n\r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data){    \r\n    if (data) {\r\n      for(let i = 0; i < data.length; i++) {\r\n        let new_item: any = {\r\n          id_product: data[i]._id,\r\n          price_unit: data[i].price,\r\n          ratio: data[i].ratio ? data[i].ratio : 1,\r\n          unit: data[i].unit,\r\n          discount: 0,\r\n          name: data[i].name,\r\n          quantity: 1,\r\n          ptype: data[i].type,\r\n          unit_array: data[i].units  \r\n        }\r\n        if(data[i].id_subproduct) {\r\n          new_item = {...new_item, id_subproduct: data[i].id_subproduct}\r\n        }\r\n        if(new_item.ptype == 5) {          \r\n          let combos = data[i].combos.map(item => {\r\n            return {\r\n              id_product: item.id_product, \r\n              ptype: item.type,\r\n              price: item.price,\r\n              ratio: item.ratio ? item.ratio : 1,\r\n              unit: item.unit ? item.unit : '',\r\n              quantity: item.quantity,\r\n              id_category: data[i].id_category\r\n            }\r\n          })\r\n          new_item = {...new_item, combos: combos}\r\n        }\r\n        if((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(new_item);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.searchProductList = false;    \r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  price: any = 0;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrice(detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if ( this.price.getRawValue() >= 0) {\r\n      this.tempDetail.discount = parseFloat(this.price.getRawValue());\r\n    } else if (this.price.getRawValue() < 0)\r\n      this.vhComponent.showToast(\r\n        2000,\r\n        this.lang.translate('Invalid data, please check again'),\r\n        'alert-toast'\r\n      );\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n\r\n   // -------modal edit unit quantity-------\r\n   temp: any;\r\n    isVisibleEditUnitQuantity: boolean = false;\r\n   quantity: any = 0;\r\n \r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n   openEditUnitQuantity(detail) {\r\n     this.temp = detail;\r\n     this.isVisibleEditUnitQuantity = true;\r\n     this.vhAlgorithm.waitingStack().then(() => {\r\n       this.quantity = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n     });\r\n   }\r\n \r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n   handleEditUnitQuantity() {\r\n     if ( this.quantity.getRawValue() >= 0) {\r\n       this.temp.quantity = parseFloat(this.quantity.getRawValue());\r\n     } else if (this.quantity.getRawValue() < 0)\r\n       this.vhComponent.alertMessageDesktop(\r\n         'error',\r\n         this.lang.translate('Invalid data, please check again')\r\n         \r\n       );\r\n     this.isVisibleEditUnitQuantity = false;\r\n   }\r\n   /**\r\n    * đóng modal chỉnh sửa số lượng sp trong km\r\n    */\r\n   handleCancelEditUnitQuantity() {\r\n     this.isVisibleEditUnitQuantity = false;\r\n   }\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  public remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  this.data.splice(this.data.indexOf(item), 1)\r\n    });\r\n  }\r\n\r\n    // Giảm giá cho tất cả\r\n\r\n   /** Modal edit all price */\r\n   new_discount: any = 0;\r\n   isVisibleEditUnitPriceAll: boolean = false;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm cho tất cả\r\n   */\r\n   openEditUnitPriceAll() {\r\n     this.isVisibleEditUnitPriceAll = true;\r\n  \r\n     this.vhAlgorithm.waitingStack().then(() => {\r\n       this.new_discount = this.vhAlgorithm.vhnumeral('.unit_price_all');\r\n     });\r\n     \r\n   }\r\n \r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm cho tất cả\r\n   */\r\n   handleEditUnitAll() {\r\n     if (this.new_discount.getRawValue() >= 0\r\n     ) {\r\n       for (let i = 0; i < this.data.length; i++) {\r\n         this.data[i].discount = parseFloat(\r\n           document.getElementById('unit_price_all')['value']\r\n         );\r\n         this.data[i].discount = parseFloat(this.new_discount.getRawValue());\r\n         this.discount_price_all = parseFloat(this.new_discount.getRawValue())\r\n       }\r\n     } else if (this.new_discount.getRawValue() < 0)\r\n       this.vhComponent.showToast(\r\n         2000,\r\n         this.lang.translate('Invalid data, please check again'),\r\n         'alert-toast'\r\n       );\r\n     this.isVisibleEditUnitPriceAll = false;\r\n   }\r\n \r\n  /**\r\n   * đóng modal nhập giá giảm cho tất cả và ko lưu\r\n   */\r\n   handleCancelEditUnitAll() {\r\n     this.isVisibleEditUnitPriceAll = false;\r\n   }\r\n\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button [disabled]=\"!data.length\" class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!data.length\" class=\"no-data\">\r\n        <p>{{'Please select a product' | translate}}</p>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"invoiceDetail-header\" *ngIf=\"data.length\">\r\n    <div nz-row>\r\n        <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n        </div>\r\n        <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n            {{\"Product name\" | translate}}\r\n        </div>\r\n        <div class=\"text-right\" nz-col nzSpan=\"3\">\r\n            {{\"Selling price\" | translate}}\r\n        </div>        \r\n        <div class=\"invoiceDetail-header-quantity text-center\" nz-col nzSpan=\"3\">\r\n            {{\"Unit\" | translate}}\r\n        </div>\r\n        <div nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n            {{'Discount value' | translate}}\r\n        </div>\r\n        <div nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n            {{'New price' | translate}}\r\n        </div>\r\n        <div class=\"invoiceDetail-header-quantity text-center\" style=\"text-align: right;\" nz-col nzSpan=\"3\">\r\n            {{'Sufficient quantity' | translate}}\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"invoiceDetail-item-scroll hideScrollbar\" id=\"invoiceDetail-item-scroll-add\">\r\n    <div nz-row [nzGutter]=\"16\">\r\n        <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n            \r\n        </div>\r\n        <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n            \r\n        </div>\r\n        <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n           \r\n        </div>       \r\n        <div class=\"text-center\" nz-col nzSpan=\"2\">\r\n           \r\n        </div>\r\n        <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"5\">\r\n            <div style=\"text-align: center; border-bottom: 1px solid #eee;\" (click)=\"openEditUnitPriceAll()\">\r\n                {{'Discount all' | translate}}\r\n            </div>\r\n        </div>\r\n        <div style=\"text-align: right;\" nz-col nzSpan=\"2\" class=\"ion-text-end\">\r\n           \r\n        </div>\r\n        <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n            \r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"invoiceDetail-item\" *ngFor=\"let item of data\">\r\n        <div nz-row [nzGutter]=\"16\">\r\n            <div (click)=\"remove(item)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                <i nz-icon nzType=\"close\" nzTheme=\"outline\" style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n            </div>\r\n            <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n                <b>{{item.name}}</b>\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\" >\r\n                {{vhAlgorithm.vhcurrencyunit(item.price_unit)}}\r\n            </div>            \r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                <nz-select [ngModel]=\"item.ratio\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                    <nz-option [nzValue]=\"un.ratio\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                </nz-select>\r\n            </div>\r\n            <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"3\">\r\n                <div style=\"text-align: right; border-bottom: 1px solid #eee; cursor: pointer\" (click)=\"openEditUnitPrice(item)\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.discount)}}\r\n                </div>\r\n            </div>\r\n            <div style=\"text-align: right;\" nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                <b>{{vhAlgorithm.vhcurrencyunit(item.price_unit > item.discount ? item.price_unit - item.discount : 0)}}</b>\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                <div style=\"text-align: right; border-bottom: 1px solid #eee\" (click)=\"openEditUnitQuantity(item)\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.quantity)}}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Discount in percent' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" [value]=\"tempDetail.discount\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'Reduced quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"temp.quantity\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit discount all-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPriceAll\" *ngIf=\"isVisibleEditUnitPriceAll\" [(nzVisible)]=\"isVisibleEditUnitPriceAll\"\r\n    nzTitle=\"Giảm giá tiền cho tất cả sản phẩm\"\r\n    (nzOnCancel)=\"handleCancelEditUnitAll()\" (nzOnOk)=\"handleEditUnitAll()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price_all\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price_all\" nz-input [value]=\"discount_price_all\"/>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPriceAll>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitAll()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitAll()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport {\r\n  VhPromotionDetail,\r\n  VhPromotions,\r\n} from 'src/app/sales/interface/vh-promotions-money-rate';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-detail-discount-percent-product',\r\n  templateUrl: './detail-discount-percent-product.component.html',\r\n  styleUrls: ['./detail-discount-percent-product.component.scss']\r\n})\r\nexport class DetailDiscountPercentProductComponent implements OnInit {\r\n  @Input() promotion_all_products\r\n  @Output() updateProduct = new EventEmitter<any>();\r\n  @Input() data: any = [];\r\n  @Input() type: number;\r\n  public vhPromotion: VhPromotions = new VhPromotions();\r\n  searchProductList: boolean = false;\r\n  isVisibleEditUnitPriceAll: boolean = false;\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    private modal: NzModalService\r\n\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    // let product = this.vhQuerySales.getlocalProduct(this.data.id_product);\r\n    // \r\n    if(!this.promotion_all_products)  this.getDataById();    \r\n  }\r\n\r\n  /** Lấy dữ liệu local */\r\n  getDataById() {\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let product = this.vhQuerySales.getlocalDetailProduct(this.data[i].id_subproduct ? this.data[i].id_subproduct : this.data[i].id_product);\r\n      this.data[i].name = product.name;\r\n      product['unit_array'] = [];\r\n      if (product.units) {\r\n        this.data[i]['unit_array'] = product['unit_array'].concat(product.units); //thêm mảng unit để chọn unit, chọn giá\r\n        this.data[i]['percent_discount'] = this.data[i].percent_reduce\r\n      } else {\r\n        this.data[i]['percent_discount'] = this.data[i].percent_reduce\r\n        this.data[i] = {...this.data[i], unit_array: product['unit_array']};\r\n      }\r\n      \r\n    }\r\n    \r\n  }      \r\n\r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, ratio) {\r\n    item.price_origin = item.unit_array.find(it => it.ratio == ratio).price;\r\n    item.ratio =  ratio\r\n    item.unit = item.unit_array.find(it => it.ratio == ratio).unit\r\n  }\r\n\r\n  /** Modal edit all price */\r\n  new_discount: any;\r\n  disabled_all: boolean = true;\r\n  percent_all: number = 0;\r\n  /**\r\n   * mở modal nhập % giảm cho tất cả\r\n   */\r\n  openEditUnitPriceAll() {\r\n    this.isVisibleEditUnitPriceAll = true;\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập % giảm cho tất cả\r\n   */\r\n  handleEditUnitAll() {\r\n    if (\r\n      parseFloat(document.getElementById('unit_price_all')['value']) >= 0 &&\r\n      parseFloat(document.getElementById('unit_price_all')['value']) <= 100\r\n    ) {\r\n      for (let i = 0; i < this.data.length; i++) {\r\n        this.data[i].percent_discount = parseFloat(document.getElementById('unit_price_all')['value']);\r\n        this.percent_all = parseFloat(document.getElementById('unit_price_all')['value']);\r\n        this.disabled_all = true;\r\n        this.isVisibleEditUnitPriceAll = false;\r\n      }\r\n    } else {\r\n      this.disabled_all = false;\r\n    }\r\n    // this.isVisibleEditUnitPriceAll = false;\r\n  }\r\n\r\n  /**\r\n   * đóng modal nhập % giảm cho tất cả và ko lưu\r\n   */\r\n  handleCancelEditUnitAll() {\r\n    this.isVisibleEditUnitPriceAll = false;\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  price: any;\r\n  disabled: boolean = true;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrice(detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if (parseFloat(document.getElementById('unit_price')['value']) >= 0 &&\r\n      parseFloat(document.getElementById('unit_price')['value']) <= 100) {\r\n      this.tempDetail.percent_discount = parseFloat(document.getElementById('unit_price')['value']);\r\n      this.disabled = true;\r\n       this.isVisibleEditUnitPrice = false;  \r\n    } else {\r\n      this.disabled = false;\r\n    }\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {    \r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i].id_product,\r\n        ratio: this.data[i].ratio,\r\n        price_origin: this.data[i].price_origin,\r\n        percent_reduce: this.data[i].percent_discount,\r\n        ptype: this.data[i].ptype,\r\n        quantity: this.data[i].quantity\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if(new_item.ptype == 5) {\r\n        let combos = this.data[i].combos\r\n        new_item = {...new_item, combos: combos}\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    \r\n    this.updateProduct.emit(products);\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      for(let i = 0; i < data.length; i++) {\r\n        let new_item: any = {\r\n          id_product: data[i]._id,          \r\n          ratio: data[i].ratio ? data[i].ratio : 1,\r\n          unit: data[i].unit,\r\n          price_origin: data[i].price,\r\n          percent_discount: 0,\r\n          ptype: data[i].type,\r\n          quantity: 1,\r\n          name: data[i].name,\r\n          unit_array: data[i].units  \r\n        }\r\n        if(data[i].id_subproduct) {\r\n          new_item = {...new_item, id_subproduct: data[i].id_subproduct}\r\n        }\r\n        if(new_item.ptype == 5) {          \r\n          let combos = data[i].combos.map(item => {\r\n            return {\r\n              id_product: item.id_product, \r\n              ptype: item.type,\r\n              price: item.price,\r\n              ratio: item.ratio ? item.ratio : 1,\r\n              unit: item.unit ? item.unit : '',\r\n              quantity: item.quantity,\r\n              id_category: data[i].id_category\r\n            }\r\n          })\r\n          new_item = {...new_item, combos: combos}\r\n        }\r\n        if((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(new_item);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n\r\n  // -------modal edit unit quantity-------\r\n  temp: any;\r\n  isVisibleEditUnitQuantity: boolean = false;\r\n  quantity: any = 0;\r\n\r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  openEditUnitQuantity(detail) {\r\n    this.temp = detail;\r\n    this.isVisibleEditUnitQuantity = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.quantity = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleEditUnitQuantity() {\r\n    if (this.quantity.getRawValue() >= 0) {\r\n      this.temp.quantity = parseFloat(this.quantity.getRawValue());\r\n    } else if (this.quantity.getRawValue() < 0)\r\n      this.vhComponent.alertMessageDesktop(\r\n        'error',\r\n        this.lang.translate('Invalid data, please check again')\r\n      );\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleCancelEditUnitQuantity() {\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  this.data.splice(this.data.indexOf(item), 1)\r\n    });\r\n  }\r\n\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button [disabled]=\"promotion_all_products\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!promotion_all_products\" class=\"no-data\">\r\n        <p *ngIf=\"!data.length \">{{'Select promotional products or apply to all products' | translate}}</p>\r\n    </div>\r\n    <div *ngIf=\"promotion_all_products\" class=\"no-data\">\r\n        <p style=\"font-weight: bold; font-size: 0.95rem;\">{{'Apply to all products' | translate}}</p>\r\n    </div>\r\n</div>\r\n<div class=\"hideScrollbar sales-cart-invoiceDetail\" *ngIf=\"!promotion_all_products\">\r\n    <div *ngIf=\"data.length\" class=\"invoiceDetail-header\">\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n            </div>\r\n            <div nz-col nzSpan=\"6\" class=\"center-col\">  \r\n                {{\"Product name\" | translate}}\r\n            </div>\r\n            <div class=\"text-right\" nz-col nzSpan=\"3\">\r\n                {{\"Selling price\" | translate}}\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"4\">\r\n                {{\"Unit\" | translate}}\r\n            </div>\r\n            <div class=\"invoiceDetail-header-quantity text-right\" nz-col nzSpan=\"3\">\r\n                {{'Discount %' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                {{'New price' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                {{'Quantity' | translate}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"data.length\" class=\"invoiceDetail-item-scroll hideScrollbar\" id=\"invoiceDetail-item-scroll-add\">\r\n        <div class=\"invoiceDetail-item\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    \r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"center-col\">\r\n                    \r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                   \r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n\r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                    <div style=\"text-align: right;\" (click)=\"openEditUnitPriceAll()\">\r\n                        Giảm tất cả\r\n                    </div>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                    \r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n                    \r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"invoiceDetail-item\" *ngFor=\"let item of !promotion_all_products ? data : []\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div (click)=\"remove(item)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                </div>\r\n                <div nz-col nzSpan=\"6\" class=\"center-col\">\r\n                    <b>{{item.name}}</b>\r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.price_origin)}}\r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                    <nz-select [ngModel]=\"item.ratio\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                        <nz-option [nzValue]=\"un.ratio\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                    </nz-select>\r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"3\">\r\n                    <div style=\"text-align: right;\" (click)=\"openEditUnitPrice(item)\">\r\n                        {{vhAlgorithm.vhpercent(item.percent_discount/100 ? item.percent_discount/100 : 0)}}</div>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                    <b>{{vhAlgorithm.vhcurrencyunit(item.price_origin * (100/100 - item.percent_discount/100))}}</b>\r\n                </div>\r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\" style=\"cursor: pointer\" (click)=\"openEditUnitQuantity(item)\">\r\n                    {{item.quantity}} <i nz-icon nzType=\"edit\" nzTheme=\"outline\" style=\"color: #00A859\"></i>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Discount in percent' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Percent' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" [value]=\"tempDetail.percent_discount\" nz-input />\r\n            </div>\r\n        </div>\r\n        <div nz-row *ngIf=\"!disabled\">\r\n            <div nz-col nzSpan=\"8\">\r\n\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <label style=\"color: red\">{{'Percentage required >= 0 and <= 100!' | translate}}</label>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit discount all-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPriceAll\" *ngIf=\"isVisibleEditUnitPriceAll\" [(nzVisible)]=\"isVisibleEditUnitPriceAll\"\r\n    nzTitle=\"{{'Discount percentage applied to all products' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitAll()\" (nzOnOk)=\"handleEditUnitAll()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Percent' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price_all\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price_all\" nz-input [value]=\"percent_all\"/>\r\n            </div>\r\n        </div>\r\n        <div nz-row *ngIf=\"!disabled_all\">\r\n            <div nz-col nzSpan=\"8\">\r\n\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <label style=\"color: red\">{{'Percentage required >= 0 and <= 100!' | translate}}</label>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPriceAll>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitAll()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitAll()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'_Quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"temp.quantity\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-detail-discount-percent-products',\r\n  templateUrl: './detail-discount-percent-products.component.html',\r\n  styleUrls: ['./detail-discount-percent-products.component.scss']\r\n})\r\nexport class DetailDiscountPercentProductsComponent implements OnInit {\r\n\r\n  @Output() updateProduct = new EventEmitter<any>();\r\n  @Input() data: any = []\r\n  searchProductList: boolean = false;\r\n  type: number = 5;\r\n  discount_percent_all: number = 0\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    private modal: NzModalService\r\n\r\n  ) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.getDataById()\r\n  }\r\n\r\n  /** Lấy dữ liệu local */\r\n  getDataById() {\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let product = this.vhQuerySales.getlocalDetailProduct(this.data[i].id_subproduct ? this.data[i].id_subproduct : this.data[i].id_product);\r\n      this.data[i].name = product.name\r\n      // this.data[i].price_unit = product.price\r\n      product['unit_array'] = [];\r\n      if (product.units) {\r\n        this.data[i]['unit_array'] = product['unit_array'].concat(product.units); //thêm mảng unit để chọn unit, chọn giá\r\n        this.data[i]['price_unit'] = this.data[i]['unit_array'].find(item => item.ratio == this.data[i].ratio).price\r\n        this.data[i]['percent_discount'] = this.data[i].percent_reduce\r\n      } else {\r\n        this.data[i]['percent_discount'] = this.data[i].percent_reduce\r\n        this.data[i] = { ...this.data[i], unit_array: product['unit_array'] };\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, ratio) {\r\n    item.price_unit = item.unit_array.find(it => it.ratio == ratio).price;\r\n    item.price = item.price_unit * item.discount\r\n    item.ratio = ratio\r\n    item.unit = item.unit_array.find(it => it.ratio == ratio).unit\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {\r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i].id_product,\r\n        quantity: this.data[i].quantity,\r\n        ratio: this.data[i].ratio ? this.data[i].ratio : 1,\r\n        percent_reduce: this.data[i].percent_discount,\r\n        ptype: this.data[i].ptype\r\n      };\r\n      if (this.data[i].id_subproduct) {\r\n        new_item = { ...new_item, id_subproduct: this.data[i].id_subproduct }\r\n      }\r\n      if (new_item.ptype == 5) {\r\n        let combos = this.data[i].combos\r\n        new_item = { ...new_item, combos: combos }\r\n      }\r\n      products.push(new_item);\r\n\r\n    }\r\n\r\n    this.updateProduct.emit(products);\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n\r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        let new_item: any = {\r\n          id_product: data[i]._id,\r\n          price_unit: data[i].price,\r\n          ratio: data[i].ratio ? data[i].ratio : 1,\r\n          unit: data[i].unit,\r\n          percent_discount: 0,\r\n          quantity: 1,\r\n          ptype: data[i].type,\r\n          name: data[i].name,\r\n          unit_array: data[i].units\r\n        }\r\n        if (data[i].id_subproduct) {\r\n          new_item = { ...new_item, id_subproduct: data[i].id_subproduct }\r\n        }\r\n        if (new_item.ptype == 5) {\r\n          let combos = data[i].combos.map(item => {\r\n            return {\r\n              id_product: item.id_product,\r\n              ptype: item.type,\r\n              price: item.price,\r\n              ratio: item.ratio ? item.ratio : 1,\r\n              unit: item.unit ? item.unit : '',\r\n              quantity: item.quantity,\r\n              id_category: data[i].id_category\r\n            }\r\n          })\r\n          new_item = { ...new_item, combos: combos }\r\n        }\r\n        if ((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(new_item);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  percent: any = 0;\r\n  disabled: boolean = true;\r\n\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrice(detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.percent = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if (parseFloat(this.percent.getRawValue()) >= 0 && parseFloat(this.percent.getRawValue()) <= 100) {\r\n      this.tempDetail.percent_discount = parseFloat(this.percent.getRawValue())\r\n      this.disabled = true;\r\n      this.isVisibleEditUnitPrice = false;\r\n    } else {\r\n      this.disabled = false;\r\n    }\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n  // -------modal edit unit quantity-------\r\n  temp: any;\r\n  isVisibleEditUnitQuantity: boolean = false;\r\n  quantity: any = 0;\r\n\r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  openEditUnitQuantity(detail) {\r\n    this.temp = detail;\r\n    this.isVisibleEditUnitQuantity = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.quantity = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleEditUnitQuantity() {\r\n    if (this.quantity.getRawValue() >= 0) {\r\n      this.temp.quantity = parseFloat(this.quantity.getRawValue());\r\n    } else if (this.quantity.getRawValue() < 0)\r\n      this.vhComponent.alertMessageDesktop(\r\n        'error',\r\n        this.lang.translate('Invalid data, please check again')\r\n\r\n      );\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleCancelEditUnitQuantity() {\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  public remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () => this.data.splice(this.data.indexOf(item), 1)\r\n    });\r\n  }\r\n\r\n  new_discount: any = 0;\r\n  isVisibleEditUnitPriceAll: boolean = false;\r\n  disabled_all: boolean = true;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm cho tất cả\r\n   */\r\n  openEditUnitPriceAll() {\r\n    this.isVisibleEditUnitPriceAll = true;\r\n\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.new_discount = this.vhAlgorithm.vhnumeral('.unit_price_all');\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm cho tất cả\r\n   */\r\n  handleEditUnitAll() {\r\n    if (this.new_discount.getRawValue() >= 0 && this.new_discount.getRawValue() < 100) {\r\n      for (let i = 0; i < this.data.length; i++) {\r\n        this.data[i].percent_discount = parseFloat(\r\n          document.getElementById('unit_price_all')['value']\r\n        );\r\n        //  this.data[i].discount = parseFloat(this.new_discount.getRawValue());\r\n        this.discount_percent_all = parseFloat(this.new_discount.getRawValue());\r\n        this.disabled_all = true\r\n      }\r\n      this.isVisibleEditUnitPriceAll = false;\r\n    } else {\r\n      this.disabled_all = false\r\n    }\r\n  }\r\n\r\n  /**\r\n   * đóng modal nhập giá giảm cho tất cả và ko lưu\r\n   */\r\n  handleCancelEditUnitAll() {\r\n    this.isVisibleEditUnitPriceAll = false;\r\n  }\r\n\r\n\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button [disabled]=\"!data.length\" class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!data.length\" class=\"no-data\">\r\n        <p>{{'Please select a product' | translate}}</p>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"invoiceDetail-header\" *ngIf=\"data.length\">\r\n    <div nz-row>\r\n        <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n        </div>\r\n        <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n            {{\"Product name\" | translate}}\r\n        </div>\r\n        <div class=\"text-right\" nz-col nzSpan=\"3\">\r\n            {{\"Selling price\" | translate}}\r\n        </div>       \r\n        <div class=\"invoiceDetail-header-quantity text-center\" nz-col nzSpan=\"3\">\r\n            {{\"Unit\" | translate}}\r\n        </div>\r\n        <div nz-col nzSpan=\"3\" class=\"ion-text-end\">\r\n            {{'Discount %' | translate}}\r\n        </div>\r\n        <div nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n            {{'New price' | translate}}\r\n        </div>\r\n        <div class=\"invoiceDetail-header-quantity text-center\" style=\"text-align: right;\" nz-col nzSpan=\"3\">\r\n            {{'Qty from' | translate}}\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"invoiceDetail-item-scroll hideScrollbar\" id=\"invoiceDetail-item-scroll-add\">\r\n    <div nz-row [nzGutter]=\"16\" *ngIf=\"data.length\">\r\n        <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n            \r\n        </div>\r\n        <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n            \r\n        </div>\r\n        <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n           \r\n        </div>       \r\n        <div class=\"text-center\" nz-col nzSpan=\"2\">\r\n           \r\n        </div>\r\n        <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"5\">\r\n            <div style=\"text-align: right; border-bottom: 1px solid #eee;\" (click)=\"openEditUnitPriceAll()\">\r\n                {{'Discount % all' | translate}}\r\n            </div>\r\n        </div>\r\n        <div style=\"text-align: right;\" nz-col nzSpan=\"2\" class=\"ion-text-end\">\r\n           \r\n        </div>\r\n        <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n            \r\n        </div>\r\n    </div>\r\n    <div class=\"invoiceDetail-item\" *ngFor=\"let item of data\">\r\n        <div nz-row [nzGutter]=\"16\">\r\n            <div (click)=\"remove(item)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                <i nz-icon nzType=\"close\" nzTheme=\"outline\" style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n            </div>\r\n            <div nz-col nzSpan=\"7\" class=\"center-col\">\r\n                <b>{{item.name}}</b>\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                {{vhAlgorithm.vhcurrencyunit(item.price_unit)}}\r\n            </div>\r\n            \r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                <nz-select [ngModel]=\"item.ratio\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                    <nz-option [nzValue]=\"un.ratio\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                </nz-select>\r\n            </div>\r\n            <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"3\">\r\n                <div style=\"text-align: right; border-bottom: 1px solid #eee; cursor: pointer\" (click)=\"openEditUnitPrice(item)\">\r\n                    {{vhAlgorithm.vhpercent(item.percent_discount/100 ? item.percent_discount/100 : 0)}}\r\n                </div>\r\n            </div>\r\n            <div style=\"text-align: right; \" nz-col nzSpan=\"4\" class=\"ion-text-end\">\r\n                <b>{{vhAlgorithm.vhcurrencyunit(item.percent_discount ? item.price_unit * (100/100 - item.percent_discount/100) : item.price_unit)}}</b>\r\n            </div>\r\n            <div class=\"text-center\" nz-col nzSpan=\"3\">\r\n                <div style=\"text-align: right; border-bottom: 1px solid #eee; cursor: pointer\" (click)=\"openEditUnitQuantity(item)\">\r\n                    {{item.quantity}}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Discount in percent' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Percent' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" [value]=\"tempDetail.percent_discount\" nz-input />\r\n            </div>\r\n            \r\n        </div>\r\n        <div nz-row *ngIf=\"!disabled\">\r\n            <div nz-col nzSpan=\"8\">\r\n\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <label style=\"color: red\">Phần trăm yêu cầu > 0 và < 100 !</label>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'Reduced quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"temp.quantity\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit discount all-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPriceAll\" *ngIf=\"isVisibleEditUnitPriceAll\" [(nzVisible)]=\"isVisibleEditUnitPriceAll\"\r\n    nzTitle=\"{{'Discount % for all' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitAll()\" (nzOnOk)=\"handleEditUnitAll()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Percent' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price_all\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price_all\" [value]=\"discount_percent_all\" nz-input />\r\n            </div>\r\n        </div>\r\n        <div nz-row *ngIf=\"!disabled_all\">\r\n            <div nz-col nzSpan=\"8\">\r\n\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <label style=\"color: red\">Phần trăm yêu cầu > 0 và < 100 !</label>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPriceAll>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitAll()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\" style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitAll()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-detail-discount-same-price',\r\n  templateUrl: './detail-discount-same-price.component.html',\r\n  styleUrls: ['./detail-discount-same-price.component.scss']\r\n})\r\nexport class DetailDiscountSamePriceComponent implements OnInit {\r\n  @Output() updateProduct = new EventEmitter<any>();\r\n  @Input() data: any = [];\r\n  @Input() type: number;\r\n  @Input() promotion_all_products\r\n  searchProductList: boolean = false;\r\n  price_same: number = 0;\r\n  constructor(\r\n    private router: Router,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    public vhQuerySales: VhQuerySales,\r\n    private modal: NzModalService\r\n\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    \r\n    this.getDataById()\r\n  }\r\n\r\n  /** Lấy dữ liệu local */\r\n  getDataById() {\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let product = this.vhQuerySales.getlocalDetailProduct(this.data[i].id_subproduct ? this.data[i].id_subproduct :this.data[i].id_product);    \r\n      let unit = this.vhQuerySales.getUnit_byRatio(product.units, this.data[i].ratio)\r\n      this.data[i].name = product.name\r\n      this.data[i].price_unit = unit.price\r\n      product['unit_array'] = [];\r\n      // let unitMain = {\r\n      //   unit: product.unit,\r\n      //   ratio: 1,\r\n      //   barcode: product.barcode,\r\n      //   price: product.price,\r\n      //   price2: product.price2,\r\n      //   price_important: product.price_important,\r\n      // };\r\n      // product['unit_array'].unshift(unitMain);\r\n\r\n      if (product.units) {\r\n        this.data[i]['unit_array'] = product['unit_array'].concat(product.units); //thêm mảng unit để chọn unit, chọn giá\r\n      } else {\r\n        this.data[i] = {...this.data[i], unit_array: product['unit_array']};\r\n      }\r\n    } \r\n  }\r\n  \r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, ratio) {\r\n    item.price_unit = item.unit_array.find(it => it.ratio == ratio).price;\r\n    item.ratio = ratio\r\n    item.unit = item.unit_array.find(it => it.ratio == ratio).unit \r\n    \r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  price: any = 0;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrices() {\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n      \r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    \r\n    if(this.price.getRawValue() >= 0) {\r\n      for( let i = 0; i < this.data.length; i++ ) {\r\n        if (this.price.getRawValue()) {\r\n          this.price_same = this.price.getRawValue();\r\n          this.data[i].price_same = parseFloat(this.price.getRawValue());\r\n        }\r\n        else {\r\n          // this.price_same = this.data[i].price\r\n          this.price_same = this.data[i].price_same \r\n        }\r\n      }\r\n    }\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {    \r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i].id_product,\r\n        ratio: this.data[i].ratio,\r\n        price_same: this.data[i].price_same,\r\n        ptype: this.data[i].ptype,\r\n        quantity: this.data[i].quantity,\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if(new_item.ptype == 5) {\r\n        let combos = this.data[i].combos\r\n        new_item = {...new_item, combos: combos}\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    this.updateProduct.emit(products);\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data) {\r\n    if (data) {\r\n      for(let i = 0; i < data.length; i++) {\r\n        let new_item: any = {\r\n          id_product: data[i]._id,\r\n          price_unit: data[i].price,\r\n          ratio: data[i].ratio ? data[i].ratio : 1,\r\n          unit: data[i].unit,\r\n          price: this.price_same,\r\n          ptype: data[i].type,\r\n          name: data[i].name,\r\n          unit_array: data[i].units  ,\r\n          quantity : 1\r\n        }\r\n        if(data[i].id_subproduct) {\r\n          new_item = {...new_item, id_subproduct: data[i].id_subproduct}\r\n        }\r\n        if(new_item.ptype == 5) {          \r\n          let combos = data[i].combos.map(item => {\r\n            return {\r\n              id_product: item.id_product, \r\n              ptype: item.type,\r\n              price: item.price,\r\n              ratio: item.ratio ? item.ratio : 1,\r\n              unit: item.unit ? item.unit : '',\r\n              quantity: item.quantity,\r\n              id_category: data[i].id_category\r\n            }\r\n          })\r\n          new_item = {...new_item, combos: combos}\r\n        }\r\n        if((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(new_item);\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.searchProductList = false;\r\n  }\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  this.data.splice(this.data.indexOf(item), 1)\r\n    });\r\n  }\r\n\r\n  quantity: any = 0;\r\n  isVisibleEditUnitQuantity = false\r\n   /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  openEditUnitQuantity(detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitQuantity = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.quantity = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleEditUnitQuantity() {\r\n    if (this.quantity.getRawValue() >= 0) {\r\n      this.tempDetail.quantity = parseFloat(this.quantity.getRawValue());\r\n    } else if (this.quantity.getRawValue() < 0)\r\n      this.vhComponent.alertMessageDesktop(\r\n        'error',\r\n        this.lang.translate('Invalid data, please check again')\r\n      );\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng sp trong km\r\n   */\r\n  handleCancelEditUnitQuantity() {\r\n    this.isVisibleEditUnitQuantity = false;\r\n  }\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button [disabled]=\"promotion_all_products\" class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!promotion_all_products && !data.length\" class=\"no-data\">\r\n        <p>{{'Select promotional product' | translate}}</p>\r\n    </div>\r\n    <div *ngIf=\"promotion_all_products\" class=\"no-data\">\r\n        <p style=\"font-weight: bold; font-size: 0.95rem;\">{{'Apply to all products' | translate}}</p>\r\n    </div>\r\n</div>\r\n<div class=\"hideScrollbar sales-cart-invoiceDetail\" *ngIf=\"data.length\">\r\n    <div class=\"invoiceDetail-header\">\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n            </div>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">  \r\n                {{\"Product name\" | translate}}\r\n            </div>\r\n            <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                {{\"Selling price\" | translate}}\r\n            </div>\r\n            <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                {{\"Unit\" | translate}}\r\n            </div>\r\n            <div class=\"invoiceDetail-header-quantity text-right\" nz-col nzSpan=\"4\">\r\n                {{\"New price\" | translate}}\r\n            </div>\r\n            <div class=\"invoiceDetail-header-quantity text-right\" nz-col nzSpan=\"3\">\r\n                {{\"Quantity\" | translate}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"invoiceDetail-item-scroll hideScrollbar\" id=\"invoiceDetail-item-scroll-add\">\r\n        <div class=\"invoiceDetail-item\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    \r\n                </div>\r\n                <div nz-col nzSpan=\"11\" class=\"center-col\">\r\n                   \r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n\r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"2\">\r\n                    \r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" style=\"border-bottom: 1px solid #ccc; cursor: pointer\"  nz-col nzSpan=\"6\" (click)=\"openEditUnitPrices()\">\r\n                    {{'Enter uniform price' | translate}}\r\n                </div>                \r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"invoiceDetail-item\" *ngFor=\"let item of data\">\r\n            <div nz-row [nzGutter]=\"16\">\r\n                <div (click)=\"remove(item)\" nz-col nzSpan=\"1\" class=\"center-col\">\r\n                    <i nz-icon nzType=\"close\" nzTheme=\"outline\"\r\n                        style=\"cursor: pointer;color: var(--ion-color-vh-red)\"></i>\r\n                </div>\r\n                <div nz-col nzSpan=\"8\" class=\"center-col\">\r\n                    <b>{{item.name}}</b>\r\n                </div>\r\n                <div class=\"text-center\" nz-col nzSpan=\"4\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.price_unit ? item.price_unit : item.price)}}\r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                    <nz-select [ngModel]=\"item.ratio\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                        <nz-option [nzValue]=\"un.ratio\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                    </nz-select>\r\n                </div>\r\n                <div class=\"invoiceDetail-item-quantity text-end\" nz-col nzSpan=\"4\">\r\n                    <div style=\"text-align: right;\" >\r\n                        {{vhAlgorithm.vhcurrencyunit(item.price_same ? item.price_same : 0)}}</div>\r\n                </div>     \r\n                <div style=\"text-align: right;\" nz-col nzSpan=\"3\" class=\"ion-text-end\" style=\"cursor: pointer\" (click)=\"openEditUnitQuantity(item)\">\r\n                    {{item.quantity}} <i nz-icon nzType=\"edit\" nzTheme=\"outline\" style=\"color: #00A859\"></i>\r\n                </div>           \r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\"\r\n    (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Discount uniform price' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" nz-input [value]=\"price_same\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'_Quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"tempDetail.quantity\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-detail-discount-take-gift',\r\n  templateUrl: './detail-discount-take-gift.component.html',\r\n  styleUrls: ['./detail-discount-take-gift.component.scss']\r\n})\r\nexport class DetailDiscountTakeGiftComponent implements OnInit {\r\n\r\n  @Output() updateProducts = new EventEmitter<any>();\r\n  @Output() gift_length = new EventEmitter<any>();\r\n  @Input() data_buy: any = [];\r\n  @Input() data_gift: any = [];\r\n\r\n  searchProductList: boolean = false;\r\n  searchProductGift: boolean = false;\r\n  quantity: number = 1;\r\n  data = {\r\n    dataBuy: [],\r\n    dataGift: []\r\n  }\r\n  constructor(\r\n    public vhQuerySales: VhQuerySales,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private lang: LanguageService,\r\n    private vhComponent: VhComponent,\r\n    private modal: NzModalService\r\n\r\n\r\n  ) { }\r\n  \r\n  \r\n  ngOnInit(): void {\r\n    this.getDataBuyById();\r\n    this.getDataGiftById();\r\n  }\r\n\r\n   /** Lấy dữ liệu sp mua local */\r\n   getDataBuyById() {\r\n    for (let i = 0; i < this.data_buy.length; i++) {\r\n      let product = this.vhQuerySales.getlocalDetailProduct(this.data_buy[i].id_subproduct ? this.data_buy[i].id_subproduct :this.data_buy[i].id_product);  \r\n      this.data_buy[i].name = product.name\r\n      // this.data_buy[i].price_unit = product.price\r\n      product['unit_array'] = [];\r\n      if (product.units) {\r\n        this.data_buy[i]['unit_array'] = product['unit_array'].concat(product.units); //thêm mảng unit để chọn unit, chọn giá\r\n        this.data_buy[i]['price_unit'] = this.data_buy[i]['unit_array'].find(item => item.ratio == this.data_buy[i].ratio).price\r\n      } else {\r\n        this.data_buy[i] = {...this.data_buy[i], unit_array: product['unit_array']};\r\n      }\r\n    }\r\n  }\r\n\r\n  mathRound(value) {\r\n    return Math.round(value)\r\n  }\r\n\r\n  /** Lấy dữ liệu sp tặng local */\r\n  getDataGiftById() {\r\n    for (let i = 0; i < this.data_gift.length; i++) {\r\n      let product = this.vhQuerySales.getlocalDetailProduct(this.data_gift[i].id_subproduct ? this.data_gift[i].id_subproduct :this.data_gift[i].id_product);  \r\n      this.data_gift[i].name = product.name\r\n      // this.data_gift[i].price_unit = product.price\r\n      product['unit_array'] = [];\r\n      if (product.units) {\r\n        this.data_gift[i]['unit_array'] = product['unit_array'].concat(product.units); //thêm mảng unit để chọn unit, chọn giá\r\n        // this.data_gift[i]['price_unit'] = this.data_gift[i]['unit_array'].find(item => item.unit == this.data_gift[i].unit).price\r\n        this.data_gift[i]['price_unit'] = this.data_gift[i].price\r\n\r\n      } else {\r\n        let price_unit = this.data_gift[i].price\r\n        this.data_gift[i] = {...this.data_gift[i], unit_array: product['unit_array'], price_unit: price_unit};\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp mua\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  /**\r\n   * mở drawer chọn sp tặng\r\n   */\r\n  openSearchProductGift() {\r\n    this.searchProductGift = true\r\n  }\r\n\r\n  \r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, e) {\r\n    // item.price_unit = item.unit_array.find(it => it.unit == e).price;\r\n    item.ratio = e\r\n    item.unit = item.unit_array.find(it => it.ratio == e).unit\r\n  }\r\n\r\n  /**\r\n   * bắt sk đóng drawer chọn sp tặng\r\n   * @param data \r\n   */\r\n  closeSearchProductGift(data) {\r\n    if (data) {\r\n      for(let i = 0; i < data.length; i++) {\r\n        let new_item: any = {\r\n          id_product: data[i]._id,\r\n          price_unit: 0,\r\n          ratio: data[i].ratio ? data[i].ratio : 1,\r\n          unit: data[i].unit,\r\n          quantity: 1,\r\n          ptype: data[i].type,\r\n          // id_subproduct: data[i].id_subproduct,\r\n          name: data[i].name,\r\n          unit_array: data[i].units  \r\n        }\r\n        if(data[i].id_subproduct) {\r\n          new_item = {...new_item, id_subproduct: data[i].id_subproduct}\r\n        }\r\n        if(new_item.ptype == 5) {          \r\n          let combos = data[i].combos.map(item => {\r\n            return {\r\n              id_product: item.id_product,\r\n              id_subproduct: item.id_subproduct,\r\n              ptype: item.type,\r\n              price: item.price,\r\n              ratio: item.ratio ? item.ratio : 1,\r\n              unit: item.unit ? item.unit : '',\r\n              quantity: item.quantity,\r\n              id_category: data[i].id_category\r\n            }\r\n          })\r\n          new_item = {...new_item, combos: combos}\r\n        }\r\n        if((this.data_gift.length + data.length) <= 100) {\r\n          this.data_gift.unshift(new_item)\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.gift_length.emit(this.data_gift.length)\r\n    this.searchProductGift = false;\r\n\r\n  }\r\n\r\n  /**\r\n   * bắt sk đóng drawer chọn sp mua\r\n   * @param data \r\n   */\r\n  closeSearchProductList(data) {     \r\n    if (data) {\r\n      for(let i = 0; i < data.length; i++) {\r\n        let new_item: any = {\r\n          id_product: data[i]._id,\r\n          price_unit: data[i].price,\r\n          ratio: data[i].ratio ? data[i].ratio : 1,\r\n          unit: data[i].unit,\r\n          quantity: 1,\r\n          ptype: data[i].type,\r\n          // id_subproduct: data[i].id_subproduct,\r\n          name: data[i].name,\r\n          unit_array: data[i].units \r\n        }\r\n        if(data[i].id_subproduct) {\r\n          new_item = {...new_item, id_subproduct: data[i].id_subproduct}\r\n        }\r\n        if(new_item.ptype == 5) {          \r\n          let combos = data[i].combos.map(item => {\r\n            return {\r\n              id_product: item.id_product, \r\n              id_subproduct: item.id_subproduct,\r\n              ptype: item.type,\r\n              price: item.price,\r\n              ratio: item.ratio ? item.ratio : 1,\r\n              unit: item.unit ? item.unit : '',\r\n              quantity: item.quantity,\r\n              id_category: data[i].id_category\r\n            }\r\n          })\r\n          new_item = {...new_item, combos: combos}\r\n        }\r\n        if((this.data_buy.length + data.length) <= 100) {\r\n          this.data_buy.unshift(new_item)\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n       \r\n      }\r\n    }\r\n\r\n    this.searchProductList = false;\r\n  }\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions(){  \r\n    this.data = {\r\n      dataBuy: [],\r\n      dataGift: []\r\n    }  \r\n    for (let i = 0; i < this.data_buy.length; i++) {\r\n      let dt_Buy: any = {\r\n        id_product: this.data_buy[i].id_product,\r\n        ratio: this.data_buy[i].ratio ? this.data_buy[i].ratio : 1,\r\n        quantity: this.data_buy[i].quantity,\r\n        ptype: this.data_buy[i].ptype,\r\n        // id_subproduct: this.data_buy[i].id_subproduct\r\n      }\r\n      if(this.data_buy[i].id_subproduct) {\r\n        dt_Buy = {...dt_Buy, id_subproduct: this.data_buy[i].id_subproduct}\r\n      }\r\n      if(dt_Buy.ptype == 5) {\r\n        let combos = this.data_buy[i].combos.map(item => {\r\n          let combo ={ \r\n            id_product: item.id_product, \r\n            ptype: item.type,\r\n            price: item.price,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n          }\r\n          if(item.id_subproduct) combo['id_subproduct'] = item.id_subproduct\r\n          return  combo\r\n        })\r\n        dt_Buy = {...dt_Buy, combos: combos}\r\n      }\r\n\r\n      this.data.dataBuy.push(dt_Buy);\r\n    }\r\n    for (let j = 0; j < this.data_gift.length; j++) {\r\n      let dt_gift: any = {\r\n        id_product: this.data_gift[j].id_product,\r\n        ratio: this.data_gift[j].ratio ? this.data_gift[j].ratio : 1,\r\n        quantity: this.data_gift[j].quantity,\r\n        price: this.data_gift[j].price_unit,\r\n        ptype: this.data_gift[j].ptype,\r\n        // id_subproduct: this.data_gift[j].id_subproduct\r\n      }\r\n      if(this.data_gift[j].id_subproduct) {\r\n        dt_gift = {...dt_gift, id_subproduct: this.data_gift[j].id_subproduct}\r\n      }\r\n      if(dt_gift.ptype == 5) {\r\n        let combos = this.data_gift[j].combos.map(item => {\r\n          let combo ={ \r\n            id_product: item.id_product, \r\n            ptype: item.type,\r\n            price: item.price,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n          }\r\n          if(item.id_subproduct) combo['id_subproduct'] = item.id_subproduct\r\n          return  combo\r\n        })\r\n        dt_gift = {...dt_gift, combos: combos}\r\n      }\r\n      this.data.dataGift.push(dt_gift)\r\n    }\r\n    this.updateProducts.emit(this.data)\r\n    }\r\n\r\n  /**\r\n   * xóa sp mua\r\n   */\r\n  public remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  this.data_buy.splice(this.data_buy.indexOf(item), 1)\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xóa sp tặng\r\n   */\r\n  removeGift(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  {\r\n        this.data_gift.splice(this.data_gift.indexOf(item), 1)\r\n        this.gift_length.emit(this.data_gift.length)\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  temp: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  price: any = 0;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrices(detail) {\r\n    this.temp = detail\r\n    this.isVisibleEditUnitPrice = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if(this.price.getRawValue() && this.price.getRawValue() >= 0) {\r\n      this.temp.price_unit = parseFloat(this.price.getRawValue())\r\n    } else {\r\n      this.temp.price_unit = 0\r\n    }\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n   // -------modal edit unit quantity-------\r\n   buyQuantity: any;\r\n   isVisibleEditUnitQuantity: boolean = false;\r\n   quantity_discount: any;\r\n \r\n  /**\r\n   * mở modal chỉnh sửa số lượng sp trong km\r\n   */\r\n   openEditUnitQuantity(detail) {\r\n     this.buyQuantity = detail;\r\n     this.isVisibleEditUnitQuantity = true;\r\n     this.vhAlgorithm.waitingStack().then(() => {\r\n       this.quantity_discount = this.vhAlgorithm.vhnumeral('.unit_quantity');\r\n     });\r\n   }\r\n \r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng sp trong km\r\n   */\r\n   handleEditUnitQuantity() {\r\n     if (this.quantity_discount.getRawValue() >= 0) {\r\n       this.buyQuantity.quantity = parseFloat(this.quantity_discount.getRawValue());\r\n     } else if (this.quantity_discount.getRawValue() < 0)\r\n       this.vhComponent.alertMessageDesktop(\r\n         \"error\",\r\n         this.lang.translate('Invalid data, please check again')\r\n       );\r\n     this.isVisibleEditUnitQuantity = false;\r\n   }\r\n   /**\r\n    * đóng modal chỉnh sửa số lượng sp trong km\r\n    */\r\n   handleCancelEditUnitQuantity() {\r\n     this.isVisibleEditUnitQuantity = false;\r\n   }\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" style=\"height: 6%; margin-bottom: 4px;\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <!-- <div>\r\n            <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\"\r\n                *ngIf=\"vhPromotion.getType() !== 5\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div> -->\r\n        <div>\r\n            <button class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <!-- <div *ngIf=\"!vhPromotion.getPromotionsDetail().length\" class=\"no-data\">\r\n        <p>{{'Please select a product' | translate}}</p>\r\n    </div> -->\r\n</div>\r\n<div class=\"hideScrollbar sales-cart-invoiceDetail\">\r\n    <div class=\"take-gift\">\r\n        <div nz-row nzSpan=\"24\" style=\"height: 10%; z-index: 99;\">\r\n            <div class=\"slide\" nz-col nzSpan=\"12\">\r\n                <div class=\"slide-item\" nz-col nzSpan=\"8\">\r\n                    Sản phẩm mua\r\n                </div>\r\n                <div class=\"slide-item text-right\" nz-col nzSpan=\"8\">\r\n                    Số lượng\r\n                </div>\r\n                <div class=\"slide-item text-right\" nz-col nzSpan=\"8\">\r\n                    Đơn giá\r\n                </div>\r\n            </div>\r\n            <div class=\"slide\" nz-col nzSpan=\"12\">\r\n                <div class=\"slide-item\" nz-col nzSpan=\"8\">\r\n                    Sản phẩm tặng\r\n                </div>\r\n                <div class=\"slide-item text-right\" nz-col nzSpan=\"8\">\r\n                    Số lượng\r\n                </div>\r\n                <div class=\"slide-item text-right\" nz-col nzSpan=\"8\">\r\n                    Đơn giá\r\n                </div>\r\n            </div>\r\n        </div>\r\n    \r\n        <div nz-row nzSpan=\"24\" style=\"height: 90%\">\r\n            <div nz-col nzSpan=\"12\" class=\"products\">\r\n                <div nz-col nzSpan=\"24\" class=\"btn-search\" (click)=\"openSearchProductList()\">\r\n                    <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                    Chọn sản phẩm mua\r\n                </div>\r\n                <div nz-row class=\"list-item\" *ngFor=\"let item of data_buy\" >\r\n                    <div nz-col nzSpan=\"2\">\r\n                        <i nz-icon nzType=\"close\" nzTheme=\"outline\" style=\"color: red;cursor: pointer\" (click)=\"remove(item)\"></i>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"22\">\r\n                        <div nz-row nzSpan=\"24\">\r\n                            <b>{{item.name}}</b>\r\n                        </div>\r\n                        <div nz-row nzSpan=\"24\" style=\"align-items: center;\">\r\n                            <div nz-col nzSpan=\"8\" class=\"text-left\">\r\n                                <nz-select [ngModel]=\"item.ratio\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                                    <nz-option [nzValue]=\"un.ratio\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                                </nz-select>\r\n                            </div>\r\n                            \r\n                            <div nz-col nzSpan=\"8\" (click)=\"openEditUnitQuantity(item)\" style=\"text-align: center; border-bottom: 1px solid #eee; cursor: pointer\">\r\n                                {{mathRound(item.quantity)}}\r\n                            </div>\r\n                            <div nz-col nzSpan=\"8\" style=\"text-align: right\">\r\n                                {{vhAlgorithm.vhcurrencyunit(item.price_unit)}}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n    \r\n            <div nz-col nzSpan=\"12\" class=\"products\">                \r\n                <div nz-col nzSpan=\"24\" class=\"btn-search\" (click)=\"openSearchProductGift()\">\r\n                    <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                    Chọn sản phẩm tặng  \r\n                </div>\r\n                <div nz-row class=\"list-item\" *ngFor=\"let item of data_gift\">\r\n                    <div nz-col nzSpan=\"2\">\r\n                        <i nz-icon nzType=\"close\" nzTheme=\"outline\" style=\"color: red; cursor: pointer\" (click)=\"removeGift(item)\"></i>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"22\">\r\n                        <div nz-row nzSpan=\"24\">\r\n                            <b>{{item.name}}</b>\r\n                        </div>\r\n                        <div nz-row nzSpan=\"24\" style=\"align-items: center;\">\r\n                            <div nz-col nzSpan=\"8\" class=\"text-left\">\r\n                                <nz-select [ngModel]=\"item.ratio\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                                    <nz-option [nzValue]=\"un.ratio\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                                </nz-select>\r\n                            </div>\r\n                            <div nz-col nzSpan=\"8\" (click)=\"openEditUnitQuantity(item)\" style=\"text-align: center; border-bottom: 1px solid #eee; cursor: pointer\">\r\n                                {{mathRound(item.quantity)}}\r\n                            </div>\r\n                            \r\n                            <div nz-col nzSpan=\"8\" style=\"text-align: right; cursor: pointer\" (click)=\"openEditUnitPrices(item)\">\r\n                                {{vhAlgorithm.vhcurrencyunit(item.price_unit)}} <i nz-icon nzType=\"edit\" nzTheme=\"outline\" style=\"color: #00A859\"></i>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                \r\n                </div>\r\n            </div>\r\n    \r\n        </div>\r\n    \r\n    </div>\r\n</div>\r\n\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\" (closeSearchProductList)=\"closeSearchProductList($event)\"></app-search-product>\r\n<app-search-product *ngIf=\"searchProductGift\" [searchProductList]=\"searchProductGift\" (closeSearchProductList)=\"closeSearchProductGift($event)\"></app-search-product>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    nzTitle=\"{{'Discount per product' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" nz-input [value]=\"temp.price_unit\" />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit quantity-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitQuantity\" *ngIf=\"isVisibleEditUnitQuantity\" [(nzVisible)]=\"isVisibleEditUnitQuantity\"\r\n    nzTitle=\"{{'Reduced quantity' | translate}}\"\r\n    (nzOnCancel)=\"handleCancelEditUnitQuantity()\" (nzOnOk)=\"handleEditUnitQuantity()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Quantity' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_quantity\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_quantity\" [value]=\"buyQuantity.quantity\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitQuantity>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnitQuantity()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnitQuantity()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-detail-discount-total-invoice',\r\n  templateUrl: './detail-discount-total-invoice.component.html',\r\n  styleUrls: ['./detail-discount-total-invoice.component.scss']\r\n})\r\nexport class DetailDiscountTotalInvoiceComponent implements OnInit {\r\n\r\n  @Output() updateProducts = new EventEmitter<any>();\r\n  @Output() gift_length = new EventEmitter<any>();\r\n  @Input() data: any;\r\n  searchProductList: boolean = false;\r\n\r\n  constructor(\r\n    private vhComponent: VhComponent,\r\n    private lang: LanguageService,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    public vhQuerySales: VhQuerySales,\r\n    private modal: NzModalService\r\n\r\n  ) { }\r\n\r\n  ngOnInit(): void {    \r\n    this.getDataById()\r\n    \r\n  }\r\n\r\n  /** Lấy dữ liệu local */\r\n  getDataById() {\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let product = this.vhQuerySales.getlocalDetailProduct(this.data[i].id_subproduct ? this.data[i].id_subproduct :this.data[i].id_product);     \r\n      this.data[i].name = product.name;\r\n      // this.data[i].price_unit = product.price;\r\n      product['unit_array'] = [];\r\n      if (product.units) {\r\n        this.data[i]['unit_array'] = product['unit_array'].concat(product.units); //thêm mảng unit để chọn unit, chọn giá\r\n        this.data[i]['price_unit'] = this.data[i]['unit_array'].find(item => item.ratio == this.data[i].ratio).price\r\n      } else {\r\n        this.data[i] = {...this.data[i], unit_array: product['unit_array']};\r\n      }\r\n    }\r\n    \r\n  }\r\n\r\n  \r\n  /**\r\n   * mở drawer chọn sp vào ctkm\r\n   */\r\n  openSearchProductList() {\r\n    this.searchProductList = true;\r\n  }\r\n\r\n  // -------modal edit unit price-------\r\n  tempDetail: any;\r\n  isVisibleEditUnitPrice: boolean = false;\r\n  new_price: any;\r\n\r\n  /**\r\n   * mở modal nhập giá giảm sp\r\n   */\r\n  openEditUnitPrice(detail) {\r\n    this.tempDetail = detail;\r\n    this.isVisibleEditUnitPrice = true;\r\n      this.vhAlgorithm.waitingStack().then(() => {\r\n        this.new_price = this.vhAlgorithm.vhnumeral('.unit_price');\r\n      });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal nhập giá giảm sp\r\n   */\r\n  handleEditUnit() {\r\n    if (this.new_price.getRawValue() >= 0) {\r\n      this.tempDetail.price = parseFloat(this.new_price.getRawValue());\r\n    } else if (this.new_price.getRawValue() < 0)\r\n      this.vhComponent.showToast(\r\n        2000,\r\n        this.lang.translate('Giá mới phải lớn hơn 0. Vui lòng nhập lại !'),\r\n        'alert-toast'\r\n      );\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n  /**\r\n   * đóng modal nhập giá giảm sp và ko lưu\r\n   */\r\n  handleCancelEditUnit() {\r\n    this.isVisibleEditUnitPrice = false;\r\n  }\r\n\r\n\r\n  // -------modal edit unit discount-------\r\n  temp: any;\r\n  isVisibleEditDiscount: boolean = false;\r\n  new_discount: any;\r\n\r\n  /**\r\n   * mở modal chỉnh sửa số lượng áp dụng sp trong km\r\n   */\r\n  openEditDiscount(detail) {\r\n    this.temp = detail;\r\n    this.isVisibleEditDiscount = true;\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      this.new_discount = this.vhAlgorithm.vhnumeral('.unit_price_discount');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * xử lý sk nhấn ok modal chỉnh sửa số lượng áp dụng sp trong km\r\n   */\r\n  handleEditDiscount() {\r\n    if (this.new_discount.getRawValue() >= 0) {\r\n      this.temp.quantity = parseFloat(this.new_discount.getRawValue());     \r\n    } else if (this.new_discount.getRawValue() < 0)\r\n      this.vhComponent.showToast(\r\n        2000,\r\n        this.lang.translate('Số lượng không thể nhỏ hơn 0. Vui lòng nhập lại !'),\r\n        'alert-toast'\r\n      );\r\n    this.isVisibleEditDiscount = false;\r\n  }\r\n  /**\r\n   * đóng modal chỉnh sửa số lượng áp dụng sp trong km\r\n   */\r\n  handleCancelEditDiscount() {\r\n    this.isVisibleEditDiscount = false;\r\n  }\r\n  \r\n  /**\r\n   * bắt sk thay đổi unit của sp\r\n   */\r\n  getPrice(item, e) {\r\n    item.price_unit = item.unit_array.find(it => it.ratio == e).price;\r\n    item.ratio =  e\r\n    item.unit = item.unit_array.find(it => it.ratio == e).unit\r\n  }\r\n\r\n  /**\r\n   * bắt sk nhấn nút lưu km , output về component cha dữ liệu sp trong KM\r\n   */\r\n  savePromotions() {\r\n    let products = [];\r\n    for (let i = 0; i < this.data.length; i++) {\r\n      let new_item: any = {\r\n        id_product: this.data[i].id_product,\r\n        ratio: this.data[i].ratio ? this.data[i].ratio : 1,\r\n        price: this.data[i].price,\r\n        quantity: this.data[i].quantity,\r\n        ptype: this.data[i].ptype,\r\n      };\r\n      if(this.data[i].id_subproduct) {\r\n        new_item = {...new_item, id_subproduct: this.data[i].id_subproduct}\r\n      }\r\n      if(new_item.ptype == 5) {\r\n        let combos = this.data[i].combos.map(item => {\r\n          let combo ={ \r\n            id_product: item.id_product, \r\n            ptype: item.type,\r\n            price: item.price,\r\n            ratio: item.ratio ? item.ratio : 1,\r\n            quantity: item.quantity,\r\n          }\r\n          if(item.id_subproduct) combo['id_subproduct'] = item.id_subproduct\r\n          return  combo\r\n        })\r\n        new_item = {...new_item, combos: combos}\r\n      }\r\n      products.push(new_item);\r\n    }\r\n    this.updateProducts.emit(products)\r\n  }\r\n\r\n  /**\r\n   * xử lý danh sách sp đã chọn khi đóng drawer chọn sp vào ctkm\r\n   */\r\n  closeSearchProductList(data){\r\n    if (data) {\r\n      for(let i = 0; i < data.length; i++) {\r\n        let new_item: any = {\r\n          id_product: data[i]._id,\r\n          price_unit: data[i].price,\r\n          ratio: data[i].ratio ? data[i].ratio : 1,\r\n          unit: data[i].unit,\r\n          quantity: 1,\r\n          price: 0,\r\n          name: data[i].name,\r\n          ptype: data[i].type,\r\n          unit_array: data[i].units  \r\n        }\r\n        if(data[i].id_subproduct) {\r\n          new_item = {...new_item, id_subproduct: data[i].id_subproduct}\r\n        }\r\n        if(new_item.ptype == 5) {          \r\n          let combos = data[i].combos.map(item => {\r\n            return {\r\n              id_product: item.id_product, \r\n              ptype: item.type,\r\n              price: item.price,\r\n              ratio: item.ratio ? item.ratio : 1,\r\n              unit: item.unit ? item.unit : '',\r\n              quantity: item.quantity,\r\n              id_category: data[i].id_category\r\n            }\r\n          })\r\n          new_item = {...new_item, combos: combos}\r\n        }\r\n        if((this.data.length + data.length) <= 100) {\r\n          this.data.unshift(new_item)\r\n        } else {\r\n          this.modal.error({\r\n            nzTitle: 'Số lượng sản phẩm vượt quá giới hạn',\r\n            nzContent: 'Vui lòng tạo thêm khuyến mãi khác !'\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.gift_length.emit(this.data.length)\r\n    this.searchProductList = false;    \r\n  }\r\n\r\n  /**\r\n   * xóa sp KM\r\n   */\r\n  public remove(item) {\r\n    this.modal.confirm({\r\n      nzTitle: `Xóa <strong><i>${item.name}</i></strong> ?`,\r\n      // nzContent: '<b>Xóa sản</b>',\r\n      nzOnOk: () =>  {\r\n        this.data.splice(this.data.indexOf(item), 1)\r\n        this.gift_length.emit(this.data.length)\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n","<div class=\"sales-cart-header promotion-add-header\" nz-row [nzGutter]=\"16\">\r\n    <div nz-col nzSpan=\"10\" class=\"title\">\r\n        <b>{{'_Select promotional product' | translate}}</b>\r\n    </div>\r\n    <div nz-col nzSpan=\"14\" class=\"right-all-content\">\r\n        <div>\r\n            <button class=\"btn-data nz-hover-border\" nz-button nzType=\"default\" (click)=\"openSearchProductList()\">\r\n                <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n                {{'Search (F4)' | translate}}</button>\r\n        </div>\r\n\r\n        <div>\r\n            <button class=\"btn-save nz-hover-border\"\r\n                nz-button nzType=\"default\" (click)=\"savePromotions()\">\r\n                {{'Save' | translate}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div *ngIf=\"!data.length\" class=\"no-data\">\r\n        <p>{{'Please select a product' | translate}}</p>\r\n    </div>\r\n</div>\r\n<div class=\"hideScrollbar sales-cart-invoiceDetail\" *ngIf=\"data.length\">\r\n    <div class=\"total-invoice\">\r\n        <div nz-row nzSpan=\"24\" class=\"total\">\r\n            <b>Tổng sản phẩm : &nbsp;</b> {{data.length}}\r\n        </div>\r\n        <div nz-row nzSpan=\"24\" class=\"title-table\">\r\n            <div nz-col nzSpan=\"1\">\r\n\r\n            </div>\r\n            <div class=\"title-name title-text text-left\" nz-col nzSpan=\"9\">\r\n                Tên sản phẩm\r\n            </div>\r\n            <div class=\"title-price title-text text-center\" nz-col nzSpan=\"3\">\r\n                Giá bán\r\n            </div>\r\n            <div class=\"title-quantity title-text text-right\" nz-col nzSpan=\"3\">\r\n                Sl tặng\r\n            </div>\r\n            <div class=\"title-new-price title-text text-right\" nz-col nzSpan=\"4\">\r\n                {{\"Unit\" | translate}}\r\n            </div>\r\n            <div class=\"title-new-price title-text text-right\" nz-col nzSpan=\"4\">\r\n                Giá mới\r\n            </div>\r\n        </div>\r\n        <div nzSpan=\"24\" class=\"total-invoice-content\">\r\n            <div nz-row nzSpan=\"24\" class=\"list-item\" *ngFor=\"let item of data\">\r\n                <div class=\"name\" nz-col nzSpan=\"1\">\r\n                    <i nz-icon nzType=\"close\" nzTheme=\"outline\" style=\"color: red\" (click)=\"remove(item)\"></i>\r\n                </div>\r\n                <div class=\"name\" nz-col nzSpan=\"9\">\r\n                    <b>{{item.name}}</b>\r\n                </div>\r\n                <div class=\"price text-center\" nz-col nzSpan=\"3\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.price_unit)}}\r\n                </div>\r\n                <div class=\"quantity text-right\" nz-col nzSpan=\"3\" (click)=\"openEditDiscount(item)\" style=\"cursor: pointer; border-bottom: 1px solid #eee\">\r\n                    {{item.quantity}}\r\n                </div>\r\n                <div class=\"text-right\" nz-col nzSpan=\"4\">\r\n                    <nz-select [ngModel]=\"item.ratio\" (ngModelChange)=\"getPrice(item, $event)\">\r\n                        <nz-option [nzValue]=\"un.ratio\" [nzLabel]=\"un.unit\" *ngFor=\"let un of item.unit_array\">{{un.unit}}</nz-option>\r\n                    </nz-select>\r\n                </div>\r\n                <div class=\"new-price text-right\" nz-col nzSpan=\"4\" (click)=\"openEditUnitPrice(item)\" style=\"cursor: pointer;  border-bottom: 1px solid #ccc\">\r\n                    {{vhAlgorithm.vhcurrencyunit(item.price)}}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n<app-search-product *ngIf=\"searchProductList\" [searchProductList]=\"searchProductList\" (closeSearchProductList)=\"closeSearchProductList($event)\">\r\n</app-search-product>\r\n\r\n<!-- ---------edit price-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditUnitPrice\" *ngIf=\"isVisibleEditUnitPrice\" [(nzVisible)]=\"isVisibleEditUnitPrice\"\r\n    [nzTitle]=\"'Enter the amount for the new price' | translate\"\r\n    (nzOnCancel)=\"handleCancelEditUnit()\" (nzOnOk)=\"handleEditUnit()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price\" [value]=\"tempDetail.price\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditUnitPrice>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditUnit()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditUnit()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>\r\n\r\n<!-- ---------edit discount-------- -->\r\n<nz-modal [nzFooter]=\"modalFooterEditDiscount\" *ngIf=\"isVisibleEditDiscount\" [(nzVisible)]=\"isVisibleEditDiscount\"\r\n    [nzTitle]=\"'Enter the amount for the new price' | translate\"\r\n    (nzOnCancel)=\"handleCancelEditDiscount()\" (nzOnOk)=\"handleEditDiscount()\">\r\n    <ng-container *nzModalContent>\r\n        <div nz-row>\r\n            <div nz-col nzSpan=\"8\" class=\"center-col\">{{'Amount' | translate}}\r\n            </div>\r\n            <div nz-col nzSpan=\"16\">\r\n                <input class=\"unit_price_discount\" type=\"text\" maxlength=\"15\"\r\n                    id=\"unit_price_discount\" [value]=\"temp.quantity\" nz-input />\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #modalFooterEditDiscount>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-white); color: var(--ion-color-vh-black)\" nzType=\"default\"\r\n            (click)=\"handleCancelEditDiscount()\">{{\"Cancel\"\r\n            |translate}}</button>\r\n        <button nz-button class=\"nz-hover-border\"\r\n            style=\"background-color: var(--ion-color-vh-green); color: var(--ion-color-vh-white)\"\r\n            class=\"nz-hover-border-green\" (click)=\"handleEditDiscount()\">{{\"Save\" | translate}}</button>\r\n    </ng-template>\r\n</nz-modal>","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhAlgorithm, VhQuerySales } from 'ionic-vhframeworks';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\nimport { VhPromotions } from 'src/app/sales/interface/vh-promotions-money-rate';\r\nimport { LanguageService } from 'src/app/sales/services/language.service';\r\n\r\n@Component({\r\n  selector: 'app-detail',\r\n  templateUrl: './detail.component.html',\r\n  styleUrls: ['./detail.component.scss']\r\n})\r\nexport class DetailComponent implements OnInit {\r\n  // public vhPromotion: VhPromotions = new VhPromotions();\r\n  public startTimeBackup: string;\r\n  public endTimeBackup: string;\r\n  tableHeight: any;\r\n  data: any = [];\r\n  promotion: any = {};\r\n  promotionType: 1 | 2 | 3 | 4 | 5 | 6 | 7 = 1;\r\n  id_promotion: any;\r\n  price_reduce:any;\r\n  price_value:any\r\n  gift_length: number;\r\n  dataStore:any\r\n  constructor(\r\n    private router: Router,\r\n    private vhComponent: VhComponent,\r\n    private vhQuerySales: VhQuerySales,\r\n    private lang: LanguageService,\r\n    public vhAlgorithm: VhAlgorithm,\r\n    private cdRef: ChangeDetectorRef,\r\n    private modal: NzModalService\r\n  ) {\r\n      this.dataStore = this.router.getCurrentNavigation().extras.state\r\n      this.promotion = {...this.dataStore.promotion};\r\n      \r\n      \r\n      if(this.promotion.type == 6) {\r\n        this.gift_length = this.promotion.products_gift.length;\r\n      }\r\n      if(this.promotion.type == 7) {\r\n        this.gift_length = this.promotion.products_gift.length;\r\n        this.initNumberral()\r\n      }\r\n      \r\n      if(this.promotion.promotion_all_products) {\r\n       if(this.promotion.type == 1  ) this.price_reduce = this.promotion.price_reduce\r\n       if( this.promotion.type  == 3 ) this.price_reduce = this.promotion.price_same\r\n        this.promotion.products = []\r\n        this.initNumberral()\r\n      }\r\n  }\r\n\r\n  ngOnInit(): void {\r\n   }\r\n\r\n   /**\r\n    * xóa KM khỏi DB\r\n    * @param id \r\n    */\r\n  deletePromotion(id) {\r\n      this.vhComponent.alertConfirm('','',`${this.lang.translate('Delete')} ${'khuyến mãi này'} ?`,'OK',this.lang.translate('Cancel'))\r\n      .then(() => {\r\n          this.vhQuerySales.deletePromotion(id).then((bool)=>{\r\n                if (bool) {\r\n                  let data = {\r\n                    check:true,\r\n                    type : this.dataStore.type,\r\n                    date : this.dataStore.date\r\n                   }\r\n                  this.vhComponent.showToast(3000, 'Xóa khuyến mãi thành công', \"success-toast\");\r\n                  this.router.navigate(['/sales/dashboard/manage/sales-program/promotions'],{state:data})\r\n                }\r\n              }, error => {\r\n                this.vhComponent.showToast(3000, 'Xóa không thành công', \"alert-toast\")\r\n              })\r\n        },\r\n        () => {}\r\n      );\r\n  }\r\n  /**\r\n   * bắt sk thiết lập áp dụng cho tất cả sp\r\n   */\r\n  setAllProduct(event){\r\n    if(event) this.initNumberral()\r\n  }\r\n  /**\r\n   * tạo cleavejs cho giá giảm để xử lý\r\n   */\r\n  initNumberral(){\r\n    this.vhAlgorithm.waitingStack().then(() => {\r\n      if(this.promotion.type == 1 || this.promotion.type == 3 || this.promotion.type == 7) this.price_value = this.vhAlgorithm.vhnumeral(\".price_discout\");\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Cập nhật KM \r\n   * @param products \r\n   */\r\n  updateData(products) {\r\n    // clear dữ liệu để lưu DB\r\n    let promotion: any;\r\n    \r\n    if(this.promotion.type == 6) {\r\n      promotion = {\r\n        name: this.promotion.name,\r\n        date_start: this.promotion.date_start,\r\n        date_end: this.promotion.date_end,\r\n        type: this.promotion.type,\r\n        status: this.promotion.status,\r\n        promotions_maximum: this.promotion.promotions_maximum,\r\n        products: products.dataBuy,\r\n        products_gift: products.dataGift\r\n      }\r\n    } else if (this.promotion.type == 7) {\r\n      promotion = {\r\n        name: this.promotion.name,\r\n        date_start: this.promotion.date_start,\r\n        date_end: this.promotion.date_end,\r\n        status: this.promotion.status,\r\n        type: this.promotion.type,\r\n        products_gift: products,\r\n        promotions_maximum: this.promotion.promotions_maximum,\r\n        total_bill_value: parseFloat(this.price_value.getRawValue()),\r\n        variable_enable: this.promotion.variable_enable\r\n\r\n      }\r\n    } else if (this.promotion.type == 4){\r\n      promotion= {\r\n        name: this.promotion.name,\r\n        date_start: this.promotion.date_start,\r\n        date_end: this.promotion.date_end,\r\n        status: this.promotion.status,\r\n        type: this.promotion.type,\r\n        products: products\r\n      }\r\n    } else if (this.promotion.type == 5){\r\n      promotion= {\r\n        name: this.promotion.name,\r\n        date_start: this.promotion.date_start,\r\n        date_end: this.promotion.date_end,\r\n        status: this.promotion.status,\r\n        type: this.promotion.type,\r\n        products: products\r\n      }\r\n    } else if (this.promotion.type == 3){\r\n      promotion= {\r\n        name: this.promotion.name,\r\n        date_start: this.promotion.date_start,\r\n        date_end: this.promotion.date_end,\r\n        status: this.promotion.status,\r\n        type: this.promotion.type,\r\n        promotion_all_products: this.promotion.promotion_all_products,\r\n        products: products,\r\n        price_same : this.price_reduce\r\n      }\r\n      if(this.promotion.promotion_all_products) promotion['quantity_promotions_all']  = this.promotion.quantity_promotions_all\r\n    }\r\n     else {\r\n      promotion= {\r\n        name: this.promotion.name,\r\n        date_start: this.promotion.date_start,\r\n        date_end: this.promotion.date_end,\r\n        status: this.promotion.status,\r\n        promotion_all_products: this.promotion.promotion_all_products,\r\n        type: this.promotion.type,\r\n        products: products\r\n      }\r\n      if(this.promotion.promotion_all_products) promotion['quantity_promotions_all']  = this.promotion.quantity_promotions_all\r\n    }\r\n    this.vhComponent.alertConfirm(this.lang.translate(\"Confirm\"), \"\", this.lang.translate(\"Save\") + \"?\", 'OK', this.lang.translate(\"Cancel\"))\r\n    .then(() => {\r\n      this.vhComponent.showLoading(\"\", \"transparent-loading\").then(() => {\r\n      if (promotion.promotion_all_products) {\r\n          if (this.promotion.name == '') {\r\n            return  this.vhComponent.hideLoading(0).then(() => this.vhComponent.showToast(1500, `${this.lang.translate(\"Vui lòng không để trống tên khuyến mại !\")}`, \"alert-toast\"))\r\n            }  \r\n            else {\r\n              switch (promotion.type) {\r\n                case 3: \r\n                case 1: {\r\n                   if(!this.price_value.getRawValue()) {\r\n                    return this.vhComponent.hideLoading(0).then(() => this.vhComponent.showToast(2000,\"Vui lòng nhập giá trị\", \"alert-toast\"))\r\n                  } else {\r\n                    promotion = { ...promotion, price_reduce: parseFloat(this.price_value.getRawValue())}\r\n                    delete promotion.products\r\n                    this.updatePromotion(promotion)\r\n                    break;\r\n                  }\r\n                }\r\n                case 2: {\r\n                    let percent =  parseFloat(this.promotion.percent_reduce)\r\n                    if(percent> 100 || percent < 0) {\r\n                     return this.vhComponent.hideLoading(0).then(() => this.vhComponent.showToast(2000,\"Giá trị % <= 100 hoặc >= 0\", \"alert-toast\"))\r\n                    } \r\n                    else if(this.promotion.percent_reduce === undefined) {\r\n                      return this.vhComponent.hideLoading(0).then(() => this.vhComponent.showToast(2000,\"Vui lòng nhập giá trị %\", \"alert-toast\"))\r\n                    }\r\n                    else {\r\n                        promotion = { ...promotion, percent_reduce: percent}\r\n                        delete promotion.products\r\n                        this.updatePromotion(promotion)\r\n                        break;\r\n                      }\r\n                }                \r\n              }\r\n            }\r\n          }\r\n      else {\r\n          if (this.promotion.name == '') {\r\n            return  this.vhComponent.hideLoading(0).then(() => this.vhComponent.showToast(1500, `${this.lang.translate(\"Vui lòng không để trống tên khuyến mại !\")}`, \"alert-toast\"))\r\n          } else if(promotion.type !== 7 && promotion.products.length == 0) return this.vhComponent.hideLoading(0).then(() => this.vhComponent.showToast(1500, `${this.lang.translate(\"Vui lòng chọn sản phẩm khuyễn mãi !\")}`, \"alert-toast\"))\r\n          else if(promotion.type == 7 && promotion.products_gift.length == 0)  return this.vhComponent.hideLoading(0).then(() => this.vhComponent.showToast(1500, `${this.lang.translate(\"Vui lòng chọn sản phẩm khuyễn mãi !\")}`, \"alert-toast\"))\r\n          else {\r\n           this.updatePromotion(promotion)\r\n          }}\r\n      })\r\n    }, () => {})\r\n  }\r\n\r\n  /**\r\n   * cập nhật km lên DB sau khi đã clear chuẩn data\r\n   * @param promotion \r\n   */\r\n  updatePromotion(promotion){\r\n    this.vhQuerySales.updatePromotion(this.promotion._id, promotion)\r\n          .then((promt)=>{\r\n                if (promt) {\r\n                  let data = {\r\n                    check:true,\r\n                    type : this.dataStore.type,\r\n                    date : this.dataStore.date\r\n                   }\r\n                  this.router.navigate(['/sales/dashboard/manage/sales-program/promotions'],{state:data})\r\n                  this.vhComponent.hideLoading(0)\r\n                }\r\n              },error=>{\r\n                \r\n                this.vhComponent.showToast(2000, 'Cập nhật không thành công', \"alert-toast\");\r\n                this.vhComponent.hideLoading(0)\r\n            });\r\n  }\r\n  \r\n\r\n\r\n  /**\r\n   * bắt sk thay đổi ngày bắt đầu KM\r\n   */\r\n  setDateStart(value) {\r\n    if (Date.parse(value) - Date.parse(this.promotion.date_end) > 0)\r\n      this.vhComponent.alertMessage(\"\", \"\", this.lang.translate(\"Staring date must be less than or the same as ending date\"), \"OK\")\r\n        .then(() => {\r\n          this.startTimeBackup = this.promotion.date_start\r\n        })\r\n    else this.promotion.date_start = value\r\n    \r\n  }\r\n  /**\r\n   * bắt sk thay đổi ngày hết hạn KM\r\n   */\r\n  setDateEnd(value) {\r\n    if (Date.parse(value) - Date.parse(this.promotion.date_start) < 0)\r\n      this.vhComponent.alertMessage(\"\", \"\", this.lang.translate(\"Staring date must be less than or the same as ending date\"), \"OK\")\r\n        .then(() => {\r\n          this.endTimeBackup = this.promotion.date_end\r\n        })\r\n    else this.promotion.date_end = value    \r\n  }\r\n  /**\r\n   * bắt sk thay đổi loại KM\r\n   */\r\n  change(value) { \r\n    this.promotionType = value;\r\n  }\r\n\r\n  // isExit: boolean = false;\r\n  goBack() {\r\n    // this.isExit = true\r\n    // this.vhComponent.alertConfirm(this.lang.translate(\"Confirm\"), \"\", this.lang.translate(\"Are you sure to cancel the promotions\"), \"OK\", (this.lang.translate(\"Cancel\"))).then(() => { this.router.navigate([\"/sales/dashboard/manage/sales-program/promotions\"]) }).catch(() => { });\r\n    this.router.navigate([\"/sales/dashboard/manage/sales-program/promotions\"], {state:this.dataStore})\r\n  }\r\n\r\n  /**\r\n   * trả về tên loại chương trình khuyến mãi theo type của KM\r\n   * @param type \r\n   * @returns string\r\n   * @example let type = this.renderType(1)\r\n   */\r\n  public renderType(type) {\r\n    switch (type) {\r\n      case 1: return 'Giảm giá tiền'\r\n      case 2: return 'Giảm giá phần trăm'\r\n      case 3: return 'Sản phẩm đồng giá'\r\n      case 4: return 'Giảm giá tiền khi mua nhiều sản phẩm'\r\n      case 5: return 'Giảm phần trăm khi mua nhiều sản phẩm'\r\n      case 6: return 'Tặng quà khi mua nhiều sản phẩm'\r\n      case 7: return 'Tặng quà theo tổng giá trị đơn hàng'\r\n    }\r\n  }\r\n\r\n  giftLength(e?) {\r\n    this.gift_length = e;\r\n    this.promotion.promotions_maximum = e\r\n    \r\n  }\r\n\r\n  checkMaximum(){\r\n    if(this.promotion.promotions_maximum == null || this.promotion.promotions_maximum > this.gift_length) this.promotion.promotions_maximum = this.gift_length\r\n  }\r\n\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n\r\n<nz-layout id=\"promotion-detail\">\r\n    <div class=\"sales\">\r\n        <div class=\"sales-cart\">\r\n\r\n            <div *ngIf=\"promotion.type == 1\" class=\"hideScrollbar sales-cart-invoiceDetail\" style=\"height:100%\">\r\n                <app-detail-discount-each-product (updateProduct)=\"updateData($event)\" [promotion_all_products]=\"promotion.promotion_all_products\" [data]=\"promotion.products\" ></app-detail-discount-each-product>\r\n            </div>\r\n\r\n            <div *ngIf=\"promotion.type == 2\" class=\"hideScrollbar sales-cart-invoiceDetail\" style=\"height:100%\">\r\n                <app-detail-discount-percent-product (updateProduct)=\"updateData($event)\" [promotion_all_products]=\"promotion.promotion_all_products\"  [data]=\"promotion.products\" ></app-detail-discount-percent-product>\r\n            </div>\r\n\r\n            <div *ngIf=\"promotion.type == 3\" class=\"hideScrollbar sales-cart-invoiceDetail\" style=\"height:100%\">\r\n                <app-detail-discount-same-price (updateProduct)=\"updateData($event)\" [promotion_all_products]=\"promotion.promotion_all_products\" [data]=\"promotion.products\" ></app-detail-discount-same-price>\r\n            </div>\r\n            <div *ngIf=\"promotion.type == 4\" class=\"hideScrollbar sales-cart-invoiceDetail\" style=\"height:100%\">\r\n                <app-detail-discount-many-product (updateProduct)=\"updateData($event)\" [data]=\"promotion.products\"></app-detail-discount-many-product>\r\n            </div>\r\n            <div *ngIf=\"promotion.type == 5\" class=\"hideScrollbar sales-cart-invoiceDetail\" style=\"height:100%\">\r\n                <app-detail-discount-percent-products (updateProduct)=\"updateData($event)\" [data]=\"promotion.products\" ></app-detail-discount-percent-products>\r\n            </div>\r\n            <div *ngIf=\"promotion.type == 6\" class=\"hideScrollbar sales-cart-invoiceDetail\" style=\"height:100%\">\r\n                <app-detail-discount-take-gift (updateProducts)=\"updateData($event)\" (gift_length)=\"giftLength($event)\" [data_buy]=\"promotion.products\" [data_gift]=\"promotion.products_gift\"></app-detail-discount-take-gift>\r\n            </div>\r\n            <div *ngIf=\"promotion.type == 7\" class=\"hideScrollbar sales-cart-invoiceDetail\" style=\"height:100%\">\r\n                <app-detail-discount-total-invoice (updateProducts)=\"updateData($event)\" (gift_length)=\"giftLength($event)\" [data]=\"promotion.products_gift\"></app-detail-discount-total-invoice>\r\n            </div>\r\n        </div>\r\n        <div class=\"sales-bills\">\r\n            <div nz-row class=\"sales-bills-content hideScrollbar\">\r\n                <div nz-col nzSpan=\"24\" class=\"text-right\">\r\n                    <button class=\"btn-xoa\" (click)=\"deletePromotion(promotion._id)\"><i nz-icon nzType=\"delete\" nzTheme=\"outline\" style=\"color: red\"></i> Xóa</button>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\" >\r\n                    <b>{{'Promotions name' | translate}}*</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <input placeholder=\"{{'Enter promotions name' |translate}}\" nz-input [(ngModel)]=\"promotion.name\"/>\r\n                </div>\r\n\r\n                <div nz-col nzSpan=\"24\">\r\n                    <b>{{'Starting date' | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <nz-date-picker nzShowTime nzFormat=\"dd/MM/yyyy HH:mm:ss\" [ngModel]=\"promotion.date_start\"\r\n                      (ngModelChange)=\"setDateStart($event)\"></nz-date-picker>\r\n                  </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <b>{{'Ending date' | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <nz-date-picker nzShowTime nzFormat=\"dd/MM/yyyy HH:mm:ss\" [ngModel]=\"promotion.date_end\"\r\n                      (ngModelChange)=\"setDateEnd($event)\"></nz-date-picker>\r\n                  </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <b>{{'Promotions type' | translate}}</b>\r\n                </div>\r\n                <div nz-col nzSpan=\"24\">\r\n                    <input nz-input placeholder=\"Basic usage\" [value]=\"renderType(promotion.type)\" [disabled]=\"true\" />\r\n                </div>\r\n                <div nz-col nzSpan=\"24\" *ngIf=\"promotion.type == 7\">\r\n                    <div nz-col nzSpan=\"24\">\r\n                      <b>{{'Total invoice value' | translate}}</b>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"24\">\r\n                      <input placeholder=\"{{'Enter total invoice value' | translate}}\" class=\"price_discout\" type=\"text\" [value]=\"promotion.total_bill_value\" nz-input [(ngModel)]=\"promotion.total_bill_value\" />\r\n                    </div>\r\n                      \r\n                </div>\r\n\r\n                <div nz-col nzSpan=\"24\" *ngIf=\"promotion.type == 7\">\r\n                    <b>{{'Allow selecting gift quantity' | translate}}</b>\r\n                  </div>\r\n                  <div nz-col nzSpan=\"24\" *ngIf=\"promotion.type == 7\" style=\"display:flex; justify-content: space-between;\">\r\n                    <span>Số quà tặng được chọn </span>\r\n                    <span>\r\n                    <input style=\"width: 64px; height: 32px;border: 1px solid lightgray;border-radius: 5px\" type=\"number\" (keyup)=\"checkMaximum()\" [(ngModel)]=\"promotion.promotions_maximum\" id=\"quantity\" name=\"quantity\" min=\"0\" max=\"{{gift_length}}\">\r\n                    /<b>{{gift_length}}</b>\r\n                    </span>   \r\n                                    \r\n                  </div>\r\n\r\n                  <div nz-col nzSpan=\"24\"  *ngIf=\"promotion.type == 7\" >\r\n                    <label nz-checkbox [(ngModel)]=\"promotion.variable_enable\">{{'Gift quantity increases with total invoice value' | translate}}</label> \r\n                  </div>   \r\n                <div nz-col nzSpan=\"24\" *ngIf=\"promotion.type == 6\">\r\n                    <b>{{'Allow selecting gift quantity' | translate}}</b>\r\n                  </div>\r\n                  <div nz-col nzSpan=\"24\" *ngIf=\"promotion.type == 6\" style=\"display:flex; justify-content: space-between;\">\r\n                    <span>Số quà tặng được chọn </span>\r\n                    <span>\r\n                    <input style=\"width: 64px; height: 32px;border: 1px solid lightgray;border-radius: 5px\" type=\"number\" (keyup)=\"checkMaximum()\" [(ngModel)]=\"promotion.promotions_maximum\" id=\"quantity\" name=\"quantity\" min=\"0\" max=\"{{gift_length}}\">\r\n                    /<b>{{gift_length}}</b>\r\n                    </span>   \r\n                  </div>\r\n\r\n               <div nz-row  *ngIf=\"promotion.type == 1 || promotion.type == 2 || promotion.type == 3\">\r\n                <div nz-col nzSpan=\"24\">\r\n                    <b>{{'Apply to all products' | translate}}</b>\r\n                  </div>\r\n                  <div nz-col nzSpan=\"24\">\r\n                    <label nz-checkbox (ngModelChange)=\"setAllProduct($event)\" [(ngModel)]=\"promotion.promotion_all_products\">Áp dụng tất cả</label>          \r\n                  </div>\r\n                  <div nz-row nzSpan=\"24\" *ngIf=\"promotion.promotion_all_products\">\r\n                    <div nz-col nzSpan=\"24\">\r\n                      <b>{{ promotion.type == 2 ? 'Nhập % giảm'  : 'Enter amount discount' | translate}}*</b>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"24\">\r\n                      <!-- <input *ngIf=\"promotion.type == 2\" [(ngModel)]=\"percent_reduce\" type=\"text\"  placeholder=\"{{'Enter %' | translate}}\" nz-input  /> -->\r\n                      <nz-input-number  *ngIf=\"promotion.type == 2\" [(ngModel)]=\"promotion.percent_reduce\" [nzMin]=\"1\" [nzMax]=\"100\" [nzStep]=\"1\" nzPlaceHolder=\"{{'Enter %' | translate}}\" ></nz-input-number>\r\n                      <input *ngIf=\"promotion.type != 2\"  [(ngModel)]=\"price_reduce\" class=\"price_discout\" type=\"text\"  placeholder=\"{{'Enter amount' | translate}}\" nz-input  />\r\n                    </div>\r\n          \r\n                    <div nz-col nzSpan=\"24\">\r\n                      <b>{{'Enter purchase quantity' | translate}}</b>\r\n                    </div>\r\n                    <div nz-col nzSpan=\"24\">\r\n                      <!-- <input *ngIf=\"promotion.type == 2\" [(ngModel)]=\"percent_reduce\" type=\"text\"  placeholder=\"{{'Enter %' | translate}}\" nz-input  /> -->\r\n                      <nz-input-number [(ngModel)]=\"promotion.quantity_promotions_all\" [nzMin]=\"1\" [nzMax]=\"999999\" [nzStep]=\"1\" nzPlaceHolder=\"{{'Enter purchase quantity' | translate}}\" ></nz-input-number>\r\n                      \r\n                    </div>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nz-layout>","import { ChangeDetectorRef, Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { VhQuerySales, VhAlgorithm } from 'ionic-vhframeworks';\r\nimport { VhComponent } from 'src/app/sales/components/vh-component/vh-component';\r\n\r\n\r\n@Component({\r\n  selector: 'app-promotions',\r\n  templateUrl: './promotions.component.html',\r\n  styleUrls: ['./promotions.component.scss']\r\n})\r\nexport class PromotionsComponent implements OnInit {\r\n  public promotions: any[] = [];\r\n  tableHeight: any;\r\n  public date: Date[] = [new Date(), new Date()];\r\n  type: any = 'all'\r\n  promotions_type: Array<any> = [\r\n    { value: \"all\", name: \"All\" },\r\n    { value: 1, name: \"Discount in amount\" },\r\n    { value: 2, name: \"Discount in percent\" },\r\n    { value: 3, name: \"Sản phẩm đồng giá\" },\r\n    { value: 4, name: \"Giảm giá tiền khi mua nhiều sản phẩm\" },\r\n    { value: 5, name: \"Giảm phần trăm khi mua nhiều sản phẩm\" },\r\n    { value: 6, name: \"Tặng quà khi mua nhiều sản phẩm\" },\r\n    { value: 7, name: \"Tặng quà theo tổng giá trị đơn hàng\" },\r\n  ]\r\n  dataRestore: any = this.router.getCurrentNavigation().extras.state\r\n  constructor(\r\n    private router: Router,\r\n    private vhQuerySales: VhQuerySales,\r\n    private cdRef: ChangeDetectorRef,\r\n    private vhAlgorithm: VhAlgorithm,\r\n    private vhComponent: VhComponent,\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.date[0].setHours(0, 0, 0, 0)\r\n    this.date[1].setHours(23, 59, 59, 59)\r\n    if (this.dataRestore) {\r\n      this.type = this.dataRestore.type\r\n      this.date = this.dataRestore.date\r\n      // this.dataRestore.check = true => có thay đổi khi thêm xoa sửa thì get mới dữ liệu\r\n      if (this.dataRestore.check) this.getPromotions_fromTime_toTime(new Date(this.date[0].setHours(0, 0, 0)), new Date(this.date[1].setHours(23, 59, 59, 59)), this.type)\r\n      else this.promotions = this.dataRestore.data\r\n    }\r\n  }\r\n\r\n  /**\r\n   * xem khuyến mãi\r\n   */\r\n  showPromotions() {\r\n    this.vhComponent.showLoading(\"\").then(() => {\r\n      this.getPromotions_fromTime_toTime(new Date(this.date[0].setHours(0, 0, 0)), new Date(this.date[1].setHours(23, 59, 59, 59)), this.type, true)\r\n    })\r\n  }\r\n\r\n\r\n  /**\r\n   * get dữ liệu khuyến mãi từ DB\r\n   */\r\n  getPromotions_fromTime_toTime(fromtime, totime, type, check?) {\r\n    this.vhQuerySales.getPromotions_fromTime_toTime(fromtime, totime, type)\r\n      .then((response) => {\r\n        this.promotions = this.vhAlgorithm.sortVietnamesebyASC(response, 'name').map(item => {\r\n          return {\r\n            ...item,\r\n            render_type: this.renderType(item.type)\r\n          }\r\n        })\r\n        \r\n\r\n        if (check) this.vhComponent.hideLoading()\r\n      }, err => {})\r\n  }\r\n  /**\r\n   * bắt sk thay đổi loại khuyến mãi\r\n   */\r\n  selectType(event) {\r\n    this.type = event\r\n  }\r\n  /**\r\n   * bắt sk thay đổi thời gian chạy CTKM\r\n   */\r\n  changeTime(event) {\r\n    this.date = [new Date(event[0]), new Date(event[1])]\r\n  }\r\n  /** ------------------------- */\r\n  /**\r\n   * router qua trang thêm khuyến mãi\r\n   */\r\n  addPromotion() {\r\n    let data = {\r\n      data: this.promotions,\r\n      type: this.type,\r\n      date: this.date,\r\n    }\r\n    this.router.navigate(['/sales/dashboard/manage/sales-program/promotions/add'], { state: data });\r\n  }\r\n  /**\r\n   * router qua trang xem chi tiết khuyến mãi\r\n   */\r\n  goToPromotionsDetail(promotion) {\r\n    let data = {\r\n      promotion: promotion,\r\n      data: this.promotions,\r\n      type: this.type,\r\n      date: this.date,\r\n    }\r\n    this.router.navigate(['/sales/dashboard/manage/sales-program/promotions/detail'], { state: data })\r\n  }\r\n  /**\r\n   * trả về tên loại khuyến mãi theo type khuyến mãi\r\n   */\r\n  public renderType(type) {\r\n    switch (type) {\r\n      case 1: return 'Discount in amount'\r\n      case 2: return 'Discount in percent'\r\n      case 3: return 'Sản phẩm đồng giá'\r\n      case 4: return 'Giảm giá tiền khi mua nhiều sản phẩm'\r\n      case 5: return 'Giảm phần trăm khi mua nhiều sản phẩm'\r\n      case 6: return 'Tặng quà khi mua nhiều sản phẩm'\r\n      case 7: return 'Tặng quà theo tổng giá trị đơn hàng'\r\n    }\r\n  }\r\n  /**\r\n   * cập nhật trường status của khuyến mãi\r\n   */\r\n  public updateToggle(_id, value) {\r\n    this.vhQuerySales.updatePromotion(_id, { status: value, _id: _id });\r\n  }\r\n  ngAfterViewChecked() {\r\n    if (document.getElementById(\"promotion-invoice-today\").clientHeight && document.querySelector(\".promotion-today-header\") && document.querySelector(\".ant-table-thead\") && document.querySelector(\".ant-table-pagination\")) {\r\n      this.tableHeight = document.getElementById(\"promotion-invoice-today\").clientHeight - document.querySelector(\".promotion-today-header\").clientHeight - document.querySelector(\".ant-table-thead\").clientHeight\r\n        - document.querySelector(\".ant-table-pagination\").clientHeight - 80 + \"px\";\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n  goBack() {\r\n    this.router.navigate(['/sales/dashboard/manage/sales-program']);\r\n  }\r\n\r\n  /** hàm sort cho các cột */\r\n  nameCol = false;\r\n  date_startCol = false;\r\n  date_endCol = false;\r\n  render_typeCol = false;\r\n  /** Hàm thực hiện sắp xếp theo collection\r\n   *\r\n   * @param colName       // tên cột muôn sắp xếp\r\n   */\r\n  sortTable(colName) {\r\n    switch (colName) {\r\n      case 'name':\r\n        if (this.nameCol) {\r\n          this.promotions = this.vhAlgorithm.sortVietnamesebyASC([...this.promotions], colName);\r\n        } else {\r\n          this.promotions = this.vhAlgorithm.sortVietnamesebyDESC([...this.promotions], colName);\r\n        }\r\n        break;\r\n      case 'date_start':\r\n        if (this.date_startCol) {\r\n          this.promotions = this.vhAlgorithm.sortDatebyASC([...this.promotions], colName);\r\n        } else {\r\n          this.promotions = this.vhAlgorithm.sortDatebyDESC([...this.promotions], colName);\r\n        }\r\n        break;\r\n      case 'date_end':\r\n        if (this.date_endCol) {\r\n          this.promotions = this.vhAlgorithm.sortDatebyASC([...this.promotions], colName);\r\n        } else {\r\n          this.promotions = this.vhAlgorithm.sortDatebyDESC([...this.promotions], colName);\r\n        }\r\n        break;\r\n      case 'render_type':\r\n        if (this.render_typeCol) {\r\n          this.promotions = this.vhAlgorithm.sortVietnamesebyASC([...this.promotions], colName);\r\n        } else {\r\n          this.promotions = this.vhAlgorithm.sortVietnamesebyDESC([...this.promotions], colName);\r\n        }\r\n        break;\r\n    }\r\n  }\r\n}\r\n","<div nz-row class=\"row-back medium-size\" (click)=\"goBack()\">\r\n    <i nz-icon nzType=\"left\" nzTheme=\"outline\"></i>{{\"Back\" | translate}}\r\n</div>\r\n<nz-layout id=\"promotion-invoice-today\">\r\n    <div nz-row class=\"promotion-today-header\">\r\n        <div nz-col nzSpan=\"4\" class=\"title left-all-content\">\r\n            <b>{{'Promotions'| translate}}</b>\r\n        </div>\r\n        <div nz-col nzSpan=\"6\" class=\"title center-all-content\">\r\n            <nz-select [(ngModel)]=\"type\" (ngModelChange)=\"selectType($event)\" nzBorderless>\r\n                <nz-option *ngFor=\"let item of promotions_type\" [nzValue]=\"item.value\" [nzLabel]=\"item.name | translate\">\r\n                </nz-option>\r\n            </nz-select>\r\n        </div>\r\n        <div nz-col nzSpan=\"9\" class=\"date-picker-cus\">\r\n            {{'Promotion time' | translate}}\r\n            <nz-range-picker nzFormat='dd/MM/yyyy' [(ngModel)]=\"date\" (ngModelChange)=\"changeTime($event)\"></nz-range-picker>\r\n        </div>\r\n        <div nz-col nzSpan=\"5\" class=\"right-all-content button-group\">\r\n            <div style=\"margin: 1px;\">\r\n                <button class=\"btn-green center-all-content ml-3\" nz-button nzType=\"default\" (click)=\"showPromotions()\">\r\n                    <ion-icon style=\"font-size: 1rem;\" src=\"assets/icon/management/view.svg\"></ion-icon>\r\n                    {{'View' | translate}}\r\n                </button>\r\n            </div>\r\n            <div style=\"margin: 1px;\">\r\n                <button class=\"btn-green center-all-content ml-3 btn-add\" nz-button nzType=\"default\" (click)=\"addPromotion()\">\r\n                    <ion-icon style=\"font-size: 1rem;\" src=\"assets/icon/add.svg\"></ion-icon>\r\n                    {{'Add' | translate}}\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div style=\"margin-top: 20px;\">\r\n        <div>{{'Total' |translate}}<span style=\"color: red;\"> {{promotions.length}} </span>{{'promotions' | translate}}\r\n        </div>\r\n        <nz-table [nzPageSize]=\"20\" [nzPageSizeOptions]=\"[20, 30, 40, 50, 100, 200]\" [nzScroll]=\"{ y: tableHeight }\" [nzData]=\"promotions\" #promotionsShow nzShowPagination nzShowSizeChanger nzNoResult=\"{{'No data' | translate}}\">\r\n            <thead>\r\n                <tr>\r\n                    <th nzWidth=\"8%\"><b>{{'#' | translate}}</b></th>\r\n                    <th style=\"cursor: pointer;\" nzWidth=\"20%\" (click)=\"nameCol = !nameCol;sortTable('name')\">\r\n                        <b>{{'Promotions name' | translate}}</b>\r\n                        <i nz-icon [nzType]=\"nameCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n                    </th>\r\n                    <th style=\"cursor: pointer;\" nzWidth=\"20%\" (click)=\"date_startCol = !date_startCol;sortTable('date_start')\">\r\n                        <b>{{'Starting date' | translate}}</b>\r\n                        <i nz-icon [nzType]=\"date_startCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n                    </th>\r\n                    <th style=\"cursor: pointer;\" nzWidth=\"20%\" (click)=\"date_endCol = !date_endCol;sortTable('date_end')\">\r\n                        <b>{{'Ending date' | translate}}</b>\r\n                        <i nz-icon [nzType]=\"date_endCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n                    </th>\r\n                    <th style=\"cursor: pointer;\" nzWidth=\"20%\" (click)=\"render_typeCol = !render_typeCol;sortTable('render_type')\">\r\n                        <b>{{'Promotions type' | translate}}</b>\r\n                        <i nz-icon [nzType]=\"render_typeCol == true ? 'caret-down':'caret-up'\" nzTheme=\"outline\"></i>\r\n                    </th>\r\n                    <th nzWidth=\"12%\">\r\n                        <b>{{'Status'|translate}}</b></th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr *ngFor=\"let promotion of promotionsShow.data; let i = index\" (click)=\"goToPromotionsDetail(promotion)\" style=\"cursor: pointer;\">\r\n                    <td nzWidth=\"8%\">{{i+1}}</td>\r\n                    <td nzWidth=\"20%\">{{promotion.name}}</td>\r\n                    <td nzWidth=\"20%\">{{promotion.date_start |date: 'dd/MM/yyyy HH:mm'}}</td>\r\n                    <td nzWidth=\"20%\">{{promotion.date_end | date: 'dd/MM/yyyy HH:mm'}}</td>\r\n                    <td nzWidth=\"20%\">{{promotion.render_type | translate}}</td>\r\n                    <td nzWidth=\"12%\">\r\n                        <nz-switch (click)=\"$event.stopPropagation()\" [(ngModel)]=\"promotion.status\" (ngModelChange)=\"updateToggle(promotion._id, $event)\"></nz-switch>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </nz-table>\r\n    </div>\r\n</nz-layout>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { PromotionsComponent } from './promotions.component';\r\nimport { AddComponent } from './add/add.component';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { NgZorroAntModule } from 'src/app/ng-zorro-ant.module';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { SearchProductComponent } from './components/search-product/search-product.component';\r\nimport { DetailComponent } from './detail/detail.component';\r\nimport { ScrollingModule } from '@angular/cdk/scrolling';\r\nimport { CanLeavePage } from 'src/app/canLeavePage';\r\nimport { DiscountTakeGiftComponent } from './components/discount-take-gift/discount-take-gift.component';\r\nimport { DiscountManyProductsComponent } from './components/discount-many-products/discount-many-products.component';\r\nimport { DiscountPriceTotalInvoiceComponent } from './components/discount-price-total-invoice/discount-price-total-invoice.component';\r\nimport { DiscountPriceEachProductComponent } from './components/discount-price-each-product/discount-price-each-product.component';\r\nimport { DiscountPercentTotalProductComponent } from './components/discount-percent-total-product/discount-percent-total-product.component';\r\nimport { DiscountPercentProductComponent } from './components/discount-percent-product/discount-percent-product.component';\r\nimport { DetailDiscountEachProductComponent } from './detail/detail-discount-each-product/detail-discount-each-product.component';\r\nimport { DetailDiscountManyProductComponent } from './detail/detail-discount-many-product/detail-discount-many-product.component';\r\nimport { DetailDiscountTakeGiftComponent } from './detail/detail-discount-take-gift/detail-discount-take-gift.component';\r\nimport { DiscountSamePriceComponent } from './components/discount-same-price/discount-same-price.component';\r\nimport { DetailDiscountSamePriceComponent } from './detail/detail-discount-same-price/detail-discount-same-price.component';\r\nimport { DetailDiscountPercentProductComponent } from './detail/detail-discount-percent-product/detail-discount-percent-product.component';\r\nimport { DetailDiscountPercentProductsComponent } from './detail/detail-discount-percent-products/detail-discount-percent-products.component';\r\nimport { DetailDiscountTotalInvoiceComponent } from './detail/detail-discount-total-invoice/detail-discount-total-invoice.component';\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: PromotionsComponent\r\n  },\r\n  {\r\n    path: 'add',\r\n    component: AddComponent,\r\n    canDeactivate: [CanLeavePage]\r\n  },\r\n  {\r\n    path: 'detail',\r\n    component: DetailComponent\r\n  },\r\n]\r\n\r\n@NgModule({\r\n  declarations: [PromotionsComponent, AddComponent, SearchProductComponent, DetailComponent, DiscountTakeGiftComponent, DiscountManyProductsComponent, DiscountPriceTotalInvoiceComponent, DiscountPriceEachProductComponent, DiscountPercentTotalProductComponent, DiscountPercentProductComponent, DetailDiscountEachProductComponent, DetailDiscountManyProductComponent, DetailDiscountTakeGiftComponent, DiscountSamePriceComponent, DetailDiscountSamePriceComponent, DetailDiscountPercentProductComponent, DetailDiscountPercentProductsComponent, DetailDiscountTotalInvoiceComponent],\r\n  imports: [\r\n    CommonModule,\r\n    RouterModule.forChild(routes),\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    NgZorroAntModule,\r\n    TranslateModule,\r\n    IonicModule,\r\n    ScrollingModule\r\n  ]\r\n})\r\nexport class PromotionsModule { }\r\n"],"names":[],"sourceRoot":"webpack:///"}